Input arguments = Namespace(data_update='permute-opt', dataset='forest', debug=False, drift_test='ddup', model_update='update', model='naru', random_seed=42, num_workload=50)
MODEL-PATH=F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
DATASET-PATH=F:\DBGroup\LearnedCardinalityUpdater\data\forest\end2end\forest.npy
Workload weights: query=15, data-update=10
Workloads: ['DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload']



WORKLOAD-START | Type: DataUpdateWorkload | Progress: 1/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (697214, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 295.9996
detection mean = 43.6630
detection threshold = 0.3123
test statistic = 252.3366
Offline time = 3.231654405593872
online time = 0.5568943023681641
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 1-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (697214, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 697214
train data shape: torch.Size([116202, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 80.1396 bits (loss 99.551, data 19.411) 0.00100 lr
epoch 9 train loss 55.1723 nats / 79.5968 bits
time since start: 4.2 secs
Epoch 10 Iter 0, train entropy gap 59.7847 bits (loss 79.196, data 19.411) 0.00082 lr
epoch 19 train loss 53.3170 nats / 76.9201 bits
time since start: 7.8 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 108.4023 nats / 156.3914 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 1/50 | Workload-time: 7.383779 | Model-update-time: 11.884652


WORKLOAD-START | Type: QueryWorkload | Progress: 2/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
71.4 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 34 (err=5.667)  
76.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
79.9 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 122 (err=3.486)  
83.3 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 4411 (err=1.843)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 75 (err=2.733)  
83.3 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 181 (err=1.207)  
83.3 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 20 (err=44.950)  
83.3 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 395 (err=1.443)  
74.0 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 903 (err=1.377)  
83.3 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 19 (err=2.111)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 1901 (err=1.608)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 15826 (err=1.597)  
90.9 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9307 (err=1.293)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.6 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 7 (err=1.400)  
90.9 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 41 (err=1.367)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
78.7 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
73.9 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 3802 (err=1.009)  
86.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 3 (err=3.000)  
76.9 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 59 (err=1.271)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 8 (err=1.875)  
83.3 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
76.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 1332 (err=1.926)  
90.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
82.8 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 25 (err=1.120)  
55.6 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 59 (err=3.017)  
66.7 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 2 (err=68.000)  
76.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.6 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1678 (err=2.318)  
76.9 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 7 (err=1.143)  
76.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 6 (err=1.500)  
origin-forest_43.843 	max: 68.0000	99th: 65.0600	95th: 50.4775	median: 1.2389	mean: 6.4852
max_err 68.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 2/50 | Workload-time: 4.294374 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.1s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
76.9 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 37 (err=6.167)  
79.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 118 (err=3.371)  
90.9 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 4008 (err=1.674)  
76.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 65 (err=3.154)  
83.3 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 162 (err=1.080)  
87.4 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 14 (err=64.214)  
83.2 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 357 (err=1.597)  
76.9 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 967 (err=1.285)  
83.3 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 15 (err=1.667)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 1441 (err=2.121)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 16017 (err=1.616)  
86.9 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9256 (err=1.286)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 7 (err=1.400)  
90.9 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 43 (err=1.433)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 3162 (err=1.192)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 3 (err=3.000)  
76.9 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 62 (err=1.210)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 9 (err=1.667)  
90.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 1644 (err=1.561)  
83.3 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 26 (err=1.077)  
76.9 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 52 (err=3.423)  
71.4 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 2 (err=68.000)  
76.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1608 (err=2.221)  
71.4 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 7 (err=1.143)  
66.7 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 6 (err=1.500)  
origin-forest_43.843 	max: 68.0000	99th: 66.1450	95th: 58.8500	median: 1.2008	mean: 6.8812
max_err 68.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/50 | Workload-time: 4.196724 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 4/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (836656, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 107.3342
detection mean = 57.5517
detection threshold = 2.3833
test statistic = 49.7825
Offline time = 3.076359272003174
online time = 0.6422038078308105
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 4-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (836656, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 836656
train data shape: torch.Size([139442, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 64.7981 bits (loss 84.472, data 19.674) 0.00100 lr
epoch 9 train loss 54.9346 nats / 79.2539 bits
time since start: 4.1 secs
Epoch 10 Iter 0, train entropy gap 59.0586 bits (loss 78.733, data 19.674) 0.00082 lr
epoch 19 train loss 54.2000 nats / 78.1941 bits
time since start: 7.4 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 78.2444 nats / 112.8829 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 4/50 | Workload-time: 7.323917 | Model-update-time: 11.426367


WORKLOAD-START | Type: QueryWorkload | Progress: 5/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.8 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
76.9 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 28 (err=4.667)  
76.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
76.9 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 262 (err=7.486)  
83.3 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 4560 (err=1.905)  
82.5 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 18 (err=11.389)  
88.8 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 54 (err=2.778)  
77.7 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 10 (err=89.900)  
90.9 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 368 (err=1.549)  
76.9 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 822 (err=1.512)  
83.3 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 6 (err=1.500)  
79.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 1435 (err=2.130)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 16500 (err=1.665)  
83.3 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9822 (err=1.365)  
90.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
86.9 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 40 (err=1.333)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 2260 (err=1.668)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 5 (err=5.000)  
83.3 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 40 (err=1.875)  
71.1 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 10 (err=1.500)  
90.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 1333 (err=1.925)  
90.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 20 (err=1.400)  
76.9 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 42 (err=4.238)  
83.3 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 4 (err=34.000)  
76.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1591 (err=2.198)  
71.4 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 7 (err=1.143)  
74.0 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 6 (err=1.500)  
origin-forest_43.843 	max: 89.9000	99th: 76.2290	95th: 45.5500	median: 1.3824	mean: 7.0575
max_err 89.9
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 5/50 | Workload-time: 4.204663 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 6/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
36.2 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
83.3 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 30 (err=5.000)  
74.0 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 231 (err=6.600)  
90.9 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 4123 (err=1.722)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 17 (err=12.059)  
90.9 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 54 (err=2.778)  
74.0 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 4 (err=224.750)  
83.3 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 403 (err=1.414)  
83.3 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 806 (err=1.542)  
90.9 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 5 (err=1.800)  
76.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 1215 (err=2.516)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 16686 (err=1.684)  
86.4 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9778 (err=1.359)  
86.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
80.7 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 36 (err=1.200)  
86.7 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 2546 (err=1.480)  
90.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 6 (err=6.000)  
76.9 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 42 (err=1.786)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 11 (err=1.364)  
76.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
76.4 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
70.7 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 1691 (err=1.517)  
95.2 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
58.8 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.2 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 23 (err=1.217)  
77.2 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 41 (err=4.341)  
72.8 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 4 (err=34.000)  
76.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1577 (err=2.178)  
76.9 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 6 (err=1.333)  
78.1 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 6 (err=1.500)  
origin-forest_43.843 	max: 224.7500	99th: 145.0025	95th: 45.5500	median: 1.3460	mean: 9.7678
max_err 224.75
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 6/50 | Workload-time: 4.146103 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 7/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
52.6 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
83.3 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 28 (err=4.667)  
70.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 238 (err=6.800)  
83.3 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 4221 (err=1.763)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 18 (err=11.389)  
83.3 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 72 (err=2.083)  
83.0 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 9 (err=99.889)  
83.3 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 406 (err=1.404)  
76.9 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 808 (err=1.538)  
88.0 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 6 (err=1.500)  
71.2 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 1346 (err=2.271)  
76.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 16963 (err=1.712)  
80.0 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9764 (err=1.357)  
90.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
83.3 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 37 (err=1.233)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 2900 (err=1.300)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 6 (err=6.000)  
66.7 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 38 (err=1.974)  
68.6 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 10 (err=1.500)  
76.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
79.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 1665 (err=1.541)  
83.3 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
70.2 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.2 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 20 (err=1.400)  
71.4 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 44 (err=4.045)  
83.3 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 4 (err=34.000)  
76.5 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1554 (err=2.146)  
76.9 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 7 (err=1.143)  
76.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 6 (err=1.500)  
origin-forest_43.843 	max: 99.8889	99th: 81.3233	95th: 45.5500	median: 1.3282	mean: 7.2281
max_err 99.88888888888889
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 7/50 | Workload-time: 4.218213 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 8/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
37.7 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
74.1 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 28 (err=4.667)  
50.0 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 213 (err=6.086)  
90.9 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 4044 (err=1.689)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 19 (err=10.789)  
83.3 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 62 (err=2.419)  
83.3 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 9 (err=99.889)  
83.3 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 407 (err=1.400)  
79.6 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 799 (err=1.556)  
83.3 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 6 (err=1.500)  
76.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 1304 (err=2.344)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 16174 (err=1.632)  
83.3 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9779 (err=1.359)  
90.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
90.9 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 37 (err=1.233)  
79.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.7 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
77.1 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 2447 (err=1.540)  
90.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 6 (err=6.000)  
71.4 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 34 (err=2.206)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 10 (err=1.500)  
83.3 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 1542 (err=1.664)  
90.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 20 (err=1.400)  
79.9 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 44 (err=4.045)  
83.3 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 4 (err=34.000)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1498 (err=2.069)  
76.9 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 7 (err=1.143)  
83.3 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 6 (err=1.500)  
origin-forest_43.843 	max: 99.8889	99th: 81.3233	95th: 45.5500	median: 1.3794	mean: 7.2126
max_err 99.88888888888889
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 8/50 | Workload-time: 4.216645 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 9/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (1003987, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.2s
done, took 0.2s
new data average log likelihood = 79.2657
detection mean = 58.8133
detection threshold = 1.5238
test statistic = 20.4524
Offline time = 3.066556930541992
online time = 0.8003056049346924
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 9-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (1003987, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.2s
dataset size: 1003987
train data shape: torch.Size([167331, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 61.7465 bits (loss 81.684, data 19.937) 0.00100 lr
epoch 9 train loss 55.2964 nats / 79.7759 bits
time since start: 4.5 secs
Epoch 10 Iter 0, train entropy gap 60.0083 bits (loss 79.946, data 19.937) 0.00082 lr
epoch 19 train loss 54.7156 nats / 78.9380 bits
time since start: 8.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 68.5400 nats / 98.8823 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 9/50 | Workload-time: 7.685984 | Model-update-time: 12.447569


WORKLOAD-START | Type: QueryWorkload | Progress: 10/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.1s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
30.2 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
76.9 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 41 (err=6.833)  
76.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
76.9 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 267 (err=7.629)  
90.9 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 4817 (err=2.012)  
76.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 68 (err=3.015)  
83.3 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 11 (err=13.636)  
71.4 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 8 (err=112.375)  
83.3 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 445 (err=1.281)  
83.3 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 815 (err=1.525)  
76.8 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 2 (err=4.500)  
77.8 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 1522 (err=2.009)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
69.8 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 15426 (err=1.556)  
74.6 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 10042 (err=1.395)  
86.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.7 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 3 (err=1.667)  
79.9 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 26 (err=1.154)  
83.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
73.7 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.5 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 2303 (err=1.637)  
76.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 8 (err=8.000)  
74.0 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 26 (err=2.885)  
71.4 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 11 (err=1.364)  
90.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
76.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 1701 (err=1.509)  
76.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
71.4 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.2 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 21 (err=1.333)  
76.9 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 47 (err=3.787)  
76.9 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 5 (err=27.200)  
71.4 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.7 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
77.1 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.9 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1253 (err=1.731)  
71.4 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 4 (err=2.000)  
71.4 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 112.3750	99th: 87.6912	95th: 42.4900	median: 1.3485	mean: 7.5856
max_err 112.375
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 10/50 | Workload-time: 4.719611 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 11/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (1204784, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.2s
done, took 0.2s
new data average log likelihood = 68.6377
detection mean = 58.4968
detection threshold = 1.0193
test statistic = 10.1409
Offline time = 3.4205729961395264
online time = 0.8922519683837891
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 11-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (1204784, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.2s
dataset size: 1204784
train data shape: torch.Size([200797, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 61.0748 bits (loss 81.275, data 20.200) 0.00100 lr
epoch 9 train loss 55.2377 nats / 79.6912 bits
time since start: 4.5 secs
Epoch 10 Iter 0, train entropy gap 59.2937 bits (loss 79.494, data 20.200) 0.00082 lr
epoch 19 train loss 54.8661 nats / 79.1551 bits
time since start: 7.8 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 62.3662 nats / 89.9754 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 11/50 | Workload-time: 8.354344 | Model-update-time: 12.557980


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 12/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (1445740, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.2s
done, took 0.2s
new data average log likelihood = 62.5349
detection mean = 57.4637
detection threshold = 0.6957
test statistic = 5.0712
Offline time = 3.4670145511627197
online time = 1.049424648284912
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 12-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (1445740, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.2s
dataset size: 1445740
train data shape: torch.Size([240956, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 60.4135 bits (loss 80.877, data 20.463) 0.00100 lr
epoch 9 train loss 55.2563 nats / 79.7180 bits
time since start: 4.1 secs
Epoch 10 Iter 0, train entropy gap 59.2973 bits (loss 79.761, data 20.463) 0.00082 lr
epoch 19 train loss 55.0496 nats / 79.4198 bits
time since start: 7.5 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 59.2922 nats / 85.5405 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 12/50 | Workload-time: 8.734213 | Model-update-time: 12.460532


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 13/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (1734888, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.3s
done, took 0.3s
new data average log likelihood = 59.3393
detection mean = 56.6455
detection threshold = 0.5034
test statistic = 2.6938
Offline time = 3.2733139991760254
online time = 1.223590612411499
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 13-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (1734888, 10)
Parsing... done, took 0.2s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.3s
dataset size: 1734888
train data shape: torch.Size([289148, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 60.0939 bits (loss 80.820, data 20.726) 0.00100 lr
epoch 9 train loss 55.4297 nats / 79.9681 bits
time since start: 4.1 secs
Epoch 10 Iter 0, train entropy gap 59.5678 bits (loss 80.294, data 20.726) 0.00082 lr
epoch 19 train loss 55.3302 nats / 79.8246 bits
time since start: 7.5 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 57.8447 nats / 83.4523 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 13/50 | Workload-time: 9.172156 | Model-update-time: 13.007399


WORKLOAD-START | Type: QueryWorkload | Progress: 14/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
29.8 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
76.9 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 94 (err=15.667)  
71.4 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 162 (err=4.629)  
83.3 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 2878 (err=1.202)  
86.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
77.4 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 114 (err=1.798)  
89.8 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 4 (err=37.500)  
79.0 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 35 (err=25.686)  
90.9 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 534 (err=1.067)  
83.3 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 648 (err=1.918)  
83.3 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 6 (err=1.500)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
69.7 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2008 (err=1.522)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 12132 (err=1.224)  
76.9 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9577 (err=1.331)  
90.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
86.9 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 36 (err=1.200)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
73.8 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1879 (err=2.006)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 17 (err=17.000)  
76.9 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 56 (err=1.339)  
80.0 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 7 (err=2.143)  
90.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 2028 (err=1.265)  
90.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 17 (err=1.647)  
76.9 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 74 (err=2.405)  
76.9 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 6 (err=22.667)  
71.4 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1424 (err=1.967)  
52.6 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
64.5 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
75.7 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 32.1836	median: 1.2011	mean: 6.3612
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 14/50 | Workload-time: 4.317791 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 15/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (2081865, 10)
Parsing... done, took 0.2s
Data updated!
done, took 0.3s
done, took 0.3s
new data average log likelihood = 57.8491
detection mean = 56.3211
detection threshold = 0.4011
test statistic = 1.5280
Offline time = 3.3739676475524902
online time = 1.4532034397125244
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 15-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (2081865, 10)
Parsing... done, took 0.2s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.3s
dataset size: 2081865
train data shape: torch.Size([346977, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 59.7341 bits (loss 80.724, data 20.989) 0.00100 lr
epoch 9 train loss 55.5923 nats / 80.2027 bits
time since start: 4.2 secs
Epoch 10 Iter 0, train entropy gap 59.1284 bits (loss 80.118, data 20.989) 0.00082 lr
epoch 19 train loss 55.5218 nats / 80.1010 bits
time since start: 7.5 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 57.1558 nats / 82.4584 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 15/50 | Workload-time: 9.794557 | Model-update-time: 13.538155


WORKLOAD-START | Type: QueryWorkload | Progress: 16/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
22.7 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
52.8 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
76.9 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 101 (err=16.833)  
76.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
90.9 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 126 (err=3.600)  
90.9 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3158 (err=1.319)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.7 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.8 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 125 (err=1.640)  
83.3 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 6 (err=25.000)  
76.9 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 41 (err=21.927)  
90.9 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 592 (err=1.039)  
76.9 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 569 (err=2.185)  
83.3 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 9 (err=1.000)  
76.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
73.9 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2164 (err=1.413)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 11502 (err=1.161)  
90.9 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9562 (err=1.329)  
90.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
90.9 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 34 (err=1.133)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
87.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1834 (err=2.055)  
90.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 17 (err=17.000)  
71.4 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 50 (err=1.500)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 7 (err=2.143)  
86.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 1991 (err=1.289)  
90.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 17 (err=1.647)  
83.3 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 87 (err=2.046)  
79.9 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1381 (err=1.907)  
76.9 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 11 (err=1.375)  
76.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 23.6171	median: 1.1469	mean: 5.9644
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 16/50 | Workload-time: 4.243979 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 17/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
29.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
83.3 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 101 (err=16.833)  
76.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
90.9 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 120 (err=3.429)  
83.3 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3254 (err=1.359)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 123 (err=1.667)  
83.3 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 7 (err=21.429)  
83.3 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 40 (err=22.475)  
90.9 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 584 (err=1.025)  
73.9 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 582 (err=2.136)  
83.3 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 9 (err=1.000)  
76.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2121 (err=1.441)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 11516 (err=1.162)  
90.9 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9567 (err=1.329)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
90.9 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 33 (err=1.100)  
86.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
84.2 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1803 (err=2.090)  
90.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 17 (err=17.000)  
76.9 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 49 (err=1.531)  
76.8 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 7 (err=2.143)  
83.4 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
90.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 1990 (err=1.289)  
90.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 17 (err=1.647)  
79.9 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 90 (err=1.978)  
83.3 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
79.4 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1377 (err=1.902)  
83.3 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 11 (err=1.375)  
76.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.3 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 22.0041	median: 1.1310	mean: 5.9004
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 17/50 | Workload-time: 4.226680 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 18/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
30.3 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
78.9 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
71.4 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 103 (err=17.167)  
71.4 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.9 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
76.9 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 120 (err=3.429)  
90.9 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3186 (err=1.331)  
76.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 124 (err=1.653)  
83.3 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 7 (err=21.429)  
83.3 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 39 (err=23.051)  
82.3 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 588 (err=1.032)  
76.9 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 571 (err=2.177)  
83.3 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 8 (err=1.125)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2086 (err=1.465)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 11559 (err=1.166)  
90.9 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9565 (err=1.329)  
86.8 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.6 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
83.3 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 34 (err=1.133)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.8 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1841 (err=2.047)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 17 (err=17.000)  
71.4 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 52 (err=1.442)  
90.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 7 (err=2.143)  
83.3 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 1950 (err=1.316)  
86.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 17 (err=1.647)  
80.7 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 88 (err=2.023)  
61.0 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
76.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
75.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1358 (err=1.876)  
71.4 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 11 (err=1.375)  
71.4 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 4 (err=1.000)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 22.3211	median: 1.1292	mean: 5.9157
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 18/50 | Workload-time: 4.256475 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 19/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
28.6 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
76.9 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 102 (err=17.000)  
79.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
76.9 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 118 (err=3.371)  
90.9 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3217 (err=1.344)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 121 (err=1.694)  
90.8 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 7 (err=21.429)  
79.9 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 40 (err=22.475)  
83.3 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 592 (err=1.039)  
71.4 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 576 (err=2.158)  
90.9 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 8 (err=1.125)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
55.6 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2112 (err=1.447)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 11403 (err=1.151)  
86.8 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9568 (err=1.329)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
83.3 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 34 (err=1.133)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
73.7 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1833 (err=2.056)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 17 (err=17.000)  
71.4 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 50 (err=1.500)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 7 (err=2.143)  
90.8 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 1972 (err=1.301)  
90.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 17 (err=1.647)  
83.3 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 89 (err=2.000)  
83.3 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
68.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1365 (err=1.885)  
62.5 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 11 (err=1.375)  
83.3 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
73.4 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 22.0041	median: 1.1419	mean: 5.9056
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 19/50 | Workload-time: 4.323602 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 20/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
30.8 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
83.3 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 101 (err=16.833)  
83.3 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
86.2 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 122 (err=3.486)  
79.9 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3231 (err=1.350)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 122 (err=1.680)  
83.3 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 7 (err=21.429)  
83.3 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 40 (err=22.475)  
90.9 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 590 (err=1.035)  
83.3 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 573 (err=2.169)  
86.8 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 9 (err=1.000)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2180 (err=1.402)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 11671 (err=1.178)  
90.9 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9569 (err=1.330)  
90.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 6 (err=1.200)  
90.8 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 34 (err=1.133)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1834 (err=2.055)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 17 (err=17.000)  
76.9 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 52 (err=1.442)  
79.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 7 (err=2.143)  
90.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 1955 (err=1.313)  
83.3 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 16 (err=1.750)  
71.4 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 85 (err=2.094)  
71.4 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
66.7 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1376 (err=1.901)  
69.7 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 11 (err=1.375)  
76.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 22.0041	median: 1.1888	mean: 5.9090
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 20/50 | Workload-time: 4.287720 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 21/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.1s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
33.3 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
76.9 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 103 (err=17.167)  
76.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 118 (err=3.371)  
76.9 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3151 (err=1.316)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 127 (err=1.614)  
83.3 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 7 (err=21.429)  
83.3 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 40 (err=22.475)  
89.8 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 589 (err=1.033)  
83.3 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 583 (err=2.132)  
90.0 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 9 (err=1.000)  
77.6 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.7 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2132 (err=1.434)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 11501 (err=1.160)  
90.8 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9577 (err=1.331)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 6 (err=1.200)  
90.9 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 34 (err=1.133)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1792 (err=2.103)  
95.1 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 17 (err=17.000)  
73.4 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 51 (err=1.471)  
71.4 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 7 (err=2.143)  
90.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
90.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.6 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 1959 (err=1.310)  
83.3 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
86.8 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 17 (err=1.647)  
83.3 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 89 (err=2.000)  
83.3 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.9 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1391 (err=1.921)  
71.4 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 11 (err=1.375)  
83.3 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 22.0041	median: 1.1802	mean: 5.9089
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 21/50 | Workload-time: 4.286739 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 22/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (2498238, 10)
Parsing... done, took 0.2s
Data updated!
done, took 0.4s
done, took 0.4s
new data average log likelihood = 57.1708
detection mean = 56.2178
detection threshold = 0.3579
test statistic = 0.9530
Offline time = 3.6242597103118896
online time = 1.8336663246154785
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 22-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (2498238, 10)
Parsing... done, took 0.2s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.4s
dataset size: 2498238
train data shape: torch.Size([416373, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 59.3998 bits (loss 80.652, data 21.252) 0.00100 lr
epoch 9 train loss 55.7231 nats / 80.3915 bits
time since start: 4.4 secs
Epoch 10 Iter 0, train entropy gap 59.3073 bits (loss 80.560, data 21.252) 0.00082 lr
epoch 19 train loss 55.6834 nats / 80.3342 bits
time since start: 7.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 56.9145 nats / 82.1103 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 22/50 | Workload-time: 10.980023 | Model-update-time: 14.922461


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 23/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (2997885, 10)
Parsing... done, took 0.3s
Data updated!
done, took 0.4s
done, took 0.4s
new data average log likelihood = 56.7728
detection mean = 56.1740
detection threshold = 0.3243
test statistic = 0.5988
Offline time = 3.798435688018799
online time = 2.103001117706299
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 23-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (2997885, 10)
Parsing... done, took 0.2s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.5s
dataset size: 2997885
train data shape: torch.Size([499647, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 59.2648 bits (loss 80.780, data 21.516) 0.00100 lr
epoch 9 train loss 55.8236 nats / 80.5364 bits
time since start: 4.4 secs
Epoch 10 Iter 0, train entropy gap 59.1632 bits (loss 80.679, data 21.516) 0.00082 lr
epoch 19 train loss 55.7829 nats / 80.4778 bits
time since start: 7.7 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 56.4817 nats / 81.4859 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 23/50 | Workload-time: 12.284039 | Model-update-time: 15.375451


WORKLOAD-START | Type: QueryWorkload | Progress: 24/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
31.3 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
51.3 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
58.8 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 112 (err=18.667)  
71.4 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 84 (err=2.400)  
83.3 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 2908 (err=1.215)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 124 (err=1.653)  
83.3 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 5 (err=30.000)  
76.9 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 38 (err=23.658)  
83.3 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 615 (err=1.079)  
76.9 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 523 (err=2.377)  
83.3 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 10 (err=1.111)  
71.4 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2223 (err=1.375)  
86.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
69.2 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 11552 (err=1.166)  
91.8 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9804 (err=1.362)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
90.6 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 38 (err=1.267)  
83.6 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1735 (err=2.172)  
76.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
71.4 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 46 (err=1.630)  
71.4 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 6 (err=2.500)  
79.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 2480 (err=1.035)  
90.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 17 (err=1.647)  
74.0 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 95 (err=1.874)  
76.9 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
71.4 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
45.5 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1213 (err=1.675)  
76.9 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
80.0 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 27.1461	median: 1.1453	mean: 6.1783
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 24/50 | Workload-time: 4.528440 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 25/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (3597462, 10)
Parsing... done, took 0.3s
Data updated!
done, took 0.5s
done, took 0.5s
new data average log likelihood = 56.5130
detection mean = 56.1497
detection threshold = 0.3025
test statistic = 0.3634
Offline time = 3.8558058738708496
online time = 2.4321534633636475
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 25-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (3597462, 10)
Parsing... done, took 0.3s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.5s
dataset size: 3597462
train data shape: torch.Size([599577, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 59.0703 bits (loss 80.849, data 21.779) 0.00100 lr
epoch 9 train loss 55.8648 nats / 80.5958 bits
time since start: 4.6 secs
Epoch 10 Iter 0, train entropy gap 58.7472 bits (loss 80.526, data 21.779) 0.00082 lr
epoch 19 train loss 55.8280 nats / 80.5428 bits
time since start: 8.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 56.4480 nats / 81.4372 bits
Epoch None Iter 500, test loss 56.3897 nats / 81.3531 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 25/50 | Workload-time: 13.359105 | Model-update-time: 16.795866


WORKLOAD-START | Type: QueryWorkload | Progress: 26/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
27.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
76.9 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 112 (err=18.667)  
83.3 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 81 (err=2.314)  
83.3 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3201 (err=1.337)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.9 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 128 (err=1.602)  
66.7 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 5 (err=30.000)  
58.8 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 33 (err=27.242)  
83.3 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 634 (err=1.112)  
71.4 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 544 (err=2.285)  
83.3 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 10 (err=1.111)  
76.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2303 (err=1.327)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 10927 (err=1.103)  
76.9 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9378 (err=1.303)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
83.3 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 34 (err=1.133)  
79.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1701 (err=2.216)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
66.6 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 47 (err=1.596)  
74.0 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 7 (err=2.143)  
90.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 2520 (err=1.018)  
83.3 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 15 (err=1.867)  
83.3 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 93 (err=1.914)  
83.3 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
76.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
73.5 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1149 (err=1.587)  
83.3 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
86.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 28.7591	median: 1.1186	mean: 6.2386
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 26/50 | Workload-time: 4.567273 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 27/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (4316954, 10)
Parsing... done, took 0.3s
Data updated!
done, took 0.7s
done, took 0.6s
new data average log likelihood = 56.3502
detection mean = 56.1345
detection threshold = 0.2938
test statistic = 0.2156
Offline time = 4.227124929428101
online time = 2.9622857570648193
Test result: False
Drift detection: False
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 27/50 | Workload-time: 15.164124 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 28/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (5180344, 10)
Parsing... done, took 0.4s
Data updated!
done, took 0.8s
done, took 0.8s
new data average log likelihood = 56.3514
detection mean = 56.1714
detection threshold = 0.2936
test statistic = 0.1800
Offline time = 4.33172082901001
online time = 3.5866801738739014
Test result: False
Drift detection: False
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 28/50 | Workload-time: 16.789943 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 29/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (6216412, 10)
Parsing... done, took 0.5s
Data updated!
done, took 0.9s
done, took 0.9s
new data average log likelihood = 56.3558
detection mean = 56.2006
detection threshold = 0.2819
test statistic = 0.1552
Offline time = 4.544536828994751
online time = 4.1898033618927
Test result: False
Drift detection: False
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 29/50 | Workload-time: 19.281117 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 30/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (7459694, 10)
Parsing... done, took 0.6s
Data updated!
done, took 1.1s
done, took 1.2s
new data average log likelihood = 56.3532
detection mean = 56.2314
detection threshold = 0.2964
test statistic = 0.1218
Offline time = 5.300597667694092
online time = 5.713649034500122
Test result: False
Drift detection: False
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 30/50 | Workload-time: 23.422724 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 31/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.1s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
33.3 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
83.3 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 111 (err=18.500)  
71.4 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 82 (err=2.343)  
83.3 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3206 (err=1.339)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 127 (err=1.614)  
90.9 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 5 (err=30.000)  
76.9 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 32 (err=28.094)  
90.9 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 637 (err=1.118)  
79.9 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 547 (err=2.272)  
90.9 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 10 (err=1.111)  
79.5 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2272 (err=1.346)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 10952 (err=1.105)  
91.0 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9380 (err=1.303)  
90.8 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
83.3 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 35 (err=1.167)  
88.5 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
77.7 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1700 (err=2.217)  
86.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
76.9 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 47 (err=1.596)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 6 (err=2.500)  
90.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
71.4 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.6 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 2543 (err=1.009)  
76.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
64.4 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.5 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 15 (err=1.867)  
71.4 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 94 (err=1.894)  
71.4 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
76.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.0 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1157 (err=1.598)  
76.9 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
76.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 29.1422	median: 1.1213	mean: 6.2609
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 31/50 | Workload-time: 4.697317 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 32/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
31.7 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
76.9 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 112 (err=18.667)  
76.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 80 (err=2.286)  
86.9 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3202 (err=1.338)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 129 (err=1.589)  
90.9 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 5 (err=30.000)  
79.5 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 32 (err=28.094)  
87.8 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 636 (err=1.116)  
83.3 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 545 (err=2.281)  
95.1 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 9 (err=1.000)  
76.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2260 (err=1.353)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 10927 (err=1.103)  
90.9 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9382 (err=1.304)  
90.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
86.9 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 35 (err=1.167)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1708 (err=2.207)  
90.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
62.5 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 47 (err=1.596)  
64.4 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
77.0 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 7 (err=2.143)  
83.3 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
71.4 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 2514 (err=1.021)  
90.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 15 (err=1.867)  
76.9 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 93 (err=1.914)  
90.9 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1137 (err=1.570)  
74.0 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
76.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 29.1422	median: 1.1204	mean: 6.2533
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 32/50 | Workload-time: 4.586302 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 33/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
29.8 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.5 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
83.3 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 112 (err=18.667)  
76.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 83 (err=2.371)  
90.9 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3195 (err=1.335)  
95.2 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 127 (err=1.614)  
83.3 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 5 (err=30.000)  
83.3 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 32 (err=28.094)  
83.3 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 636 (err=1.116)  
83.3 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 544 (err=2.285)  
83.1 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 9 (err=1.000)  
79.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2263 (err=1.351)  
76.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 10965 (err=1.106)  
76.9 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9379 (err=1.303)  
76.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
86.8 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 34 (err=1.133)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1728 (err=2.181)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
76.9 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 48 (err=1.562)  
76.4 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 7 (err=2.143)  
100.0 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
71.4 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 2552 (err=1.005)  
90.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 15 (err=1.867)  
83.3 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 94 (err=1.894)  
83.3 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
76.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1150 (err=1.588)  
71.4 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
86.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 29.1422	median: 1.1204	mean: 6.2534
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 33/50 | Workload-time: 4.570355 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 34/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (8951632, 10)
Parsing... done, took 0.7s
Data updated!
done, took 1.3s
done, took 1.4s
new data average log likelihood = 56.3490
detection mean = 56.2442
detection threshold = 0.2879
test statistic = 0.1048
Offline time = 5.3932013511657715
online time = 6.480379581451416
Test result: False
Drift detection: False
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 34/50 | Workload-time: 26.747364 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 35/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
27.8 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
74.1 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 112 (err=18.667)  
76.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 82 (err=2.343)  
83.3 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3173 (err=1.325)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 128 (err=1.602)  
80.0 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 5 (err=30.000)  
83.3 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 32 (err=28.094)  
90.9 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 631 (err=1.107)  
62.5 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 550 (err=2.260)  
83.3 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 9 (err=1.000)  
71.4 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2278 (err=1.342)  
76.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
64.5 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 10946 (err=1.104)  
76.9 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9368 (err=1.302)  
90.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
90.9 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 35 (err=1.167)  
76.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1706 (err=2.209)  
90.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
76.9 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 48 (err=1.562)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 6 (err=2.500)  
90.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
86.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 2530 (err=1.014)  
90.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
71.4 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 15 (err=1.867)  
83.3 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 94 (err=1.894)  
83.3 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
68.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1163 (err=1.606)  
62.5 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
71.4 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
64.5 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 29.1422	median: 1.1160	mean: 6.2604
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 35/50 | Workload-time: 4.816512 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 36/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
34.5 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
79.9 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 111 (err=18.500)  
79.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 82 (err=2.343)  
83.3 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3202 (err=1.338)  
76.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 127 (err=1.614)  
91.0 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 5 (err=30.000)  
79.9 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 33 (err=27.242)  
71.4 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 632 (err=1.109)  
76.9 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 545 (err=2.281)  
83.3 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 10 (err=1.111)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2281 (err=1.340)  
86.5 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 10845 (err=1.094)  
95.1 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9381 (err=1.303)  
90.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
90.9 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 34 (err=1.133)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1707 (err=2.208)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
76.9 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 46 (err=1.630)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 7 (err=2.143)  
83.3 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 2561 (err=1.002)  
89.4 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.0 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.5 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 15 (err=1.867)  
83.3 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 94 (err=1.894)  
83.3 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
76.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1153 (err=1.593)  
71.4 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
71.4 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 28.7591	median: 1.1181	mean: 6.2360
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 36/50 | Workload-time: 4.625670 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 37/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (10741958, 10)
Parsing... done, took 0.8s
Data updated!
done, took 1.6s
done, took 1.7s
new data average log likelihood = 56.3574
detection mean = 56.2677
detection threshold = 0.2892
test statistic = 0.0897
Offline time = 6.047903060913086
online time = 7.781131267547607
Test result: False
Drift detection: False
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 37/50 | Workload-time: 31.569769 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 38/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
29.8 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
76.9 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 111 (err=18.500)  
71.4 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.4 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 82 (err=2.343)  
76.9 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3191 (err=1.333)  
79.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 129 (err=1.589)  
76.9 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 5 (err=30.000)  
83.3 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 33 (err=27.242)  
83.3 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 632 (err=1.109)  
76.9 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 540 (err=2.302)  
83.3 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 10 (err=1.111)  
79.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2266 (err=1.349)  
76.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 10978 (err=1.108)  
83.3 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9386 (err=1.304)  
76.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
90.9 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 34 (err=1.133)  
76.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1728 (err=2.181)  
80.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
71.1 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 47 (err=1.596)  
66.7 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 7 (err=2.143)  
83.3 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 2592 (err=1.010)  
94.5 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.5 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 15 (err=1.867)  
76.9 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 94 (err=1.894)  
71.4 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
55.5 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
55.4 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1151 (err=1.590)  
71.4 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
76.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 28.7591	median: 1.1181	mean: 6.2351
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 38/50 | Workload-time: 4.871939 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 39/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (12890349, 10)
Parsing... done, took 0.9s
Data updated!
done, took 1.9s
done, took 2.0s
new data average log likelihood = 56.3561
detection mean = 56.2887
detection threshold = 0.2906
test statistic = 0.0675
Offline time = 6.519916772842407
online time = 9.25716781616211
Test result: False
Drift detection: False
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 39/50 | Workload-time: 37.202631 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 40/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
29.4 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
76.9 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 111 (err=18.500)  
76.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 81 (err=2.314)  
76.9 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3233 (err=1.350)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 128 (err=1.602)  
83.3 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 5 (err=30.000)  
76.9 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 32 (err=28.094)  
86.9 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 637 (err=1.118)  
71.4 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 542 (err=2.293)  
76.9 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 10 (err=1.111)  
76.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2287 (err=1.337)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 11066 (err=1.117)  
90.9 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9377 (err=1.303)  
95.1 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
90.9 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 35 (err=1.167)  
76.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1715 (err=2.198)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
76.9 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 47 (err=1.596)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 6 (err=2.500)  
90.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.6 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 2504 (err=1.025)  
90.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
76.8 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 15 (err=1.867)  
83.3 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 93 (err=1.914)  
83.3 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1140 (err=1.575)  
83.3 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
74.6 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
72.4 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 29.1422	median: 1.1213	mean: 6.2606
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 40/50 | Workload-time: 4.807801 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 41/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
24.7 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
66.7 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 111 (err=18.500)  
71.4 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 79 (err=2.257)  
83.3 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3182 (err=1.329)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 128 (err=1.602)  
83.3 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 5 (err=30.000)  
76.9 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 32 (err=28.094)  
86.9 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 638 (err=1.119)  
83.3 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 541 (err=2.298)  
83.3 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 10 (err=1.111)  
76.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.9 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2280 (err=1.341)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 10876 (err=1.097)  
90.9 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9375 (err=1.303)  
86.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
83.3 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 35 (err=1.167)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1717 (err=2.195)  
79.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
76.9 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 47 (err=1.596)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 6 (err=2.500)  
90.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.6 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 2564 (err=1.001)  
90.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
86.8 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 15 (err=1.867)  
83.3 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 93 (err=1.914)  
76.9 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
76.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
73.2 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1146 (err=1.583)  
71.0 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
83.3 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 29.1422	median: 1.1152	mean: 6.2535
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 41/50 | Workload-time: 4.754100 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 42/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
33.3 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
83.3 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 112 (err=18.667)  
79.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 81 (err=2.314)  
83.3 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3206 (err=1.339)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 127 (err=1.614)  
86.9 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 5 (err=30.000)  
83.3 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 33 (err=27.242)  
89.6 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 633 (err=1.111)  
83.1 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 538 (err=2.310)  
86.3 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 10 (err=1.111)  
83.4 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2268 (err=1.348)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 10891 (err=1.099)  
86.9 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9379 (err=1.303)  
90.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
90.9 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 35 (err=1.167)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1719 (err=2.193)  
90.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
71.4 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 47 (err=1.596)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 7 (err=2.143)  
90.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.9 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 2514 (err=1.021)  
90.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 15 (err=1.867)  
83.3 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 94 (err=1.894)  
83.3 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
74.4 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1152 (err=1.591)  
66.7 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
76.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 28.7591	median: 1.1108	mean: 6.2346
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 42/50 | Workload-time: 4.805647 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 43/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
27.8 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
83.3 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 111 (err=18.500)  
76.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
79.9 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 79 (err=2.257)  
66.7 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3187 (err=1.331)  
71.4 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 128 (err=1.602)  
79.5 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 5 (err=30.000)  
83.3 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 33 (err=27.242)  
90.9 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 628 (err=1.102)  
74.0 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 544 (err=2.285)  
90.9 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 9 (err=1.000)  
76.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2275 (err=1.344)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 10835 (err=1.093)  
87.9 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9377 (err=1.303)  
90.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
83.3 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 35 (err=1.167)  
71.4 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1709 (err=2.205)  
74.0 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
71.4 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 47 (err=1.596)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 6 (err=2.500)  
83.3 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
76.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 2510 (err=1.022)  
95.1 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
83.0 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.7 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.1 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 15 (err=1.867)  
83.3 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 93 (err=1.914)  
83.3 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1139 (err=1.573)  
76.9 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
76.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 28.7591	median: 1.1134	mean: 6.2391
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 43/50 | Workload-time: 4.688658 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 44/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
29.3 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
66.7 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 111 (err=18.500)  
60.4 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
71.4 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 81 (err=2.314)  
74.0 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3189 (err=1.332)  
62.5 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
58.8 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 127 (err=1.614)  
76.9 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 5 (err=30.000)  
66.7 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 33 (err=27.242)  
76.9 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 636 (err=1.116)  
68.9 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 546 (err=2.277)  
76.9 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 10 (err=1.111)  
66.7 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2263 (err=1.351)  
71.4 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 10973 (err=1.107)  
71.4 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9391 (err=1.305)  
68.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
76.9 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 35 (err=1.167)  
68.6 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1714 (err=2.199)  
76.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
76.9 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 46 (err=1.630)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 7 (err=2.143)  
90.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 2543 (err=1.009)  
90.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 15 (err=1.867)  
66.7 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 93 (err=1.914)  
62.5 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
60.6 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
36.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
64.2 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
69.4 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1139 (err=1.573)  
55.6 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
66.6 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
60.5 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 28.7591	median: 1.1204	mean: 6.2365
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 44/50 | Workload-time: 4.921072 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 45/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (15468418, 10)
Parsing... done, took 1.2s
Data updated!
done, took 2.3s
done, took 2.4s
new data average log likelihood = 56.3546
detection mean = 56.2879
detection threshold = 0.2753
test statistic = 0.0667
Offline time = 6.876203536987305
online time = 10.9733567237854
Test result: False
Drift detection: False
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 45/50 | Workload-time: 46.248278 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 46/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
26.7 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
83.3 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 111 (err=18.500)  
71.4 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 80 (err=2.286)  
79.9 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3152 (err=1.317)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 128 (err=1.602)  
83.3 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 5 (err=30.000)  
83.3 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 33 (err=27.242)  
90.9 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 631 (err=1.107)  
83.3 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 544 (err=2.285)  
86.9 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 10 (err=1.111)  
76.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2262 (err=1.351)  
86.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 10932 (err=1.103)  
90.9 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9372 (err=1.302)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
90.9 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 35 (err=1.167)  
83.1 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.6 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1713 (err=2.200)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
71.2 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 47 (err=1.596)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 7 (err=2.143)  
76.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 2551 (err=1.006)  
90.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
62.4 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.8 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
77.0 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 15 (err=1.867)  
83.3 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 93 (err=1.914)  
76.9 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
76.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1152 (err=1.591)  
82.3 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
71.4 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 28.7591	median: 1.1181	mean: 6.2349
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 46/50 | Workload-time: 4.734614 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 47/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
29.4 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
83.3 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 112 (err=18.667)  
74.0 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 81 (err=2.314)  
90.9 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3203 (err=1.338)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 129 (err=1.589)  
90.8 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 5 (err=30.000)  
76.9 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 33 (err=27.242)  
82.3 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 633 (err=1.111)  
83.3 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 546 (err=2.277)  
90.9 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 10 (err=1.111)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.7 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2274 (err=1.344)  
90.2 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 10941 (err=1.104)  
90.9 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9372 (err=1.302)  
86.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
90.9 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 35 (err=1.167)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1700 (err=2.217)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
71.4 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 47 (err=1.596)  
60.5 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 6 (err=2.500)  
90.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
76.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 2530 (err=1.014)  
95.1 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 15 (err=1.867)  
76.9 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 93 (err=1.914)  
76.9 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.7 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1147 (err=1.584)  
71.4 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
83.3 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.6 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 28.7591	median: 1.1181	mean: 6.2462
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 47/50 | Workload-time: 4.636708 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 48/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
23.8 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
79.9 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 112 (err=18.667)  
66.7 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
71.4 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 80 (err=2.286)  
71.4 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3203 (err=1.338)  
76.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.3 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 126 (err=1.627)  
83.3 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 5 (err=30.000)  
83.3 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 32 (err=28.094)  
83.3 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 634 (err=1.112)  
83.3 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 547 (err=2.272)  
71.4 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 10 (err=1.111)  
56.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2277 (err=1.343)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 10962 (err=1.106)  
77.0 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9384 (err=1.304)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
61.8 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
72.6 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 34 (err=1.133)  
76.6 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.6 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1695 (err=2.224)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
76.9 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 48 (err=1.562)  
74.0 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 6 (err=2.500)  
83.3 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.4 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 2551 (err=1.006)  
83.3 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 15 (err=1.867)  
76.9 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 93 (err=1.914)  
83.3 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
76.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1139 (err=1.573)  
76.9 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
80.0 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 29.1422	median: 1.1186	mean: 6.2618
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 48/50 | Workload-time: 4.664947 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 49/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
33.3 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
76.9 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 112 (err=18.667)  
77.8 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
75.3 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
86.9 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 81 (err=2.314)  
83.3 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3177 (err=1.327)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 129 (err=1.589)  
90.9 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 5 (err=30.000)  
83.3 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 33 (err=27.242)  
83.3 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 636 (err=1.116)  
68.9 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 544 (err=2.285)  
90.9 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 10 (err=1.111)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2250 (err=1.359)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 10975 (err=1.107)  
90.9 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9376 (err=1.303)  
90.8 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
90.9 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 35 (err=1.167)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.4 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1697 (err=2.221)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
79.9 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 47 (err=1.596)  
83.3 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 6 (err=2.500)  
90.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 2548 (err=1.007)  
76.9 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 15 (err=1.867)  
76.9 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 94 (err=1.894)  
83.3 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
41.6 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1156 (err=1.597)  
83.3 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
76.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 28.7591	median: 1.1204	mean: 6.2464
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 49/50 | Workload-time: 4.615487 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 50/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
21.3 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 2: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
76.9 queries/sec
Query 3: actual 6 (0.001%)  origin-forest_43.843 111 (err=18.500)  
71.4 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
76.4 queries/sec
Query 6: actual 35 (0.005%)  origin-forest_43.843 80 (err=2.286)  
90.9 queries/sec
Query 7: actual 2394 (0.343%)  origin-forest_43.843 3219 (err=1.345)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
55.6 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 10: actual 205 (0.029%)  origin-forest_43.843 129 (err=1.589)  
76.9 queries/sec
Query 11: actual 150 (0.022%)  origin-forest_43.843 5 (err=30.000)  
71.4 queries/sec
Query 12: actual 899 (0.129%)  origin-forest_43.843 33 (err=27.242)  
70.5 queries/sec
Query 13: actual 570 (0.082%)  origin-forest_43.843 629 (err=1.104)  
76.9 queries/sec
Query 14: actual 1243 (0.178%)  origin-forest_43.843 543 (err=2.289)  
83.3 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 10 (err=1.111)  
71.4 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 17: actual 3057 (0.438%)  origin-forest_43.843 2245 (err=1.362)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 19: actual 9911 (1.422%)  origin-forest_43.843 11138 (err=1.124)  
83.3 queries/sec
Query 20: actual 7197 (1.032%)  origin-forest_43.843 9375 (err=1.303)  
79.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
83.4 queries/sec
Query 24: actual 30 (0.004%)  origin-forest_43.843 34 (err=1.133)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 29: actual 3769 (0.541%)  origin-forest_43.843 1726 (err=2.184)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
71.4 queries/sec
Query 31: actual 75 (0.011%)  origin-forest_43.843 48 (err=1.562)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 7 (err=2.143)  
76.9 queries/sec
Query 34: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
76.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
70.3 queries/sec
Query 36: actual 2566 (0.368%)  origin-forest_43.843 2553 (err=1.005)  
93.3 queries/sec
Query 37: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 28 (0.004%)  origin-forest_43.843 15 (err=1.867)  
76.9 queries/sec
Query 41: actual 178 (0.026%)  origin-forest_43.843 94 (err=1.894)  
83.3 queries/sec
Query 42: actual 136 (0.020%)  origin-forest_43.843 7 (err=19.429)  
90.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.5 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 724 (0.104%)  origin-forest_43.843 1139 (err=1.573)  
76.9 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
76.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 4 (err=1.000)  
origin-forest_43.843 	max: 62.0000	99th: 58.5700	95th: 28.7591	median: 1.1175	mean: 6.2284
max_err 62.0
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 50/50 | Workload-time: 4.668425 | Model-update-time: 0.000000





Experiment Summary: #drift=10 | total-time=590.488650
