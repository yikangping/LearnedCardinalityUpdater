Input arguments = Namespace(data_update='single', dataset='forest', debug=False, drift_test='ddup', model_update='update', model='naru', random_seed=42, num_workload=50)
MODEL-PATH=F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
DATASET-PATH=F:\DBGroup\LearnedCardinalityUpdater\data\forest\end2end\forest.npy
Workload weights: query=15, data-update=10
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload']



WORKLOAD-START | Type: QueryWorkload | Progress: 1/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 0
RandomSeedCommunicator.get: 0
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
30.3 queries/sec
Query 1: actual 5561 (0.798%)  origin-forest_43.843 5103 (err=1.090)  
66.7 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 3: actual 59 (0.008%)  origin-forest_43.843 44 (err=1.341)  
79.9 queries/sec
Query 4: actual 8 (0.001%)  origin-forest_43.843 3 (err=2.667)  
90.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 6: actual 384 (0.055%)  origin-forest_43.843 459 (err=1.195)  
83.3 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 8: actual 703 (0.101%)  origin-forest_43.843 467 (err=1.505)  
90.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 67 (0.010%)  origin-forest_43.843 78 (err=1.164)  
83.3 queries/sec
Query 11: actual 66 (0.009%)  origin-forest_43.843 1 (err=66.000)  
76.9 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 13: actual 2 (0.000%)  origin-forest_43.843 5 (err=2.500)  
83.3 queries/sec
Query 14: actual 134 (0.019%)  origin-forest_43.843 65 (err=2.062)  
83.3 queries/sec
Query 15: actual 89 (0.013%)  origin-forest_43.843 74 (err=1.203)  
76.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 9 (err=9.000)  
83.3 queries/sec
Query 17: actual 22 (0.003%)  origin-forest_43.843 1 (err=22.000)  
76.9 queries/sec
Query 18: actual 53 (0.008%)  origin-forest_43.843 95 (err=1.792)  
83.3 queries/sec
Query 19: actual 86 (0.012%)  origin-forest_43.843 66 (err=1.303)  
100.0 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 21: actual 134 (0.019%)  origin-forest_43.843 1 (err=134.000)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 24: actual 395 (0.057%)  origin-forest_43.843 605 (err=1.532)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 26: actual 14604 (2.095%)  origin-forest_43.843 15623 (err=1.070)  
83.3 queries/sec
Query 27: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 29: actual 7 (0.001%)  origin-forest_43.843 4 (err=1.750)  
83.3 queries/sec
Query 30: actual 4 (0.001%)  origin-forest_43.843 6 (err=1.500)  
83.3 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 35: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 37: actual 86 (0.012%)  origin-forest_43.843 1 (err=86.000)  
79.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 39: actual 6 (0.001%)  origin-forest_43.843 6 (err=1.000)  
100.0 queries/sec
Query 40: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 17 (0.002%)  origin-forest_43.843 9 (err=1.889)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 123 (0.018%)  origin-forest_43.843 184 (err=1.496)  
90.9 queries/sec
Query 45: actual 689 (0.099%)  origin-forest_43.843 221 (err=3.118)  
95.1 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 134.0000	99th: 110.4800	95th: 46.2000	median: 1.1270	mean: 7.6035
ReportEsts: [1.0, 1.0897511267881639, 1.0, 1.3409090909090908, 2.6666666666666665, 1.0, 1.1953125, 1.0, 1.5053533190578159, 1.0, 1.164179104477612, 66.0, 1.0, 2.5, 2.0615384615384613, 1.2027027027027026, 9.0, 22.0, 1.7924528301886793, 1.303030303030303, 1.0, 134.0, 1.0, 1.0, 1.5316455696202531, 1.0, 1.0697754039989045, 4.0, 1.0, 1.75, 1.5, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 86.0, 1.0, 1.0, 2.0, 1.0, 1.8888888888888888, 1.0, 1.4959349593495934, 3.1176470588235294, 1.0, 2.0, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/50 | Workload-time: 4.203530 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=single', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
SingleSample - START
SingleSample - END
load_npy_dataset_from_path - df.shape = (591012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.0s
done, took 0.0s
new data average log likelihood = 44.5102
detection mean = 43.5353
detection threshold = 0.3124
test statistic = 0.9749
Offline time = 2.858931064605713
Online time = 0.4220547676086426
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 2-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (591012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.0s
dataset size: 591012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 44.0777 bits (loss 63.026, data 18.948) 0.00100 lr
epoch 9 train loss 42.0274 nats / 60.6327 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 41.6166 bits (loss 60.565, data 18.948) 0.00082 lr
epoch 19 train loss 41.0215 nats / 59.1815 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 20.3175 nats / 29.3120 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/50 | Workload-time: 6.409848 | Model-update-time: 10.288434


WORKLOAD-START | Type: QueryWorkload | Progress: 3/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 1
RandomSeedCommunicator.get: 1
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
39.5 queries/sec
Query 1: actual 3 (0.000%)  origin-forest_43.843 3 (err=1.000)  
83.5 queries/sec
Query 2: actual 4 (0.001%)  origin-forest_43.843 9 (err=2.250)  
74.4 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 4: actual 292 (0.042%)  origin-forest_43.843 179 (err=1.631)  
90.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 35874 (5.145%)  origin-forest_43.843 46437 (err=1.294)  
76.9 queries/sec
Query 7: actual 4 (0.001%)  origin-forest_43.843 16 (err=4.000)  
55.6 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 2 (0.000%)  origin-forest_43.843 5 (err=2.500)  
76.9 queries/sec
Query 10: actual 13191 (1.892%)  origin-forest_43.843 17405 (err=1.319)  
90.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.5 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.4 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 21: actual 51 (0.007%)  origin-forest_43.843 32 (err=1.594)  
83.3 queries/sec
Query 22: actual 277 (0.040%)  origin-forest_43.843 235 (err=1.179)  
76.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 25: actual 41 (0.006%)  origin-forest_43.843 1 (err=41.000)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 27: actual 852 (0.122%)  origin-forest_43.843 1017 (err=1.194)  
83.3 queries/sec
Query 28: actual 339109 (48.638%)  origin-forest_43.843 317930 (err=1.067)  
83.3 queries/sec
Query 29: actual 11 (0.002%)  origin-forest_43.843 8 (err=1.375)  
76.9 queries/sec
Query 30: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 31: actual 10 (0.001%)  origin-forest_43.843 10 (err=1.000)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
77.5 queries/sec
Query 35: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
86.5 queries/sec
Query 36: actual 80 (0.011%)  origin-forest_43.843 1 (err=80.000)  
66.7 queries/sec
Query 37: actual 7 (0.001%)  origin-forest_43.843 10 (err=1.429)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
66.7 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 64 (0.009%)  origin-forest_43.843 1 (err=64.000)  
64.5 queries/sec
Query 43: actual 25 (0.004%)  origin-forest_43.843 42 (err=1.680)  
66.7 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 32 (0.005%)  origin-forest_43.843 31 (err=1.032)  
83.4 queries/sec
Query 46: actual 31604 (4.533%)  origin-forest_43.843 38348 (err=1.213)  
90.9 queries/sec
Query 47: actual 44 (0.006%)  origin-forest_43.843 48 (err=1.091)  
83.3 queries/sec
Query 48: actual 56 (0.008%)  origin-forest_43.843 89 (err=1.589)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 80.0000	99th: 72.1600	95th: 24.3500	median: 1.0000	mean: 4.9187
ReportEsts: [1.0, 1.0, 2.25, 1.0, 1.6312849162011174, 1.0, 1.2944472319785918, 4.0, 1.0, 2.5, 1.3194602380410887, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.59375, 1.1787234042553192, 1.0, 1.0, 41.0, 1.0, 1.193661971830986, 1.066615292674488, 1.375, 2.0, 1.0, 1.0, 1.0, 1.0, 3.0, 80.0, 1.4285714285714286, 1.0, 1.0, 1.5, 1.0, 64.0, 1.68, 1.0, 1.032258064516129, 1.2133907100367043, 1.0909090909090908, 1.5892857142857142, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/50 | Workload-time: 4.195511 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 4/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.1s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 2
RandomSeedCommunicator.get: 2
Query 0: actual 1898 (0.272%)  origin-forest_43.843 1823 (err=1.041)  
37.7 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 2: actual 6 (0.001%)  origin-forest_43.843 3 (err=2.000)  
62.5 queries/sec
Query 3: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
66.7 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 5: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
62.5 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
64.5 queries/sec
Query 7: actual 18 (0.003%)  origin-forest_43.843 0 (err=18.000)  
58.8 queries/sec
Query 8: actual 2479 (0.356%)  origin-forest_43.843 1315 (err=1.885)  
71.4 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
62.5 queries/sec
Query 10: actual 140 (0.020%)  origin-forest_43.843 256 (err=1.829)  
76.9 queries/sec
Query 11: actual 9575 (1.373%)  origin-forest_43.843 11231 (err=1.173)  
66.7 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.1 queries/sec
Query 13: actual 19 (0.003%)  origin-forest_43.843 1 (err=19.000)  
68.7 queries/sec
Query 14: actual 152 (0.022%)  origin-forest_43.843 149 (err=1.020)  
66.7 queries/sec
Query 15: actual 3607 (0.517%)  origin-forest_43.843 2979 (err=1.211)  
66.7 queries/sec
Query 16: actual 515 (0.074%)  origin-forest_43.843 598 (err=1.161)  
66.7 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 18: actual 41888 (6.008%)  origin-forest_43.843 6683 (err=6.268)  
66.7 queries/sec
Query 19: actual 578 (0.083%)  origin-forest_43.843 791 (err=1.369)  
71.4 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
64.5 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 22: actual 104091 (14.930%)  origin-forest_43.843 93107 (err=1.118)  
71.4 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
71.4 queries/sec
Query 24: actual 15 (0.002%)  origin-forest_43.843 1 (err=15.000)  
62.5 queries/sec
Query 25: actual 3342 (0.479%)  origin-forest_43.843 3833 (err=1.147)  
71.4 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 29: actual 7 (0.001%)  origin-forest_43.843 3 (err=2.333)  
76.9 queries/sec
Query 30: actual 44825 (6.429%)  origin-forest_43.843 56220 (err=1.254)  
83.3 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 32: actual 721 (0.103%)  origin-forest_43.843 412 (err=1.750)  
76.9 queries/sec
Query 33: actual 32 (0.005%)  origin-forest_43.843 1 (err=32.000)  
83.3 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 35: actual 6 (0.001%)  origin-forest_43.843 1 (err=6.000)  
76.9 queries/sec
Query 36: actual 882 (0.127%)  origin-forest_43.843 911 (err=1.033)  
76.9 queries/sec
Query 37: actual 691 (0.099%)  origin-forest_43.843 831 (err=1.203)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
62.5 queries/sec
Query 40: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
58.8 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
60.6 queries/sec
Query 42: actual 5 (0.001%)  origin-forest_43.843 2 (err=2.500)  
62.5 queries/sec
Query 43: actual 393 (0.056%)  origin-forest_43.843 477 (err=1.214)  
66.7 queries/sec
Query 44: actual 5277 (0.757%)  origin-forest_43.843 7386 (err=1.400)  
62.5 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
58.8 queries/sec
Query 46: actual 23 (0.003%)  origin-forest_43.843 1 (err=23.000)  
58.8 queries/sec
Query 47: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
60.6 queries/sec
Query 48: actual 18 (0.003%)  origin-forest_43.843 21 (err=1.167)  
58.8 queries/sec
Query 49: actual 66 (0.009%)  origin-forest_43.843 1 (err=66.000)  
origin-forest_43.843 	max: 66.0000	99th: 49.3400	95th: 21.2000	median: 1.2123	mean: 4.8915
ReportEsts: [1.0411409764125068, 1.0, 2.0, 1.5, 1.0, 2.0, 1.0, 18, 1.885171102661597, 2.0, 1.8285714285714285, 1.1729503916449087, 1.0, 19.0, 1.0201342281879195, 1.2108089963074857, 1.1611650485436893, 1.0, 6.267843782732306, 1.3685121107266436, 1.0, 1.0, 1.1179717958907494, 2.0, 15.0, 1.146918013165769, 1.0, 1.0, 1.0, 2.3333333333333335, 1.2542108198549917, 1.0, 1.75, 32.0, 1.0, 6.0, 1.0328798185941044, 1.2026049204052098, 1.0, 2.0, 2.0, 1.0, 2.5, 1.213740458015267, 1.3996588971006254, 1.0, 23.0, 4.0, 1.1666666666666667, 66.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 4/50 | Workload-time: 4.378128 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 5/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=single', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
SingleSample - START
SingleSample - END
load_npy_dataset_from_path - df.shape = (601012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.0s
done, took 0.0s
new data average log likelihood = 39.5134
detection mean = 43.4692
detection threshold = 0.3411
test statistic = 3.9559
Offline time = 2.8922646045684814
Online time = 0.44533467292785645
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 5-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (601012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.0s
dataset size: 601012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 39.8182 bits (loss 58.540, data 18.722) 0.00100 lr
epoch 9 train loss 39.9609 nats / 57.6514 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 39.0206 bits (loss 57.742, data 18.722) 0.00082 lr
epoch 19 train loss 39.6708 nats / 57.2328 bits
time since start: 7.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 12.6883 nats / 18.3054 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 5/50 | Workload-time: 6.494442 | Model-update-time: 10.354433


WORKLOAD-START | Type: QueryWorkload | Progress: 6/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 3
RandomSeedCommunicator.get: 3
Query 0: actual 184 (0.026%)  origin-forest_43.843 0 (err=184.000)  
43.1 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 2: actual 219 (0.031%)  origin-forest_43.843 148 (err=1.480)  
90.9 queries/sec
Query 3: actual 1291 (0.185%)  origin-forest_43.843 2074 (err=1.607)  
71.4 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
83.3 queries/sec
Query 6: actual 40770 (5.848%)  origin-forest_43.843 41883 (err=1.027)  
95.2 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 8: actual 225 (0.032%)  origin-forest_43.843 310 (err=1.378)  
83.3 queries/sec
Query 9: actual 2367 (0.339%)  origin-forest_43.843 1250 (err=1.894)  
83.3 queries/sec
Query 10: actual 168 (0.024%)  origin-forest_43.843 1 (err=168.000)  
76.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 21 (0.003%)  origin-forest_43.843 48 (err=2.286)  
76.9 queries/sec
Query 13: actual 52 (0.007%)  origin-forest_43.843 65 (err=1.250)  
83.3 queries/sec
Query 14: actual 58 (0.008%)  origin-forest_43.843 55 (err=1.055)  
86.9 queries/sec
Query 15: actual 113 (0.016%)  origin-forest_43.843 1 (err=113.000)  
83.3 queries/sec
Query 16: actual 18 (0.003%)  origin-forest_43.843 31 (err=1.722)  
76.9 queries/sec
Query 17: actual 456 (0.065%)  origin-forest_43.843 663 (err=1.454)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 3248 (0.466%)  origin-forest_43.843 3413 (err=1.051)  
90.9 queries/sec
Query 20: actual 45 (0.006%)  origin-forest_43.843 225 (err=5.000)  
83.3 queries/sec
Query 21: actual 6 (0.001%)  origin-forest_43.843 1 (err=6.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 411 (0.059%)  origin-forest_43.843 1 (err=411.000)  
89.8 queries/sec
Query 24: actual 25071 (3.596%)  origin-forest_43.843 14122 (err=1.775)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
90.9 queries/sec
Query 27: actual 34 (0.005%)  origin-forest_43.843 1 (err=34.000)  
83.3 queries/sec
Query 28: actual 50 (0.007%)  origin-forest_43.843 46 (err=1.087)  
71.4 queries/sec
Query 29: actual 12447 (1.785%)  origin-forest_43.843 14877 (err=1.195)  
58.8 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
60.6 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 34: actual 280 (0.040%)  origin-forest_43.843 271 (err=1.033)  
90.9 queries/sec
Query 35: actual 56 (0.008%)  origin-forest_43.843 1 (err=56.000)  
62.5 queries/sec
Query 36: actual 7 (0.001%)  origin-forest_43.843 5 (err=1.400)  
83.3 queries/sec
Query 37: actual 6 (0.001%)  origin-forest_43.843 7 (err=1.167)  
90.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 39: actual 137 (0.020%)  origin-forest_43.843 2 (err=68.500)  
90.9 queries/sec
Query 40: actual 3097 (0.444%)  origin-forest_43.843 5794 (err=1.871)  
90.9 queries/sec
Query 41: actual 40283 (5.778%)  origin-forest_43.843 19238 (err=2.094)  
83.3 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 1893 (0.272%)  origin-forest_43.843 1696 (err=1.116)  
86.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 411.0000	99th: 299.7700	95th: 143.2500	median: 1.1414	mean: 21.9788
ReportEsts: [184, 1.0, 1.4797297297297298, 1.6065065840433772, 1.0, 4.0, 1.027299484915379, 1.0, 1.3777777777777778, 1.8936, 168.0, 1.0, 2.2857142857142856, 1.25, 1.0545454545454545, 113.0, 1.7222222222222223, 1.4539473684210527, 1.0, 1.0508004926108374, 5.0, 6.0, 1.0, 411.0, 1.7753151111740546, 1.0, 1.5, 34.0, 1.0869565217391304, 1.1952277657266812, 1.0, 1.0, 1.0, 1.0, 1.033210332103321, 56.0, 1.4, 1.1666666666666667, 1.0, 68.5, 1.8708427510494026, 2.0939286828152617, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1161556603773586, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 6/50 | Workload-time: 4.128057 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 7/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 4
RandomSeedCommunicator.get: 4
Query 0: actual 335 (0.048%)  origin-forest_43.843 395 (err=1.179)  
42.5 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 4: actual 2984 (0.428%)  origin-forest_43.843 2408 (err=1.239)  
83.3 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 10: actual 66205 (9.496%)  origin-forest_43.843 47375 (err=1.397)  
100.0 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 13: actual 189 (0.027%)  origin-forest_43.843 20 (err=9.450)  
83.3 queries/sec
Query 14: actual 10 (0.001%)  origin-forest_43.843 1 (err=10.000)  
76.9 queries/sec
Query 15: actual 19 (0.003%)  origin-forest_43.843 17 (err=1.118)  
90.9 queries/sec
Query 16: actual 141378 (20.278%)  origin-forest_43.843 110580 (err=1.279)  
95.1 queries/sec
Query 17: actual 19 (0.003%)  origin-forest_43.843 33 (err=1.737)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 145 (0.021%)  origin-forest_43.843 138 (err=1.051)  
90.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 21: actual 939 (0.135%)  origin-forest_43.843 950 (err=1.012)  
90.9 queries/sec
Query 22: actual 604 (0.087%)  origin-forest_43.843 638 (err=1.056)  
90.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 24: actual 181232 (25.994%)  origin-forest_43.843 184444 (err=1.018)  
86.9 queries/sec
Query 25: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
80.9 queries/sec
Query 26: actual 17 (0.002%)  origin-forest_43.843 1 (err=17.000)  
75.5 queries/sec
Query 27: actual 386673 (55.460%)  origin-forest_43.843 371807 (err=1.040)  
83.1 queries/sec
Query 28: actual 218 (0.031%)  origin-forest_43.843 263 (err=1.206)  
76.9 queries/sec
Query 29: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
76.9 queries/sec
Query 30: actual 1893 (0.272%)  origin-forest_43.843 2341 (err=1.237)  
76.9 queries/sec
Query 31: actual 4 (0.001%)  origin-forest_43.843 7 (err=1.750)  
71.4 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.9 queries/sec
Query 33: actual 28 (0.004%)  origin-forest_43.843 17 (err=1.647)  
76.9 queries/sec
Query 34: actual 82 (0.012%)  origin-forest_43.843 1 (err=82.000)  
76.9 queries/sec
Query 35: actual 75224 (10.789%)  origin-forest_43.843 77957 (err=1.036)  
83.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 38: actual 2066 (0.296%)  origin-forest_43.843 2130 (err=1.031)  
83.3 queries/sec
Query 39: actual 12 (0.002%)  origin-forest_43.843 10 (err=1.200)  
90.9 queries/sec
Query 40: actual 23 (0.003%)  origin-forest_43.843 22 (err=1.045)  
79.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 43: actual 164 (0.024%)  origin-forest_43.843 147 (err=1.116)  
83.3 queries/sec
Query 44: actual 9007 (1.292%)  origin-forest_43.843 9785 (err=1.086)  
76.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
71.4 queries/sec
Query 48: actual 14387 (2.063%)  origin-forest_43.843 17425 (err=1.211)  
79.9 queries/sec
Query 49: actual 7656 (1.098%)  origin-forest_43.843 5341 (err=1.433)  
origin-forest_43.843 	max: 82.0000	99th: 50.1500	95th: 9.7525	median: 1.0382	mean: 3.5515
ReportEsts: [1.1791044776119404, 1.0, 1.0, 1.0, 1.239202657807309, 1.0, 1.0, 1.0, 1.0, 1.0, 1.397467018469657, 1.0, 1.0, 9.45, 10.0, 1.1176470588235294, 1.2785132935431363, 1.736842105263158, 1.0, 1.0507246376811594, 1.0, 1.0117145899893503, 1.0562913907284768, 1.0, 1.01772313940143, 2.0, 17.0, 1.0399831095164964, 1.2064220183486238, 8.0, 1.236661384046487, 1.75, 1.0, 1.6470588235294117, 82.0, 1.036331489950016, 1.0, 1.0, 1.0309777347531461, 1.2, 1.0454545454545454, 1.0, 1.0, 1.1156462585034013, 1.086377262129455, 1.0, 1.0, 1.0, 1.2111628553555294, 1.4334394308181988]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 7/50 | Workload-time: 4.096071 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 8/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 5
RandomSeedCommunicator.get: 5
Query 0: actual 1832 (0.263%)  origin-forest_43.843 1729 (err=1.060)  
41.7 queries/sec
Query 1: actual 33175 (4.758%)  origin-forest_43.843 36442 (err=1.098)  
90.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.7 queries/sec
Query 4: actual 172 (0.025%)  origin-forest_43.843 78 (err=2.205)  
90.9 queries/sec
Query 5: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
76.9 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 7: actual 59 (0.008%)  origin-forest_43.843 1 (err=59.000)  
83.3 queries/sec
Query 8: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 9: actual 47787 (6.854%)  origin-forest_43.843 15393 (err=3.104)  
90.9 queries/sec
Query 10: actual 13073 (1.875%)  origin-forest_43.843 15779 (err=1.207)  
83.3 queries/sec
Query 11: actual 12 (0.002%)  origin-forest_43.843 7 (err=1.714)  
86.9 queries/sec
Query 12: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 13: actual 9736 (1.396%)  origin-forest_43.843 10536 (err=1.082)  
83.3 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 15: actual 1442 (0.207%)  origin-forest_43.843 1765 (err=1.224)  
71.4 queries/sec
Query 16: actual 6 (0.001%)  origin-forest_43.843 2 (err=3.000)  
83.3 queries/sec
Query 17: actual 23578 (3.382%)  origin-forest_43.843 32232 (err=1.367)  
83.3 queries/sec
Query 18: actual 52 (0.007%)  origin-forest_43.843 1 (err=52.000)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.9 queries/sec
Query 20: actual 13 (0.002%)  origin-forest_43.843 1 (err=13.000)  
76.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 26: actual 21601 (3.098%)  origin-forest_43.843 21352 (err=1.012)  
90.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 15 (0.002%)  origin-forest_43.843 7 (err=2.143)  
83.3 queries/sec
Query 30: actual 65 (0.009%)  origin-forest_43.843 1 (err=65.000)  
90.9 queries/sec
Query 31: actual 1639 (0.235%)  origin-forest_43.843 2391 (err=1.459)  
90.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 3592 (0.515%)  origin-forest_43.843 3041 (err=1.181)  
83.3 queries/sec
Query 34: actual 508 (0.073%)  origin-forest_43.843 94 (err=5.404)  
90.9 queries/sec
Query 35: actual 120 (0.017%)  origin-forest_43.843 20 (err=6.000)  
80.0 queries/sec
Query 36: actual 6 (0.001%)  origin-forest_43.843 9 (err=1.500)  
76.9 queries/sec
Query 37: actual 96854 (13.892%)  origin-forest_43.843 107847 (err=1.114)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
52.6 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 21 (0.003%)  origin-forest_43.843 23 (err=1.095)  
90.9 queries/sec
Query 41: actual 87 (0.012%)  origin-forest_43.843 1 (err=87.000)  
83.3 queries/sec
Query 42: actual 5160 (0.740%)  origin-forest_43.843 5351 (err=1.037)  
90.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.0 queries/sec
Query 44: actual 4 (0.001%)  origin-forest_43.843 10 (err=2.500)  
76.9 queries/sec
Query 45: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
71.2 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
84.3 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 48: actual 11 (0.002%)  origin-forest_43.843 12 (err=1.091)  
83.3 queries/sec
Query 49: actual 24 (0.003%)  origin-forest_43.843 15 (err=1.600)  
origin-forest_43.843 	max: 87.0000	99th: 76.2200	95th: 55.8500	median: 1.1473	mean: 7.3240
ReportEsts: [1.059572006940428, 1.0984777694046721, 1.0, 1.0, 2.2051282051282053, 20.0, 1.0, 59.0, 2.0, 3.1044630676281426, 1.2069915092174712, 1.7142857142857142, 3.0, 1.0821692686935087, 1.0, 1.2239944521497919, 3.0, 1.3670370684536433, 52.0, 1.0, 13.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0116616710378419, 1.0, 1.0, 2.142857142857143, 65.0, 1.458816351433801, 1.0, 1.1811903978954292, 5.404255319148936, 6.0, 1.5, 1.1135007330621347, 1.0, 1.0, 1.0952380952380953, 87.0, 1.037015503875969, 1.0, 2.5, 2.0, 2.0, 1.0, 1.0909090909090908, 1.6]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 8/50 | Workload-time: 4.118974 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 9/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 6
RandomSeedCommunicator.get: 6
Query 0: actual 28 (0.004%)  origin-forest_43.843 44 (err=1.571)  
40.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 3: actual 38445 (5.514%)  origin-forest_43.843 11772 (err=3.266)  
95.1 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 6: actual 61640 (8.841%)  origin-forest_43.843 71260 (err=1.156)  
83.3 queries/sec
Query 7: actual 20 (0.003%)  origin-forest_43.843 2 (err=10.000)  
83.3 queries/sec
Query 8: actual 927 (0.133%)  origin-forest_43.843 1047 (err=1.129)  
90.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 10: actual 1231 (0.177%)  origin-forest_43.843 1530 (err=1.243)  
90.9 queries/sec
Query 11: actual 21076 (3.023%)  origin-forest_43.843 24655 (err=1.170)  
90.9 queries/sec
Query 12: actual 61 (0.009%)  origin-forest_43.843 0 (err=61.000)  
74.0 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 14: actual 133 (0.019%)  origin-forest_43.843 116 (err=1.147)  
83.3 queries/sec
Query 15: actual 12 (0.002%)  origin-forest_43.843 3 (err=4.000)  
76.9 queries/sec
Query 16: actual 491 (0.070%)  origin-forest_43.843 287 (err=1.711)  
83.3 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 20: actual 151 (0.022%)  origin-forest_43.843 2 (err=75.500)  
79.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 24: actual 218 (0.031%)  origin-forest_43.843 188 (err=1.160)  
90.9 queries/sec
Query 25: actual 150795 (21.628%)  origin-forest_43.843 155816 (err=1.033)  
90.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 27: actual 18 (0.003%)  origin-forest_43.843 34 (err=1.889)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 29: actual 321 (0.046%)  origin-forest_43.843 1178 (err=3.670)  
83.3 queries/sec
Query 30: actual 80 (0.011%)  origin-forest_43.843 109 (err=1.363)  
83.3 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 32: actual 195 (0.028%)  origin-forest_43.843 105 (err=1.857)  
100.0 queries/sec
Query 33: actual 6 (0.001%)  origin-forest_43.843 5 (err=1.200)  
90.9 queries/sec
Query 34: actual 217 (0.031%)  origin-forest_43.843 1 (err=217.000)  
83.3 queries/sec
Query 35: actual 6 (0.001%)  origin-forest_43.843 1 (err=6.000)  
83.3 queries/sec
Query 36: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.7 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.4 queries/sec
Query 38: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
83.3 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 151 (0.022%)  origin-forest_43.843 281 (err=1.861)  
83.3 queries/sec
Query 41: actual 7493 (1.075%)  origin-forest_43.843 8685 (err=1.159)  
90.9 queries/sec
Query 42: actual 127990 (18.357%)  origin-forest_43.843 94696 (err=1.352)  
86.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 45: actual 166 (0.024%)  origin-forest_43.843 189 (err=1.139)  
95.1 queries/sec
Query 46: actual 31 (0.004%)  origin-forest_43.843 47 (err=1.516)  
83.3 queries/sec
Query 47: actual 376 (0.054%)  origin-forest_43.843 567 (err=1.508)  
90.9 queries/sec
Query 48: actual 6481 (0.930%)  origin-forest_43.843 4534 (err=1.429)  
83.3 queries/sec
Query 49: actual 59239 (8.497%)  origin-forest_43.843 66429 (err=1.121)  
origin-forest_43.843 	max: 217.0000	99th: 147.6650	95th: 38.0500	median: 1.1647	mean: 8.6930
ReportEsts: [1.5714285714285714, 1.0, 1.0, 3.2658002038735985, 1.0, 1.0, 1.1560674886437379, 10.0, 1.1294498381877023, 1.0, 1.2428919577579205, 1.1698140064528373, 61, 1.0, 1.146551724137931, 4.0, 1.710801393728223, 2.0, 1.0, 1.0, 75.5, 1.0, 1.0, 3.0, 1.1595744680851063, 1.0332968599754633, 1.0, 1.8888888888888888, 1.0, 3.6697819314641746, 1.3625, 1.0, 1.8571428571428572, 1.2, 217.0, 6.0, 2.0, 1.0, 1.5, 1.0, 1.8609271523178808, 1.1590818096890432, 1.3515882402635804, 1.0, 1.0, 1.1385542168674698, 1.5161290322580645, 1.5079787234042554, 1.429422143802382, 1.1213727443069599]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 9/50 | Workload-time: 4.103769 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 10/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=single', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
SingleSample - START
SingleSample - END
load_npy_dataset_from_path - df.shape = (611012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.0s
new data average log likelihood = 34.9748
detection mean = 43.5629
detection threshold = 0.3482
test statistic = 8.5882
Offline time = 2.8805341720581055
Online time = 0.43006134033203125
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 10-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (611012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 611012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 38.8011 bits (loss 57.292, data 18.491) 0.00100 lr
epoch 9 train loss 38.9886 nats / 56.2487 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 37.9674 bits (loss 56.458, data 18.491) 0.00082 lr
epoch 19 train loss 38.7573 nats / 55.9150 bits
time since start: 7.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 10.0524 nats / 14.5025 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 10/50 | Workload-time: 6.461219 | Model-update-time: 10.354315


WORKLOAD-START | Type: QueryWorkload | Progress: 11/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 7
RandomSeedCommunicator.get: 7
Query 0: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
34.5 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 5 (0.001%)  origin-forest_43.843 3 (err=1.667)  
76.9 queries/sec
Query 3: actual 9 (0.001%)  origin-forest_43.843 13 (err=1.444)  
95.2 queries/sec
Query 4: actual 1291 (0.185%)  origin-forest_43.843 4890 (err=3.788)  
83.3 queries/sec
Query 5: actual 20 (0.003%)  origin-forest_43.843 17 (err=1.176)  
83.3 queries/sec
Query 6: actual 21 (0.003%)  origin-forest_43.843 24 (err=1.143)  
83.3 queries/sec
Query 7: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
90.9 queries/sec
Query 8: actual 34317 (4.922%)  origin-forest_43.843 33263 (err=1.032)  
90.9 queries/sec
Query 9: actual 187 (0.027%)  origin-forest_43.843 80 (err=2.337)  
83.3 queries/sec
Query 10: actual 12 (0.002%)  origin-forest_43.843 4 (err=3.000)  
90.9 queries/sec
Query 11: actual 461 (0.066%)  origin-forest_43.843 515 (err=1.117)  
90.9 queries/sec
Query 12: actual 90 (0.013%)  origin-forest_43.843 91 (err=1.011)  
95.2 queries/sec
Query 13: actual 37 (0.005%)  origin-forest_43.843 1 (err=37.000)  
83.3 queries/sec
Query 14: actual 23994 (3.441%)  origin-forest_43.843 14253 (err=1.683)  
100.0 queries/sec
Query 15: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 16: actual 131 (0.019%)  origin-forest_43.843 103 (err=1.272)  
87.0 queries/sec
Query 17: actual 6 (0.001%)  origin-forest_43.843 7 (err=1.167)  
89.7 queries/sec
Query 18: actual 4 (0.001%)  origin-forest_43.843 3 (err=1.333)  
95.1 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 20: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
82.4 queries/sec
Query 21: actual 125 (0.018%)  origin-forest_43.843 2 (err=62.500)  
83.3 queries/sec
Query 22: actual 1808 (0.259%)  origin-forest_43.843 71 (err=25.465)  
90.9 queries/sec
Query 23: actual 533 (0.076%)  origin-forest_43.843 718 (err=1.347)  
90.9 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 25: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
90.9 queries/sec
Query 26: actual 116 (0.017%)  origin-forest_43.843 0 (err=116.000)  
83.3 queries/sec
Query 27: actual 547289 (78.497%)  origin-forest_43.843 547338 (err=1.000)  
100.0 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.8 queries/sec
Query 30: actual 9155 (1.313%)  origin-forest_43.843 6017 (err=1.522)  
90.9 queries/sec
Query 31: actual 18764 (2.691%)  origin-forest_43.843 26883 (err=1.433)  
76.9 queries/sec
Query 32: actual 170 (0.024%)  origin-forest_43.843 3 (err=56.667)  
90.9 queries/sec
Query 33: actual 12244 (1.756%)  origin-forest_43.843 17019 (err=1.390)  
90.9 queries/sec
Query 34: actual 21 (0.003%)  origin-forest_43.843 19 (err=1.105)  
90.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 37: actual 5 (0.001%)  origin-forest_43.843 2 (err=2.500)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.7 queries/sec
Query 39: actual 67 (0.010%)  origin-forest_43.843 52 (err=1.288)  
83.3 queries/sec
Query 40: actual 30444 (4.367%)  origin-forest_43.843 40852 (err=1.342)  
71.4 queries/sec
Query 41: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 36377 (5.217%)  origin-forest_43.843 38525 (err=1.059)  
90.9 queries/sec
Query 45: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
86.4 queries/sec
Query 46: actual 90 (0.013%)  origin-forest_43.843 1 (err=90.000)  
86.9 queries/sec
Query 47: actual 127 (0.018%)  origin-forest_43.843 379 (err=2.984)  
90.9 queries/sec
Query 48: actual 388234 (55.684%)  origin-forest_43.843 377714 (err=1.028)  
90.9 queries/sec
Query 49: actual 520 (0.075%)  origin-forest_43.843 726 (err=1.396)  
origin-forest_43.843 	max: 116.0000	99th: 103.2600	95th: 59.8750	median: 1.3376	mean: 9.0539
ReportEsts: [1.0, 1.0, 1.6666666666666667, 1.4444444444444444, 3.787761425251743, 1.1764705882352942, 1.1428571428571428, 1.0, 1.0316868592730661, 2.3375, 3.0, 1.1171366594360086, 1.011111111111111, 37.0, 1.6834350663018312, 2.0, 1.2718446601941749, 1.1666666666666667, 1.3333333333333333, 1.0, 2.0, 62.5, 25.464788732394368, 1.3470919324577861, 1.0, 1.5, 116, 1.0000895322215502, 1.0, 1.0, 1.5215223533322253, 1.4326902579407377, 56.666666666666664, 1.389986932375041, 1.105263157894737, 1.0, 1.0, 2.5, 1.0, 1.2884615384615385, 1.341873603994219, 2.0, 1.0, 1.0, 1.0590482997498418, 3.0, 90.0, 2.984251968503937, 1.0278517608560975, 1.396153846153846]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 11/50 | Workload-time: 4.051090 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 12/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=single', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
SingleSample - START
SingleSample - END
load_npy_dataset_from_path - df.shape = (621012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.0s
done, took 0.0s
new data average log likelihood = 31.0395
detection mean = 43.6436
detection threshold = 0.3665
test statistic = 12.6040
Offline time = 2.875624656677246
Online time = 0.4454963207244873
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 12-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (621012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.0s
dataset size: 621012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 37.5492 bits (loss 55.809, data 18.260) 0.00100 lr
epoch 9 train loss 38.0859 nats / 54.9464 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 36.3168 bits (loss 54.576, data 18.260) 0.00082 lr
epoch 19 train loss 37.8802 nats / 54.6496 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 8.4454 nats / 12.1841 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 12/50 | Workload-time: 6.412501 | Model-update-time: 10.352175


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 13/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=single', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
SingleSample - START
SingleSample - END
load_npy_dataset_from_path - df.shape = (631012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 27.4219
detection mean = 43.7253
detection threshold = 0.3645
test statistic = 16.3035
Offline time = 2.863816738128662
Online time = 0.4577045440673828
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 13-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (631012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 631012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 36.3152 bits (loss 54.346, data 18.030) 0.00100 lr
epoch 9 train loss 37.4496 nats / 54.0284 bits
time since start: 4.1 secs
Epoch 10 Iter 0, train entropy gap 36.0114 bits (loss 54.042, data 18.030) 0.00082 lr
epoch 19 train loss 37.3111 nats / 53.8286 bits
time since start: 7.3 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 7.8643 nats / 11.3458 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 13/50 | Workload-time: 6.432743 | Model-update-time: 10.633287


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 14/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=single', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
SingleSample - START
SingleSample - END
load_npy_dataset_from_path - df.shape = (641012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.0s
new data average log likelihood = 23.9639
detection mean = 43.7983
detection threshold = 0.3713
test statistic = 19.8344
Offline time = 2.9268317222595215
Online time = 0.4534413814544678
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 14-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (641012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.0s
dataset size: 641012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 36.0991 bits (loss 53.903, data 17.804) 0.00100 lr
epoch 9 train loss 36.8725 nats / 53.1958 bits
time since start: 4.0 secs
Epoch 10 Iter 0, train entropy gap 35.1343 bits (loss 52.939, data 17.804) 0.00082 lr
epoch 19 train loss 36.7095 nats / 52.9606 bits
time since start: 7.2 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 7.5364 nats / 10.8727 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 14/50 | Workload-time: 6.515162 | Model-update-time: 10.490563


WORKLOAD-START | Type: QueryWorkload | Progress: 15/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 8
RandomSeedCommunicator.get: 8
Query 0: actual 42 (0.006%)  origin-forest_43.843 61 (err=1.452)  
40.0 queries/sec
Query 1: actual 10 (0.001%)  origin-forest_43.843 18 (err=1.800)  
78.1 queries/sec
Query 2: actual 58583 (8.402%)  origin-forest_43.843 73068 (err=1.247)  
79.6 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 5: actual 21 (0.003%)  origin-forest_43.843 15 (err=1.400)  
90.9 queries/sec
Query 6: actual 63 (0.009%)  origin-forest_43.843 359 (err=5.698)  
74.0 queries/sec
Query 7: actual 12 (0.002%)  origin-forest_43.843 22 (err=1.833)  
83.3 queries/sec
Query 8: actual 23 (0.003%)  origin-forest_43.843 6 (err=3.833)  
76.9 queries/sec
Query 9: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 11: actual 108 (0.015%)  origin-forest_43.843 1 (err=108.000)  
76.9 queries/sec
Query 12: actual 55 (0.008%)  origin-forest_43.843 16 (err=3.438)  
90.9 queries/sec
Query 13: actual 160379 (23.003%)  origin-forest_43.843 191030 (err=1.191)  
90.9 queries/sec
Query 14: actual 31 (0.004%)  origin-forest_43.843 1 (err=31.000)  
80.0 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 16: actual 47 (0.007%)  origin-forest_43.843 1 (err=47.000)  
83.3 queries/sec
Query 17: actual 10266 (1.472%)  origin-forest_43.843 13978 (err=1.362)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
76.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 44 (0.006%)  origin-forest_43.843 74 (err=1.682)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 24: actual 35 (0.005%)  origin-forest_43.843 37 (err=1.057)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 192 (0.028%)  origin-forest_43.843 124 (err=1.548)  
83.3 queries/sec
Query 27: actual 25 (0.004%)  origin-forest_43.843 21 (err=1.190)  
90.9 queries/sec
Query 28: actual 285 (0.041%)  origin-forest_43.843 249 (err=1.145)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 30: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
90.9 queries/sec
Query 31: actual 5 (0.001%)  origin-forest_43.843 1 (err=5.000)  
79.9 queries/sec
Query 32: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 34: actual 73 (0.010%)  origin-forest_43.843 1 (err=73.000)  
76.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 36: actual 63040 (9.042%)  origin-forest_43.843 76714 (err=1.217)  
90.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 38: actual 88 (0.013%)  origin-forest_43.843 133 (err=1.511)  
76.9 queries/sec
Query 39: actual 361 (0.052%)  origin-forest_43.843 360 (err=1.003)  
90.9 queries/sec
Query 40: actual 161 (0.023%)  origin-forest_43.843 1 (err=161.000)  
86.9 queries/sec
Query 41: actual 27 (0.004%)  origin-forest_43.843 77 (err=2.852)  
83.3 queries/sec
Query 42: actual 153 (0.022%)  origin-forest_43.843 1 (err=153.000)  
90.9 queries/sec
Query 43: actual 204 (0.029%)  origin-forest_43.843 164 (err=1.244)  
90.9 queries/sec
Query 44: actual 288 (0.041%)  origin-forest_43.843 521 (err=1.809)  
90.9 queries/sec
Query 45: actual 1016 (0.146%)  origin-forest_43.843 983 (err=1.034)  
83.3 queries/sec
Query 46: actual 288 (0.041%)  origin-forest_43.843 9 (err=32.000)  
83.3 queries/sec
Query 47: actual 1445 (0.207%)  origin-forest_43.843 1765 (err=1.221)  
90.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 49: actual 52 (0.007%)  origin-forest_43.843 55 (err=1.058)  
origin-forest_43.843 	max: 161.0000	99th: 157.0800	95th: 92.2500	median: 1.3044	mean: 13.5365
ReportEsts: [1.4523809523809523, 1.8, 1.2472560299062867, 1.0, 1.0, 1.4, 5.698412698412699, 1.8333333333333333, 3.8333333333333335, 3.0, 1.0, 108.0, 3.4375, 1.1911160438710804, 31.0, 1.0, 47.0, 1.3615819209039548, 1.0, 1.0, 2.0, 1.0, 1.6818181818181819, 1.0, 1.0571428571428572, 1.0, 1.5483870967741935, 1.1904761904761905, 1.144578313253012, 1.0, 3.0, 5.0, 2.0, 1.0, 73.0, 1.0, 1.2169098984771574, 1.0, 1.5113636363636365, 1.0027777777777778, 161.0, 2.8518518518518516, 153.0, 1.2439024390243902, 1.8090277777777777, 1.0335707019328586, 32.0, 1.221453287197232, 1.0, 1.0576923076923077]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 15/50 | Workload-time: 4.084016 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 16/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=single', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
SingleSample - START
SingleSample - END
load_npy_dataset_from_path - df.shape = (651012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.0s
new data average log likelihood = 20.8301
detection mean = 43.8767
detection threshold = 0.3832
test statistic = 23.0466
Offline time = 2.8716254234313965
Online time = 0.45806169509887695
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 16-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (651012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 651012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 35.3397 bits (loss 52.921, data 17.582) 0.00100 lr
epoch 9 train loss 36.4636 nats / 52.6059 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 35.5025 bits (loss 53.084, data 17.582) 0.00082 lr
epoch 19 train loss 36.3263 nats / 52.4078 bits
time since start: 7.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 7.2767 nats / 10.4981 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 16/50 | Workload-time: 6.579561 | Model-update-time: 10.482340


WORKLOAD-START | Type: QueryWorkload | Progress: 17/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 9
RandomSeedCommunicator.get: 9
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.8 queries/sec
Query 1: actual 214 (0.031%)  origin-forest_43.843 1 (err=214.000)  
76.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 3: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 4: actual 3403 (0.488%)  origin-forest_43.843 2260 (err=1.506)  
100.0 queries/sec
Query 5: actual 623 (0.089%)  origin-forest_43.843 380 (err=1.639)  
83.3 queries/sec
Query 6: actual 13 (0.002%)  origin-forest_43.843 13 (err=1.000)  
83.3 queries/sec
Query 7: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 9: actual 52 (0.007%)  origin-forest_43.843 40 (err=1.300)  
90.9 queries/sec
Query 10: actual 1674 (0.240%)  origin-forest_43.843 2369 (err=1.415)  
83.3 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 14 (0.002%)  origin-forest_43.843 1 (err=14.000)  
83.3 queries/sec
Query 13: actual 1191 (0.171%)  origin-forest_43.843 1497 (err=1.257)  
76.9 queries/sec
Query 14: actual 604 (0.087%)  origin-forest_43.843 581 (err=1.040)  
90.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 18: actual 30 (0.004%)  origin-forest_43.843 39 (err=1.300)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 20: actual 2569 (0.368%)  origin-forest_43.843 2935 (err=1.142)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 24: actual 18870 (2.706%)  origin-forest_43.843 23337 (err=1.237)  
86.9 queries/sec
Query 25: actual 2846 (0.408%)  origin-forest_43.843 3084 (err=1.084)  
83.3 queries/sec
Query 26: actual 6943 (0.996%)  origin-forest_43.843 168 (err=41.327)  
83.3 queries/sec
Query 27: actual 18582 (2.665%)  origin-forest_43.843 17627 (err=1.054)  
83.3 queries/sec
Query 28: actual 3190 (0.458%)  origin-forest_43.843 4398 (err=1.379)  
76.9 queries/sec
Query 29: actual 71 (0.010%)  origin-forest_43.843 128 (err=1.803)  
90.9 queries/sec
Query 30: actual 13 (0.002%)  origin-forest_43.843 14 (err=1.077)  
90.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 32: actual 9 (0.001%)  origin-forest_43.843 12 (err=1.333)  
68.9 queries/sec
Query 33: actual 279 (0.040%)  origin-forest_43.843 4 (err=69.750)  
83.3 queries/sec
Query 34: actual 34855 (4.999%)  origin-forest_43.843 40154 (err=1.152)  
100.0 queries/sec
Query 35: actual 23 (0.003%)  origin-forest_43.843 18 (err=1.278)  
83.3 queries/sec
Query 36: actual 6 (0.001%)  origin-forest_43.843 7 (err=1.167)  
83.3 queries/sec
Query 37: actual 4 (0.001%)  origin-forest_43.843 4 (err=1.000)  
82.8 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 71772 (10.294%)  origin-forest_43.843 67604 (err=1.062)  
90.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 43: actual 40 (0.006%)  origin-forest_43.843 1 (err=40.000)  
90.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 4 (0.001%)  origin-forest_43.843 2 (err=2.000)  
76.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 27 (0.004%)  origin-forest_43.843 2 (err=13.500)  
90.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 214.0000	99th: 143.3175	95th: 48.8473	median: 1.0693	mean: 9.9460
ReportEsts: [1.0, 214.0, 1.0, 55.0, 1.5057522123893805, 1.6394736842105264, 1.0, 1.5, 1.0, 1.3, 1.4151732377538828, 1.0, 14.0, 1.256926952141058, 1.0395869191049913, 1.0, 1.0, 1.0, 1.3, 1.0, 1.142467886337096, 1.0, 1.0, 1.0, 1.236724960254372, 1.083626141953619, 41.32738095238095, 1.0541782492766778, 1.3786833855799374, 1.8028169014084507, 1.0769230769230769, 1.0, 1.3333333333333333, 69.75, 1.1520298378998708, 1.2777777777777777, 1.1666666666666667, 1.0, 1.0, 1.0, 1.0616531566179517, 1.0, 1.0, 40.0, 1.0, 2.0, 1.0, 13.5, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 17/50 | Workload-time: 4.112323 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 18/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 10
RandomSeedCommunicator.get: 10
Query 0: actual 3155 (0.453%)  origin-forest_43.843 1749 (err=1.804)  
44.4 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 3: actual 4130 (0.592%)  origin-forest_43.843 5017 (err=1.215)  
90.9 queries/sec
Query 4: actual 43 (0.006%)  origin-forest_43.843 15 (err=2.867)  
90.9 queries/sec
Query 5: actual 60 (0.009%)  origin-forest_43.843 57 (err=1.053)  
83.3 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 7: actual 32710 (4.692%)  origin-forest_43.843 20867 (err=1.568)  
90.9 queries/sec
Query 8: actual 47 (0.007%)  origin-forest_43.843 48 (err=1.021)  
82.5 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.3 queries/sec
Query 10: actual 178 (0.026%)  origin-forest_43.843 342 (err=1.921)  
95.2 queries/sec
Query 11: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 12: actual 81 (0.012%)  origin-forest_43.843 117 (err=1.444)  
90.9 queries/sec
Query 13: actual 356 (0.051%)  origin-forest_43.843 5 (err=71.200)  
83.3 queries/sec
Query 14: actual 207 (0.030%)  origin-forest_43.843 1 (err=207.000)  
90.9 queries/sec
Query 15: actual 1597 (0.229%)  origin-forest_43.843 1539 (err=1.038)  
90.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 15 (0.002%)  origin-forest_43.843 18 (err=1.200)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 19: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 20: actual 15 (0.002%)  origin-forest_43.843 2 (err=7.500)  
83.3 queries/sec
Query 21: actual 157 (0.023%)  origin-forest_43.843 80 (err=1.962)  
90.9 queries/sec
Query 22: actual 110401 (15.835%)  origin-forest_43.843 145620 (err=1.319)  
90.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 24: actual 713 (0.102%)  origin-forest_43.843 1 (err=713.000)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 26: actual 38 (0.005%)  origin-forest_43.843 1 (err=38.000)  
64.5 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 29: actual 50 (0.007%)  origin-forest_43.843 1 (err=50.000)  
90.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
76.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.7 queries/sec
Query 32: actual 497 (0.071%)  origin-forest_43.843 703 (err=1.414)  
90.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 36: actual 1043 (0.150%)  origin-forest_43.843 374 (err=2.789)  
83.3 queries/sec
Query 37: actual 4 (0.001%)  origin-forest_43.843 6 (err=1.500)  
76.9 queries/sec
Query 38: actual 141 (0.020%)  origin-forest_43.843 42 (err=3.357)  
90.9 queries/sec
Query 39: actual 190 (0.027%)  origin-forest_43.843 109 (err=1.743)  
90.9 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
76.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 42: actual 5740 (0.823%)  origin-forest_43.843 4622 (err=1.242)  
86.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 21 (0.003%)  origin-forest_43.843 33 (err=1.571)  
90.9 queries/sec
Query 45: actual 5568 (0.799%)  origin-forest_43.843 5285 (err=1.054)  
100.0 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 3 (0.000%)  origin-forest_43.843 0 (err=3.000)  
83.3 queries/sec
Query 48: actual 16 (0.002%)  origin-forest_43.843 31 (err=1.938)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 713.0000	99th: 465.0600	95th: 61.6600	median: 1.2804	mean: 23.0144
ReportEsts: [1.8038879359634077, 1.0, 1.0, 1.214769975786925, 2.8666666666666667, 1.0526315789473684, 1.0, 1.5675468442996119, 1.0212765957446808, 1.0, 1.9213483146067416, 2.0, 1.4444444444444444, 71.2, 207.0, 1.0376868096166343, 1.0, 1.2, 1.0, 2.0, 7.5, 1.9625, 1.3190097915779748, 1.0, 713.0, 1.0, 38.0, 1.0, 1.0, 50.0, 2.0, 1.0, 1.414486921529175, 1.0, 1.0, 1.0, 2.7887700534759357, 1.5, 3.357142857142857, 1.7431192660550459, 2.0, 1.0, 1.2418866291648636, 1.0, 1.5714285714285714, 1.0535477767265846, 1.0, 3, 1.9375, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 18/50 | Workload-time: 4.080841 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 19/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 11
RandomSeedCommunicator.get: 11
Query 0: actual 4511 (0.647%)  origin-forest_43.843 4488 (err=1.005)  
43.5 queries/sec
Query 1: actual 8 (0.001%)  origin-forest_43.843 4 (err=2.000)  
83.3 queries/sec
Query 2: actual 4102 (0.588%)  origin-forest_43.843 3482 (err=1.178)  
90.9 queries/sec
Query 3: actual 19 (0.003%)  origin-forest_43.843 1 (err=19.000)  
79.8 queries/sec
Query 4: actual 2449 (0.351%)  origin-forest_43.843 806 (err=3.038)  
83.4 queries/sec
Query 5: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
90.9 queries/sec
Query 6: actual 21 (0.003%)  origin-forest_43.843 1 (err=21.000)  
83.3 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 8: actual 578 (0.083%)  origin-forest_43.843 1 (err=578.000)  
83.3 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 10: actual 26 (0.004%)  origin-forest_43.843 0 (err=26.000)  
90.9 queries/sec
Query 11: actual 453381 (65.028%)  origin-forest_43.843 436196 (err=1.039)  
80.0 queries/sec
Query 12: actual 6 (0.001%)  origin-forest_43.843 7 (err=1.167)  
90.8 queries/sec
Query 13: actual 339 (0.049%)  origin-forest_43.843 202 (err=1.678)  
83.4 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 328 (0.047%)  origin-forest_43.843 7 (err=46.857)  
83.3 queries/sec
Query 18: actual 32 (0.005%)  origin-forest_43.843 41 (err=1.281)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 33 (0.005%)  origin-forest_43.843 9 (err=3.667)  
90.9 queries/sec
Query 23: actual 13 (0.002%)  origin-forest_43.843 1 (err=13.000)  
83.3 queries/sec
Query 24: actual 6262 (0.898%)  origin-forest_43.843 10243 (err=1.636)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.3 queries/sec
Query 26: actual 19 (0.003%)  origin-forest_43.843 11 (err=1.727)  
76.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 4 (0.001%)  origin-forest_43.843 4 (err=1.000)  
95.1 queries/sec
Query 29: actual 4910 (0.704%)  origin-forest_43.843 3403 (err=1.443)  
83.3 queries/sec
Query 30: actual 76 (0.011%)  origin-forest_43.843 1 (err=76.000)  
76.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 214 (0.031%)  origin-forest_43.843 79 (err=2.709)  
80.0 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
87.4 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.7 queries/sec
Query 38: actual 166510 (23.882%)  origin-forest_43.843 173165 (err=1.040)  
90.9 queries/sec
Query 39: actual 140 (0.020%)  origin-forest_43.843 226 (err=1.614)  
83.3 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 41: actual 765 (0.110%)  origin-forest_43.843 16 (err=47.812)  
90.9 queries/sec
Query 42: actual 4 (0.001%)  origin-forest_43.843 8 (err=2.000)  
90.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 6 (0.001%)  origin-forest_43.843 5 (err=1.200)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 11862 (1.701%)  origin-forest_43.843 19775 (err=1.667)  
100.0 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 578.0000	99th: 332.0200	95th: 47.3826	median: 1.1033	mean: 17.7152
ReportEsts: [1.0051247771836007, 2.0, 1.1780585870189546, 19.0, 3.0384615384615383, 3.0, 21.0, 1.0, 578.0, 2.0, 26, 1.039397426844813, 1.1666666666666667, 1.6782178217821782, 1.0, 1.0, 1.0, 46.857142857142854, 1.28125, 1.0, 1.0, 1.0, 3.6666666666666665, 13.0, 1.6357393803896518, 1.0, 1.7272727272727273, 1.0, 1.0, 1.442844548927417, 76.0, 1.0, 1.0, 1.0, 1.0, 2.7088607594936707, 1.0, 1.0, 1.0399675695153445, 1.6142857142857143, 1.0, 47.8125, 2.0, 1.0, 1.2, 1.0, 1.0, 1.667088180745237, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 19/50 | Workload-time: 4.057851 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 20/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 12
RandomSeedCommunicator.get: 12
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.8 queries/sec
Query 1: actual 6 (0.001%)  origin-forest_43.843 8 (err=1.333)  
83.3 queries/sec
Query 2: actual 633 (0.091%)  origin-forest_43.843 1 (err=633.000)  
83.3 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 4: actual 8 (0.001%)  origin-forest_43.843 6 (err=1.333)  
83.3 queries/sec
Query 5: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
90.9 queries/sec
Query 6: actual 380 (0.055%)  origin-forest_43.843 422 (err=1.111)  
90.9 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 9: actual 167 (0.024%)  origin-forest_43.843 214 (err=1.281)  
100.0 queries/sec
Query 10: actual 42669 (6.120%)  origin-forest_43.843 48183 (err=1.129)  
83.3 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 10545 (1.512%)  origin-forest_43.843 10576 (err=1.003)  
83.3 queries/sec
Query 13: actual 25423 (3.646%)  origin-forest_43.843 19766 (err=1.286)  
90.9 queries/sec
Query 14: actual 35 (0.005%)  origin-forest_43.843 1 (err=35.000)  
90.9 queries/sec
Query 15: actual 70 (0.010%)  origin-forest_43.843 190 (err=2.714)  
76.9 queries/sec
Query 16: actual 5847 (0.839%)  origin-forest_43.843 7161 (err=1.225)  
74.0 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 19: actual 42 (0.006%)  origin-forest_43.843 4 (err=10.500)  
90.9 queries/sec
Query 20: actual 161577 (23.175%)  origin-forest_43.843 126478 (err=1.278)  
83.3 queries/sec
Query 21: actual 71 (0.010%)  origin-forest_43.843 102 (err=1.437)  
90.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
73.7 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 26: actual 1741 (0.250%)  origin-forest_43.843 1 (err=1741.000)  
90.9 queries/sec
Query 27: actual 195 (0.028%)  origin-forest_43.843 224 (err=1.149)  
83.3 queries/sec
Query 28: actual 1359 (0.195%)  origin-forest_43.843 1275 (err=1.066)  
83.3 queries/sec
Query 29: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
76.9 queries/sec
Query 30: actual 5131 (0.736%)  origin-forest_43.843 1528 (err=3.358)  
83.3 queries/sec
Query 31: actual 111 (0.016%)  origin-forest_43.843 157 (err=1.414)  
90.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 35: actual 37 (0.005%)  origin-forest_43.843 13 (err=2.846)  
76.9 queries/sec
Query 36: actual 6 (0.001%)  origin-forest_43.843 7 (err=1.167)  
83.3 queries/sec
Query 37: actual 6 (0.001%)  origin-forest_43.843 2 (err=3.000)  
90.9 queries/sec
Query 38: actual 791 (0.113%)  origin-forest_43.843 1220 (err=1.542)  
90.9 queries/sec
Query 39: actual 7 (0.001%)  origin-forest_43.843 2 (err=3.500)  
76.9 queries/sec
Query 40: actual 1512 (0.217%)  origin-forest_43.843 2851 (err=1.886)  
76.9 queries/sec
Query 41: actual 52 (0.007%)  origin-forest_43.843 0 (err=52.000)  
74.0 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 43: actual 9 (0.001%)  origin-forest_43.843 2 (err=4.500)  
76.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 49: actual 156933 (22.509%)  origin-forest_43.843 117806 (err=1.332)  
origin-forest_43.843 	max: 1741.0000	99th: 1198.0800	95th: 44.3500	median: 1.1390	mean: 50.7178
ReportEsts: [1.0, 1.3333333333333333, 633.0, 1.0, 1.3333333333333333, 1.5, 1.1105263157894736, 1.0, 1.0, 1.281437125748503, 1.1292273078816002, 1.0, 1.0029397818871504, 1.2861985227157746, 35.0, 2.7142857142857144, 1.224730631092868, 1.0, 1.0, 10.5, 1.2775107133256376, 1.4366197183098592, 1.0, 1.0, 1.0, 1.0, 1741.0, 1.1487179487179486, 1.0658823529411765, 1.0, 3.3579842931937174, 1.4144144144144144, 1.0, 1.0, 1.0, 2.8461538461538463, 1.1666666666666667, 3.0, 1.5423514538558787, 3.5, 1.8855820105820107, 52, 1.0, 4.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.3321307913009524]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 20/50 | Workload-time: 4.068020 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 21/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 13
RandomSeedCommunicator.get: 13
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.3 queries/sec
Query 2: actual 12128 (1.739%)  origin-forest_43.843 2411 (err=5.030)  
84.5 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 4: actual 8 (0.001%)  origin-forest_43.843 5 (err=1.600)  
83.3 queries/sec
Query 5: actual 146 (0.021%)  origin-forest_43.843 80 (err=1.825)  
83.3 queries/sec
Query 6: actual 31786 (4.559%)  origin-forest_43.843 38488 (err=1.211)  
90.9 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 8: actual 11308 (1.622%)  origin-forest_43.843 6064 (err=1.865)  
90.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.8 queries/sec
Query 10: actual 59 (0.008%)  origin-forest_43.843 121 (err=2.051)  
64.5 queries/sec
Query 11: actual 14574 (2.090%)  origin-forest_43.843 75 (err=194.320)  
83.3 queries/sec
Query 12: actual 854 (0.122%)  origin-forest_43.843 1263 (err=1.479)  
83.3 queries/sec
Query 13: actual 8 (0.001%)  origin-forest_43.843 10 (err=1.250)  
90.9 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 15: actual 335 (0.048%)  origin-forest_43.843 277 (err=1.209)  
83.3 queries/sec
Query 16: actual 7 (0.001%)  origin-forest_43.843 47 (err=6.714)  
94.5 queries/sec
Query 17: actual 95 (0.014%)  origin-forest_43.843 1 (err=95.000)  
83.3 queries/sec
Query 18: actual 4247 (0.609%)  origin-forest_43.843 1885 (err=2.253)  
83.3 queries/sec
Query 19: actual 87 (0.012%)  origin-forest_43.843 15 (err=5.800)  
86.9 queries/sec
Query 20: actual 59035 (8.467%)  origin-forest_43.843 82110 (err=1.391)  
90.9 queries/sec
Query 21: actual 7 (0.001%)  origin-forest_43.843 2 (err=3.500)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.5 queries/sec
Query 25: actual 232 (0.033%)  origin-forest_43.843 29 (err=8.000)  
83.4 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 28: actual 13 (0.002%)  origin-forest_43.843 9 (err=1.444)  
83.3 queries/sec
Query 29: actual 27 (0.004%)  origin-forest_43.843 1 (err=27.000)  
90.9 queries/sec
Query 30: actual 36 (0.005%)  origin-forest_43.843 1 (err=36.000)  
83.3 queries/sec
Query 31: actual 501 (0.072%)  origin-forest_43.843 775 (err=1.547)  
90.9 queries/sec
Query 32: actual 57 (0.008%)  origin-forest_43.843 1 (err=57.000)  
83.3 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 26 (err=1.733)  
83.3 queries/sec
Query 34: actual 26 (0.004%)  origin-forest_43.843 1 (err=26.000)  
76.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 37: actual 3379 (0.485%)  origin-forest_43.843 3760 (err=1.113)  
90.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 175 (0.025%)  origin-forest_43.843 202 (err=1.154)  
100.0 queries/sec
Query 40: actual 3 (0.000%)  origin-forest_43.843 3 (err=1.000)  
76.9 queries/sec
Query 41: actual 76945 (11.036%)  origin-forest_43.843 71702 (err=1.073)  
83.3 queries/sec
Query 42: actual 2 (0.000%)  origin-forest_43.843 5 (err=2.500)  
71.4 queries/sec
Query 43: actual 19 (0.003%)  origin-forest_43.843 10 (err=1.900)  
74.0 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 45: actual 9 (0.001%)  origin-forest_43.843 11 (err=1.222)  
76.9 queries/sec
Query 46: actual 12212 (1.752%)  origin-forest_43.843 14545 (err=1.191)  
90.9 queries/sec
Query 47: actual 12503 (1.793%)  origin-forest_43.843 14134 (err=1.130)  
90.9 queries/sec
Query 48: actual 7 (0.001%)  origin-forest_43.843 1 (err=7.000)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 194.3200	99th: 145.6532	95th: 47.5500	median: 1.2361	mean: 10.4101
ReportEsts: [1.0, 1.0, 5.03027789299046, 1.0, 1.6, 1.825, 1.2108475429434342, 1.0, 1.8647757255936674, 1.0, 2.0508474576271185, 194.32, 1.4789227166276346, 1.25, 1.0, 1.2093862815884477, 6.714285714285714, 95.0, 2.253050397877984, 5.8, 1.390869822986364, 3.5, 1.0, 1.0, 1.0, 8.0, 1.0, 1.0, 1.4444444444444444, 27.0, 36.0, 1.5469061876247505, 57.0, 1.7333333333333334, 26.0, 1.0, 1.0, 1.112755253033442, 1.0, 1.1542857142857144, 1.0, 1.0731220886446682, 2.5, 1.9, 1.0, 1.2222222222222223, 1.191041598427776, 1.1304486923138446, 7.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 21/50 | Workload-time: 4.091861 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 22/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.1s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 14
RandomSeedCommunicator.get: 14
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
41.7 queries/sec
Query 1: actual 3 (0.000%)  origin-forest_43.843 3 (err=1.000)  
51.2 queries/sec
Query 2: actual 349 (0.050%)  origin-forest_43.843 464 (err=1.330)  
76.9 queries/sec
Query 3: actual 129 (0.019%)  origin-forest_43.843 131 (err=1.016)  
90.9 queries/sec
Query 4: actual 1181 (0.169%)  origin-forest_43.843 890 (err=1.327)  
83.3 queries/sec
Query 5: actual 145 (0.021%)  origin-forest_43.843 89 (err=1.629)  
90.9 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.4 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 8: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 9: actual 64 (0.009%)  origin-forest_43.843 2 (err=32.000)  
83.3 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
90.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 14: actual 10 (0.001%)  origin-forest_43.843 5 (err=2.000)  
76.9 queries/sec
Query 15: actual 2472 (0.355%)  origin-forest_43.843 2261 (err=1.093)  
83.3 queries/sec
Query 16: actual 334 (0.048%)  origin-forest_43.843 421 (err=1.260)  
82.1 queries/sec
Query 17: actual 6959 (0.998%)  origin-forest_43.843 7508 (err=1.079)  
90.8 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 19: actual 19 (0.003%)  origin-forest_43.843 18 (err=1.056)  
76.9 queries/sec
Query 20: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
76.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 25: actual 47 (0.007%)  origin-forest_43.843 1 (err=47.000)  
90.9 queries/sec
Query 26: actual 2914 (0.418%)  origin-forest_43.843 3888 (err=1.334)  
94.6 queries/sec
Query 27: actual 16 (0.002%)  origin-forest_43.843 1 (err=16.000)  
76.5 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 30: actual 36 (0.005%)  origin-forest_43.843 1 (err=36.000)  
83.3 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 27 (0.004%)  origin-forest_43.843 13 (err=2.077)  
90.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 35: actual 99 (0.014%)  origin-forest_43.843 1 (err=99.000)  
74.0 queries/sec
Query 36: actual 191 (0.027%)  origin-forest_43.843 1 (err=191.000)  
76.9 queries/sec
Query 37: actual 2147 (0.308%)  origin-forest_43.843 64 (err=33.547)  
83.3 queries/sec
Query 38: actual 2 (0.000%)  origin-forest_43.843 4 (err=2.000)  
90.9 queries/sec
Query 39: actual 171 (0.025%)  origin-forest_43.843 17 (err=10.059)  
90.9 queries/sec
Query 40: actual 198 (0.028%)  origin-forest_43.843 151 (err=1.311)  
90.9 queries/sec
Query 41: actual 555 (0.080%)  origin-forest_43.843 749 (err=1.350)  
83.3 queries/sec
Query 42: actual 131 (0.019%)  origin-forest_43.843 73 (err=1.795)  
90.9 queries/sec
Query 43: actual 3 (0.000%)  origin-forest_43.843 4 (err=1.333)  
90.6 queries/sec
Query 44: actual 1341 (0.192%)  origin-forest_43.843 515 (err=2.604)  
100.0 queries/sec
Query 45: actual 101 (0.014%)  origin-forest_43.843 162 (err=1.604)  
83.3 queries/sec
Query 46: actual 95 (0.014%)  origin-forest_43.843 87 (err=1.092)  
90.9 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 191.0000	99th: 145.9200	95th: 42.0500	median: 1.0926	mean: 10.3779
ReportEsts: [1.0, 1.0, 1.329512893982808, 1.0155038759689923, 1.3269662921348315, 1.6292134831460674, 1.0, 1.0, 2.0, 32.0, 1.0, 1.0, 3.0, 1.0, 2.0, 1.0933215391419726, 1.2604790419161678, 1.0788906452076448, 1.0, 1.0555555555555556, 1.0, 1.0, 1.0, 1.0, 1.0, 47.0, 1.334248455730954, 16.0, 1.0, 1.0, 36.0, 1.0, 2.076923076923077, 1.0, 1.0, 99.0, 191.0, 33.546875, 2.0, 10.058823529411764, 1.3112582781456954, 1.3495495495495495, 1.7945205479452055, 1.3333333333333333, 2.603883495145631, 1.603960396039604, 1.0919540229885059, 1.0, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 22/50 | Workload-time: 4.062768 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 23/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=single', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
SingleSample - START
SingleSample - END
load_npy_dataset_from_path - df.shape = (661012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 17.5743
detection mean = 43.9911
detection threshold = 0.3809
test statistic = 26.4168
Offline time = 3.0023810863494873
Online time = 0.46827220916748047
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 23-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (661012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.0s
dataset size: 661012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 35.2294 bits (loss 52.592, data 17.363) 0.00100 lr
epoch 9 train loss 36.1034 nats / 52.0863 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 34.7552 bits (loss 52.118, data 17.363) 0.00082 lr
epoch 19 train loss 35.9469 nats / 51.8604 bits
time since start: 7.2 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 7.0531 nats / 10.1754 bits
Traceback (most recent call last):
  File "F:\DBGroup\LearnedCardinalityUpdater\Naru\incremental_train.py", line 2065, in <module>
    main()
  File "F:\DBGroup\LearnedCardinalityUpdater\Naru\incremental_train.py", line 2034, in main
    UpdateTask(pre_model=model_path, new_model_path=new_model_path, end2end=True)
  File "F:\DBGroup\LearnedCardinalityUpdater\Naru\incremental_train.py", line 1381, in UpdateTask
    save_torch_model(model, new_model_path)
  File "F:\DBGroup\LearnedCardinalityUpdater\utils\model_util.py", line 28, in save_torch_model
    torch.save(model.state_dict(), absolute_path)
  File "D:\Develop_Tools\Anaconda3\envs\cardi\lib\site-packages\torch\serialization.py", line 504, in save
    with _open_zipfile_writer(f) as opened_zipfile:
  File "D:\Develop_Tools\Anaconda3\envs\cardi\lib\site-packages\torch\serialization.py", line 378, in _open_zipfile_writer
    return container(name_or_buffer)
  File "D:\Develop_Tools\Anaconda3\envs\cardi\lib\site-packages\torch\serialization.py", line 349, in __init__
    super().__init__(torch._C.PyTorchFileWriter(self.name))
RuntimeError: File F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt cannot be opened.
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 23/50 | Workload-time: 6.665097 | Model-update-time: 10.816558


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 24/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=single', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
SingleSample - START
SingleSample - END
load_npy_dataset_from_path - df.shape = (671012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 14.4542
detection mean = 44.0353
detection threshold = 0.3816
test statistic = 29.5812
Offline time = 2.8400917053222656
Online time = 0.49082159996032715
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 24-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (671012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.0s
dataset size: 671012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 34.7981 bits (loss 51.947, data 17.149) 0.00100 lr
epoch 9 train loss 35.5781 nats / 51.3284 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 34.3905 bits (loss 51.539, data 17.149) 0.00082 lr
epoch 19 train loss 35.4367 nats / 51.1244 bits
time since start: 7.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 7.0490 nats / 10.1695 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 24/50 | Workload-time: 6.486789 | Model-update-time: 10.398317


WORKLOAD-START | Type: QueryWorkload | Progress: 25/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 15
RandomSeedCommunicator.get: 15
Query 0: actual 60725 (8.710%)  origin-forest_43.843 19315 (err=3.144)  
45.5 queries/sec
Query 1: actual 1234 (0.177%)  origin-forest_43.843 1366 (err=1.107)  
86.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 3: actual 1480 (0.212%)  origin-forest_43.843 215 (err=6.884)  
90.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 5: actual 47 (0.007%)  origin-forest_43.843 1 (err=47.000)  
83.3 queries/sec
Query 6: actual 37 (0.005%)  origin-forest_43.843 36 (err=1.028)  
83.3 queries/sec
Query 7: actual 124 (0.018%)  origin-forest_43.843 146 (err=1.177)  
90.9 queries/sec
Query 8: actual 11 (0.002%)  origin-forest_43.843 1 (err=11.000)  
76.9 queries/sec
Query 9: actual 17 (0.002%)  origin-forest_43.843 7 (err=2.429)  
83.3 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
95.2 queries/sec
Query 11: actual 6 (0.001%)  origin-forest_43.843 7 (err=1.167)  
83.3 queries/sec
Query 12: actual 894 (0.128%)  origin-forest_43.843 1234 (err=1.380)  
90.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 15: actual 140 (0.020%)  origin-forest_43.843 48 (err=2.917)  
90.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 20: actual 138219 (19.824%)  origin-forest_43.843 116983 (err=1.182)  
90.9 queries/sec
Query 21: actual 36 (0.005%)  origin-forest_43.843 17 (err=2.118)  
90.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 67 (0.010%)  origin-forest_43.843 2 (err=33.500)  
90.9 queries/sec
Query 24: actual 251 (0.036%)  origin-forest_43.843 7 (err=35.857)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 26: actual 2 (0.000%)  origin-forest_43.843 6 (err=3.000)  
90.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 28: actual 156 (0.022%)  origin-forest_43.843 280 (err=1.795)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 30: actual 108 (0.015%)  origin-forest_43.843 107 (err=1.009)  
83.3 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 15 (0.002%)  origin-forest_43.843 24 (err=1.600)  
100.0 queries/sec
Query 33: actual 297 (0.043%)  origin-forest_43.843 415 (err=1.397)  
83.3 queries/sec
Query 34: actual 1490 (0.214%)  origin-forest_43.843 2721 (err=1.826)  
90.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 37: actual 41869 (6.005%)  origin-forest_43.843 50184 (err=1.199)  
90.9 queries/sec
Query 38: actual 43969 (6.306%)  origin-forest_43.843 26124 (err=1.683)  
95.1 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 40: actual 18989 (2.724%)  origin-forest_43.843 20288 (err=1.068)  
80.0 queries/sec
Query 41: actual 66 (0.009%)  origin-forest_43.843 60 (err=1.100)  
76.5 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 43: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 45: actual 31 (0.004%)  origin-forest_43.843 16 (err=1.938)  
90.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 48: actual 6810 (0.977%)  origin-forest_43.843 2529 (err=2.693)  
83.3 queries/sec
Query 49: actual 629 (0.090%)  origin-forest_43.843 556 (err=1.131)  
origin-forest_43.843 	max: 47.0000	99th: 41.5400	95th: 23.3750	median: 1.0842	mean: 3.9066
ReportEsts: [3.143929588402796, 1.106969205834684, 1.0, 6.883720930232558, 1.0, 47.0, 1.0277777777777777, 1.1774193548387097, 11.0, 2.4285714285714284, 1.0, 1.1666666666666667, 1.3803131991051454, 1.0, 1.0, 2.9166666666666665, 1.0, 1.0, 1.0, 1.0, 1.1815306497525282, 2.1176470588235294, 1.0, 33.5, 35.857142857142854, 1.0, 3.0, 1.0, 1.794871794871795, 1.0, 1.0093457943925233, 1.0, 1.6, 1.3973063973063973, 1.8261744966442952, 1.0, 1.0, 1.1985956196708782, 1.6830883478793446, 1.0, 1.0684080256990889, 1.1, 1.0, 1.0, 1.0, 1.9375, 1.0, 1.0, 2.6927639383155397, 1.131294964028777]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 25/50 | Workload-time: 4.080113 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 26/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=single', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
SingleSample - START
SingleSample - END
load_npy_dataset_from_path - df.shape = (681012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 11.4136
detection mean = 44.1391
detection threshold = 0.3953
test statistic = 32.7255
Offline time = 2.8983712196350098
Online time = 0.48740673065185547
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 26-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (681012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 681012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 34.1398 bits (loss 51.078, data 16.938) 0.00100 lr
epoch 9 train loss 35.1996 nats / 50.7823 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 33.9785 bits (loss 50.917, data 16.938) 0.00082 lr
epoch 19 train loss 35.0693 nats / 50.5942 bits
time since start: 7.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 6.8248 nats / 9.8460 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 26/50 | Workload-time: 6.517701 | Model-update-time: 10.414210


WORKLOAD-START | Type: QueryWorkload | Progress: 27/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 16
RandomSeedCommunicator.get: 16
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
43.5 queries/sec
Query 1: actual 12327 (1.768%)  origin-forest_43.843 7003 (err=1.760)  
83.3 queries/sec
Query 2: actual 104 (0.015%)  origin-forest_43.843 90 (err=1.156)  
86.6 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.6 queries/sec
Query 4: actual 3703 (0.531%)  origin-forest_43.843 5016 (err=1.355)  
83.3 queries/sec
Query 5: actual 11 (0.002%)  origin-forest_43.843 16 (err=1.455)  
83.3 queries/sec
Query 6: actual 2 (0.000%)  origin-forest_43.843 6 (err=3.000)  
83.3 queries/sec
Query 7: actual 123 (0.018%)  origin-forest_43.843 86 (err=1.430)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 9: actual 52 (0.007%)  origin-forest_43.843 58 (err=1.115)  
90.9 queries/sec
Query 10: actual 99292 (14.241%)  origin-forest_43.843 96355 (err=1.030)  
90.3 queries/sec
Query 11: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 12: actual 42698 (6.124%)  origin-forest_43.843 50002 (err=1.171)  
83.3 queries/sec
Query 13: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
90.9 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
76.9 queries/sec
Query 15: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 305 (0.044%)  origin-forest_43.843 312 (err=1.023)  
86.8 queries/sec
Query 20: actual 341 (0.049%)  origin-forest_43.843 59 (err=5.780)  
90.9 queries/sec
Query 21: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 6 (0.001%)  origin-forest_43.843 2 (err=3.000)  
83.3 queries/sec
Query 24: actual 1518 (0.218%)  origin-forest_43.843 1607 (err=1.059)  
90.9 queries/sec
Query 25: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
90.9 queries/sec
Query 26: actual 6 (0.001%)  origin-forest_43.843 2 (err=3.000)  
76.9 queries/sec
Query 27: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
74.0 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
64.6 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
78.2 queries/sec
Query 30: actual 37 (0.005%)  origin-forest_43.843 1 (err=37.000)  
76.9 queries/sec
Query 31: actual 2099 (0.301%)  origin-forest_43.843 2120 (err=1.010)  
90.9 queries/sec
Query 32: actual 11 (0.002%)  origin-forest_43.843 1 (err=11.000)  
76.9 queries/sec
Query 33: actual 14813 (2.125%)  origin-forest_43.843 12035 (err=1.231)  
83.3 queries/sec
Query 34: actual 43 (0.006%)  origin-forest_43.843 1 (err=43.000)  
76.9 queries/sec
Query 35: actual 220449 (31.619%)  origin-forest_43.843 219833 (err=1.003)  
86.7 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
77.0 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
55.5 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
79.9 queries/sec
Query 43: actual 611 (0.088%)  origin-forest_43.843 879 (err=1.439)  
90.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 177 (0.025%)  origin-forest_43.843 76 (err=2.329)  
79.2 queries/sec
Query 47: actual 104 (0.015%)  origin-forest_43.843 154 (err=1.481)  
83.6 queries/sec
Query 48: actual 866 (0.124%)  origin-forest_43.843 900 (err=1.039)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 43.0000	99th: 40.0600	95th: 8.6508	median: 1.0489	mean: 3.2623
ReportEsts: [1.0, 1.7602456090247036, 1.1555555555555554, 1.0, 1.354577369700243, 1.4545454545454546, 3.0, 1.430232558139535, 1.0, 1.1153846153846154, 1.0304810336775465, 2.0, 1.1710618764344933, 3.0, 2.0, 3.0, 1.0, 1.0, 1.0, 1.022950819672131, 5.779661016949152, 1.0, 1.0, 3.0, 1.0586297760210803, 1.0, 3.0, 4.0, 1.0, 1.0, 37.0, 1.010004764173416, 11.0, 1.2308267552970502, 43.0, 1.0028021270691843, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.25, 1.4386252045826513, 1.0, 1.0, 2.3289473684210527, 1.4807692307692308, 1.0392609699769053, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 27/50 | Workload-time: 4.202332 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 28/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=single', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
SingleSample - START
SingleSample - END
load_npy_dataset_from_path - df.shape = (691012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 8.5188
detection mean = 44.2171
detection threshold = 0.4003
test statistic = 35.6983
Offline time = 2.9385344982147217
Online time = 0.5040161609649658
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 28-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (691012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 691012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 33.0524 bits (loss 49.785, data 16.732) 0.00100 lr
epoch 9 train loss 34.5908 nats / 49.9040 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 33.4258 bits (loss 50.158, data 16.732) 0.00082 lr
epoch 19 train loss 34.4995 nats / 49.7723 bits
time since start: 7.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 6.6071 nats / 9.5320 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 28/50 | Workload-time: 6.631484 | Model-update-time: 10.391370


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 29/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=single', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
SingleSample - START
SingleSample - END
load_npy_dataset_from_path - df.shape = (701012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 6.6071
detection mean = 44.1172
detection threshold = 0.4771
test statistic = 37.5101
Offline time = 2.9569897651672363
Online time = 0.4953441619873047
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 29-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (701012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 701012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 33.5311 bits (loss 50.062, data 16.531) 0.00100 lr
epoch 9 train loss 34.2594 nats / 49.4259 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 33.2330 bits (loss 49.764, data 16.531) 0.00082 lr
epoch 19 train loss 34.1008 nats / 49.1971 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 6.3849 nats / 9.2114 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 29/50 | Workload-time: 6.651984 | Model-update-time: 10.340235


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 30/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=single', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
SingleSample - START
SingleSample - END
load_npy_dataset_from_path - df.shape = (711012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 6.3849
detection mean = 43.6799
detection threshold = 0.6280
test statistic = 37.2951
Offline time = 2.897848606109619
Online time = 0.4969656467437744
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 30-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (711012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 711012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 33.1049 bits (loss 49.438, data 16.333) 0.00100 lr
epoch 9 train loss 33.9604 nats / 48.9946 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 32.6519 bits (loss 48.985, data 16.333) 0.00082 lr
epoch 19 train loss 33.8266 nats / 48.8015 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 6.1695 nats / 8.9007 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 30/50 | Workload-time: 6.578108 | Model-update-time: 10.333463


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 31/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=single', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
SingleSample - START
SingleSample - END
load_npy_dataset_from_path - df.shape = (721012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 6.1695
detection mean = 43.2376
detection threshold = 0.7571
test statistic = 37.0682
Offline time = 2.907386541366577
Online time = 0.517071008682251
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 31-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (721012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 721012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 33.8094 bits (loss 49.950, data 16.140) 0.00100 lr
epoch 9 train loss 33.6175 nats / 48.4998 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 32.9104 bits (loss 49.051, data 16.140) 0.00082 lr
epoch 19 train loss 33.4907 nats / 48.3169 bits
time since start: 7.2 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 5.9572 nats / 8.5944 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 31/50 | Workload-time: 6.634062 | Model-update-time: 10.496708


WORKLOAD-START | Type: QueryWorkload | Progress: 32/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 17
RandomSeedCommunicator.get: 17
Query 0: actual 13463 (1.931%)  origin-forest_43.843 17109 (err=1.271)  
42.5 queries/sec
Query 1: actual 628 (0.090%)  origin-forest_43.843 556 (err=1.129)  
90.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 3: actual 5 (0.001%)  origin-forest_43.843 8 (err=1.600)  
83.4 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 3 (err=3.000)  
90.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 6: actual 4 (0.001%)  origin-forest_43.843 2 (err=2.000)  
76.9 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 8: actual 35 (0.005%)  origin-forest_43.843 35 (err=1.000)  
90.9 queries/sec
Query 9: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 12: actual 17 (0.002%)  origin-forest_43.843 3 (err=5.667)  
76.9 queries/sec
Query 13: actual 260 (0.037%)  origin-forest_43.843 54 (err=4.815)  
83.3 queries/sec
Query 14: actual 1814 (0.260%)  origin-forest_43.843 2146 (err=1.183)  
83.3 queries/sec
Query 15: actual 65 (0.009%)  origin-forest_43.843 76 (err=1.169)  
95.2 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 20: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 22: actual 946 (0.136%)  origin-forest_43.843 1052 (err=1.112)  
90.9 queries/sec
Query 23: actual 519 (0.074%)  origin-forest_43.843 733 (err=1.412)  
86.3 queries/sec
Query 24: actual 3 (0.000%)  origin-forest_43.843 14 (err=4.667)  
84.9 queries/sec
Query 25: actual 39 (0.006%)  origin-forest_43.843 47 (err=1.205)  
86.5 queries/sec
Query 26: actual 7187 (1.031%)  origin-forest_43.843 10030 (err=1.396)  
83.3 queries/sec
Query 27: actual 103 (0.015%)  origin-forest_43.843 169 (err=1.641)  
71.4 queries/sec
Query 28: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
83.3 queries/sec
Query 29: actual 45 (0.006%)  origin-forest_43.843 49 (err=1.089)  
90.9 queries/sec
Query 30: actual 341 (0.049%)  origin-forest_43.843 335 (err=1.018)  
90.9 queries/sec
Query 31: actual 23 (0.003%)  origin-forest_43.843 22 (err=1.045)  
90.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.8 queries/sec
Query 33: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 34: actual 15 (0.002%)  origin-forest_43.843 38 (err=2.533)  
83.3 queries/sec
Query 35: actual 5 (0.001%)  origin-forest_43.843 2 (err=2.500)  
76.9 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 38: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 11433 (1.640%)  origin-forest_43.843 14972 (err=1.310)  
95.1 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 42: actual 25090 (3.599%)  origin-forest_43.843 29609 (err=1.180)  
100.0 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 141 (0.020%)  origin-forest_43.843 1 (err=141.000)  
83.3 queries/sec
Query 45: actual 65 (0.009%)  origin-forest_43.843 56 (err=1.161)  
83.3 queries/sec
Query 46: actual 12 (0.002%)  origin-forest_43.843 20 (err=1.667)  
90.9 queries/sec
Query 47: actual 202 (0.029%)  origin-forest_43.843 185 (err=1.092)  
90.8 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 141.0000	99th: 74.6867	95th: 4.7481	median: 1.1208	mean: 4.3572
ReportEsts: [1.2708163113719082, 1.129496402877698, 1.0, 1.6, 3.0, 1.0, 2.0, 1.0, 1.0, 3.0, 1.0, 1.0, 5.666666666666667, 4.814814814814815, 1.1830209481808158, 1.1692307692307693, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.1120507399577166, 1.4123314065510597, 4.666666666666667, 1.205128205128205, 1.3955753443717824, 1.6407766990291262, 1.0, 1.0888888888888888, 1.017910447761194, 1.0454545454545454, 1.0, 2.0, 2.533333333333333, 2.5, 1.0, 1.0, 2.0, 1.0, 1.309542552260999, 1.0, 1.1801115982463133, 1.0, 141.0, 1.1607142857142858, 1.6666666666666667, 1.0918918918918918, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 32/50 | Workload-time: 4.052758 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 33/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 18
RandomSeedCommunicator.get: 18
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
42.4 queries/sec
Query 1: actual 8 (0.001%)  origin-forest_43.843 21 (err=2.625)  
83.4 queries/sec
Query 2: actual 298 (0.043%)  origin-forest_43.843 151 (err=1.974)  
90.9 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 4: actual 13499 (1.936%)  origin-forest_43.843 15980 (err=1.184)  
83.3 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
85.0 queries/sec
Query 6: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
80.8 queries/sec
Query 7: actual 955 (0.137%)  origin-forest_43.843 877 (err=1.089)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 9: actual 6 (0.001%)  origin-forest_43.843 7 (err=1.167)  
90.9 queries/sec
Query 10: actual 144 (0.021%)  origin-forest_43.843 5 (err=28.800)  
83.3 queries/sec
Query 11: actual 35 (0.005%)  origin-forest_43.843 1 (err=35.000)  
76.9 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 13: actual 34 (0.005%)  origin-forest_43.843 1 (err=34.000)  
76.9 queries/sec
Query 14: actual 358 (0.051%)  origin-forest_43.843 283 (err=1.265)  
90.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 18: actual 5500 (0.789%)  origin-forest_43.843 2300 (err=2.391)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 20: actual 233770 (33.529%)  origin-forest_43.843 232779 (err=1.004)  
95.1 queries/sec
Query 21: actual 8202 (1.176%)  origin-forest_43.843 8039 (err=1.020)  
83.3 queries/sec
Query 22: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 23: actual 104 (0.015%)  origin-forest_43.843 103 (err=1.010)  
66.7 queries/sec
Query 24: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 26: actual 21 (0.003%)  origin-forest_43.843 58 (err=2.762)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 4 (err=4.000)  
82.7 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 30: actual 21535 (3.089%)  origin-forest_43.843 23714 (err=1.101)  
90.9 queries/sec
Query 31: actual 29 (0.004%)  origin-forest_43.843 25 (err=1.160)  
90.9 queries/sec
Query 32: actual 11 (0.002%)  origin-forest_43.843 5 (err=2.200)  
83.3 queries/sec
Query 33: actual 605 (0.087%)  origin-forest_43.843 822 (err=1.359)  
83.3 queries/sec
Query 34: actual 201 (0.029%)  origin-forest_43.843 176 (err=1.142)  
83.3 queries/sec
Query 35: actual 446 (0.064%)  origin-forest_43.843 330 (err=1.352)  
90.9 queries/sec
Query 36: actual 5 (0.001%)  origin-forest_43.843 1 (err=5.000)  
76.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 32625 (4.679%)  origin-forest_43.843 26737 (err=1.220)  
100.0 queries/sec
Query 40: actual 282 (0.040%)  origin-forest_43.843 304 (err=1.078)  
90.9 queries/sec
Query 41: actual 989 (0.142%)  origin-forest_43.843 1261 (err=1.275)  
83.3 queries/sec
Query 42: actual 3799 (0.545%)  origin-forest_43.843 1558 (err=2.438)  
83.3 queries/sec
Query 43: actual 14 (0.002%)  origin-forest_43.843 16 (err=1.143)  
90.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 107 (0.015%)  origin-forest_43.843 133 (err=1.243)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 47: actual 14271 (2.047%)  origin-forest_43.843 11343 (err=1.258)  
90.9 queries/sec
Query 48: actual 11 (0.002%)  origin-forest_43.843 1 (err=11.000)  
76.9 queries/sec
Query 49: actual 46 (0.007%)  origin-forest_43.843 57 (err=1.239)  
origin-forest_43.843 	max: 62.0000	99th: 48.7700	95th: 31.6600	median: 1.1633	mean: 4.7900
ReportEsts: [1.0, 2.625, 1.9735099337748345, 1.0, 1.1837913919549596, 1.0, 4.0, 1.088939566704675, 1.0, 1.1666666666666667, 28.8, 35.0, 1.0, 34.0, 1.265017667844523, 1.0, 1.0, 1.0, 2.391304347826087, 1.0, 1.004257256883138, 1.0202761537504665, 3.0, 1.0097087378640777, 62.0, 1.0, 2.761904761904762, 1.0, 4.0, 1.0, 1.101184118876248, 1.16, 2.2, 1.3586776859504133, 1.1420454545454546, 1.3515151515151516, 5.0, 1.0, 1.0, 1.220219171934024, 1.0780141843971631, 1.275025278058645, 2.438382541720154, 1.1428571428571428, 1.0, 1.2429906542056075, 1.0, 1.2581327691087014, 11.0, 1.2391304347826086]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 33/50 | Workload-time: 4.033582 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 34/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 19
RandomSeedCommunicator.get: 19
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
37.0 queries/sec
Query 1: actual 31665 (4.542%)  origin-forest_43.843 35981 (err=1.136)  
70.7 queries/sec
Query 2: actual 17 (0.002%)  origin-forest_43.843 5 (err=3.400)  
66.6 queries/sec
Query 3: actual 10 (0.001%)  origin-forest_43.843 3 (err=3.333)  
76.8 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 8932 (1.281%)  origin-forest_43.843 11408 (err=1.277)  
74.4 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.3 queries/sec
Query 7: actual 132 (0.019%)  origin-forest_43.843 169 (err=1.280)  
83.8 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 9: actual 71707 (10.285%)  origin-forest_43.843 80571 (err=1.124)  
71.4 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 13: actual 82 (0.012%)  origin-forest_43.843 41 (err=2.000)  
90.9 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 18: actual 2496 (0.358%)  origin-forest_43.843 2341 (err=1.066)  
86.9 queries/sec
Query 19: actual 32501 (4.662%)  origin-forest_43.843 44845 (err=1.380)  
83.5 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
52.6 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 25: actual 129 (0.019%)  origin-forest_43.843 175 (err=1.357)  
76.9 queries/sec
Query 26: actual 296 (0.042%)  origin-forest_43.843 316 (err=1.068)  
76.4 queries/sec
Query 27: actual 10 (0.001%)  origin-forest_43.843 11 (err=1.100)  
83.3 queries/sec
Query 28: actual 83 (0.012%)  origin-forest_43.843 1 (err=83.000)  
71.4 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
63.9 queries/sec
Query 30: actual 55 (0.008%)  origin-forest_43.843 83 (err=1.509)  
76.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 32: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 33: actual 17232 (2.472%)  origin-forest_43.843 21347 (err=1.239)  
79.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.8 queries/sec
Query 35: actual 146610 (21.028%)  origin-forest_43.843 114381 (err=1.282)  
83.9 queries/sec
Query 36: actual 164 (0.024%)  origin-forest_43.843 206 (err=1.256)  
86.5 queries/sec
Query 37: actual 15 (0.002%)  origin-forest_43.843 5 (err=3.000)  
66.7 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
58.8 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
64.5 queries/sec
Query 41: actual 302 (0.043%)  origin-forest_43.843 32 (err=9.438)  
55.6 queries/sec
Query 42: actual 2366 (0.339%)  origin-forest_43.843 970 (err=2.439)  
76.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 44: actual 81 (0.012%)  origin-forest_43.843 115 (err=1.420)  
71.4 queries/sec
Query 45: actual 5851 (0.839%)  origin-forest_43.843 9023 (err=1.542)  
76.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
61.2 queries/sec
Query 48: actual 140 (0.020%)  origin-forest_43.843 159 (err=1.136)  
71.4 queries/sec
Query 49: actual 412 (0.059%)  origin-forest_43.843 395 (err=1.043)  
origin-forest_43.843 	max: 83.0000	99th: 46.9544	95th: 3.3700	median: 1.0215	mean: 3.0965
ReportEsts: [1.0, 1.136301910626875, 3.4, 3.3333333333333335, 1.0, 1.277205553067622, 1.0, 1.2803030303030303, 1.0, 1.1236141520353662, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0662110209312259, 1.379803698347743, 1.0, 1.0, 1.0, 1.0, 1.0, 1.3565891472868217, 1.0675675675675675, 1.1, 83.0, 1.0, 1.509090909090909, 1.0, 2.0, 1.2387999071494893, 1.0, 1.2817688252419546, 1.2560975609756098, 3.0, 1.0, 1.0, 1.0, 9.4375, 2.439175257731959, 1.0, 1.4197530864197532, 1.5421295505041872, 1.0, 1.0, 1.1357142857142857, 1.0430379746835443]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 34/50 | Workload-time: 4.215195 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 35/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=single', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
SingleSample - START
SingleSample - END
load_npy_dataset_from_path - df.shape = (731012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 5.9572
detection mean = 42.8133
detection threshold = 0.8692
test statistic = 36.8561
Offline time = 2.8574025630950928
Online time = 0.5022749900817871
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 35-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (731012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 731012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 33.1345 bits (loss 49.086, data 15.951) 0.00100 lr
epoch 9 train loss 33.3671 nats / 48.1386 bits
time since start: 4.0 secs
Epoch 10 Iter 0, train entropy gap 31.9104 bits (loss 47.862, data 15.951) 0.00082 lr
epoch 19 train loss 33.2573 nats / 47.9802 bits
time since start: 7.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 5.7394 nats / 8.2802 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 35/50 | Workload-time: 6.556091 | Model-update-time: 10.583339


WORKLOAD-START | Type: QueryWorkload | Progress: 36/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 20
RandomSeedCommunicator.get: 20
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.0 queries/sec
Query 1: actual 29 (0.004%)  origin-forest_43.843 40 (err=1.379)  
71.4 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 3: actual 58 (0.008%)  origin-forest_43.843 2 (err=29.000)  
89.2 queries/sec
Query 4: actual 348 (0.050%)  origin-forest_43.843 31 (err=11.226)  
71.4 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
70.0 queries/sec
Query 6: actual 2205 (0.316%)  origin-forest_43.843 2279 (err=1.034)  
83.4 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 8: actual 61 (0.009%)  origin-forest_43.843 1 (err=61.000)  
76.9 queries/sec
Query 9: actual 66 (0.009%)  origin-forest_43.843 7 (err=9.429)  
73.3 queries/sec
Query 10: actual 19 (0.003%)  origin-forest_43.843 5 (err=3.800)  
82.6 queries/sec
Query 11: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
76.9 queries/sec
Query 12: actual 36 (0.005%)  origin-forest_43.843 1 (err=36.000)  
76.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 14: actual 50 (0.007%)  origin-forest_43.843 55 (err=1.100)  
73.4 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 16: actual 47 (0.007%)  origin-forest_43.843 1 (err=47.000)  
76.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 18: actual 5 (0.001%)  origin-forest_43.843 6 (err=1.200)  
84.4 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 21: actual 86580 (12.418%)  origin-forest_43.843 40055 (err=2.162)  
90.9 queries/sec
Query 22: actual 14 (0.002%)  origin-forest_43.843 28 (err=2.000)  
76.9 queries/sec
Query 23: actual 34 (0.005%)  origin-forest_43.843 27 (err=1.259)  
100.0 queries/sec
Query 24: actual 633 (0.091%)  origin-forest_43.843 864 (err=1.365)  
71.4 queries/sec
Query 25: actual 327 (0.047%)  origin-forest_43.843 130 (err=2.515)  
90.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
95.2 queries/sec
Query 27: actual 127960 (18.353%)  origin-forest_43.843 156769 (err=1.225)  
90.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.5 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 30: actual 148340 (21.276%)  origin-forest_43.843 187605 (err=1.265)  
90.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 32: actual 10 (0.001%)  origin-forest_43.843 4 (err=2.500)  
83.3 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 34: actual 102 (0.015%)  origin-forest_43.843 103 (err=1.010)  
90.9 queries/sec
Query 35: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
86.9 queries/sec
Query 36: actual 66410 (9.525%)  origin-forest_43.843 78556 (err=1.183)  
90.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
81.0 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.2 queries/sec
Query 39: actual 77146 (11.065%)  origin-forest_43.843 88909 (err=1.152)  
76.9 queries/sec
Query 40: actual 1115 (0.160%)  origin-forest_43.843 1425 (err=1.278)  
83.3 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 43: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 44: actual 3 (0.000%)  origin-forest_43.843 8 (err=2.667)  
80.0 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 2363 (0.339%)  origin-forest_43.843 1715 (err=1.378)  
90.9 queries/sec
Query 48: actual 279 (0.040%)  origin-forest_43.843 340 (err=1.219)  
83.3 queries/sec
Query 49: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
origin-forest_43.843 	max: 61.0000	99th: 54.1400	95th: 32.8500	median: 1.1914	mean: 5.2169
ReportEsts: [1.0, 1.3793103448275863, 1.0, 29.0, 11.225806451612904, 1.0, 1.0335600907029479, 1.0, 61.0, 9.428571428571429, 3.8, 1.5, 36.0, 1.0, 1.1, 1.0, 47.0, 1.0, 1.2, 1.0, 1.0, 2.1615278991386844, 2.0, 1.2592592592592593, 1.3649289099526067, 2.5153846153846153, 1.0, 1.2251406689590496, 1.0, 1.0, 1.264695968720507, 1.0, 2.5, 1.0, 1.0098039215686274, 2.0, 1.1828941424484265, 1.0, 1.0, 1.1524771213024654, 1.2780269058295963, 1.0, 3.0, 8.0, 2.6666666666666665, 1.0, 1.0, 1.3778425655976676, 1.2186379928315412, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 36/50 | Workload-time: 4.107641 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 37/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 21
RandomSeedCommunicator.get: 21
Query 0: actual 2425 (0.348%)  origin-forest_43.843 2426 (err=1.000)  
42.2 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.9 queries/sec
Query 2: actual 11 (0.002%)  origin-forest_43.843 1 (err=11.000)  
76.9 queries/sec
Query 3: actual 10 (0.001%)  origin-forest_43.843 15 (err=1.500)  
90.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
89.2 queries/sec
Query 5: actual 273 (0.039%)  origin-forest_43.843 177 (err=1.542)  
86.9 queries/sec
Query 6: actual 84 (0.012%)  origin-forest_43.843 13 (err=6.462)  
76.9 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 8: actual 308779 (44.288%)  origin-forest_43.843 319816 (err=1.036)  
90.9 queries/sec
Query 9: actual 9405 (1.349%)  origin-forest_43.843 11064 (err=1.176)  
84.2 queries/sec
Query 10: actual 251 (0.036%)  origin-forest_43.843 184 (err=1.364)  
90.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 12: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
83.3 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
73.3 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
78.8 queries/sec
Query 16: actual 30 (0.004%)  origin-forest_43.843 55 (err=1.833)  
79.4 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 18: actual 44 (0.006%)  origin-forest_43.843 41 (err=1.073)  
83.4 queries/sec
Query 19: actual 3 (0.000%)  origin-forest_43.843 10 (err=3.333)  
80.2 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 21: actual 3 (0.000%)  origin-forest_43.843 5 (err=1.667)  
83.3 queries/sec
Query 22: actual 12 (0.002%)  origin-forest_43.843 23 (err=1.917)  
78.4 queries/sec
Query 23: actual 110 (0.016%)  origin-forest_43.843 174 (err=1.582)  
90.9 queries/sec
Query 24: actual 36 (0.005%)  origin-forest_43.843 23 (err=1.565)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 26: actual 2140 (0.307%)  origin-forest_43.843 1620 (err=1.321)  
90.9 queries/sec
Query 27: actual 61 (0.009%)  origin-forest_43.843 17 (err=3.588)  
82.0 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 30: actual 140 (0.020%)  origin-forest_43.843 105 (err=1.333)  
76.9 queries/sec
Query 31: actual 307 (0.044%)  origin-forest_43.843 1 (err=307.000)  
78.2 queries/sec
Query 32: actual 46 (0.007%)  origin-forest_43.843 1 (err=46.000)  
76.9 queries/sec
Query 33: actual 6688 (0.959%)  origin-forest_43.843 9723 (err=1.454)  
83.6 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.7 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 36: actual 2727 (0.391%)  origin-forest_43.843 27 (err=101.000)  
91.3 queries/sec
Query 37: actual 75 (0.011%)  origin-forest_43.843 109 (err=1.453)  
83.3 queries/sec
Query 38: actual 4 (0.001%)  origin-forest_43.843 6 (err=1.500)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 58 (0.008%)  origin-forest_43.843 1 (err=58.000)  
79.1 queries/sec
Query 41: actual 32 (0.005%)  origin-forest_43.843 61 (err=1.906)  
79.9 queries/sec
Query 42: actual 952 (0.137%)  origin-forest_43.843 1034 (err=1.086)  
71.4 queries/sec
Query 43: actual 77365 (11.096%)  origin-forest_43.843 119575 (err=1.546)  
76.9 queries/sec
Query 44: actual 42731 (6.129%)  origin-forest_43.843 48509 (err=1.135)  
83.4 queries/sec
Query 45: actual 58017 (8.321%)  origin-forest_43.843 13684 (err=4.240)  
83.9 queries/sec
Query 46: actual 8 (0.001%)  origin-forest_43.843 8 (err=1.000)  
76.9 queries/sec
Query 47: actual 625 (0.090%)  origin-forest_43.843 774 (err=1.238)  
83.3 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 307.0000	99th: 206.0600	95th: 52.6000	median: 1.2442	mean: 11.8220
ReportEsts: [1.0004123711340207, 1.0, 11.0, 1.5, 1.0, 1.5423728813559323, 6.461538461538462, 1.0, 1.035744011088837, 1.1763955342902712, 1.3641304347826086, 1.0, 1.25, 1.0, 1.0, 1.0, 1.8333333333333333, 1.0, 1.0731707317073171, 3.3333333333333335, 1.0, 1.6666666666666667, 1.9166666666666667, 1.5818181818181818, 1.565217391304348, 1.0, 1.3209876543209877, 3.588235294117647, 1.0, 1.0, 1.3333333333333333, 307.0, 46.0, 1.4537978468899522, 1.0, 1.0, 101.0, 1.4533333333333334, 1.5, 1.0, 58.0, 1.90625, 1.0861344537815125, 1.5455955535448846, 1.1352179916220075, 4.2397690733703595, 1.0, 1.2384, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 37/50 | Workload-time: 4.143703 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 38/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=single', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
SingleSample - START
SingleSample - END
load_npy_dataset_from_path - df.shape = (741012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 5.7394
detection mean = 42.3620
detection threshold = 0.9586
test statistic = 36.6226
Offline time = 2.918637752532959
Online time = 0.509411096572876
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 38-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (741012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 741012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 31.6524 bits (loss 47.419, data 15.766) 0.00100 lr
epoch 9 train loss 33.0007 nats / 47.6100 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 32.6609 bits (loss 48.427, data 15.766) 0.00082 lr
epoch 19 train loss 32.8606 nats / 47.4078 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 5.5246 nats / 7.9704 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 38/50 | Workload-time: 6.604440 | Model-update-time: 10.418228


WORKLOAD-START | Type: QueryWorkload | Progress: 39/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 22
RandomSeedCommunicator.get: 22
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
39.2 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 2: actual 61787 (8.862%)  origin-forest_43.843 77523 (err=1.255)  
83.3 queries/sec
Query 3: actual 16 (0.002%)  origin-forest_43.843 7 (err=2.286)  
75.6 queries/sec
Query 4: actual 4000 (0.574%)  origin-forest_43.843 3278 (err=1.220)  
89.3 queries/sec
Query 5: actual 27 (0.004%)  origin-forest_43.843 27 (err=1.000)  
76.9 queries/sec
Query 6: actual 53 (0.008%)  origin-forest_43.843 77 (err=1.453)  
90.9 queries/sec
Query 7: actual 85342 (12.240%)  origin-forest_43.843 94262 (err=1.105)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 9: actual 14 (0.002%)  origin-forest_43.843 14 (err=1.000)  
90.9 queries/sec
Query 10: actual 86 (0.012%)  origin-forest_43.843 4 (err=21.500)  
90.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 14: actual 574 (0.082%)  origin-forest_43.843 605 (err=1.054)  
90.9 queries/sec
Query 15: actual 109505 (15.706%)  origin-forest_43.843 74427 (err=1.471)  
90.9 queries/sec
Query 16: actual 353 (0.051%)  origin-forest_43.843 197 (err=1.792)  
90.9 queries/sec
Query 17: actual 467 (0.067%)  origin-forest_43.843 152 (err=3.072)  
86.9 queries/sec
Query 18: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 20: actual 7 (0.001%)  origin-forest_43.843 2 (err=3.500)  
83.3 queries/sec
Query 21: actual 779 (0.112%)  origin-forest_43.843 1043 (err=1.339)  
83.3 queries/sec
Query 22: actual 18 (0.003%)  origin-forest_43.843 26 (err=1.444)  
76.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 24: actual 17 (0.002%)  origin-forest_43.843 1 (err=17.000)  
83.3 queries/sec
Query 25: actual 41 (0.006%)  origin-forest_43.843 51 (err=1.244)  
86.9 queries/sec
Query 26: actual 15 (0.002%)  origin-forest_43.843 14 (err=1.071)  
90.9 queries/sec
Query 27: actual 318 (0.046%)  origin-forest_43.843 846 (err=2.660)  
90.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 4 (0.001%)  origin-forest_43.843 4 (err=1.000)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 31: actual 24 (0.003%)  origin-forest_43.843 13 (err=1.846)  
90.9 queries/sec
Query 32: actual 12 (0.002%)  origin-forest_43.843 10 (err=1.200)  
83.3 queries/sec
Query 33: actual 30 (0.004%)  origin-forest_43.843 7 (err=4.286)  
90.9 queries/sec
Query 34: actual 245 (0.035%)  origin-forest_43.843 495 (err=2.020)  
86.9 queries/sec
Query 35: actual 35 (0.005%)  origin-forest_43.843 1 (err=35.000)  
90.9 queries/sec
Query 36: actual 2 (0.000%)  origin-forest_43.843 4 (err=2.000)  
76.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 38: actual 1261 (0.181%)  origin-forest_43.843 1 (err=1261.000)  
90.9 queries/sec
Query 39: actual 12 (0.002%)  origin-forest_43.843 5 (err=2.400)  
83.3 queries/sec
Query 40: actual 6 (0.001%)  origin-forest_43.843 14 (err=2.333)  
83.3 queries/sec
Query 41: actual 6 (0.001%)  origin-forest_43.843 1 (err=6.000)  
83.3 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 19057 (2.733%)  origin-forest_43.843 24394 (err=1.280)  
83.3 queries/sec
Query 45: actual 126 (0.018%)  origin-forest_43.843 49 (err=2.571)  
76.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 47: actual 320 (0.046%)  origin-forest_43.843 1 (err=320.000)  
90.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 1261.0000	99th: 799.9100	95th: 28.9250	median: 1.2493	mean: 34.5681
ReportEsts: [1.0, 1.0, 1.2546814054736433, 2.2857142857142856, 1.2202562538133008, 1.0, 1.4528301886792452, 1.104520634623046, 1.0, 1.0, 21.5, 1.0, 1.0, 1.0, 1.0540069686411149, 1.471307455627662, 1.7918781725888324, 3.0723684210526314, 3.0, 1.0, 3.5, 1.3388960205391527, 1.4444444444444444, 1.0, 17.0, 1.2439024390243902, 1.0714285714285714, 2.660377358490566, 1.0, 1.0, 1.0, 1.8461538461538463, 1.2, 4.285714285714286, 2.020408163265306, 35.0, 2.0, 1.0, 1261.0, 2.4, 2.3333333333333335, 6.0, 1.0, 1.0, 1.280054573122737, 2.5714285714285716, 1.0, 320.0, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 39/50 | Workload-time: 4.063944 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 40/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=single', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
SingleSample - START
SingleSample - END
load_npy_dataset_from_path - df.shape = (751012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 5.5246
detection mean = 41.9309
detection threshold = 1.0173
test statistic = 36.4063
Offline time = 2.8843014240264893
Online time = 0.5312948226928711
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 40-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (751012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 751012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 31.4727 bits (loss 47.058, data 15.585) 0.00100 lr
epoch 9 train loss 32.4879 nats / 46.8702 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 30.9191 bits (loss 46.505, data 15.585) 0.00082 lr
epoch 19 train loss 32.3376 nats / 46.6533 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 5.3080 nats / 7.6579 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 40/50 | Workload-time: 6.618310 | Model-update-time: 10.308546


WORKLOAD-START | Type: QueryWorkload | Progress: 41/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 23
RandomSeedCommunicator.get: 23
Query 0: actual 1661 (0.238%)  origin-forest_43.843 1 (err=1661.000)  
41.7 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 2: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 4: actual 73 (0.010%)  origin-forest_43.843 108 (err=1.479)  
90.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 6: actual 11625 (1.667%)  origin-forest_43.843 5869 (err=1.981)  
90.9 queries/sec
Query 7: actual 1663 (0.239%)  origin-forest_43.843 1545 (err=1.076)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 36 (0.005%)  origin-forest_43.843 42 (err=1.167)  
95.1 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 11: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
90.9 queries/sec
Query 12: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 13: actual 221 (0.032%)  origin-forest_43.843 201 (err=1.100)  
76.9 queries/sec
Query 14: actual 2 (0.000%)  origin-forest_43.843 4 (err=2.000)  
83.3 queries/sec
Query 15: actual 767 (0.110%)  origin-forest_43.843 1393 (err=1.816)  
90.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 338274 (48.518%)  origin-forest_43.843 341983 (err=1.011)  
82.6 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 110 (0.016%)  origin-forest_43.843 1 (err=110.000)  
76.9 queries/sec
Query 20: actual 182 (0.026%)  origin-forest_43.843 1 (err=182.000)  
76.9 queries/sec
Query 21: actual 131 (0.019%)  origin-forest_43.843 1 (err=131.000)  
76.9 queries/sec
Query 22: actual 198 (0.028%)  origin-forest_43.843 87 (err=2.276)  
76.9 queries/sec
Query 23: actual 717 (0.103%)  origin-forest_43.843 1 (err=717.000)  
83.3 queries/sec
Query 24: actual 282 (0.040%)  origin-forest_43.843 437 (err=1.550)  
83.3 queries/sec
Query 25: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
79.9 queries/sec
Query 26: actual 22 (0.003%)  origin-forest_43.843 82 (err=3.727)  
71.4 queries/sec
Query 27: actual 328 (0.047%)  origin-forest_43.843 787 (err=2.399)  
83.3 queries/sec
Query 28: actual 65 (0.009%)  origin-forest_43.843 140 (err=2.154)  
76.9 queries/sec
Query 29: actual 76297 (10.943%)  origin-forest_43.843 62521 (err=1.220)  
90.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 32: actual 115955 (16.631%)  origin-forest_43.843 123425 (err=1.064)  
90.9 queries/sec
Query 33: actual 104726 (15.021%)  origin-forest_43.843 91567 (err=1.144)  
90.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 35: actual 126 (0.018%)  origin-forest_43.843 128 (err=1.016)  
90.9 queries/sec
Query 36: actual 251 (0.036%)  origin-forest_43.843 157 (err=1.599)  
83.3 queries/sec
Query 37: actual 290 (0.042%)  origin-forest_43.843 447 (err=1.541)  
76.9 queries/sec
Query 38: actual 8 (0.001%)  origin-forest_43.843 6 (err=1.333)  
90.9 queries/sec
Query 39: actual 104 (0.015%)  origin-forest_43.843 110 (err=1.058)  
90.9 queries/sec
Query 40: actual 1508 (0.216%)  origin-forest_43.843 1152 (err=1.309)  
83.3 queries/sec
Query 41: actual 9 (0.001%)  origin-forest_43.843 33 (err=3.667)  
83.3 queries/sec
Query 42: actual 98 (0.014%)  origin-forest_43.843 26 (err=3.769)  
86.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 44: actual 54058 (7.753%)  origin-forest_43.843 33206 (err=1.628)  
100.0 queries/sec
Query 45: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 46: actual 105633 (15.151%)  origin-forest_43.843 131927 (err=1.249)  
95.8 queries/sec
Query 47: actual 51 (0.007%)  origin-forest_43.843 7 (err=7.286)  
76.8 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 49: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
origin-forest_43.843 	max: 1661.0000	99th: 1198.4400	95th: 159.0500	median: 1.4064	mean: 57.5724
ReportEsts: [1661.0, 1.0, 3.0, 1.0, 1.4794520547945205, 1.0, 1.9807462940875789, 1.0763754045307443, 1.0, 1.1666666666666667, 1.0, 3.0, 2.0, 1.099502487562189, 2.0, 1.8161668839634941, 1.0, 1.0109644844120447, 1.0, 110.0, 182.0, 131.0, 2.2758620689655173, 717.0, 1.549645390070922, 1.0, 3.727272727272727, 2.399390243902439, 2.1538461538461537, 1.2203419650997265, 1.0, 1.0, 1.0644215428398949, 1.1437089781253071, 1.0, 1.0158730158730158, 1.5987261146496816, 1.5413793103448277, 1.3333333333333333, 1.0576923076923077, 1.3090277777777777, 3.6666666666666665, 3.769230769230769, 1.0, 1.6279588026260314, 2.0, 1.2489184251133643, 7.285714285714286, 1.0, 2.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 41/50 | Workload-time: 4.079017 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 42/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 24
RandomSeedCommunicator.get: 24
Query 0: actual 5 (0.001%)  origin-forest_43.843 1 (err=5.000)  
41.7 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 56 (0.008%)  origin-forest_43.843 1 (err=56.000)  
83.3 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 4: actual 1683 (0.241%)  origin-forest_43.843 1482 (err=1.136)  
86.9 queries/sec
Query 5: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
83.3 queries/sec
Query 6: actual 41934 (6.015%)  origin-forest_43.843 56116 (err=1.338)  
90.9 queries/sec
Query 7: actual 92 (0.013%)  origin-forest_43.843 4 (err=23.000)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 11: actual 36 (0.005%)  origin-forest_43.843 4 (err=9.000)  
90.9 queries/sec
Query 12: actual 528 (0.076%)  origin-forest_43.843 752 (err=1.424)  
90.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 14: actual 562 (0.081%)  origin-forest_43.843 115 (err=4.887)  
90.9 queries/sec
Query 15: actual 14528 (2.084%)  origin-forest_43.843 16056 (err=1.105)  
90.9 queries/sec
Query 16: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
76.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 3601 (0.516%)  origin-forest_43.843 4036 (err=1.121)  
83.3 queries/sec
Query 20: actual 18 (0.003%)  origin-forest_43.843 1 (err=18.000)  
83.3 queries/sec
Query 21: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
77.8 queries/sec
Query 22: actual 16 (0.002%)  origin-forest_43.843 1 (err=16.000)  
84.8 queries/sec
Query 23: actual 389 (0.056%)  origin-forest_43.843 404 (err=1.039)  
90.9 queries/sec
Query 24: actual 882 (0.127%)  origin-forest_43.843 1104 (err=1.252)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 263 (0.038%)  origin-forest_43.843 355 (err=1.350)  
90.9 queries/sec
Query 28: actual 92437 (13.258%)  origin-forest_43.843 97896 (err=1.059)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
100.0 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 31: actual 38 (0.005%)  origin-forest_43.843 22 (err=1.727)  
90.9 queries/sec
Query 32: actual 407 (0.058%)  origin-forest_43.843 450 (err=1.106)  
83.3 queries/sec
Query 33: actual 44 (0.006%)  origin-forest_43.843 56 (err=1.273)  
83.3 queries/sec
Query 34: actual 998 (0.143%)  origin-forest_43.843 1288 (err=1.291)  
100.0 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
90.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 7075 (1.015%)  origin-forest_43.843 2028 (err=3.489)  
90.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 968 (0.139%)  origin-forest_43.843 1329 (err=1.373)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 25 (0.004%)  origin-forest_43.843 1 (err=25.000)  
83.3 queries/sec
Query 45: actual 59970 (8.601%)  origin-forest_43.843 65624 (err=1.094)  
90.9 queries/sec
Query 46: actual 1577 (0.226%)  origin-forest_43.843 1975 (err=1.252)  
90.9 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
60.6 queries/sec
Query 48: actual 11 (0.002%)  origin-forest_43.843 20 (err=1.818)  
90.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 56.0000	99th: 40.8100	95th: 20.7500	median: 1.1132	mean: 4.2127
ReportEsts: [5.0, 1.0, 56.0, 1.0, 1.1356275303643724, 1.5, 1.338198120856584, 23.0, 1.0, 1.0, 1.0, 9.0, 1.4242424242424243, 1.0, 4.886956521739131, 1.1051762114537445, 3.0, 1.0, 1.0, 1.120799777839489, 18.0, 2.0, 16.0, 1.038560411311054, 1.251700680272109, 1.0, 1.0, 1.349809885931559, 1.0590564384391532, 1.0, 1.0, 1.7272727272727273, 1.1056511056511056, 1.2727272727272727, 1.2905811623246493, 1.0, 2.0, 1.0, 1.0, 1.0, 3.4886587771203157, 1.0, 1.3729338842975207, 1.0, 25.0, 1.0942804735701184, 1.2523779327837667, 1.0, 1.8181818181818181, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 42/50 | Workload-time: 4.023239 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 43/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 25
RandomSeedCommunicator.get: 25
Query 0: actual 19 (0.003%)  origin-forest_43.843 34 (err=1.789)  
40.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 2: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
83.3 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 4: actual 942 (0.135%)  origin-forest_43.843 1128 (err=1.197)  
79.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 12 (0.002%)  origin-forest_43.843 3 (err=4.000)  
83.3 queries/sec
Query 7: actual 8677 (1.245%)  origin-forest_43.843 9580 (err=1.104)  
90.9 queries/sec
Query 8: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 9: actual 65 (0.009%)  origin-forest_43.843 13 (err=5.000)  
90.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 12: actual 7 (0.001%)  origin-forest_43.843 11 (err=1.571)  
95.2 queries/sec
Query 13: actual 136 (0.020%)  origin-forest_43.843 1 (err=136.000)  
83.3 queries/sec
Query 14: actual 39 (0.006%)  origin-forest_43.843 42 (err=1.077)  
83.3 queries/sec
Query 15: actual 15629 (2.242%)  origin-forest_43.843 10584 (err=1.477)  
100.0 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 1555 (0.223%)  origin-forest_43.843 1714 (err=1.102)  
90.9 queries/sec
Query 18: actual 26 (0.004%)  origin-forest_43.843 35 (err=1.346)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 21: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
79.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 1279 (0.183%)  origin-forest_43.843 1637 (err=1.280)  
76.9 queries/sec
Query 24: actual 4171 (0.598%)  origin-forest_43.843 2768 (err=1.507)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 26: actual 5 (0.001%)  origin-forest_43.843 10 (err=2.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 84 (0.012%)  origin-forest_43.843 88 (err=1.048)  
90.9 queries/sec
Query 29: actual 52 (0.007%)  origin-forest_43.843 44 (err=1.182)  
86.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 31: actual 5 (0.001%)  origin-forest_43.843 13 (err=2.600)  
83.3 queries/sec
Query 32: actual 1196 (0.172%)  origin-forest_43.843 1431 (err=1.196)  
90.9 queries/sec
Query 33: actual 554 (0.079%)  origin-forest_43.843 893 (err=1.612)  
90.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 53 (0.008%)  origin-forest_43.843 1 (err=53.000)  
76.9 queries/sec
Query 36: actual 28 (0.004%)  origin-forest_43.843 1 (err=28.000)  
83.3 queries/sec
Query 37: actual 21 (0.003%)  origin-forest_43.843 90 (err=4.286)  
79.9 queries/sec
Query 38: actual 6831 (0.980%)  origin-forest_43.843 7738 (err=1.133)  
90.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 5121 (0.734%)  origin-forest_43.843 4809 (err=1.065)  
90.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 42: actual 8 (0.001%)  origin-forest_43.843 5 (err=1.600)  
90.9 queries/sec
Query 43: actual 454 (0.065%)  origin-forest_43.843 775 (err=1.707)  
83.3 queries/sec
Query 44: actual 33 (0.005%)  origin-forest_43.843 3 (err=11.000)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 46: actual 500 (0.072%)  origin-forest_43.843 676 (err=1.352)  
79.9 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 4 (err=2.000)  
90.9 queries/sec
Query 48: actual 3 (0.000%)  origin-forest_43.843 4 (err=1.333)  
83.3 queries/sec
Query 49: actual 19 (0.003%)  origin-forest_43.843 1 (err=19.000)  
origin-forest_43.843 	max: 136.0000	99th: 95.3300	95th: 23.9500	median: 1.2387	mean: 6.3013
ReportEsts: [1.7894736842105263, 1.0, 1.5, 1.0, 1.197452229299363, 1.0, 4.0, 1.104068226345511, 2.0, 5.0, 1.0, 1.0, 1.5714285714285714, 136.0, 1.0769230769230769, 1.476662887377173, 1.0, 1.1022508038585208, 1.3461538461538463, 1.0, 1.0, 2.0, 1.0, 1.2799061767005473, 1.506864161849711, 1.0, 2.0, 1.0, 1.0476190476190477, 1.1818181818181819, 1.0, 2.6, 1.1964882943143813, 1.611913357400722, 1.0, 53.0, 28.0, 4.285714285714286, 1.1327770458205242, 1.0, 1.06487835308796, 1.0, 1.6, 1.7070484581497798, 11.0, 1.0, 1.352, 2.0, 1.3333333333333333, 19.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 43/50 | Workload-time: 4.010153 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 44/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 26
RandomSeedCommunicator.get: 26
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
34.5 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 7: actual 18577 (2.664%)  origin-forest_43.843 22223 (err=1.196)  
90.9 queries/sec
Query 8: actual 125 (0.018%)  origin-forest_43.843 32 (err=3.906)  
83.3 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 10: actual 62643 (8.985%)  origin-forest_43.843 91511 (err=1.461)  
90.9 queries/sec
Query 11: actual 15 (0.002%)  origin-forest_43.843 7 (err=2.143)  
83.3 queries/sec
Query 12: actual 394 (0.057%)  origin-forest_43.843 299 (err=1.318)  
86.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 14: actual 12 (0.002%)  origin-forest_43.843 12 (err=1.000)  
83.3 queries/sec
Query 15: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
76.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 262 (0.038%)  origin-forest_43.843 232 (err=1.129)  
83.3 queries/sec
Query 18: actual 17 (0.002%)  origin-forest_43.843 34 (err=2.000)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 20: actual 7950 (1.140%)  origin-forest_43.843 10794 (err=1.358)  
86.9 queries/sec
Query 21: actual 130 (0.019%)  origin-forest_43.843 145 (err=1.115)  
90.9 queries/sec
Query 22: actual 15 (0.002%)  origin-forest_43.843 1 (err=15.000)  
83.3 queries/sec
Query 23: actual 6136 (0.880%)  origin-forest_43.843 3759 (err=1.632)  
90.9 queries/sec
Query 24: actual 60 (0.009%)  origin-forest_43.843 0 (err=60.000)  
83.3 queries/sec
Query 25: actual 13 (0.002%)  origin-forest_43.843 32 (err=2.462)  
83.3 queries/sec
Query 26: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 27: actual 5 (0.001%)  origin-forest_43.843 15 (err=3.000)  
90.9 queries/sec
Query 28: actual 13 (0.002%)  origin-forest_43.843 8 (err=1.625)  
83.3 queries/sec
Query 29: actual 160120 (22.966%)  origin-forest_43.843 153813 (err=1.041)  
74.0 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 32: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
83.3 queries/sec
Query 33: actual 112 (0.016%)  origin-forest_43.843 189 (err=1.688)  
90.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 27 (0.004%)  origin-forest_43.843 19 (err=1.421)  
83.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 38: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 39: actual 1510 (0.217%)  origin-forest_43.843 1015 (err=1.488)  
90.9 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 43: actual 140 (0.020%)  origin-forest_43.843 1 (err=140.000)  
90.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.6 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 46: actual 20713 (2.971%)  origin-forest_43.843 24472 (err=1.181)  
90.9 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 48: actual 18 (0.003%)  origin-forest_43.843 1 (err=18.000)  
76.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 140.0000	99th: 100.8000	95th: 16.6500	median: 1.0782	mean: 5.9533
ReportEsts: [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1962641976637778, 3.90625, 1.0, 1.4608336126941557, 2.142857142857143, 1.3177257525083612, 1.0, 1.0, 4.0, 1.0, 1.1293103448275863, 2.0, 1.0, 1.3577358490566038, 1.1153846153846154, 15.0, 1.6323490289970737, 60, 2.4615384615384617, 2.0, 3.0, 1.625, 1.0410043364345016, 1.0, 1.0, 1.5, 1.6875, 1.0, 1.4210526315789473, 1.0, 1.0, 2.0, 1.4876847290640394, 1.0, 1.0, 1.0, 140.0, 1.0, 1.0, 1.1814802298073674, 1.0, 18.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 44/50 | Workload-time: 4.013304 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 45/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 27
RandomSeedCommunicator.get: 27
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
41.7 queries/sec
Query 1: actual 35 (0.005%)  origin-forest_43.843 11 (err=3.182)  
83.3 queries/sec
Query 2: actual 7770 (1.114%)  origin-forest_43.843 10057 (err=1.294)  
83.3 queries/sec
Query 3: actual 3484 (0.500%)  origin-forest_43.843 4852 (err=1.393)  
90.9 queries/sec
Query 4: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
86.9 queries/sec
Query 5: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 8: actual 589 (0.084%)  origin-forest_43.843 729 (err=1.238)  
100.0 queries/sec
Query 9: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
76.7 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.6 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 87 (0.012%)  origin-forest_43.843 1 (err=87.000)  
86.9 queries/sec
Query 13: actual 19485 (2.795%)  origin-forest_43.843 23529 (err=1.208)  
90.9 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 16: actual 332 (0.048%)  origin-forest_43.843 402 (err=1.211)  
90.9 queries/sec
Query 17: actual 253 (0.036%)  origin-forest_43.843 1 (err=253.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 20: actual 232 (0.033%)  origin-forest_43.843 82 (err=2.829)  
90.9 queries/sec
Query 21: actual 2 (0.000%)  origin-forest_43.843 5 (err=2.500)  
82.7 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
83.3 queries/sec
Query 24: actual 23 (0.003%)  origin-forest_43.843 6 (err=3.833)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 26: actual 1555 (0.223%)  origin-forest_43.843 1278 (err=1.217)  
90.9 queries/sec
Query 27: actual 133 (0.019%)  origin-forest_43.843 1 (err=133.000)  
90.9 queries/sec
Query 28: actual 14 (0.002%)  origin-forest_43.843 32 (err=2.286)  
90.9 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
58.7 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
58.0 queries/sec
Query 31: actual 3 (0.000%)  origin-forest_43.843 5 (err=1.667)  
62.5 queries/sec
Query 32: actual 5 (0.001%)  origin-forest_43.843 7 (err=1.400)  
90.9 queries/sec
Query 33: actual 241 (0.035%)  origin-forest_43.843 229 (err=1.052)  
90.9 queries/sec
Query 34: actual 177 (0.025%)  origin-forest_43.843 212 (err=1.198)  
83.3 queries/sec
Query 35: actual 100 (0.014%)  origin-forest_43.843 1 (err=100.000)  
76.9 queries/sec
Query 36: actual 32 (0.005%)  origin-forest_43.843 31 (err=1.032)  
80.0 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 38: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 39: actual 6 (0.001%)  origin-forest_43.843 1 (err=6.000)  
83.3 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 41: actual 431521 (61.892%)  origin-forest_43.843 412935 (err=1.045)  
90.9 queries/sec
Query 42: actual 187 (0.027%)  origin-forest_43.843 420 (err=2.246)  
76.9 queries/sec
Query 43: actual 255 (0.037%)  origin-forest_43.843 9 (err=28.333)  
90.9 queries/sec
Query 44: actual 45 (0.006%)  origin-forest_43.843 20 (err=2.250)  
76.9 queries/sec
Query 45: actual 39 (0.006%)  origin-forest_43.843 1 (err=39.000)  
79.9 queries/sec
Query 46: actual 242 (0.035%)  origin-forest_43.843 364 (err=1.504)  
90.9 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 48: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
83.3 queries/sec
Query 49: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
origin-forest_43.843 	max: 253.0000	99th: 194.2000	95th: 94.1500	median: 1.2660	mean: 15.4283
ReportEsts: [1.0, 3.1818181818181817, 1.2943371943371944, 1.3926521239954075, 3.0, 2.0, 1.0, 1.0, 1.237691001697793, 1.5, 1.0, 1.0, 87.0, 1.2075442648190917, 1.0, 1.0, 1.2108433734939759, 253.0, 1.0, 1.0, 2.8292682926829267, 2.5, 1.0, 1.0, 3.8333333333333335, 1.0, 1.2167449139280124, 133.0, 2.2857142857142856, 1.0, 1.0, 1.6666666666666667, 1.4, 1.0524017467248907, 1.1977401129943503, 100.0, 1.032258064516129, 1.0, 2.0, 6.0, 1.0, 1.0450095051279258, 2.2459893048128343, 28.333333333333332, 2.25, 39.0, 1.5041322314049588, 1.0, 62.0, 2.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 45/50 | Workload-time: 3.991625 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 46/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=single', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
SingleSample - START
SingleSample - END
load_npy_dataset_from_path - df.shape = (761012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 5.3080
detection mean = 41.5193
detection threshold = 1.0779
test statistic = 36.2113
Offline time = 2.8591701984405518
Online time = 0.5296816825866699
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 46-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (761012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 761012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 31.8362 bits (loss 47.244, data 15.408) 0.00100 lr
epoch 9 train loss 32.2639 nats / 46.5469 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 31.2975 bits (loss 46.706, data 15.408) 0.00082 lr
epoch 19 train loss 32.1788 nats / 46.4242 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 5.0898 nats / 7.3431 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 46/50 | Workload-time: 6.480907 | Model-update-time: 10.182752


WORKLOAD-START | Type: QueryWorkload | Progress: 47/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 28
RandomSeedCommunicator.get: 28
Query 0: actual 2 (0.000%)  origin-forest_43.843 6 (err=3.000)  
38.5 queries/sec
Query 1: actual 31 (0.004%)  origin-forest_43.843 1 (err=31.000)  
74.1 queries/sec
Query 2: actual 45 (0.006%)  origin-forest_43.843 26 (err=1.731)  
76.9 queries/sec
Query 3: actual 314 (0.045%)  origin-forest_43.843 368 (err=1.172)  
86.9 queries/sec
Query 4: actual 14 (0.002%)  origin-forest_43.843 30 (err=2.143)  
90.9 queries/sec
Query 5: actual 18 (0.003%)  origin-forest_43.843 19 (err=1.056)  
76.9 queries/sec
Query 6: actual 63 (0.009%)  origin-forest_43.843 3 (err=21.000)  
83.3 queries/sec
Query 7: actual 29709 (4.261%)  origin-forest_43.843 27744 (err=1.071)  
90.9 queries/sec
Query 8: actual 4 (0.001%)  origin-forest_43.843 4 (err=1.000)  
90.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 11: actual 77979 (11.184%)  origin-forest_43.843 76195 (err=1.023)  
83.3 queries/sec
Query 12: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
79.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 16: actual 193 (0.028%)  origin-forest_43.843 1 (err=193.000)  
83.3 queries/sec
Query 17: actual 19 (0.003%)  origin-forest_43.843 1 (err=19.000)  
83.3 queries/sec
Query 18: actual 84976 (12.188%)  origin-forest_43.843 69333 (err=1.226)  
100.0 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 20: actual 48 (0.007%)  origin-forest_43.843 1 (err=48.000)  
80.0 queries/sec
Query 21: actual 201 (0.029%)  origin-forest_43.843 110 (err=1.827)  
90.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 24: actual 312 (0.045%)  origin-forest_43.843 395 (err=1.266)  
83.3 queries/sec
Query 25: actual 148 (0.021%)  origin-forest_43.843 196 (err=1.324)  
90.9 queries/sec
Query 26: actual 828 (0.119%)  origin-forest_43.843 467 (err=1.773)  
83.3 queries/sec
Query 27: actual 5288 (0.758%)  origin-forest_43.843 4245 (err=1.246)  
90.9 queries/sec
Query 28: actual 138 (0.020%)  origin-forest_43.843 124 (err=1.113)  
90.9 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 30: actual 215 (0.031%)  origin-forest_43.843 223 (err=1.037)  
83.3 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 2257 (0.324%)  origin-forest_43.843 2835 (err=1.256)  
90.9 queries/sec
Query 34: actual 150 (0.022%)  origin-forest_43.843 194 (err=1.293)  
83.3 queries/sec
Query 35: actual 108507 (15.563%)  origin-forest_43.843 82954 (err=1.308)  
90.9 queries/sec
Query 36: actual 3897 (0.559%)  origin-forest_43.843 3700 (err=1.053)  
90.9 queries/sec
Query 37: actual 69 (0.010%)  origin-forest_43.843 90 (err=1.304)  
86.9 queries/sec
Query 38: actual 10077 (1.445%)  origin-forest_43.843 7290 (err=1.382)  
90.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 41: actual 342 (0.049%)  origin-forest_43.843 713 (err=2.085)  
82.2 queries/sec
Query 42: actual 3 (0.000%)  origin-forest_43.843 4 (err=1.333)  
86.4 queries/sec
Query 43: actual 88982 (12.763%)  origin-forest_43.843 120680 (err=1.356)  
83.3 queries/sec
Query 44: actual 208 (0.030%)  origin-forest_43.843 202 (err=1.030)  
76.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 48: actual 14 (0.002%)  origin-forest_43.843 17 (err=1.214)  
83.3 queries/sec
Query 49: actual 15 (0.002%)  origin-forest_43.843 1 (err=15.000)  
origin-forest_43.843 	max: 193.0000	99th: 121.9500	95th: 26.5000	median: 1.1931	mean: 7.6525
ReportEsts: [3.0, 31.0, 1.7307692307692308, 1.1719745222929936, 2.142857142857143, 1.0555555555555556, 21.0, 1.070826124567474, 1.0, 1.0, 1.0, 1.023413609816917, 2.0, 1.0, 1.0, 1.0, 193.0, 19.0, 1.2256212770253703, 1.0, 48.0, 1.8272727272727274, 1.0, 1.0, 1.266025641025641, 1.3243243243243243, 1.7730192719486082, 1.245700824499411, 1.1129032258064515, 1.0, 1.0372093023255815, 1.0, 1.0, 1.256092157731502, 1.2933333333333332, 1.3080381898401523, 1.0532432432432433, 1.3043478260869565, 1.382304526748971, 1.0, 1.0, 2.084795321637427, 1.3333333333333333, 1.3562293497561304, 1.0297029702970297, 1.0, 1.0, 1.0, 1.2142857142857142, 15.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 47/50 | Workload-time: 4.050374 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 48/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 29
RandomSeedCommunicator.get: 29
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
39.2 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 9 (0.001%)  origin-forest_43.843 2 (err=4.500)  
76.9 queries/sec
Query 3: actual 19 (0.003%)  origin-forest_43.843 0 (err=19.000)  
76.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 2342 (0.336%)  origin-forest_43.843 2805 (err=1.198)  
83.3 queries/sec
Query 7: actual 120321 (17.257%)  origin-forest_43.843 76145 (err=1.580)  
90.8 queries/sec
Query 8: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
86.8 queries/sec
Query 9: actual 65 (0.009%)  origin-forest_43.843 1 (err=65.000)  
90.9 queries/sec
Query 10: actual 27 (0.004%)  origin-forest_43.843 1 (err=27.000)  
76.9 queries/sec
Query 11: actual 21 (0.003%)  origin-forest_43.843 1 (err=21.000)  
71.4 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 3 (err=3.000)  
76.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 17: actual 385 (0.055%)  origin-forest_43.843 3 (err=128.333)  
90.9 queries/sec
Query 18: actual 6452 (0.925%)  origin-forest_43.843 3372 (err=1.913)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 20: actual 284 (0.041%)  origin-forest_43.843 347 (err=1.222)  
90.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 22: actual 349 (0.050%)  origin-forest_43.843 427 (err=1.223)  
83.3 queries/sec
Query 23: actual 2560 (0.367%)  origin-forest_43.843 33 (err=77.576)  
90.9 queries/sec
Query 24: actual 32 (0.005%)  origin-forest_43.843 1 (err=32.000)  
76.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 26: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 195 (0.028%)  origin-forest_43.843 218 (err=1.118)  
83.4 queries/sec
Query 30: actual 267 (0.038%)  origin-forest_43.843 93 (err=2.871)  
100.0 queries/sec
Query 31: actual 208 (0.030%)  origin-forest_43.843 165 (err=1.261)  
83.3 queries/sec
Query 32: actual 124 (0.018%)  origin-forest_43.843 116 (err=1.069)  
76.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 36: actual 6 (0.001%)  origin-forest_43.843 8 (err=1.333)  
83.3 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 579 (0.083%)  origin-forest_43.843 748 (err=1.292)  
83.3 queries/sec
Query 40: actual 3 (0.000%)  origin-forest_43.843 3 (err=1.000)  
83.3 queries/sec
Query 41: actual 5 (0.001%)  origin-forest_43.843 8 (err=1.600)  
86.8 queries/sec
Query 42: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
76.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 3 (err=3.000)  
76.9 queries/sec
Query 45: actual 35 (0.005%)  origin-forest_43.843 21 (err=1.667)  
90.9 queries/sec
Query 46: actual 151 (0.022%)  origin-forest_43.843 258 (err=1.709)  
90.9 queries/sec
Query 47: actual 31053 (4.454%)  origin-forest_43.843 33123 (err=1.067)  
90.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 49: actual 119407 (17.126%)  origin-forest_43.843 154081 (err=1.290)  
origin-forest_43.843 	max: 128.3333	99th: 103.4621	95th: 50.1500	median: 1.2098	mean: 8.6264
ReportEsts: [1.0, 1.0, 4.5, 19, 1.0, 1.0, 1.1976942783945346, 1.5801562807800906, 1.5, 65.0, 27.0, 21.0, 3.0, 1.0, 1.0, 1.0, 1.0, 128.33333333333334, 1.9134045077105575, 1.0, 1.221830985915493, 1.0, 1.2234957020057307, 77.57575757575758, 32.0, 1.0, 2.0, 1.0, 1.0, 1.117948717948718, 2.870967741935484, 1.2606060606060605, 1.0689655172413792, 1.0, 1.0, 1.0, 1.3333333333333333, 1.0, 1.0, 1.2918825561312608, 1.0, 1.6, 3.0, 1.0, 3.0, 1.6666666666666667, 1.7086092715231789, 1.0666602260651146, 1.0, 1.2903849858048524]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 48/50 | Workload-time: 4.053166 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 49/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 30
RandomSeedCommunicator.get: 30
Query 0: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
40.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 3: actual 1491 (0.214%)  origin-forest_43.843 152 (err=9.809)  
83.3 queries/sec
Query 4: actual 7002 (1.004%)  origin-forest_43.843 10034 (err=1.433)  
86.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
71.4 queries/sec
Query 7: actual 66 (0.009%)  origin-forest_43.843 1 (err=66.000)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 9: actual 8448 (1.212%)  origin-forest_43.843 9859 (err=1.167)  
90.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.8 queries/sec
Query 11: actual 67 (0.010%)  origin-forest_43.843 49 (err=1.367)  
85.1 queries/sec
Query 12: actual 124 (0.018%)  origin-forest_43.843 1 (err=124.000)  
90.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 15: actual 95 (0.014%)  origin-forest_43.843 108 (err=1.137)  
90.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 225 (0.032%)  origin-forest_43.843 351 (err=1.560)  
76.9 queries/sec
Query 18: actual 21 (0.003%)  origin-forest_43.843 7 (err=3.000)  
83.3 queries/sec
Query 19: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 20: actual 21 (0.003%)  origin-forest_43.843 63 (err=3.000)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.2 queries/sec
Query 22: actual 55 (0.008%)  origin-forest_43.843 78 (err=1.418)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 24: actual 18 (0.003%)  origin-forest_43.843 1 (err=18.000)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 26: actual 1605 (0.230%)  origin-forest_43.843 735 (err=2.184)  
90.9 queries/sec
Query 27: actual 17 (0.002%)  origin-forest_43.843 15 (err=1.133)  
83.3 queries/sec
Query 28: actual 179 (0.026%)  origin-forest_43.843 65 (err=2.754)  
90.9 queries/sec
Query 29: actual 876 (0.126%)  origin-forest_43.843 1129 (err=1.289)  
95.2 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 31: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
90.9 queries/sec
Query 32: actual 49685 (7.126%)  origin-forest_43.843 29885 (err=1.663)  
83.3 queries/sec
Query 33: actual 875 (0.125%)  origin-forest_43.843 820 (err=1.067)  
91.0 queries/sec
Query 34: actual 91 (0.013%)  origin-forest_43.843 110 (err=1.209)  
83.3 queries/sec
Query 35: actual 1867 (0.268%)  origin-forest_43.843 2022 (err=1.083)  
83.3 queries/sec
Query 36: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
83.3 queries/sec
Query 37: actual 1483 (0.213%)  origin-forest_43.843 2026 (err=1.366)  
90.9 queries/sec
Query 38: actual 145 (0.021%)  origin-forest_43.843 126 (err=1.151)  
86.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 284 (0.041%)  origin-forest_43.843 196 (err=1.449)  
90.9 queries/sec
Query 45: actual 14265 (2.046%)  origin-forest_43.843 6868 (err=2.077)  
90.9 queries/sec
Query 46: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
76.6 queries/sec
Query 47: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 48: actual 9 (0.001%)  origin-forest_43.843 1 (err=9.000)  
76.9 queries/sec
Query 49: actual 27 (0.004%)  origin-forest_43.843 1 (err=27.000)  
origin-forest_43.843 	max: 124.0000	99th: 95.5800	95th: 23.8500	median: 1.2488	mean: 6.6663
ReportEsts: [1.0, 1.0, 1.0, 9.80921052631579, 1.4330191373893173, 1.0, 1.5, 66.0, 1.0, 1.1670217803030303, 1.0, 1.3673469387755102, 124.0, 1.0, 1.0, 1.1368421052631579, 1.0, 1.56, 3.0, 2.0, 3.0, 1.0, 1.4181818181818182, 2.0, 18.0, 1.0, 2.183673469387755, 1.1333333333333333, 2.753846153846154, 1.288812785388128, 1.0, 1.5, 1.6625397356533378, 1.0670731707317074, 1.2087912087912087, 1.0830208891269417, 20.0, 1.366149696561025, 1.1507936507936507, 1.0, 1.0, 1.0, 1.0, 1.0, 1.4489795918367347, 2.077023878858474, 1.0, 2.0, 9.0, 27.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 49/50 | Workload-time: 4.033290 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 50/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 31
RandomSeedCommunicator.get: 31
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
41.7 queries/sec
Query 1: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
77.8 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
78.5 queries/sec
Query 3: actual 128 (0.018%)  origin-forest_43.843 96 (err=1.333)  
86.9 queries/sec
Query 4: actual 6 (0.001%)  origin-forest_43.843 3 (err=2.000)  
90.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 8: actual 68 (0.010%)  origin-forest_43.843 2 (err=34.000)  
83.3 queries/sec
Query 9: actual 9 (0.001%)  origin-forest_43.843 1 (err=9.000)  
71.4 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 13: actual 438 (0.063%)  origin-forest_43.843 516 (err=1.178)  
90.9 queries/sec
Query 14: actual 1332 (0.191%)  origin-forest_43.843 1297 (err=1.027)  
90.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 16: actual 55 (0.008%)  origin-forest_43.843 18 (err=3.056)  
75.6 queries/sec
Query 17: actual 1838 (0.264%)  origin-forest_43.843 2266 (err=1.233)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 6 (0.001%)  origin-forest_43.843 1 (err=6.000)  
79.9 queries/sec
Query 20: actual 42 (0.006%)  origin-forest_43.843 1 (err=42.000)  
89.2 queries/sec
Query 21: actual 32944 (4.725%)  origin-forest_43.843 19896 (err=1.656)  
83.3 queries/sec
Query 22: actual 158 (0.023%)  origin-forest_43.843 107 (err=1.477)  
83.3 queries/sec
Query 23: actual 5149 (0.739%)  origin-forest_43.843 5124 (err=1.005)  
100.0 queries/sec
Query 24: actual 7 (0.001%)  origin-forest_43.843 8 (err=1.143)  
83.3 queries/sec
Query 25: actual 22033 (3.160%)  origin-forest_43.843 23593 (err=1.071)  
90.9 queries/sec
Query 26: actual 21901 (3.141%)  origin-forest_43.843 27968 (err=1.277)  
90.9 queries/sec
Query 27: actual 574 (0.082%)  origin-forest_43.843 643 (err=1.120)  
90.8 queries/sec
Query 28: actual 14 (0.002%)  origin-forest_43.843 3 (err=4.667)  
86.8 queries/sec
Query 29: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 31: actual 1154 (0.166%)  origin-forest_43.843 1357 (err=1.176)  
90.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 34: actual 39414 (5.653%)  origin-forest_43.843 37153 (err=1.061)  
90.9 queries/sec
Query 35: actual 68 (0.010%)  origin-forest_43.843 78 (err=1.147)  
83.3 queries/sec
Query 36: actual 67 (0.010%)  origin-forest_43.843 28 (err=2.393)  
79.9 queries/sec
Query 37: actual 4 (0.001%)  origin-forest_43.843 3 (err=1.333)  
76.9 queries/sec
Query 38: actual 23 (0.003%)  origin-forest_43.843 1 (err=23.000)  
77.0 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
69.3 queries/sec
Query 42: actual 488 (0.070%)  origin-forest_43.843 1 (err=488.000)  
82.6 queries/sec
Query 43: actual 9 (0.001%)  origin-forest_43.843 14 (err=1.556)  
82.6 queries/sec
Query 44: actual 692 (0.099%)  origin-forest_43.843 264 (err=2.621)  
79.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 46: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 47: actual 17 (0.002%)  origin-forest_43.843 1 (err=17.000)  
90.9 queries/sec
Query 48: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 488.0000	99th: 269.4600	95th: 29.0500	median: 1.1615	mean: 13.6206
ReportEsts: [1.0, 1.5, 1.0, 1.3333333333333333, 2.0, 1.0, 1.0, 1.0, 34.0, 9.0, 1.0, 1.0, 1.0, 1.178082191780822, 1.0269853508095605, 1.0, 3.0555555555555554, 1.2328618063112078, 1.0, 6.0, 42.0, 1.6558102131081625, 1.4766355140186915, 1.00487900078064, 1.1428571428571428, 1.070802886579222, 1.277019314186567, 1.1202090592334495, 4.666666666666667, 2.0, 1.0, 1.1759098786828424, 1.0, 1.0, 1.06085645842866, 1.1470588235294117, 2.392857142857143, 1.3333333333333333, 23.0, 1.0, 1.0, 1.0, 488.0, 1.5555555555555556, 2.621212121212121, 1.0, 2.0, 17.0, 4.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 50/50 | Workload-time: 4.052494 | Model-update-time: 0.000000





Experiment Summary: #drift=18 | total-time=436.467872
