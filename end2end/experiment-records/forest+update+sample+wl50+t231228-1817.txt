Input arguments = Namespace(data_update='sample', dataset='forest', debug=False, drift_test='ddup', model_update='update', model='naru', random_seed=42, num_workload=50)
MODEL-PATH=F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
DATASET-PATH=F:\DBGroup\LearnedCardinalityUpdater\data\forest\end2end\forest.npy
Workload weights: query=15, data-update=10
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload']



WORKLOAD-START | Type: QueryWorkload | Progress: 1/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 0
RandomSeedCommunicator.get: 0
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
37.7 queries/sec
Query 1: actual 5561 (0.798%)  origin-forest_43.843 4496 (err=1.237)  
71.4 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 3: actual 59 (0.008%)  origin-forest_43.843 43 (err=1.372)  
58.8 queries/sec
Query 4: actual 8 (0.001%)  origin-forest_43.843 3 (err=2.667)  
58.8 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
58.8 queries/sec
Query 6: actual 384 (0.055%)  origin-forest_43.843 371 (err=1.035)  
64.5 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
55.6 queries/sec
Query 8: actual 703 (0.101%)  origin-forest_43.843 650 (err=1.082)  
62.5 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 10: actual 67 (0.010%)  origin-forest_43.843 75 (err=1.119)  
62.5 queries/sec
Query 11: actual 66 (0.009%)  origin-forest_43.843 1 (err=66.000)  
60.2 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
54.0 queries/sec
Query 13: actual 2 (0.000%)  origin-forest_43.843 5 (err=2.500)  
55.6 queries/sec
Query 14: actual 134 (0.019%)  origin-forest_43.843 66 (err=2.030)  
62.5 queries/sec
Query 15: actual 89 (0.013%)  origin-forest_43.843 75 (err=1.187)  
62.5 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 4 (err=4.000)  
58.8 queries/sec
Query 17: actual 22 (0.003%)  origin-forest_43.843 1 (err=22.000)  
43.5 queries/sec
Query 18: actual 53 (0.008%)  origin-forest_43.843 80 (err=1.509)  
58.3 queries/sec
Query 19: actual 86 (0.012%)  origin-forest_43.843 65 (err=1.323)  
71.4 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 21: actual 134 (0.019%)  origin-forest_43.843 1 (err=134.000)  
66.7 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
55.6 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 24: actual 395 (0.057%)  origin-forest_43.843 644 (err=1.630)  
74.0 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 26: actual 14604 (2.095%)  origin-forest_43.843 15521 (err=1.063)  
82.7 queries/sec
Query 27: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
79.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 29: actual 7 (0.001%)  origin-forest_43.843 1 (err=7.000)  
76.9 queries/sec
Query 30: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
83.3 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.0 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 37: actual 86 (0.012%)  origin-forest_43.843 1 (err=86.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 39: actual 6 (0.001%)  origin-forest_43.843 4 (err=1.500)  
90.9 queries/sec
Query 40: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 42: actual 17 (0.002%)  origin-forest_43.843 8 (err=2.125)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 123 (0.018%)  origin-forest_43.843 216 (err=1.756)  
90.9 queries/sec
Query 45: actual 689 (0.099%)  origin-forest_43.843 220 (err=3.132)  
90.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 134.0000	99th: 110.4800	95th: 46.2000	median: 1.1005	mean: 7.6103
ReportEsts: [1.0, 1.2368772241992882, 1.0, 1.372093023255814, 2.6666666666666665, 1.0, 1.0350404312668464, 1.0, 1.0815384615384616, 1.0, 1.1194029850746268, 66.0, 1.0, 2.5, 2.0303030303030303, 1.1866666666666668, 4.0, 22.0, 1.509433962264151, 1.323076923076923, 1.0, 134.0, 1.0, 1.0, 1.630379746835443, 1.0, 1.062791016159956, 4.0, 1.0, 7.0, 1.25, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 86.0, 1.0, 1.5, 2.0, 1.0, 2.125, 1.0, 1.7560975609756098, 3.131818181818182, 1.0, 2.0, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/50 | Workload-time: 4.255164 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (591012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.0s
done, took 0.0s
new data average log likelihood = 44.2785
detection mean = 43.5363
detection threshold = 0.3234
test statistic = 0.7422
Offline time = 3.0544896125793457
Online time = 0.43929028511047363
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 2-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (591012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 591012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.5605 bits (loss 62.699, data 19.139) 0.00100 lr
epoch 9 train loss 43.1645 nats / 62.2732 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 43.1431 bits (loss 62.282, data 19.139) 0.00082 lr
epoch 19 train loss 43.0631 nats / 62.1270 bits
time since start: 7.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 42.4280 nats / 61.2106 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/50 | Workload-time: 6.706962 | Model-update-time: 10.389149


WORKLOAD-START | Type: QueryWorkload | Progress: 3/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.1s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 1
RandomSeedCommunicator.get: 1
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
39.0 queries/sec
Query 1: actual 3 (0.000%)  origin-forest_43.843 4 (err=1.333)  
76.9 queries/sec
Query 2: actual 4 (0.001%)  origin-forest_43.843 6 (err=1.500)  
76.9 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 4: actual 292 (0.042%)  origin-forest_43.843 99 (err=2.949)  
90.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 35874 (5.145%)  origin-forest_43.843 46517 (err=1.297)  
86.9 queries/sec
Query 7: actual 4 (0.001%)  origin-forest_43.843 13 (err=3.250)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 9: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
83.3 queries/sec
Query 10: actual 13191 (1.892%)  origin-forest_43.843 16309 (err=1.236)  
90.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 21: actual 51 (0.007%)  origin-forest_43.843 34 (err=1.500)  
83.3 queries/sec
Query 22: actual 277 (0.040%)  origin-forest_43.843 142 (err=1.951)  
76.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 25: actual 41 (0.006%)  origin-forest_43.843 1 (err=41.000)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.0 queries/sec
Query 27: actual 852 (0.122%)  origin-forest_43.843 1140 (err=1.338)  
73.7 queries/sec
Query 28: actual 339109 (48.638%)  origin-forest_43.843 320460 (err=1.058)  
90.9 queries/sec
Query 29: actual 11 (0.002%)  origin-forest_43.843 5 (err=2.200)  
83.3 queries/sec
Query 30: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 31: actual 10 (0.001%)  origin-forest_43.843 10 (err=1.000)  
74.0 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.7 queries/sec
Query 35: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
90.9 queries/sec
Query 36: actual 80 (0.011%)  origin-forest_43.843 1 (err=80.000)  
76.9 queries/sec
Query 37: actual 7 (0.001%)  origin-forest_43.843 9 (err=1.286)  
100.0 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 40: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
76.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 42: actual 64 (0.009%)  origin-forest_43.843 1 (err=64.000)  
83.3 queries/sec
Query 43: actual 25 (0.004%)  origin-forest_43.843 39 (err=1.560)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 32 (0.005%)  origin-forest_43.843 29 (err=1.103)  
90.9 queries/sec
Query 46: actual 31604 (4.533%)  origin-forest_43.843 38172 (err=1.208)  
90.9 queries/sec
Query 47: actual 44 (0.006%)  origin-forest_43.843 45 (err=1.023)  
100.0 queries/sec
Query 48: actual 56 (0.008%)  origin-forest_43.843 93 (err=1.661)  
79.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 80.0000	99th: 72.1600	95th: 24.0125	median: 1.0000	mean: 4.8791
ReportEsts: [1.0, 1.3333333333333333, 1.5, 1.0, 2.9494949494949494, 1.0, 1.2966772592964264, 3.25, 1.0, 1.0, 1.2363732848154045, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.5, 1.9507042253521127, 1.0, 1.0, 41.0, 1.0, 1.3380281690140845, 1.05819447044873, 2.2, 2.0, 1.0, 1.0, 1.0, 1.0, 1.5, 80.0, 1.2857142857142858, 1.0, 1.0, 1.0, 1.0, 64.0, 1.56, 1.0, 1.103448275862069, 1.2078217947095304, 1.0227272727272727, 1.6607142857142858, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/50 | Workload-time: 4.225564 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 4/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.1s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 2
RandomSeedCommunicator.get: 2
Query 0: actual 1898 (0.272%)  origin-forest_43.843 1830 (err=1.037)  
43.5 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 6 (0.001%)  origin-forest_43.843 3 (err=2.000)  
83.3 queries/sec
Query 3: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
86.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 5: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 7: actual 18 (0.003%)  origin-forest_43.843 0 (err=18.000)  
76.9 queries/sec
Query 8: actual 2479 (0.356%)  origin-forest_43.843 1514 (err=1.637)  
90.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 10: actual 140 (0.020%)  origin-forest_43.843 172 (err=1.229)  
100.0 queries/sec
Query 11: actual 9575 (1.373%)  origin-forest_43.843 11322 (err=1.182)  
90.9 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.8 queries/sec
Query 13: actual 19 (0.003%)  origin-forest_43.843 1 (err=19.000)  
76.9 queries/sec
Query 14: actual 152 (0.022%)  origin-forest_43.843 156 (err=1.026)  
100.0 queries/sec
Query 15: actual 3607 (0.517%)  origin-forest_43.843 3040 (err=1.187)  
90.9 queries/sec
Query 16: actual 515 (0.074%)  origin-forest_43.843 579 (err=1.124)  
83.3 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 18: actual 41888 (6.008%)  origin-forest_43.843 4707 (err=8.899)  
83.3 queries/sec
Query 19: actual 578 (0.083%)  origin-forest_43.843 777 (err=1.344)  
100.0 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
88.5 queries/sec
Query 22: actual 104091 (14.930%)  origin-forest_43.843 91495 (err=1.138)  
90.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
100.0 queries/sec
Query 24: actual 15 (0.002%)  origin-forest_43.843 1 (err=15.000)  
76.9 queries/sec
Query 25: actual 3342 (0.479%)  origin-forest_43.843 3469 (err=1.038)  
100.0 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 7 (0.001%)  origin-forest_43.843 4 (err=1.750)  
90.9 queries/sec
Query 30: actual 44825 (6.429%)  origin-forest_43.843 50239 (err=1.121)  
86.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 721 (0.103%)  origin-forest_43.843 408 (err=1.767)  
90.9 queries/sec
Query 33: actual 32 (0.005%)  origin-forest_43.843 1 (err=32.000)  
83.3 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 35: actual 6 (0.001%)  origin-forest_43.843 1 (err=6.000)  
76.9 queries/sec
Query 36: actual 882 (0.127%)  origin-forest_43.843 703 (err=1.255)  
83.3 queries/sec
Query 37: actual 691 (0.099%)  origin-forest_43.843 818 (err=1.184)  
90.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 39: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 40: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 5 (0.001%)  origin-forest_43.843 2 (err=2.500)  
90.9 queries/sec
Query 43: actual 393 (0.056%)  origin-forest_43.843 534 (err=1.359)  
90.9 queries/sec
Query 44: actual 5277 (0.757%)  origin-forest_43.843 6211 (err=1.177)  
90.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 46: actual 23 (0.003%)  origin-forest_43.843 1 (err=23.000)  
76.6 queries/sec
Query 47: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
91.0 queries/sec
Query 48: actual 18 (0.003%)  origin-forest_43.843 41 (err=2.278)  
83.3 queries/sec
Query 49: actual 66 (0.009%)  origin-forest_43.843 1 (err=66.000)  
origin-forest_43.843 	max: 66.0000	99th: 49.3400	95th: 21.2000	median: 1.1852	mean: 4.9146
ReportEsts: [1.037158469945355, 1.0, 2.0, 1.5, 1.0, 2.0, 1.0, 18, 1.6373844121532364, 2.0, 1.2285714285714286, 1.1824543080939949, 1.0, 19.0, 1.0263157894736843, 1.1865131578947368, 1.1242718446601943, 1.0, 8.899086466964096, 1.3442906574394464, 1.0, 1.0, 1.1376687250669435, 1.0, 15.0, 1.038001196888091, 1.0, 1.0, 1.0, 1.75, 1.120780814277747, 1.0, 1.767156862745098, 32.0, 1.0, 6.0, 1.2546230440967283, 1.1837916063675833, 1.0, 2.0, 2.0, 1.0, 2.5, 1.3587786259541985, 1.176994504453288, 1.0, 23.0, 4.0, 2.2777777777777777, 66.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 4/50 | Workload-time: 4.011019 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 5/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (601012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.0s
new data average log likelihood = 43.8203
detection mean = 43.1977
detection threshold = 0.3139
test statistic = 0.6226
Offline time = 2.8655176162719727
Online time = 0.4430820941925049
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 5-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (601012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 601012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.1404 bits (loss 62.258, data 19.117) 0.00100 lr
epoch 9 train loss 43.0076 nats / 62.0469 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.8293 bits (loss 61.947, data 19.117) 0.00082 lr
epoch 19 train loss 42.8891 nats / 61.8759 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 41.8434 nats / 60.3672 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 5/50 | Workload-time: 6.387902 | Model-update-time: 10.164526


WORKLOAD-START | Type: QueryWorkload | Progress: 6/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 3
RandomSeedCommunicator.get: 3
Query 0: actual 184 (0.026%)  origin-forest_43.843 0 (err=184.000)  
38.9 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 2: actual 219 (0.031%)  origin-forest_43.843 177 (err=1.237)  
83.3 queries/sec
Query 3: actual 1291 (0.185%)  origin-forest_43.843 1746 (err=1.352)  
76.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
73.1 queries/sec
Query 6: actual 40770 (5.848%)  origin-forest_43.843 41027 (err=1.006)  
85.8 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.1 queries/sec
Query 8: actual 225 (0.032%)  origin-forest_43.843 285 (err=1.267)  
72.1 queries/sec
Query 9: actual 2367 (0.339%)  origin-forest_43.843 1403 (err=1.687)  
83.3 queries/sec
Query 10: actual 168 (0.024%)  origin-forest_43.843 1 (err=168.000)  
76.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 12: actual 21 (0.003%)  origin-forest_43.843 51 (err=2.429)  
83.3 queries/sec
Query 13: actual 52 (0.007%)  origin-forest_43.843 64 (err=1.231)  
83.3 queries/sec
Query 14: actual 58 (0.008%)  origin-forest_43.843 51 (err=1.137)  
83.3 queries/sec
Query 15: actual 113 (0.016%)  origin-forest_43.843 1 (err=113.000)  
83.3 queries/sec
Query 16: actual 18 (0.003%)  origin-forest_43.843 40 (err=2.222)  
76.7 queries/sec
Query 17: actual 456 (0.065%)  origin-forest_43.843 680 (err=1.491)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 3248 (0.466%)  origin-forest_43.843 3595 (err=1.107)  
71.4 queries/sec
Query 20: actual 45 (0.006%)  origin-forest_43.843 33 (err=1.364)  
90.9 queries/sec
Query 21: actual 6 (0.001%)  origin-forest_43.843 1 (err=6.000)  
71.4 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 411 (0.059%)  origin-forest_43.843 1 (err=411.000)  
79.9 queries/sec
Query 24: actual 25071 (3.596%)  origin-forest_43.843 14327 (err=1.750)  
90.8 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.4 queries/sec
Query 26: actual 2 (0.000%)  origin-forest_43.843 5 (err=2.500)  
90.9 queries/sec
Query 27: actual 34 (0.005%)  origin-forest_43.843 1 (err=34.000)  
83.3 queries/sec
Query 28: actual 50 (0.007%)  origin-forest_43.843 51 (err=1.020)  
83.3 queries/sec
Query 29: actual 12447 (1.785%)  origin-forest_43.843 15116 (err=1.214)  
90.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 34: actual 280 (0.040%)  origin-forest_43.843 240 (err=1.167)  
87.5 queries/sec
Query 35: actual 56 (0.008%)  origin-forest_43.843 1 (err=56.000)  
77.0 queries/sec
Query 36: actual 7 (0.001%)  origin-forest_43.843 6 (err=1.167)  
80.3 queries/sec
Query 37: actual 6 (0.001%)  origin-forest_43.843 7 (err=1.167)  
81.1 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
70.9 queries/sec
Query 39: actual 137 (0.020%)  origin-forest_43.843 2 (err=68.500)  
90.9 queries/sec
Query 40: actual 3097 (0.444%)  origin-forest_43.843 4333 (err=1.399)  
83.6 queries/sec
Query 41: actual 40283 (5.778%)  origin-forest_43.843 16101 (err=2.502)  
76.9 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.0 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 47: actual 1893 (0.272%)  origin-forest_43.843 2533 (err=1.338)  
83.3 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 411.0000	99th: 299.7700	95th: 143.2500	median: 1.1667	mean: 21.9251
ReportEsts: [184, 1.0, 1.2372881355932204, 1.3524399690162665, 1.0, 4.0, 1.0063036546480255, 1.0, 1.2666666666666666, 1.6870990734141127, 168.0, 1.0, 2.4285714285714284, 1.2307692307692308, 1.1372549019607843, 113.0, 2.2222222222222223, 1.4912280701754386, 1.0, 1.1068349753694582, 1.3636363636363635, 6.0, 1.0, 411.0, 1.7499127521462972, 1.0, 2.5, 34.0, 1.02, 1.2144291797220215, 1.0, 1.0, 1.0, 1.0, 1.1666666666666667, 56.0, 1.1666666666666667, 1.1666666666666667, 1.0, 68.5, 1.399095899257346, 2.5018942922799825, 1.0, 1.0, 1.0, 1.0, 1.0, 1.3380876914949815, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 6/50 | Workload-time: 4.163877 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 7/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 4
RandomSeedCommunicator.get: 4
Query 0: actual 335 (0.048%)  origin-forest_43.843 371 (err=1.107)  
38.5 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 4: actual 2984 (0.428%)  origin-forest_43.843 2332 (err=1.280)  
83.3 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 10: actual 66205 (9.496%)  origin-forest_43.843 44235 (err=1.497)  
90.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 13: actual 189 (0.027%)  origin-forest_43.843 21 (err=9.000)  
83.3 queries/sec
Query 14: actual 10 (0.001%)  origin-forest_43.843 1 (err=10.000)  
82.7 queries/sec
Query 15: actual 19 (0.003%)  origin-forest_43.843 18 (err=1.056)  
87.5 queries/sec
Query 16: actual 141378 (20.278%)  origin-forest_43.843 109548 (err=1.291)  
95.6 queries/sec
Query 17: actual 19 (0.003%)  origin-forest_43.843 30 (err=1.579)  
89.4 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 19: actual 145 (0.021%)  origin-forest_43.843 144 (err=1.007)  
90.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 21: actual 939 (0.135%)  origin-forest_43.843 887 (err=1.059)  
90.9 queries/sec
Query 22: actual 604 (0.087%)  origin-forest_43.843 638 (err=1.056)  
90.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 24: actual 181232 (25.994%)  origin-forest_43.843 185729 (err=1.025)  
83.3 queries/sec
Query 25: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
76.9 queries/sec
Query 26: actual 17 (0.002%)  origin-forest_43.843 1 (err=17.000)  
83.3 queries/sec
Query 27: actual 386673 (55.460%)  origin-forest_43.843 371537 (err=1.041)  
90.9 queries/sec
Query 28: actual 218 (0.031%)  origin-forest_43.843 267 (err=1.225)  
76.9 queries/sec
Query 29: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 30: actual 1893 (0.272%)  origin-forest_43.843 2037 (err=1.076)  
83.3 queries/sec
Query 31: actual 4 (0.001%)  origin-forest_43.843 4 (err=1.000)  
86.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 28 (0.004%)  origin-forest_43.843 23 (err=1.217)  
90.9 queries/sec
Query 34: actual 82 (0.012%)  origin-forest_43.843 1 (err=82.000)  
83.3 queries/sec
Query 35: actual 75224 (10.789%)  origin-forest_43.843 77957 (err=1.036)  
83.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 38: actual 2066 (0.296%)  origin-forest_43.843 2433 (err=1.178)  
83.3 queries/sec
Query 39: actual 12 (0.002%)  origin-forest_43.843 11 (err=1.091)  
95.2 queries/sec
Query 40: actual 23 (0.003%)  origin-forest_43.843 24 (err=1.043)  
83.3 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 43: actual 164 (0.024%)  origin-forest_43.843 152 (err=1.079)  
100.0 queries/sec
Query 44: actual 9007 (1.292%)  origin-forest_43.843 9317 (err=1.034)  
76.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 48: actual 14387 (2.063%)  origin-forest_43.843 15976 (err=1.110)  
72.5 queries/sec
Query 49: actual 7656 (1.098%)  origin-forest_43.843 6060 (err=1.263)  
origin-forest_43.843 	max: 82.0000	99th: 50.1500	95th: 9.5500	median: 1.0354	mean: 3.5070
ReportEsts: [1.1074626865671642, 1.0, 1.0, 1.0, 1.2795883361921099, 1.0, 1.0, 1.0, 1.0, 1.0, 1.4966655363400023, 1.0, 1.0, 9.0, 10.0, 1.0555555555555556, 1.2905575638076459, 1.5789473684210527, 1.0, 1.0069444444444444, 1.0, 1.0586245772266065, 1.0562913907284768, 1.0, 1.024813498719873, 1.0, 17.0, 1.040738876612558, 1.224770642201835, 8.0, 1.076069730586371, 1.0, 1.0, 1.2173913043478262, 82.0, 1.036331489950016, 1.0, 1.0, 1.1776379477250727, 1.0909090909090908, 1.0434782608695652, 1.0, 1.0, 1.0789473684210527, 1.0344176751415566, 1.0, 1.0, 2.0, 1.1104469312573853, 1.2633663366336634]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 7/50 | Workload-time: 4.079424 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 8/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 5
RandomSeedCommunicator.get: 5
Query 0: actual 1832 (0.263%)  origin-forest_43.843 2161 (err=1.180)  
37.0 queries/sec
Query 1: actual 33175 (4.758%)  origin-forest_43.843 37228 (err=1.122)  
90.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 4: actual 172 (0.025%)  origin-forest_43.843 67 (err=2.567)  
90.9 queries/sec
Query 5: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
66.7 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
55.6 queries/sec
Query 7: actual 59 (0.008%)  origin-forest_43.843 1 (err=59.000)  
83.3 queries/sec
Query 8: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.4 queries/sec
Query 9: actual 47787 (6.854%)  origin-forest_43.843 15693 (err=3.045)  
83.3 queries/sec
Query 10: actual 13073 (1.875%)  origin-forest_43.843 14648 (err=1.120)  
94.3 queries/sec
Query 11: actual 12 (0.002%)  origin-forest_43.843 7 (err=1.714)  
83.3 queries/sec
Query 12: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
76.9 queries/sec
Query 13: actual 9736 (1.396%)  origin-forest_43.843 10302 (err=1.058)  
90.9 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 15: actual 1442 (0.207%)  origin-forest_43.843 1769 (err=1.227)  
83.3 queries/sec
Query 16: actual 6 (0.001%)  origin-forest_43.843 2 (err=3.000)  
83.3 queries/sec
Query 17: actual 23578 (3.382%)  origin-forest_43.843 26707 (err=1.133)  
83.3 queries/sec
Query 18: actual 52 (0.007%)  origin-forest_43.843 1 (err=52.000)  
90.7 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 20: actual 13 (0.002%)  origin-forest_43.843 1 (err=13.000)  
76.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
84.0 queries/sec
Query 26: actual 21601 (3.098%)  origin-forest_43.843 21853 (err=1.012)  
86.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 15 (0.002%)  origin-forest_43.843 6 (err=2.500)  
83.3 queries/sec
Query 30: actual 65 (0.009%)  origin-forest_43.843 1 (err=65.000)  
76.9 queries/sec
Query 31: actual 1639 (0.235%)  origin-forest_43.843 2313 (err=1.411)  
83.3 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 3592 (0.515%)  origin-forest_43.843 3050 (err=1.178)  
90.9 queries/sec
Query 34: actual 508 (0.073%)  origin-forest_43.843 96 (err=5.292)  
90.8 queries/sec
Query 35: actual 120 (0.017%)  origin-forest_43.843 35 (err=3.429)  
83.0 queries/sec
Query 36: actual 6 (0.001%)  origin-forest_43.843 10 (err=1.667)  
79.7 queries/sec
Query 37: actual 96854 (13.892%)  origin-forest_43.843 103786 (err=1.072)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 21 (0.003%)  origin-forest_43.843 23 (err=1.095)  
83.3 queries/sec
Query 41: actual 87 (0.012%)  origin-forest_43.843 1 (err=87.000)  
83.3 queries/sec
Query 42: actual 5160 (0.740%)  origin-forest_43.843 4949 (err=1.043)  
90.8 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 44: actual 4 (0.001%)  origin-forest_43.843 8 (err=2.000)  
83.3 queries/sec
Query 45: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
73.7 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
86.0 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 48: actual 11 (0.002%)  origin-forest_43.843 12 (err=1.091)  
76.9 queries/sec
Query 49: actual 24 (0.003%)  origin-forest_43.843 9 (err=2.667)  
origin-forest_43.843 	max: 87.0000	99th: 76.2200	95th: 55.8500	median: 1.1274	mean: 7.2924
ReportEsts: [1.179585152838428, 1.122170308967596, 1.0, 1.0, 2.5671641791044775, 20.0, 1.0, 59.0, 2.0, 3.045115656662206, 1.1204773196664881, 1.7142857142857142, 3.0, 1.0581347576006574, 1.0, 1.226768377253814, 3.0, 1.1327084570362203, 52.0, 1.0, 13.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0116661265682145, 1.0, 1.0, 2.5, 65.0, 1.4112263575350823, 1.0, 1.177704918032787, 5.291666666666667, 3.4285714285714284, 1.6666666666666667, 1.0715716439176493, 1.0, 1.0, 1.0952380952380953, 87.0, 1.0426348757324713, 1.0, 2.0, 2.0, 2.0, 1.0, 1.0909090909090908, 2.6666666666666665]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 8/50 | Workload-time: 4.040159 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 9/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.1s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 6
RandomSeedCommunicator.get: 6
Query 0: actual 28 (0.004%)  origin-forest_43.843 45 (err=1.607)  
38.5 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
55.6 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 3: actual 38445 (5.514%)  origin-forest_43.843 11939 (err=3.220)  
83.4 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
78.9 queries/sec
Query 6: actual 61640 (8.841%)  origin-forest_43.843 72177 (err=1.171)  
83.3 queries/sec
Query 7: actual 20 (0.003%)  origin-forest_43.843 2 (err=10.000)  
83.3 queries/sec
Query 8: actual 927 (0.133%)  origin-forest_43.843 1344 (err=1.450)  
83.3 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
78.3 queries/sec
Query 10: actual 1231 (0.177%)  origin-forest_43.843 1681 (err=1.366)  
76.9 queries/sec
Query 11: actual 21076 (3.023%)  origin-forest_43.843 23922 (err=1.135)  
76.9 queries/sec
Query 12: actual 61 (0.009%)  origin-forest_43.843 0 (err=61.000)  
66.6 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 14: actual 133 (0.019%)  origin-forest_43.843 160 (err=1.203)  
71.4 queries/sec
Query 15: actual 12 (0.002%)  origin-forest_43.843 3 (err=4.000)  
50.0 queries/sec
Query 16: actual 491 (0.070%)  origin-forest_43.843 282 (err=1.741)  
58.8 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.3 queries/sec
Query 20: actual 151 (0.022%)  origin-forest_43.843 2 (err=75.500)  
76.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
76.9 queries/sec
Query 24: actual 218 (0.031%)  origin-forest_43.843 221 (err=1.014)  
76.9 queries/sec
Query 25: actual 150795 (21.628%)  origin-forest_43.843 153506 (err=1.018)  
76.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 27: actual 18 (0.003%)  origin-forest_43.843 29 (err=1.611)  
83.1 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 29: actual 321 (0.046%)  origin-forest_43.843 321 (err=1.000)  
71.4 queries/sec
Query 30: actual 80 (0.011%)  origin-forest_43.843 92 (err=1.150)  
71.4 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 32: actual 195 (0.028%)  origin-forest_43.843 111 (err=1.757)  
83.3 queries/sec
Query 33: actual 6 (0.001%)  origin-forest_43.843 4 (err=1.500)  
83.3 queries/sec
Query 34: actual 217 (0.031%)  origin-forest_43.843 1 (err=217.000)  
76.9 queries/sec
Query 35: actual 6 (0.001%)  origin-forest_43.843 1 (err=6.000)  
76.3 queries/sec
Query 36: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
71.4 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 38: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
71.4 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 151 (0.022%)  origin-forest_43.843 226 (err=1.497)  
71.4 queries/sec
Query 41: actual 7493 (1.075%)  origin-forest_43.843 8088 (err=1.079)  
90.9 queries/sec
Query 42: actual 127990 (18.357%)  origin-forest_43.843 92251 (err=1.387)  
79.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 45: actual 166 (0.024%)  origin-forest_43.843 204 (err=1.229)  
90.9 queries/sec
Query 46: actual 31 (0.004%)  origin-forest_43.843 43 (err=1.387)  
83.3 queries/sec
Query 47: actual 376 (0.054%)  origin-forest_43.843 608 (err=1.617)  
76.9 queries/sec
Query 48: actual 6481 (0.930%)  origin-forest_43.843 5497 (err=1.179)  
71.4 queries/sec
Query 49: actual 59239 (8.497%)  origin-forest_43.843 73202 (err=1.236)  
origin-forest_43.843 	max: 217.0000	99th: 147.6650	95th: 38.0500	median: 1.1910	mean: 8.6611
ReportEsts: [1.6071428571428572, 1.0, 1.0, 3.2201189379345005, 1.0, 1.0, 1.170944192083063, 10.0, 1.4498381877022655, 1.0, 1.3655564581640942, 1.1350351110267602, 61, 1.0, 1.2030075187969924, 4.0, 1.7411347517730495, 2.0, 1.0, 1.0, 75.5, 1.0, 1.0, 3.0, 1.0137614678899083, 1.0179780496700819, 1.0, 1.6111111111111112, 1.0, 1.0, 1.15, 1.0, 1.7567567567567568, 1.5, 217.0, 6.0, 2.0, 1.0, 3.0, 1.0, 1.4966887417218544, 1.079407446950487, 1.387410434575235, 1.0, 1.0, 1.2289156626506024, 1.3870967741935485, 1.6170212765957446, 1.1790067309441514, 1.2357062070595384]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 9/50 | Workload-time: 4.139309 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 10/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (611012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.0s
done, took 0.0s
new data average log likelihood = 43.5548
detection mean = 43.2097
detection threshold = 0.3196
test statistic = 0.3451
Offline time = 2.9208316802978516
Online time = 0.4529886245727539
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 10-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (611012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 611012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.1896 bits (loss 62.278, data 19.089) 0.00100 lr
epoch 9 train loss 42.8740 nats / 61.8541 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 42.8422 bits (loss 61.931, data 19.089) 0.00082 lr
epoch 19 train loss 42.7305 nats / 61.6471 bits
time since start: 7.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 41.2961 nats / 59.5777 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 10/50 | Workload-time: 6.566037 | Model-update-time: 10.508626


WORKLOAD-START | Type: QueryWorkload | Progress: 11/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 7
RandomSeedCommunicator.get: 7
Query 0: actual 5 (0.001%)  origin-forest_43.843 6 (err=1.200)  
38.5 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
71.4 queries/sec
Query 3: actual 9 (0.001%)  origin-forest_43.843 14 (err=1.556)  
79.8 queries/sec
Query 4: actual 1291 (0.185%)  origin-forest_43.843 3660 (err=2.835)  
73.5 queries/sec
Query 5: actual 20 (0.003%)  origin-forest_43.843 19 (err=1.053)  
75.7 queries/sec
Query 6: actual 21 (0.003%)  origin-forest_43.843 37 (err=1.762)  
76.9 queries/sec
Query 7: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
83.4 queries/sec
Query 8: actual 34317 (4.922%)  origin-forest_43.843 35067 (err=1.022)  
83.3 queries/sec
Query 9: actual 187 (0.027%)  origin-forest_43.843 78 (err=2.397)  
76.7 queries/sec
Query 10: actual 12 (0.002%)  origin-forest_43.843 6 (err=2.000)  
77.1 queries/sec
Query 11: actual 461 (0.066%)  origin-forest_43.843 527 (err=1.143)  
83.4 queries/sec
Query 12: actual 90 (0.013%)  origin-forest_43.843 124 (err=1.378)  
83.3 queries/sec
Query 13: actual 37 (0.005%)  origin-forest_43.843 1 (err=37.000)  
76.3 queries/sec
Query 14: actual 23994 (3.441%)  origin-forest_43.843 16353 (err=1.467)  
90.9 queries/sec
Query 15: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 16: actual 131 (0.019%)  origin-forest_43.843 134 (err=1.023)  
90.9 queries/sec
Query 17: actual 6 (0.001%)  origin-forest_43.843 8 (err=1.333)  
90.9 queries/sec
Query 18: actual 4 (0.001%)  origin-forest_43.843 3 (err=1.333)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 20: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 21: actual 125 (0.018%)  origin-forest_43.843 2 (err=62.500)  
83.3 queries/sec
Query 22: actual 1808 (0.259%)  origin-forest_43.843 98 (err=18.449)  
95.1 queries/sec
Query 23: actual 533 (0.076%)  origin-forest_43.843 720 (err=1.351)  
90.9 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 25: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
90.9 queries/sec
Query 26: actual 116 (0.017%)  origin-forest_43.843 0 (err=116.000)  
76.9 queries/sec
Query 27: actual 547289 (78.497%)  origin-forest_43.843 542358 (err=1.009)  
83.4 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 30: actual 9155 (1.313%)  origin-forest_43.843 5504 (err=1.663)  
95.1 queries/sec
Query 31: actual 18764 (2.691%)  origin-forest_43.843 25190 (err=1.342)  
83.4 queries/sec
Query 32: actual 170 (0.024%)  origin-forest_43.843 4 (err=42.500)  
90.9 queries/sec
Query 33: actual 12244 (1.756%)  origin-forest_43.843 16172 (err=1.321)  
84.9 queries/sec
Query 34: actual 21 (0.003%)  origin-forest_43.843 27 (err=1.286)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 37: actual 5 (0.001%)  origin-forest_43.843 3 (err=1.667)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
81.3 queries/sec
Query 39: actual 67 (0.010%)  origin-forest_43.843 54 (err=1.241)  
92.4 queries/sec
Query 40: actual 30444 (4.367%)  origin-forest_43.843 35384 (err=1.162)  
90.9 queries/sec
Query 41: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 44: actual 36377 (5.217%)  origin-forest_43.843 37830 (err=1.040)  
90.9 queries/sec
Query 45: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
90.9 queries/sec
Query 46: actual 90 (0.013%)  origin-forest_43.843 1 (err=90.000)  
83.3 queries/sec
Query 47: actual 127 (0.018%)  origin-forest_43.843 167 (err=1.315)  
90.9 queries/sec
Query 48: actual 388234 (55.684%)  origin-forest_43.843 386463 (err=1.005)  
98.3 queries/sec
Query 49: actual 520 (0.075%)  origin-forest_43.843 655 (err=1.260)  
origin-forest_43.843 	max: 116.0000	99th: 103.2600	95th: 53.5000	median: 1.3179	mean: 8.5472
ReportEsts: [1.2, 1.0, 1.25, 1.5555555555555556, 2.8350116189000776, 1.0526315789473684, 1.7619047619047619, 1.0, 1.02185505726025, 2.3974358974358974, 2.0, 1.143167028199566, 1.3777777777777778, 37.0, 1.4672537149146945, 2.0, 1.0229007633587786, 1.3333333333333333, 1.3333333333333333, 1.0, 2.0, 62.5, 18.448979591836736, 1.3508442776735459, 1.0, 1.5, 116, 1.0090917807057331, 1.0, 1.0, 1.6633357558139534, 1.3424642933276487, 42.5, 1.3208101927474682, 1.2857142857142858, 1.0, 1.0, 1.6666666666666667, 1.0, 1.2407407407407407, 1.1622651425568256, 2.0, 1.0, 1.0, 1.0399428210132777, 3.0, 90.0, 1.31496062992126, 1.0045825861725444, 1.2596153846153846]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 11/50 | Workload-time: 4.080822 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 12/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (621012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 43.3375
detection mean = 43.2960
detection threshold = 0.3252
test statistic = 0.0415
Offline time = 2.9983108043670654
Online time = 0.4985923767089844
Test result: False
Drift detection: False
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 12/50 | Workload-time: 6.713420 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 13/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (631012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.0s
done, took 0.0s
new data average log likelihood = 43.1836
detection mean = 43.3003
detection threshold = 0.3329
test statistic = 0.1167
Offline time = 2.864039659500122
Online time = 0.4411799907684326
Test result: False
Drift detection: False
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 13/50 | Workload-time: 6.443887 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 14/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (641012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.0s
done, took 0.1s
new data average log likelihood = 43.0425
detection mean = 43.3068
detection threshold = 0.3366
test statistic = 0.2643
Offline time = 2.888674020767212
Online time = 0.46315717697143555
Test result: False
Drift detection: False
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 14/50 | Workload-time: 6.468154 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 15/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 8
RandomSeedCommunicator.get: 8
Query 0: actual 42 (0.006%)  origin-forest_43.843 129 (err=3.071)  
35.7 queries/sec
Query 1: actual 10 (0.001%)  origin-forest_43.843 22 (err=2.200)  
83.3 queries/sec
Query 2: actual 58583 (8.402%)  origin-forest_43.843 69435 (err=1.185)  
79.9 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
58.8 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 21 (0.003%)  origin-forest_43.843 10 (err=2.100)  
90.9 queries/sec
Query 6: actual 63 (0.009%)  origin-forest_43.843 362 (err=5.746)  
90.9 queries/sec
Query 7: actual 12 (0.002%)  origin-forest_43.843 20 (err=1.667)  
83.3 queries/sec
Query 8: actual 23 (0.003%)  origin-forest_43.843 3 (err=7.667)  
86.3 queries/sec
Query 9: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 11: actual 108 (0.015%)  origin-forest_43.843 1 (err=108.000)  
71.4 queries/sec
Query 12: actual 55 (0.008%)  origin-forest_43.843 40 (err=1.375)  
90.9 queries/sec
Query 13: actual 160379 (23.003%)  origin-forest_43.843 189297 (err=1.180)  
90.9 queries/sec
Query 14: actual 31 (0.004%)  origin-forest_43.843 1 (err=31.000)  
83.3 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 16: actual 47 (0.007%)  origin-forest_43.843 1 (err=47.000)  
83.3 queries/sec
Query 17: actual 10266 (1.472%)  origin-forest_43.843 12511 (err=1.219)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.3 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
71.4 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 44 (0.006%)  origin-forest_43.843 87 (err=1.977)  
90.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 24: actual 35 (0.005%)  origin-forest_43.843 133 (err=3.800)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 26: actual 192 (0.028%)  origin-forest_43.843 108 (err=1.778)  
90.9 queries/sec
Query 27: actual 25 (0.004%)  origin-forest_43.843 23 (err=1.087)  
83.1 queries/sec
Query 28: actual 285 (0.041%)  origin-forest_43.843 151 (err=1.887)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 30: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
90.9 queries/sec
Query 31: actual 5 (0.001%)  origin-forest_43.843 1 (err=5.000)  
83.3 queries/sec
Query 32: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 6 (err=6.000)  
90.9 queries/sec
Query 34: actual 73 (0.010%)  origin-forest_43.843 1 (err=73.000)  
76.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.4 queries/sec
Query 36: actual 63040 (9.042%)  origin-forest_43.843 83832 (err=1.330)  
100.0 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 38: actual 88 (0.013%)  origin-forest_43.843 166 (err=1.886)  
83.3 queries/sec
Query 39: actual 361 (0.052%)  origin-forest_43.843 402 (err=1.114)  
83.3 queries/sec
Query 40: actual 161 (0.023%)  origin-forest_43.843 1 (err=161.000)  
90.9 queries/sec
Query 41: actual 27 (0.004%)  origin-forest_43.843 13 (err=2.077)  
90.9 queries/sec
Query 42: actual 153 (0.022%)  origin-forest_43.843 1 (err=153.000)  
90.9 queries/sec
Query 43: actual 204 (0.029%)  origin-forest_43.843 136 (err=1.500)  
90.9 queries/sec
Query 44: actual 288 (0.041%)  origin-forest_43.843 374 (err=1.299)  
95.2 queries/sec
Query 45: actual 1016 (0.146%)  origin-forest_43.843 936 (err=1.085)  
83.3 queries/sec
Query 46: actual 288 (0.041%)  origin-forest_43.843 12 (err=24.000)  
90.9 queries/sec
Query 47: actual 1445 (0.207%)  origin-forest_43.843 1362 (err=1.061)  
83.3 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 49: actual 52 (0.007%)  origin-forest_43.843 33 (err=1.576)  
origin-forest_43.843 	max: 161.0000	99th: 157.0800	95th: 92.2500	median: 1.6212	mean: 13.6373
ReportEsts: [3.0714285714285716, 2.2, 1.1852414522984485, 1.0, 1.0, 2.1, 5.746031746031746, 1.6666666666666667, 7.666666666666667, 3.0, 1.0, 108.0, 1.375, 1.180310389764246, 31.0, 1.0, 47.0, 1.2186830313656731, 1.0, 1.0, 2.0, 1.0, 1.9772727272727273, 1.0, 3.8, 1.0, 1.7777777777777777, 1.0869565217391304, 1.8874172185430464, 1.0, 3.0, 5.0, 2.0, 6.0, 73.0, 1.0, 1.3298223350253806, 1.0, 1.8863636363636365, 1.113573407202216, 161.0, 2.076923076923077, 153.0, 1.5, 1.2986111111111112, 1.0854700854700854, 24.0, 1.0609397944199705, 1.0, 1.5757575757575757]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 15/50 | Workload-time: 4.085933 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 16/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (651012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 42.9099
detection mean = 43.3148
detection threshold = 0.3348
test statistic = 0.4048
Offline time = 2.8419785499572754
Online time = 0.472430944442749
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 16-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (651012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 651012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.0471 bits (loss 61.985, data 18.938) 0.00100 lr
epoch 9 train loss 42.7348 nats / 61.6533 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.6875 bits (loss 61.625, data 18.938) 0.00082 lr
epoch 19 train loss 42.6139 nats / 61.4788 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 40.8281 nats / 58.9025 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 16/50 | Workload-time: 6.442094 | Model-update-time: 10.184896


WORKLOAD-START | Type: QueryWorkload | Progress: 17/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 9
RandomSeedCommunicator.get: 9
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
41.7 queries/sec
Query 1: actual 214 (0.031%)  origin-forest_43.843 1 (err=214.000)  
71.4 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
100.0 queries/sec
Query 3: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
90.9 queries/sec
Query 4: actual 3403 (0.488%)  origin-forest_43.843 2543 (err=1.338)  
100.0 queries/sec
Query 5: actual 623 (0.089%)  origin-forest_43.843 827 (err=1.327)  
83.3 queries/sec
Query 6: actual 13 (0.002%)  origin-forest_43.843 10 (err=1.300)  
86.9 queries/sec
Query 7: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 52 (0.007%)  origin-forest_43.843 53 (err=1.019)  
90.9 queries/sec
Query 10: actual 1674 (0.240%)  origin-forest_43.843 2089 (err=1.248)  
90.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 14 (0.002%)  origin-forest_43.843 1 (err=14.000)  
90.9 queries/sec
Query 13: actual 1191 (0.171%)  origin-forest_43.843 1066 (err=1.117)  
83.3 queries/sec
Query 14: actual 604 (0.087%)  origin-forest_43.843 895 (err=1.482)  
95.1 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.5 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.7 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.4 queries/sec
Query 18: actual 30 (0.004%)  origin-forest_43.843 57 (err=1.900)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 20: actual 2569 (0.368%)  origin-forest_43.843 3060 (err=1.191)  
90.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 24: actual 18870 (2.706%)  origin-forest_43.843 22847 (err=1.211)  
76.9 queries/sec
Query 25: actual 2846 (0.408%)  origin-forest_43.843 3527 (err=1.239)  
90.9 queries/sec
Query 26: actual 6943 (0.996%)  origin-forest_43.843 434 (err=15.998)  
90.9 queries/sec
Query 27: actual 18582 (2.665%)  origin-forest_43.843 19243 (err=1.036)  
90.9 queries/sec
Query 28: actual 3190 (0.458%)  origin-forest_43.843 4273 (err=1.339)  
76.9 queries/sec
Query 29: actual 71 (0.010%)  origin-forest_43.843 79 (err=1.113)  
90.9 queries/sec
Query 30: actual 13 (0.002%)  origin-forest_43.843 15 (err=1.154)  
90.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 9 (0.001%)  origin-forest_43.843 13 (err=1.444)  
68.9 queries/sec
Query 33: actual 279 (0.040%)  origin-forest_43.843 5 (err=55.800)  
90.9 queries/sec
Query 34: actual 34855 (4.999%)  origin-forest_43.843 39901 (err=1.145)  
83.3 queries/sec
Query 35: actual 23 (0.003%)  origin-forest_43.843 17 (err=1.353)  
90.9 queries/sec
Query 36: actual 6 (0.001%)  origin-forest_43.843 7 (err=1.167)  
83.3 queries/sec
Query 37: actual 4 (0.001%)  origin-forest_43.843 4 (err=1.000)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.5 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 40: actual 71772 (10.294%)  origin-forest_43.843 61487 (err=1.167)  
86.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 43: actual 40 (0.006%)  origin-forest_43.843 6 (err=6.667)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 45: actual 4 (0.001%)  origin-forest_43.843 2 (err=2.000)  
76.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 47: actual 27 (0.004%)  origin-forest_43.843 2 (err=13.500)  
90.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
77.6 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 214.0000	99th: 136.4820	95th: 37.4490	median: 1.1310	mean: 8.4951
ReportEsts: [1.0, 214.0, 1.0, 55.0, 1.3381832481321274, 1.3274478330658106, 1.3, 1.5, 1.0, 1.0192307692307692, 1.2479091995221028, 1.0, 14.0, 1.1172607879924954, 1.4817880794701987, 1.0, 1.0, 1.0, 1.9, 1.0, 1.191124951342935, 1.0, 1.0, 1.0, 1.2107578166401696, 1.2392832044975404, 15.997695852534562, 1.0355720589818103, 1.3394984326018808, 1.1126760563380282, 1.1538461538461537, 1.0, 1.4444444444444444, 55.8, 1.1447711949505093, 1.3529411764705883, 1.1666666666666667, 1.0, 1.0, 1.0, 1.1672711304828662, 1.0, 1.0, 6.666666666666667, 1.0, 2.0, 1.0, 13.5, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 17/50 | Workload-time: 4.018781 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 18/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 10
RandomSeedCommunicator.get: 10
Query 0: actual 3155 (0.453%)  origin-forest_43.843 1771 (err=1.781)  
43.5 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 3: actual 4130 (0.592%)  origin-forest_43.843 5108 (err=1.237)  
83.3 queries/sec
Query 4: actual 43 (0.006%)  origin-forest_43.843 23 (err=1.870)  
100.0 queries/sec
Query 5: actual 60 (0.009%)  origin-forest_43.843 58 (err=1.034)  
83.3 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 7: actual 32710 (4.692%)  origin-forest_43.843 24303 (err=1.346)  
100.0 queries/sec
Query 8: actual 47 (0.007%)  origin-forest_43.843 41 (err=1.146)  
76.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 10: actual 178 (0.026%)  origin-forest_43.843 295 (err=1.657)  
90.9 queries/sec
Query 11: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 12: actual 81 (0.012%)  origin-forest_43.843 61 (err=1.328)  
90.9 queries/sec
Query 13: actual 356 (0.051%)  origin-forest_43.843 2 (err=178.000)  
90.9 queries/sec
Query 14: actual 207 (0.030%)  origin-forest_43.843 2 (err=103.500)  
90.9 queries/sec
Query 15: actual 1597 (0.229%)  origin-forest_43.843 1597 (err=1.000)  
87.4 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.9 queries/sec
Query 17: actual 15 (0.002%)  origin-forest_43.843 17 (err=1.133)  
68.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 20: actual 15 (0.002%)  origin-forest_43.843 4 (err=3.750)  
90.9 queries/sec
Query 21: actual 157 (0.023%)  origin-forest_43.843 86 (err=1.826)  
83.3 queries/sec
Query 22: actual 110401 (15.835%)  origin-forest_43.843 136369 (err=1.235)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.3 queries/sec
Query 24: actual 713 (0.102%)  origin-forest_43.843 1 (err=713.000)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 26: actual 38 (0.005%)  origin-forest_43.843 1 (err=38.000)  
76.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 50 (0.007%)  origin-forest_43.843 1 (err=50.000)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 32: actual 497 (0.071%)  origin-forest_43.843 597 (err=1.201)  
76.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 36: actual 1043 (0.150%)  origin-forest_43.843 501 (err=2.082)  
83.3 queries/sec
Query 37: actual 4 (0.001%)  origin-forest_43.843 6 (err=1.500)  
86.3 queries/sec
Query 38: actual 141 (0.020%)  origin-forest_43.843 54 (err=2.611)  
100.0 queries/sec
Query 39: actual 190 (0.027%)  origin-forest_43.843 103 (err=1.845)  
90.9 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.7 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 5740 (0.823%)  origin-forest_43.843 5272 (err=1.089)  
100.0 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 21 (0.003%)  origin-forest_43.843 22 (err=1.048)  
100.0 queries/sec
Query 45: actual 5568 (0.799%)  origin-forest_43.843 6465 (err=1.161)  
90.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 3 (0.000%)  origin-forest_43.843 0 (err=3.000)  
71.5 queries/sec
Query 48: actual 16 (0.002%)  origin-forest_43.843 40 (err=2.500)  
80.0 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 713.0000	99th: 450.8500	95th: 79.4250	median: 1.1398	mean: 22.8976
ReportEsts: [1.7814793901750423, 1.0, 1.0, 1.2368038740920098, 1.8695652173913044, 1.0344827586206897, 1.0, 1.3459243714767724, 1.146341463414634, 1.0, 1.6573033707865168, 2.0, 1.3278688524590163, 178.0, 103.5, 1.0, 1.0, 1.1333333333333333, 1.0, 2.0, 3.75, 1.8255813953488371, 1.235215260731334, 1.0, 713.0, 1.0, 38.0, 1.0, 1.0, 50.0, 1.0, 1.0, 1.2012072434607646, 1.0, 1.0, 1.0, 2.0818363273453095, 1.5, 2.611111111111111, 1.8446601941747574, 1.0, 1.0, 1.0887708649468892, 1.0, 1.0476190476190477, 1.1610991379310345, 1.0, 3, 2.5, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 18/50 | Workload-time: 4.025294 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 19/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 11
RandomSeedCommunicator.get: 11
Query 0: actual 4511 (0.647%)  origin-forest_43.843 5125 (err=1.136)  
43.5 queries/sec
Query 1: actual 8 (0.001%)  origin-forest_43.843 2 (err=4.000)  
83.3 queries/sec
Query 2: actual 4102 (0.588%)  origin-forest_43.843 3306 (err=1.241)  
90.9 queries/sec
Query 3: actual 19 (0.003%)  origin-forest_43.843 1 (err=19.000)  
83.3 queries/sec
Query 4: actual 2449 (0.351%)  origin-forest_43.843 912 (err=2.685)  
83.3 queries/sec
Query 5: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
80.0 queries/sec
Query 6: actual 21 (0.003%)  origin-forest_43.843 1 (err=21.000)  
83.3 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 8: actual 578 (0.083%)  origin-forest_43.843 1 (err=578.000)  
76.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 10: actual 26 (0.004%)  origin-forest_43.843 0 (err=26.000)  
83.3 queries/sec
Query 11: actual 453381 (65.028%)  origin-forest_43.843 441189 (err=1.028)  
83.3 queries/sec
Query 12: actual 6 (0.001%)  origin-forest_43.843 8 (err=1.333)  
90.9 queries/sec
Query 13: actual 339 (0.049%)  origin-forest_43.843 222 (err=1.527)  
90.9 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.8 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 17: actual 328 (0.047%)  origin-forest_43.843 3 (err=109.333)  
76.9 queries/sec
Query 18: actual 32 (0.005%)  origin-forest_43.843 36 (err=1.125)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 22: actual 33 (0.005%)  origin-forest_43.843 15 (err=2.200)  
89.1 queries/sec
Query 23: actual 13 (0.002%)  origin-forest_43.843 1 (err=13.000)  
83.3 queries/sec
Query 24: actual 6262 (0.898%)  origin-forest_43.843 9494 (err=1.516)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 19 (0.003%)  origin-forest_43.843 12 (err=1.583)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 4 (0.001%)  origin-forest_43.843 4 (err=1.000)  
90.9 queries/sec
Query 29: actual 4910 (0.704%)  origin-forest_43.843 3867 (err=1.270)  
90.9 queries/sec
Query 30: actual 76 (0.011%)  origin-forest_43.843 1 (err=76.000)  
83.3 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
64.5 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 35: actual 214 (0.031%)  origin-forest_43.843 73 (err=2.932)  
83.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.4 queries/sec
Query 38: actual 166510 (23.882%)  origin-forest_43.843 178338 (err=1.071)  
90.9 queries/sec
Query 39: actual 140 (0.020%)  origin-forest_43.843 209 (err=1.493)  
90.3 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 41: actual 765 (0.110%)  origin-forest_43.843 17 (err=45.000)  
90.9 queries/sec
Query 42: actual 4 (0.001%)  origin-forest_43.843 7 (err=1.750)  
90.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 44: actual 6 (0.001%)  origin-forest_43.843 8 (err=1.333)  
76.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 11862 (1.701%)  origin-forest_43.843 17370 (err=1.464)  
90.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.5 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 578.0000	99th: 348.3533	95th: 62.0500	median: 1.0980	mean: 18.8804
ReportEsts: [1.1361117268898249, 4.0, 1.2407743496672716, 19.0, 2.6853070175438596, 3.0, 21.0, 1.0, 578.0, 1.0, 26, 1.027634415182609, 1.3333333333333333, 1.527027027027027, 1.0, 1.0, 1.0, 109.33333333333333, 1.125, 1.0, 1.0, 1.0, 2.2, 13.0, 1.5161290322580645, 1.0, 1.5833333333333333, 1.0, 1.0, 1.269718127747608, 76.0, 1.0, 1.0, 1.0, 1.0, 2.9315068493150687, 1.0, 1.0, 1.0710347726863252, 1.4928571428571429, 1.0, 45.0, 1.75, 1.0, 1.3333333333333333, 1.0, 1.0, 1.464339908952959, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 19/50 | Workload-time: 3.989808 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 20/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 12
RandomSeedCommunicator.get: 12
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.0 queries/sec
Query 1: actual 6 (0.001%)  origin-forest_43.843 8 (err=1.333)  
83.3 queries/sec
Query 2: actual 633 (0.091%)  origin-forest_43.843 1 (err=633.000)  
83.3 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 4: actual 8 (0.001%)  origin-forest_43.843 6 (err=1.333)  
83.3 queries/sec
Query 5: actual 2 (0.000%)  origin-forest_43.843 4 (err=2.000)  
86.9 queries/sec
Query 6: actual 380 (0.055%)  origin-forest_43.843 386 (err=1.016)  
90.9 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 9: actual 167 (0.024%)  origin-forest_43.843 201 (err=1.204)  
90.9 queries/sec
Query 10: actual 42669 (6.120%)  origin-forest_43.843 49380 (err=1.157)  
90.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 12: actual 10545 (1.512%)  origin-forest_43.843 12412 (err=1.177)  
90.8 queries/sec
Query 13: actual 25423 (3.646%)  origin-forest_43.843 19657 (err=1.293)  
90.9 queries/sec
Query 14: actual 35 (0.005%)  origin-forest_43.843 1 (err=35.000)  
86.9 queries/sec
Query 15: actual 70 (0.010%)  origin-forest_43.843 216 (err=3.086)  
83.3 queries/sec
Query 16: actual 5847 (0.839%)  origin-forest_43.843 6852 (err=1.172)  
92.2 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.0 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 19: actual 42 (0.006%)  origin-forest_43.843 3 (err=14.000)  
76.9 queries/sec
Query 20: actual 161577 (23.175%)  origin-forest_43.843 139102 (err=1.162)  
58.8 queries/sec
Query 21: actual 71 (0.010%)  origin-forest_43.843 104 (err=1.465)  
68.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
75.6 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
91.4 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.7 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 1741 (0.250%)  origin-forest_43.843 1 (err=1741.000)  
90.9 queries/sec
Query 27: actual 195 (0.028%)  origin-forest_43.843 208 (err=1.067)  
83.3 queries/sec
Query 28: actual 1359 (0.195%)  origin-forest_43.843 1346 (err=1.010)  
90.9 queries/sec
Query 29: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 30: actual 5131 (0.736%)  origin-forest_43.843 3114 (err=1.648)  
64.5 queries/sec
Query 31: actual 111 (0.016%)  origin-forest_43.843 150 (err=1.351)  
100.0 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 35: actual 37 (0.005%)  origin-forest_43.843 9 (err=4.111)  
79.6 queries/sec
Query 36: actual 6 (0.001%)  origin-forest_43.843 5 (err=1.200)  
83.3 queries/sec
Query 37: actual 6 (0.001%)  origin-forest_43.843 4 (err=1.500)  
90.9 queries/sec
Query 38: actual 791 (0.113%)  origin-forest_43.843 942 (err=1.191)  
86.9 queries/sec
Query 39: actual 7 (0.001%)  origin-forest_43.843 4 (err=1.750)  
83.3 queries/sec
Query 40: actual 1512 (0.217%)  origin-forest_43.843 3336 (err=2.206)  
83.3 queries/sec
Query 41: actual 52 (0.007%)  origin-forest_43.843 0 (err=52.000)  
83.3 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 43: actual 9 (0.001%)  origin-forest_43.843 2 (err=4.500)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.0 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 49: actual 156933 (22.509%)  origin-forest_43.843 123171 (err=1.274)  
origin-forest_43.843 	max: 1741.0000	99th: 1198.0800	95th: 44.3500	median: 1.1667	mean: 50.7441
ReportEsts: [1.0, 1.3333333333333333, 633.0, 1.0, 1.3333333333333333, 2.0, 1.0157894736842106, 1.0, 1.0, 1.2035928143712575, 1.1572804612247767, 1.0, 1.1770507349454717, 1.2933306201353207, 35.0, 3.085714285714286, 1.1718830169317598, 1.0, 1.0, 14.0, 1.1615720837946255, 1.4647887323943662, 1.0, 1.0, 1.0, 1.0, 1741.0, 1.0666666666666667, 1.0096582466567607, 2.0, 1.6477199743095696, 1.3513513513513513, 1.0, 1.0, 1.0, 4.111111111111111, 1.2, 1.5, 1.190897597977244, 1.75, 2.2063492063492065, 52, 1.0, 4.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.2741067296685096]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 20/50 | Workload-time: 4.014090 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 21/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 13
RandomSeedCommunicator.get: 13
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
41.7 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 2: actual 12128 (1.739%)  origin-forest_43.843 2902 (err=4.179)  
90.9 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 4: actual 8 (0.001%)  origin-forest_43.843 13 (err=1.625)  
83.3 queries/sec
Query 5: actual 146 (0.021%)  origin-forest_43.843 99 (err=1.475)  
90.9 queries/sec
Query 6: actual 31786 (4.559%)  origin-forest_43.843 38170 (err=1.201)  
90.5 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
100.0 queries/sec
Query 8: actual 11308 (1.622%)  origin-forest_43.843 5735 (err=1.972)  
90.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 10: actual 59 (0.008%)  origin-forest_43.843 120 (err=2.034)  
90.9 queries/sec
Query 11: actual 14574 (2.090%)  origin-forest_43.843 23 (err=633.652)  
90.9 queries/sec
Query 12: actual 854 (0.122%)  origin-forest_43.843 1441 (err=1.687)  
76.9 queries/sec
Query 13: actual 8 (0.001%)  origin-forest_43.843 12 (err=1.500)  
90.2 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 15: actual 335 (0.048%)  origin-forest_43.843 292 (err=1.147)  
86.9 queries/sec
Query 16: actual 7 (0.001%)  origin-forest_43.843 48 (err=6.857)  
90.9 queries/sec
Query 17: actual 95 (0.014%)  origin-forest_43.843 1 (err=95.000)  
83.3 queries/sec
Query 18: actual 4247 (0.609%)  origin-forest_43.843 1956 (err=2.171)  
83.4 queries/sec
Query 19: actual 87 (0.012%)  origin-forest_43.843 2 (err=43.500)  
100.0 queries/sec
Query 20: actual 59035 (8.467%)  origin-forest_43.843 72784 (err=1.233)  
90.9 queries/sec
Query 21: actual 7 (0.001%)  origin-forest_43.843 2 (err=3.500)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.0 queries/sec
Query 25: actual 232 (0.033%)  origin-forest_43.843 35 (err=6.629)  
90.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 13 (0.002%)  origin-forest_43.843 9 (err=1.444)  
90.9 queries/sec
Query 29: actual 27 (0.004%)  origin-forest_43.843 1 (err=27.000)  
83.3 queries/sec
Query 30: actual 36 (0.005%)  origin-forest_43.843 1 (err=36.000)  
76.9 queries/sec
Query 31: actual 501 (0.072%)  origin-forest_43.843 618 (err=1.234)  
83.3 queries/sec
Query 32: actual 57 (0.008%)  origin-forest_43.843 1 (err=57.000)  
66.1 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 31 (err=2.067)  
83.3 queries/sec
Query 34: actual 26 (0.004%)  origin-forest_43.843 1 (err=26.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 37: actual 3379 (0.485%)  origin-forest_43.843 4334 (err=1.283)  
94.8 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 175 (0.025%)  origin-forest_43.843 168 (err=1.042)  
100.0 queries/sec
Query 40: actual 3 (0.000%)  origin-forest_43.843 3 (err=1.000)  
83.3 queries/sec
Query 41: actual 76945 (11.036%)  origin-forest_43.843 77548 (err=1.008)  
86.9 queries/sec
Query 42: actual 2 (0.000%)  origin-forest_43.843 4 (err=2.000)  
83.3 queries/sec
Query 43: actual 19 (0.003%)  origin-forest_43.843 11 (err=1.727)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 9 (0.001%)  origin-forest_43.843 10 (err=1.111)  
83.3 queries/sec
Query 46: actual 12212 (1.752%)  origin-forest_43.843 14748 (err=1.208)  
90.9 queries/sec
Query 47: actual 12503 (1.793%)  origin-forest_43.843 14291 (err=1.143)  
100.0 queries/sec
Query 48: actual 7 (0.001%)  origin-forest_43.843 2 (err=3.500)  
90.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 633.6522	99th: 369.7126	95th: 50.9250	median: 1.2581	mean: 19.8426
ReportEsts: [1.0, 1.0, 4.179186767746382, 1.0, 1.625, 1.4747474747474747, 1.2008431384886429, 2.0, 1.9717523975588491, 1.0, 2.0338983050847457, 633.6521739130435, 1.6873536299765808, 1.5, 1.0, 1.1472602739726028, 6.857142857142857, 95.0, 2.1712678936605316, 43.5, 1.2328957398153637, 3.5, 1.0, 1.0, 1.0, 6.628571428571429, 1.0, 1.0, 1.4444444444444444, 27.0, 36.0, 1.2335329341317365, 57.0, 2.066666666666667, 26.0, 1.0, 1.0, 1.2826279964486536, 1.0, 1.0416666666666667, 1.0, 1.0078367665215413, 2.0, 1.7272727272727273, 1.0, 1.1111111111111112, 1.2076645922043892, 1.143005678637127, 3.5, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 21/50 | Workload-time: 3.972018 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 22/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 14
RandomSeedCommunicator.get: 14
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
42.5 queries/sec
Query 1: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
76.9 queries/sec
Query 2: actual 349 (0.050%)  origin-forest_43.843 437 (err=1.252)  
83.3 queries/sec
Query 3: actual 129 (0.019%)  origin-forest_43.843 130 (err=1.008)  
90.2 queries/sec
Query 4: actual 1181 (0.169%)  origin-forest_43.843 1030 (err=1.147)  
83.3 queries/sec
Query 5: actual 145 (0.021%)  origin-forest_43.843 75 (err=1.933)  
76.9 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 8: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 9: actual 64 (0.009%)  origin-forest_43.843 2 (err=32.000)  
83.3 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 14: actual 10 (0.001%)  origin-forest_43.843 3 (err=3.333)  
76.9 queries/sec
Query 15: actual 2472 (0.355%)  origin-forest_43.843 2666 (err=1.078)  
83.3 queries/sec
Query 16: actual 334 (0.048%)  origin-forest_43.843 415 (err=1.243)  
83.0 queries/sec
Query 17: actual 6959 (0.998%)  origin-forest_43.843 7921 (err=1.138)  
100.0 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 19 (0.003%)  origin-forest_43.843 12 (err=1.583)  
76.9 queries/sec
Query 20: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.0 queries/sec
Query 25: actual 47 (0.007%)  origin-forest_43.843 1 (err=47.000)  
100.0 queries/sec
Query 26: actual 2914 (0.418%)  origin-forest_43.843 3608 (err=1.238)  
90.9 queries/sec
Query 27: actual 16 (0.002%)  origin-forest_43.843 1 (err=16.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 30: actual 36 (0.005%)  origin-forest_43.843 1 (err=36.000)  
76.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 27 (0.004%)  origin-forest_43.843 14 (err=1.929)  
66.4 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 99 (0.014%)  origin-forest_43.843 1 (err=99.000)  
83.3 queries/sec
Query 36: actual 191 (0.027%)  origin-forest_43.843 1 (err=191.000)  
83.3 queries/sec
Query 37: actual 2147 (0.308%)  origin-forest_43.843 74 (err=29.014)  
86.3 queries/sec
Query 38: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
90.9 queries/sec
Query 39: actual 171 (0.025%)  origin-forest_43.843 33 (err=5.182)  
90.9 queries/sec
Query 40: actual 198 (0.028%)  origin-forest_43.843 168 (err=1.179)  
90.9 queries/sec
Query 41: actual 555 (0.080%)  origin-forest_43.843 736 (err=1.326)  
86.9 queries/sec
Query 42: actual 131 (0.019%)  origin-forest_43.843 74 (err=1.770)  
90.9 queries/sec
Query 43: actual 3 (0.000%)  origin-forest_43.843 4 (err=1.333)  
90.9 queries/sec
Query 44: actual 1341 (0.192%)  origin-forest_43.843 727 (err=1.845)  
100.0 queries/sec
Query 45: actual 101 (0.014%)  origin-forest_43.843 134 (err=1.327)  
76.9 queries/sec
Query 46: actual 95 (0.014%)  origin-forest_43.843 69 (err=1.377)  
90.9 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 191.0000	99th: 145.9200	95th: 42.0500	median: 1.1626	mean: 10.2247
ReportEsts: [1.0, 3.0, 1.2521489971346704, 1.0077519379844961, 1.1466019417475728, 1.9333333333333333, 1.0, 1.0, 2.0, 32.0, 1.0, 1.0, 3.0, 1.0, 3.3333333333333335, 1.0784789644012944, 1.2425149700598803, 1.1382382526225032, 1.0, 1.5833333333333333, 1.0, 1.0, 1.0, 1.0, 1.0, 47.0, 1.2381606039807824, 16.0, 1.0, 1.0, 36.0, 1.0, 1.9285714285714286, 1.0, 1.0, 99.0, 191.0, 29.013513513513512, 1.0, 5.181818181818182, 1.1785714285714286, 1.3261261261261261, 1.7702702702702702, 1.3333333333333333, 1.8445667125171938, 1.3267326732673268, 1.3768115942028984, 1.0, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 22/50 | Workload-time: 4.003206 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 23/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (661012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 42.5141
detection mean = 43.4464
detection threshold = 0.3480
test statistic = 0.9323
Offline time = 2.880373239517212
Online time = 0.48137950897216797
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 23-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (661012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 661012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.0761 bits (loss 61.971, data 18.895) 0.00100 lr
epoch 9 train loss 42.7047 nats / 61.6098 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.8105 bits (loss 61.706, data 18.895) 0.00082 lr
epoch 19 train loss 42.5678 nats / 61.4123 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 40.4144 nats / 58.3056 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 23/50 | Workload-time: 6.484176 | Model-update-time: 10.166364


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 24/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (671012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 42.0110
detection mean = 43.6060
detection threshold = 0.3602
test statistic = 1.5950
Offline time = 2.859067916870117
Online time = 0.4721229076385498
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 24-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (671012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 671012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.1911 bits (loss 62.043, data 18.852) 0.00100 lr
epoch 9 train loss 42.6342 nats / 61.5082 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.7087 bits (loss 61.560, data 18.852) 0.00082 lr
epoch 19 train loss 42.5124 nats / 61.3324 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 39.9796 nats / 57.6784 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 24/50 | Workload-time: 6.437223 | Model-update-time: 10.263529


WORKLOAD-START | Type: QueryWorkload | Progress: 25/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 15
RandomSeedCommunicator.get: 15
Query 0: actual 60725 (8.710%)  origin-forest_43.843 19428 (err=3.126)  
43.5 queries/sec
Query 1: actual 1234 (0.177%)  origin-forest_43.843 1229 (err=1.004)  
90.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 3: actual 1480 (0.212%)  origin-forest_43.843 1007 (err=1.470)  
71.4 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
95.2 queries/sec
Query 5: actual 47 (0.007%)  origin-forest_43.843 1 (err=47.000)  
76.9 queries/sec
Query 6: actual 37 (0.005%)  origin-forest_43.843 35 (err=1.057)  
79.0 queries/sec
Query 7: actual 124 (0.018%)  origin-forest_43.843 137 (err=1.105)  
94.3 queries/sec
Query 8: actual 11 (0.002%)  origin-forest_43.843 2 (err=5.500)  
76.9 queries/sec
Query 9: actual 17 (0.002%)  origin-forest_43.843 11 (err=1.545)  
83.3 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 11: actual 6 (0.001%)  origin-forest_43.843 7 (err=1.167)  
83.3 queries/sec
Query 12: actual 894 (0.128%)  origin-forest_43.843 1430 (err=1.600)  
80.0 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.7 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
91.3 queries/sec
Query 15: actual 140 (0.020%)  origin-forest_43.843 59 (err=2.373)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 20: actual 138219 (19.824%)  origin-forest_43.843 122846 (err=1.125)  
90.9 queries/sec
Query 21: actual 36 (0.005%)  origin-forest_43.843 21 (err=1.714)  
86.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 67 (0.010%)  origin-forest_43.843 2 (err=33.500)  
83.3 queries/sec
Query 24: actual 251 (0.036%)  origin-forest_43.843 11 (err=22.818)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 26: actual 2 (0.000%)  origin-forest_43.843 6 (err=3.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 28: actual 156 (0.022%)  origin-forest_43.843 240 (err=1.538)  
90.9 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.6 queries/sec
Query 30: actual 108 (0.015%)  origin-forest_43.843 105 (err=1.029)  
83.3 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 15 (0.002%)  origin-forest_43.843 16 (err=1.067)  
90.9 queries/sec
Query 33: actual 297 (0.043%)  origin-forest_43.843 420 (err=1.414)  
90.9 queries/sec
Query 34: actual 1490 (0.214%)  origin-forest_43.843 1836 (err=1.232)  
90.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 37: actual 41869 (6.005%)  origin-forest_43.843 47909 (err=1.144)  
90.9 queries/sec
Query 38: actual 43969 (6.306%)  origin-forest_43.843 25912 (err=1.697)  
95.2 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 18989 (2.724%)  origin-forest_43.843 22051 (err=1.161)  
90.9 queries/sec
Query 41: actual 66 (0.009%)  origin-forest_43.843 59 (err=1.119)  
90.9 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 43: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
90.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 45: actual 31 (0.004%)  origin-forest_43.843 25 (err=1.240)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 48: actual 6810 (0.977%)  origin-forest_43.843 3985 (err=1.709)  
90.9 queries/sec
Query 49: actual 629 (0.090%)  origin-forest_43.843 578 (err=1.088)  
origin-forest_43.843 	max: 47.0000	99th: 40.3850	95th: 15.0250	median: 1.0775	mean: 3.3408
ReportEsts: [3.125643401276508, 1.0040683482506103, 1.0, 1.4697120158887786, 1.0, 47.0, 1.0571428571428572, 1.1048387096774193, 5.5, 1.5454545454545454, 1.0, 1.1666666666666667, 1.599552572706935, 1.0, 1.0, 2.3728813559322033, 1.0, 1.0, 1.0, 1.0, 1.1251404197124855, 1.7142857142857142, 1.0, 33.5, 22.818181818181817, 1.0, 3.0, 1.0, 1.5384615384615385, 1.0, 1.0285714285714285, 1.0, 1.0666666666666667, 1.4141414141414141, 1.2322147651006712, 1.0, 1.0, 1.1442594759846187, 1.6968585983328188, 1.0, 1.1612512507241035, 1.11864406779661, 1.0, 1.5, 1.0, 1.24, 1.0, 1.0, 1.7089084065244668, 1.088235294117647]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 25/50 | Workload-time: 3.996707 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 26/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (681012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 41.5880
detection mean = 43.7577
detection threshold = 0.3941
test statistic = 2.1696
Offline time = 2.873037576675415
Online time = 0.4647064208984375
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 26-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (681012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 681012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.1155 bits (loss 61.923, data 18.807) 0.00100 lr
epoch 9 train loss 42.6015 nats / 61.4610 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.7040 bits (loss 61.511, data 18.807) 0.00082 lr
epoch 19 train loss 42.4897 nats / 61.2996 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 39.6151 nats / 57.1526 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 26/50 | Workload-time: 6.462669 | Model-update-time: 10.194177


WORKLOAD-START | Type: QueryWorkload | Progress: 27/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 16
RandomSeedCommunicator.get: 16
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
43.5 queries/sec
Query 1: actual 12327 (1.768%)  origin-forest_43.843 7485 (err=1.647)  
83.3 queries/sec
Query 2: actual 104 (0.015%)  origin-forest_43.843 121 (err=1.163)  
90.9 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 4: actual 3703 (0.531%)  origin-forest_43.843 4770 (err=1.288)  
83.3 queries/sec
Query 5: actual 11 (0.002%)  origin-forest_43.843 8 (err=1.375)  
83.3 queries/sec
Query 6: actual 2 (0.000%)  origin-forest_43.843 5 (err=2.500)  
90.9 queries/sec
Query 7: actual 123 (0.018%)  origin-forest_43.843 75 (err=1.640)  
81.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 9: actual 52 (0.007%)  origin-forest_43.843 50 (err=1.040)  
90.9 queries/sec
Query 10: actual 99292 (14.241%)  origin-forest_43.843 107302 (err=1.081)  
90.9 queries/sec
Query 11: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 12: actual 42698 (6.124%)  origin-forest_43.843 48037 (err=1.125)  
90.9 queries/sec
Query 13: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
90.9 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 3 (err=3.000)  
76.9 queries/sec
Query 15: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
79.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 19: actual 305 (0.044%)  origin-forest_43.843 480 (err=1.574)  
83.3 queries/sec
Query 20: actual 341 (0.049%)  origin-forest_43.843 77 (err=4.429)  
83.3 queries/sec
Query 21: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 6 (0.001%)  origin-forest_43.843 5 (err=1.200)  
83.3 queries/sec
Query 24: actual 1518 (0.218%)  origin-forest_43.843 1905 (err=1.255)  
95.1 queries/sec
Query 25: actual 5 (0.001%)  origin-forest_43.843 7 (err=1.400)  
83.3 queries/sec
Query 26: actual 6 (0.001%)  origin-forest_43.843 20 (err=3.333)  
83.3 queries/sec
Query 27: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
57.4 queries/sec
Query 30: actual 37 (0.005%)  origin-forest_43.843 1 (err=37.000)  
78.2 queries/sec
Query 31: actual 2099 (0.301%)  origin-forest_43.843 2295 (err=1.093)  
90.9 queries/sec
Query 32: actual 11 (0.002%)  origin-forest_43.843 1 (err=11.000)  
86.9 queries/sec
Query 33: actual 14813 (2.125%)  origin-forest_43.843 11834 (err=1.252)  
90.9 queries/sec
Query 34: actual 43 (0.006%)  origin-forest_43.843 1 (err=43.000)  
76.9 queries/sec
Query 35: actual 220449 (31.619%)  origin-forest_43.843 211932 (err=1.040)  
86.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 5 (0.001%)  origin-forest_43.843 3 (err=1.667)  
83.3 queries/sec
Query 43: actual 611 (0.088%)  origin-forest_43.843 888 (err=1.453)  
90.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 177 (0.025%)  origin-forest_43.843 145 (err=1.221)  
90.9 queries/sec
Query 47: actual 104 (0.015%)  origin-forest_43.843 137 (err=1.317)  
90.8 queries/sec
Query 48: actual 866 (0.124%)  origin-forest_43.843 899 (err=1.038)  
95.2 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 43.0000	99th: 40.0600	95th: 8.0429	median: 1.1443	mean: 3.2226
ReportEsts: [1.0, 1.6468937875751504, 1.1634615384615385, 1.0, 1.2881447475020253, 1.375, 2.5, 1.64, 1.0, 1.04, 1.0806711517544214, 2.0, 1.1250409855262542, 3.0, 3.0, 3.0, 1.0, 1.0, 1.0, 1.5737704918032787, 4.428571428571429, 1.0, 1.0, 1.2, 1.2549407114624507, 1.4, 3.3333333333333335, 4.0, 1.0, 1.0, 37.0, 1.0933777989518818, 11.0, 1.2517322967720128, 43.0, 1.0401874186059679, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.6666666666666667, 1.453355155482815, 1.0, 1.0, 1.2206896551724138, 1.3173076923076923, 1.03810623556582, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 27/50 | Workload-time: 4.032176 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 28/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (691012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 41.2656
detection mean = 43.8891
detection threshold = 0.4195
test statistic = 2.6236
Offline time = 2.882676839828491
Online time = 0.48594117164611816
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 28-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (691012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 691012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.0100 bits (loss 61.772, data 18.762) 0.00100 lr
epoch 9 train loss 42.5499 nats / 61.3865 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.6021 bits (loss 61.364, data 18.762) 0.00082 lr
epoch 19 train loss 42.4400 nats / 61.2279 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 39.2777 nats / 56.6657 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 28/50 | Workload-time: 6.491023 | Model-update-time: 10.217136


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 29/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (701012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 40.9432
detection mean = 44.0154
detection threshold = 0.4430
test statistic = 3.0722
Offline time = 2.8542487621307373
Online time = 0.49401354789733887
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 29-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (701012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 701012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.1677 bits (loss 61.884, data 18.717) 0.00100 lr
epoch 9 train loss 42.5638 nats / 61.4066 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 43.0425 bits (loss 61.759, data 18.717) 0.00082 lr
epoch 19 train loss 42.4286 nats / 61.2115 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 38.9934 nats / 56.2556 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 29/50 | Workload-time: 6.508421 | Model-update-time: 10.236626


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 30/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (711012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 40.7035
detection mean = 44.1136
detection threshold = 0.4839
test statistic = 3.4102
Offline time = 2.8896420001983643
Online time = 0.4902970790863037
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 30-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (711012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 711012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.2044 bits (loss 61.876, data 18.671) 0.00100 lr
epoch 9 train loss 42.4902 nats / 61.3004 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.6297 bits (loss 61.301, data 18.671) 0.00082 lr
epoch 19 train loss 42.3600 nats / 61.1126 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 38.7429 nats / 55.8942 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 30/50 | Workload-time: 6.496847 | Model-update-time: 10.245813


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 31/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (721012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 40.4732
detection mean = 44.2025
detection threshold = 0.5155
test statistic = 3.7293
Offline time = 2.918813943862915
Online time = 0.5076773166656494
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 31-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (721012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 721012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.3342 bits (loss 61.960, data 18.626) 0.00100 lr
epoch 9 train loss 42.4192 nats / 61.1980 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.8070 bits (loss 61.433, data 18.626) 0.00082 lr
epoch 19 train loss 42.3017 nats / 61.0285 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 38.4875 nats / 55.5257 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 31/50 | Workload-time: 6.633657 | Model-update-time: 10.218865


WORKLOAD-START | Type: QueryWorkload | Progress: 32/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 17
RandomSeedCommunicator.get: 17
Query 0: actual 13463 (1.931%)  origin-forest_43.843 16994 (err=1.262)  
43.5 queries/sec
Query 1: actual 628 (0.090%)  origin-forest_43.843 635 (err=1.011)  
90.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 3: actual 5 (0.001%)  origin-forest_43.843 7 (err=1.400)  
79.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 4 (err=4.000)  
90.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 4 (0.001%)  origin-forest_43.843 2 (err=2.000)  
90.9 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 8: actual 35 (0.005%)  origin-forest_43.843 38 (err=1.086)  
90.9 queries/sec
Query 9: actual 3 (0.000%)  origin-forest_43.843 4 (err=1.333)  
76.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 12: actual 17 (0.002%)  origin-forest_43.843 25 (err=1.471)  
83.3 queries/sec
Query 13: actual 260 (0.037%)  origin-forest_43.843 60 (err=4.333)  
83.3 queries/sec
Query 14: actual 1814 (0.260%)  origin-forest_43.843 1622 (err=1.118)  
90.9 queries/sec
Query 15: actual 65 (0.009%)  origin-forest_43.843 79 (err=1.215)  
90.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.8 queries/sec
Query 20: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
74.0 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 946 (0.136%)  origin-forest_43.843 1509 (err=1.595)  
90.9 queries/sec
Query 23: actual 519 (0.074%)  origin-forest_43.843 435 (err=1.193)  
76.9 queries/sec
Query 24: actual 3 (0.000%)  origin-forest_43.843 12 (err=4.000)  
71.4 queries/sec
Query 25: actual 39 (0.006%)  origin-forest_43.843 48 (err=1.231)  
83.3 queries/sec
Query 26: actual 7187 (1.031%)  origin-forest_43.843 8569 (err=1.192)  
90.9 queries/sec
Query 27: actual 103 (0.015%)  origin-forest_43.843 124 (err=1.204)  
83.3 queries/sec
Query 28: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
86.9 queries/sec
Query 29: actual 45 (0.006%)  origin-forest_43.843 43 (err=1.047)  
94.4 queries/sec
Query 30: actual 341 (0.049%)  origin-forest_43.843 464 (err=1.361)  
90.9 queries/sec
Query 31: actual 23 (0.003%)  origin-forest_43.843 28 (err=1.217)  
90.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 34: actual 15 (0.002%)  origin-forest_43.843 30 (err=2.000)  
90.9 queries/sec
Query 35: actual 5 (0.001%)  origin-forest_43.843 2 (err=2.500)  
83.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 38: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 11433 (1.640%)  origin-forest_43.843 14100 (err=1.233)  
90.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 42: actual 25090 (3.599%)  origin-forest_43.843 29730 (err=1.185)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 141 (0.020%)  origin-forest_43.843 1 (err=141.000)  
83.3 queries/sec
Query 45: actual 65 (0.009%)  origin-forest_43.843 44 (err=1.477)  
86.9 queries/sec
Query 46: actual 12 (0.002%)  origin-forest_43.843 27 (err=2.250)  
90.9 queries/sec
Query 47: actual 202 (0.029%)  origin-forest_43.843 156 (err=1.295)  
90.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 141.0000	99th: 74.0333	95th: 4.0000	median: 1.1927	mean: 4.2442
ReportEsts: [1.2622743816385649, 1.0111464968152866, 1.0, 1.4, 4.0, 1.0, 2.0, 1.0, 1.0857142857142856, 1.3333333333333333, 1.0, 1.0, 1.4705882352941178, 4.333333333333333, 1.1183723797780518, 1.2153846153846153, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.595137420718816, 1.193103448275862, 4.0, 1.2307692307692308, 1.1922916376791428, 1.203883495145631, 1.0, 1.0465116279069768, 1.3607038123167154, 1.2173913043478262, 1.0, 2.0, 2.0, 2.5, 1.0, 1.0, 2.0, 1.0, 1.2332721070585149, 1.0, 1.1849342367477083, 1.0, 141.0, 1.4772727272727273, 2.25, 1.294871794871795, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 32/50 | Workload-time: 4.026387 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 33/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 18
RandomSeedCommunicator.get: 18
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.8 queries/sec
Query 1: actual 8 (0.001%)  origin-forest_43.843 19 (err=2.375)  
83.3 queries/sec
Query 2: actual 298 (0.043%)  origin-forest_43.843 160 (err=1.863)  
90.9 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 4: actual 13499 (1.936%)  origin-forest_43.843 17368 (err=1.287)  
89.6 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.2 queries/sec
Query 6: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
83.3 queries/sec
Query 7: actual 955 (0.137%)  origin-forest_43.843 1380 (err=1.445)  
90.8 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 9: actual 6 (0.001%)  origin-forest_43.843 4 (err=1.500)  
86.9 queries/sec
Query 10: actual 144 (0.021%)  origin-forest_43.843 4 (err=36.000)  
83.3 queries/sec
Query 11: actual 35 (0.005%)  origin-forest_43.843 1 (err=35.000)  
83.3 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 13: actual 34 (0.005%)  origin-forest_43.843 1 (err=34.000)  
83.3 queries/sec
Query 14: actual 358 (0.051%)  origin-forest_43.843 296 (err=1.209)  
100.0 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
95.1 queries/sec
Query 18: actual 5500 (0.789%)  origin-forest_43.843 3703 (err=1.485)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 20: actual 233770 (33.529%)  origin-forest_43.843 229747 (err=1.018)  
83.3 queries/sec
Query 21: actual 8202 (1.176%)  origin-forest_43.843 8720 (err=1.063)  
71.4 queries/sec
Query 22: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
76.9 queries/sec
Query 23: actual 104 (0.015%)  origin-forest_43.843 140 (err=1.346)  
90.9 queries/sec
Query 24: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 26: actual 21 (0.003%)  origin-forest_43.843 56 (err=2.667)  
93.8 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 4 (err=4.000)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 30: actual 21535 (3.089%)  origin-forest_43.843 25260 (err=1.173)  
90.9 queries/sec
Query 31: actual 29 (0.004%)  origin-forest_43.843 32 (err=1.103)  
83.3 queries/sec
Query 32: actual 11 (0.002%)  origin-forest_43.843 4 (err=2.750)  
83.3 queries/sec
Query 33: actual 605 (0.087%)  origin-forest_43.843 738 (err=1.220)  
90.9 queries/sec
Query 34: actual 201 (0.029%)  origin-forest_43.843 182 (err=1.104)  
86.9 queries/sec
Query 35: actual 446 (0.064%)  origin-forest_43.843 315 (err=1.416)  
90.9 queries/sec
Query 36: actual 5 (0.001%)  origin-forest_43.843 1 (err=5.000)  
83.3 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 32625 (4.679%)  origin-forest_43.843 23779 (err=1.372)  
90.9 queries/sec
Query 40: actual 282 (0.040%)  origin-forest_43.843 288 (err=1.021)  
90.9 queries/sec
Query 41: actual 989 (0.142%)  origin-forest_43.843 1306 (err=1.321)  
90.9 queries/sec
Query 42: actual 3799 (0.545%)  origin-forest_43.843 2528 (err=1.503)  
90.9 queries/sec
Query 43: actual 14 (0.002%)  origin-forest_43.843 15 (err=1.071)  
86.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 107 (0.015%)  origin-forest_43.843 169 (err=1.579)  
90.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 14271 (2.047%)  origin-forest_43.843 8894 (err=1.605)  
100.0 queries/sec
Query 48: actual 11 (0.002%)  origin-forest_43.843 9 (err=1.222)  
71.4 queries/sec
Query 49: actual 46 (0.007%)  origin-forest_43.843 58 (err=1.261)  
origin-forest_43.843 	max: 62.0000	99th: 49.2600	95th: 34.5500	median: 1.2210	mean: 4.7396
ReportEsts: [1.0, 2.375, 1.8625, 1.0, 1.2866138232461664, 1.0, 4.0, 1.4450261780104712, 1.0, 1.5, 36.0, 35.0, 1.0, 34.0, 1.2094594594594594, 1.0, 1.0, 1.0, 1.4852822036186875, 1.0, 1.0175105659703936, 1.0631553279687882, 3.0, 1.3461538461538463, 62.0, 1.0, 2.6666666666666665, 1.0, 4.0, 1.0, 1.1729742280009288, 1.103448275862069, 2.75, 1.2198347107438017, 1.1043956043956045, 1.415873015873016, 5.0, 1.0, 1.0, 1.3720089154295807, 1.0212765957446808, 1.320525783619818, 1.5027689873417722, 1.0714285714285714, 1.0, 1.5794392523364487, 1.0, 1.6045648751967618, 1.2222222222222223, 1.2608695652173914]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 33/50 | Workload-time: 4.024767 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 34/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 19
RandomSeedCommunicator.get: 19
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.0 queries/sec
Query 1: actual 31665 (4.542%)  origin-forest_43.843 37087 (err=1.171)  
83.3 queries/sec
Query 2: actual 17 (0.002%)  origin-forest_43.843 8 (err=2.125)  
76.9 queries/sec
Query 3: actual 10 (0.001%)  origin-forest_43.843 2 (err=5.000)  
83.3 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 5: actual 8932 (1.281%)  origin-forest_43.843 13701 (err=1.534)  
76.9 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.7 queries/sec
Query 7: actual 132 (0.019%)  origin-forest_43.843 152 (err=1.152)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 71707 (10.285%)  origin-forest_43.843 80319 (err=1.120)  
90.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 13: actual 82 (0.012%)  origin-forest_43.843 46 (err=1.783)  
83.3 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.6 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
52.6 queries/sec
Query 18: actual 2496 (0.358%)  origin-forest_43.843 2852 (err=1.143)  
76.9 queries/sec
Query 19: actual 32501 (4.662%)  origin-forest_43.843 44747 (err=1.377)  
83.3 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
73.6 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 25: actual 129 (0.019%)  origin-forest_43.843 184 (err=1.426)  
83.3 queries/sec
Query 26: actual 296 (0.042%)  origin-forest_43.843 308 (err=1.041)  
83.3 queries/sec
Query 27: actual 10 (0.001%)  origin-forest_43.843 2 (err=5.000)  
83.4 queries/sec
Query 28: actual 83 (0.012%)  origin-forest_43.843 1 (err=83.000)  
80.8 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
76.6 queries/sec
Query 30: actual 55 (0.008%)  origin-forest_43.843 76 (err=1.382)  
76.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 32: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 33: actual 17232 (2.472%)  origin-forest_43.843 21644 (err=1.256)  
76.0 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.1 queries/sec
Query 35: actual 146610 (21.028%)  origin-forest_43.843 110856 (err=1.323)  
83.3 queries/sec
Query 36: actual 164 (0.024%)  origin-forest_43.843 245 (err=1.494)  
90.8 queries/sec
Query 37: actual 15 (0.002%)  origin-forest_43.843 4 (err=3.750)  
68.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
45.5 queries/sec
Query 41: actual 302 (0.043%)  origin-forest_43.843 35 (err=8.629)  
43.5 queries/sec
Query 42: actual 2366 (0.339%)  origin-forest_43.843 989 (err=2.392)  
58.8 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
61.9 queries/sec
Query 44: actual 81 (0.012%)  origin-forest_43.843 67 (err=1.209)  
83.3 queries/sec
Query 45: actual 5851 (0.839%)  origin-forest_43.843 8193 (err=1.400)  
90.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 48: actual 140 (0.020%)  origin-forest_43.843 125 (err=1.120)  
83.3 queries/sec
Query 49: actual 412 (0.059%)  origin-forest_43.843 349 (err=1.181)  
origin-forest_43.843 	max: 83.0000	99th: 46.5580	95th: 5.0000	median: 1.0803	mean: 3.2001
ReportEsts: [1.0, 1.1712300647402494, 2.125, 5.0, 1.0, 1.5339229735781459, 1.0, 1.1515151515151516, 1.0, 1.120099850781653, 1.0, 1.0, 1.0, 1.7826086956521738, 1.0, 1.0, 1.0, 1.0, 1.142628205128205, 1.3767884065105689, 1.0, 1.0, 1.0, 1.0, 1.0, 1.426356589147287, 1.0405405405405406, 5.0, 83.0, 2.0, 1.3818181818181818, 1.0, 2.0, 1.2560352831940576, 1.0, 1.3225265208919679, 1.4939024390243902, 3.75, 1.0, 1.0, 1.0, 8.628571428571428, 2.3923154701718907, 1.0, 1.208955223880597, 1.4002734575286275, 1.0, 1.0, 1.12, 1.180515759312321]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 34/50 | Workload-time: 4.128143 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 35/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (731012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 40.2830
detection mean = 44.2839
detection threshold = 0.5326
test statistic = 4.0009
Offline time = 2.887645721435547
Online time = 0.5110297203063965
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 35-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (731012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 731012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.0691 bits (loss 61.649, data 18.580) 0.00100 lr
epoch 9 train loss 42.4411 nats / 61.2296 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.7961 bits (loss 61.376, data 18.580) 0.00082 lr
epoch 19 train loss 42.3033 nats / 61.0307 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 38.2058 nats / 55.1194 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 35/50 | Workload-time: 6.622552 | Model-update-time: 10.329779


WORKLOAD-START | Type: QueryWorkload | Progress: 36/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 20
RandomSeedCommunicator.get: 20
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
41.7 queries/sec
Query 1: actual 29 (0.004%)  origin-forest_43.843 38 (err=1.310)  
86.8 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 3: actual 58 (0.008%)  origin-forest_43.843 2 (err=29.000)  
90.9 queries/sec
Query 4: actual 348 (0.050%)  origin-forest_43.843 26 (err=13.385)  
66.7 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 6: actual 2205 (0.316%)  origin-forest_43.843 2134 (err=1.033)  
83.3 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 8: actual 61 (0.009%)  origin-forest_43.843 1 (err=61.000)  
83.3 queries/sec
Query 9: actual 66 (0.009%)  origin-forest_43.843 7 (err=9.429)  
82.6 queries/sec
Query 10: actual 19 (0.003%)  origin-forest_43.843 5 (err=3.800)  
83.4 queries/sec
Query 11: actual 3 (0.000%)  origin-forest_43.843 3 (err=1.000)  
83.3 queries/sec
Query 12: actual 36 (0.005%)  origin-forest_43.843 1 (err=36.000)  
90.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 14: actual 50 (0.007%)  origin-forest_43.843 57 (err=1.140)  
83.3 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 16: actual 47 (0.007%)  origin-forest_43.843 1 (err=47.000)  
76.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 18: actual 5 (0.001%)  origin-forest_43.843 8 (err=1.600)  
90.5 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.5 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
84.4 queries/sec
Query 21: actual 86580 (12.418%)  origin-forest_43.843 39004 (err=2.220)  
87.7 queries/sec
Query 22: actual 14 (0.002%)  origin-forest_43.843 30 (err=2.143)  
83.3 queries/sec
Query 23: actual 34 (0.005%)  origin-forest_43.843 31 (err=1.097)  
90.9 queries/sec
Query 24: actual 633 (0.091%)  origin-forest_43.843 605 (err=1.046)  
83.3 queries/sec
Query 25: actual 327 (0.047%)  origin-forest_43.843 991 (err=3.031)  
100.0 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 27: actual 127960 (18.353%)  origin-forest_43.843 152476 (err=1.192)  
100.0 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 30: actual 148340 (21.276%)  origin-forest_43.843 177362 (err=1.196)  
90.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 32: actual 10 (0.001%)  origin-forest_43.843 4 (err=2.500)  
90.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 34: actual 102 (0.015%)  origin-forest_43.843 106 (err=1.039)  
90.8 queries/sec
Query 35: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.5 queries/sec
Query 36: actual 66410 (9.525%)  origin-forest_43.843 80239 (err=1.208)  
90.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 39: actual 77146 (11.065%)  origin-forest_43.843 93066 (err=1.206)  
90.9 queries/sec
Query 40: actual 1115 (0.160%)  origin-forest_43.843 1422 (err=1.275)  
90.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 42: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 43: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 44: actual 3 (0.000%)  origin-forest_43.843 11 (err=3.667)  
81.1 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 47: actual 2363 (0.339%)  origin-forest_43.843 2247 (err=1.052)  
90.9 queries/sec
Query 48: actual 279 (0.040%)  origin-forest_43.843 317 (err=1.136)  
90.9 queries/sec
Query 49: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
origin-forest_43.843 	max: 61.0000	99th: 54.1400	95th: 32.8500	median: 1.0742	mean: 5.2741
ReportEsts: [1.0, 1.3103448275862069, 1.0, 29.0, 13.384615384615385, 1.0, 1.0332708528584817, 1.0, 61.0, 9.428571428571429, 3.8, 1.0, 36.0, 1.0, 1.14, 1.0, 47.0, 1.0, 1.6, 1.0, 1.0, 2.21977233104297, 2.142857142857143, 1.096774193548387, 1.0462809917355371, 3.0305810397553516, 1.0, 1.1915911222256956, 1.0, 1.0, 1.1956451395442902, 1.0, 2.5, 1.0, 1.0392156862745099, 2.0, 1.2082367113386538, 1.0, 1.0, 1.2063619630311357, 1.2753363228699552, 1.0, 3.0, 8.0, 3.6666666666666665, 1.0, 1.0, 1.0516243880729863, 1.136200716845878, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 36/50 | Workload-time: 4.091967 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 37/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 21
RandomSeedCommunicator.get: 21
Query 0: actual 2425 (0.348%)  origin-forest_43.843 2679 (err=1.105)  
43.5 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 11 (0.002%)  origin-forest_43.843 1 (err=11.000)  
76.9 queries/sec
Query 3: actual 10 (0.001%)  origin-forest_43.843 16 (err=1.600)  
90.8 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
90.9 queries/sec
Query 5: actual 273 (0.039%)  origin-forest_43.843 406 (err=1.487)  
95.1 queries/sec
Query 6: actual 84 (0.012%)  origin-forest_43.843 31 (err=2.710)  
83.3 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 8: actual 308779 (44.288%)  origin-forest_43.843 304563 (err=1.014)  
76.9 queries/sec
Query 9: actual 9405 (1.349%)  origin-forest_43.843 10220 (err=1.087)  
83.3 queries/sec
Query 10: actual 251 (0.036%)  origin-forest_43.843 221 (err=1.136)  
90.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 12: actual 4 (0.001%)  origin-forest_43.843 3 (err=1.333)  
90.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.6 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 16: actual 30 (0.004%)  origin-forest_43.843 43 (err=1.433)  
76.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 44 (0.006%)  origin-forest_43.843 35 (err=1.257)  
83.3 queries/sec
Query 19: actual 3 (0.000%)  origin-forest_43.843 12 (err=4.000)  
83.3 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 21: actual 3 (0.000%)  origin-forest_43.843 6 (err=2.000)  
90.7 queries/sec
Query 22: actual 12 (0.002%)  origin-forest_43.843 21 (err=1.750)  
83.3 queries/sec
Query 23: actual 110 (0.016%)  origin-forest_43.843 110 (err=1.000)  
90.9 queries/sec
Query 24: actual 36 (0.005%)  origin-forest_43.843 36 (err=1.000)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 26: actual 2140 (0.307%)  origin-forest_43.843 2735 (err=1.278)  
90.9 queries/sec
Query 27: actual 61 (0.009%)  origin-forest_43.843 21 (err=2.905)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 30: actual 140 (0.020%)  origin-forest_43.843 134 (err=1.045)  
86.9 queries/sec
Query 31: actual 307 (0.044%)  origin-forest_43.843 1 (err=307.000)  
90.9 queries/sec
Query 32: actual 46 (0.007%)  origin-forest_43.843 1 (err=46.000)  
83.3 queries/sec
Query 33: actual 6688 (0.959%)  origin-forest_43.843 9154 (err=1.369)  
90.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 36: actual 2727 (0.391%)  origin-forest_43.843 74 (err=36.851)  
100.0 queries/sec
Query 37: actual 75 (0.011%)  origin-forest_43.843 118 (err=1.573)  
83.3 queries/sec
Query 38: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
100.0 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 40: actual 58 (0.008%)  origin-forest_43.843 1 (err=58.000)  
83.3 queries/sec
Query 41: actual 32 (0.005%)  origin-forest_43.843 46 (err=1.438)  
83.3 queries/sec
Query 42: actual 952 (0.137%)  origin-forest_43.843 1052 (err=1.105)  
83.3 queries/sec
Query 43: actual 77365 (11.096%)  origin-forest_43.843 107304 (err=1.387)  
90.9 queries/sec
Query 44: actual 42731 (6.129%)  origin-forest_43.843 51027 (err=1.194)  
90.9 queries/sec
Query 45: actual 58017 (8.321%)  origin-forest_43.843 18403 (err=3.153)  
100.0 queries/sec
Query 46: actual 8 (0.001%)  origin-forest_43.843 7 (err=1.143)  
83.3 queries/sec
Query 47: actual 625 (0.090%)  origin-forest_43.843 766 (err=1.226)  
90.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 307.0000	99th: 184.9900	95th: 41.8831	median: 1.1685	mean: 10.4165
ReportEsts: [1.104742268041237, 1.0, 11.0, 1.6, 2.0, 1.4871794871794872, 2.7096774193548385, 1.0, 1.0138427845798734, 1.086656034024455, 1.1357466063348416, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.4333333333333333, 1.0, 1.2571428571428571, 4.0, 1.0, 2.0, 1.75, 1.0, 1.0, 1.0, 1.27803738317757, 2.9047619047619047, 1.0, 1.0, 1.044776119402985, 307.0, 46.0, 1.36872009569378, 1.0, 1.0, 36.851351351351354, 1.5733333333333333, 1.25, 1.0, 58.0, 1.4375, 1.1050420168067228, 1.386983778194274, 1.1941447660948725, 3.1525838178557843, 1.1428571428571428, 1.2256, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 37/50 | Workload-time: 3.964816 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 38/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (741012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 40.1020
detection mean = 44.3395
detection threshold = 0.5819
test statistic = 4.2375
Offline time = 2.908475637435913
Online time = 0.5222623348236084
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 38-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (741012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 741012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.1362 bits (loss 61.671, data 18.535) 0.00100 lr
epoch 9 train loss 42.4635 nats / 61.2619 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 43.0015 bits (loss 61.536, data 18.535) 0.00082 lr
epoch 19 train loss 42.3351 nats / 61.0766 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 37.9611 nats / 54.7663 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 38/50 | Workload-time: 6.579664 | Model-update-time: 10.211011


WORKLOAD-START | Type: QueryWorkload | Progress: 39/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 22
RandomSeedCommunicator.get: 22
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 2: actual 61787 (8.862%)  origin-forest_43.843 75617 (err=1.224)  
83.3 queries/sec
Query 3: actual 16 (0.002%)  origin-forest_43.843 6 (err=2.667)  
76.9 queries/sec
Query 4: actual 4000 (0.574%)  origin-forest_43.843 3709 (err=1.078)  
90.2 queries/sec
Query 5: actual 27 (0.004%)  origin-forest_43.843 22 (err=1.227)  
76.9 queries/sec
Query 6: actual 53 (0.008%)  origin-forest_43.843 46 (err=1.152)  
90.9 queries/sec
Query 7: actual 85342 (12.240%)  origin-forest_43.843 89735 (err=1.051)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 9: actual 14 (0.002%)  origin-forest_43.843 15 (err=1.071)  
83.4 queries/sec
Query 10: actual 86 (0.012%)  origin-forest_43.843 6 (err=14.333)  
90.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 14: actual 574 (0.082%)  origin-forest_43.843 818 (err=1.425)  
90.9 queries/sec
Query 15: actual 109505 (15.706%)  origin-forest_43.843 74057 (err=1.479)  
90.9 queries/sec
Query 16: actual 353 (0.051%)  origin-forest_43.843 222 (err=1.590)  
100.0 queries/sec
Query 17: actual 467 (0.067%)  origin-forest_43.843 160 (err=2.919)  
83.3 queries/sec
Query 18: actual 3 (0.000%)  origin-forest_43.843 4 (err=1.333)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 20: actual 7 (0.001%)  origin-forest_43.843 1 (err=7.000)  
90.9 queries/sec
Query 21: actual 779 (0.112%)  origin-forest_43.843 992 (err=1.273)  
90.9 queries/sec
Query 22: actual 18 (0.003%)  origin-forest_43.843 4 (err=4.500)  
80.0 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 24: actual 17 (0.002%)  origin-forest_43.843 1 (err=17.000)  
66.7 queries/sec
Query 25: actual 41 (0.006%)  origin-forest_43.843 32 (err=1.281)  
90.9 queries/sec
Query 26: actual 15 (0.002%)  origin-forest_43.843 15 (err=1.000)  
83.3 queries/sec
Query 27: actual 318 (0.046%)  origin-forest_43.843 716 (err=2.252)  
100.0 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 4 (0.001%)  origin-forest_43.843 4 (err=1.000)  
76.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.9 queries/sec
Query 31: actual 24 (0.003%)  origin-forest_43.843 8 (err=3.000)  
90.9 queries/sec
Query 32: actual 12 (0.002%)  origin-forest_43.843 22 (err=1.833)  
90.9 queries/sec
Query 33: actual 30 (0.004%)  origin-forest_43.843 6 (err=5.000)  
83.3 queries/sec
Query 34: actual 245 (0.035%)  origin-forest_43.843 465 (err=1.898)  
90.9 queries/sec
Query 35: actual 35 (0.005%)  origin-forest_43.843 1 (err=35.000)  
90.9 queries/sec
Query 36: actual 2 (0.000%)  origin-forest_43.843 12 (err=6.000)  
83.3 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 38: actual 1261 (0.181%)  origin-forest_43.843 1 (err=1261.000)  
90.9 queries/sec
Query 39: actual 12 (0.002%)  origin-forest_43.843 8 (err=1.500)  
81.7 queries/sec
Query 40: actual 6 (0.001%)  origin-forest_43.843 8 (err=1.333)  
83.3 queries/sec
Query 41: actual 6 (0.001%)  origin-forest_43.843 1 (err=6.000)  
90.9 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 44: actual 19057 (2.733%)  origin-forest_43.843 24306 (err=1.275)  
83.3 queries/sec
Query 45: actual 126 (0.018%)  origin-forest_43.843 55 (err=2.291)  
90.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 320 (0.046%)  origin-forest_43.843 1 (err=320.000)  
87.6 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 1261.0000	99th: 799.9100	95th: 26.9000	median: 1.2783	mean: 34.6198
ReportEsts: [1.0, 1.0, 1.2238334924822374, 2.6666666666666665, 1.0784578053383662, 1.2272727272727273, 1.1521739130434783, 1.0514752407958567, 1.0, 1.0714285714285714, 14.333333333333334, 1.0, 1.0, 1.0, 1.4250871080139373, 1.4786583307452368, 1.59009009009009, 2.91875, 1.3333333333333333, 1.0, 7.0, 1.2734274711168165, 4.5, 1.0, 17.0, 1.28125, 1.0, 2.251572327044025, 1.0, 1.0, 1.0, 3.0, 1.8333333333333333, 5.0, 1.8979591836734695, 35.0, 6.0, 1.0, 1261.0, 1.5, 1.3333333333333333, 6.0, 1.0, 2.0, 1.2754368473526787, 2.290909090909091, 1.0, 320.0, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 39/50 | Workload-time: 4.023272 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 40/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (751012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 39.9379
detection mean = 44.3846
detection threshold = 0.5981
test statistic = 4.4467
Offline time = 2.8735010623931885
Online time = 0.5175728797912598
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 40-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (751012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 751012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.2298 bits (loss 61.719, data 18.489) 0.00100 lr
epoch 9 train loss 42.4048 nats / 61.1772 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.5498 bits (loss 61.039, data 18.489) 0.00082 lr
epoch 19 train loss 42.2473 nats / 60.9500 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 37.7479 nats / 54.4587 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 40/50 | Workload-time: 6.531325 | Model-update-time: 10.329414


WORKLOAD-START | Type: QueryWorkload | Progress: 41/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 23
RandomSeedCommunicator.get: 23
Query 0: actual 1661 (0.238%)  origin-forest_43.843 1 (err=1661.000)  
42.5 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 2: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 4: actual 73 (0.010%)  origin-forest_43.843 81 (err=1.110)  
90.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 11625 (1.667%)  origin-forest_43.843 6010 (err=1.934)  
90.9 queries/sec
Query 7: actual 1663 (0.239%)  origin-forest_43.843 1766 (err=1.062)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 9: actual 36 (0.005%)  origin-forest_43.843 42 (err=1.167)  
90.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 11: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
90.9 queries/sec
Query 12: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 13: actual 221 (0.032%)  origin-forest_43.843 218 (err=1.014)  
76.9 queries/sec
Query 14: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
83.3 queries/sec
Query 15: actual 767 (0.110%)  origin-forest_43.843 1291 (err=1.683)  
90.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 17: actual 338274 (48.518%)  origin-forest_43.843 324361 (err=1.043)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 110 (0.016%)  origin-forest_43.843 0 (err=110.000)  
76.9 queries/sec
Query 20: actual 182 (0.026%)  origin-forest_43.843 1 (err=182.000)  
71.4 queries/sec
Query 21: actual 131 (0.019%)  origin-forest_43.843 1 (err=131.000)  
83.3 queries/sec
Query 22: actual 198 (0.028%)  origin-forest_43.843 95 (err=2.084)  
90.9 queries/sec
Query 23: actual 717 (0.103%)  origin-forest_43.843 1 (err=717.000)  
83.3 queries/sec
Query 24: actual 282 (0.040%)  origin-forest_43.843 398 (err=1.411)  
90.9 queries/sec
Query 25: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
79.9 queries/sec
Query 26: actual 22 (0.003%)  origin-forest_43.843 55 (err=2.500)  
80.3 queries/sec
Query 27: actual 328 (0.047%)  origin-forest_43.843 676 (err=2.061)  
87.2 queries/sec
Query 28: actual 65 (0.009%)  origin-forest_43.843 85 (err=1.308)  
76.9 queries/sec
Query 29: actual 76297 (10.943%)  origin-forest_43.843 78954 (err=1.035)  
100.0 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 32: actual 115955 (16.631%)  origin-forest_43.843 109334 (err=1.061)  
90.9 queries/sec
Query 33: actual 104726 (15.021%)  origin-forest_43.843 99607 (err=1.051)  
86.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 35: actual 126 (0.018%)  origin-forest_43.843 126 (err=1.000)  
90.9 queries/sec
Query 36: actual 251 (0.036%)  origin-forest_43.843 169 (err=1.485)  
90.9 queries/sec
Query 37: actual 290 (0.042%)  origin-forest_43.843 479 (err=1.652)  
76.9 queries/sec
Query 38: actual 8 (0.001%)  origin-forest_43.843 7 (err=1.143)  
100.0 queries/sec
Query 39: actual 104 (0.015%)  origin-forest_43.843 116 (err=1.115)  
90.9 queries/sec
Query 40: actual 1508 (0.216%)  origin-forest_43.843 2143 (err=1.421)  
80.0 queries/sec
Query 41: actual 9 (0.001%)  origin-forest_43.843 45 (err=5.000)  
86.9 queries/sec
Query 42: actual 98 (0.014%)  origin-forest_43.843 22 (err=4.455)  
90.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 44: actual 54058 (7.753%)  origin-forest_43.843 43863 (err=1.232)  
90.9 queries/sec
Query 45: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 46: actual 105633 (15.151%)  origin-forest_43.843 127122 (err=1.203)  
90.9 queries/sec
Query 47: actual 51 (0.007%)  origin-forest_43.843 60 (err=1.176)  
58.8 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 49: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
origin-forest_43.843 	max: 1661.0000	99th: 1198.4400	95th: 159.0500	median: 1.1900	mean: 57.3681
ReportEsts: [1661.0, 1.0, 3.0, 1.0, 1.1095890410958904, 1.0, 1.9342762063227954, 1.0619362597714972, 1.0, 1.1666666666666667, 1.0, 1.5, 2.0, 1.0137614678899083, 1.5, 1.683181225554107, 1.0, 1.0428935661192313, 1.0, 110, 182.0, 131.0, 2.0842105263157893, 717.0, 1.4113475177304964, 1.0, 2.5, 2.0609756097560976, 1.3076923076923077, 1.0348244360852983, 1.0, 1.0, 1.0605575575758683, 1.0513919704438444, 1.0, 1.0, 1.485207100591716, 1.6517241379310346, 1.1428571428571428, 1.1153846153846154, 1.4210875331564987, 5.0, 4.454545454545454, 1.0, 1.2324282424822743, 2.0, 1.2034307460736702, 1.1764705882352942, 1.0, 2.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 41/50 | Workload-time: 4.030185 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 42/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 24
RandomSeedCommunicator.get: 24
Query 0: actual 5 (0.001%)  origin-forest_43.843 2 (err=2.500)  
41.7 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 2: actual 56 (0.008%)  origin-forest_43.843 1 (err=56.000)  
85.4 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
78.3 queries/sec
Query 4: actual 1683 (0.241%)  origin-forest_43.843 1688 (err=1.003)  
83.4 queries/sec
Query 5: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
76.9 queries/sec
Query 6: actual 41934 (6.015%)  origin-forest_43.843 53702 (err=1.281)  
100.0 queries/sec
Query 7: actual 92 (0.013%)  origin-forest_43.843 16 (err=5.750)  
80.0 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 11: actual 36 (0.005%)  origin-forest_43.843 6 (err=6.000)  
90.9 queries/sec
Query 12: actual 528 (0.076%)  origin-forest_43.843 647 (err=1.225)  
90.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 14: actual 562 (0.081%)  origin-forest_43.843 156 (err=3.603)  
90.9 queries/sec
Query 15: actual 14528 (2.084%)  origin-forest_43.843 18302 (err=1.260)  
90.5 queries/sec
Query 16: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 19: actual 3601 (0.516%)  origin-forest_43.843 3781 (err=1.050)  
90.9 queries/sec
Query 20: actual 18 (0.003%)  origin-forest_43.843 1 (err=18.000)  
83.3 queries/sec
Query 21: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 22: actual 16 (0.002%)  origin-forest_43.843 1 (err=16.000)  
83.3 queries/sec
Query 23: actual 389 (0.056%)  origin-forest_43.843 419 (err=1.077)  
100.0 queries/sec
Query 24: actual 882 (0.127%)  origin-forest_43.843 1111 (err=1.260)  
95.2 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 263 (0.038%)  origin-forest_43.843 350 (err=1.331)  
100.0 queries/sec
Query 28: actual 92437 (13.258%)  origin-forest_43.843 104966 (err=1.136)  
90.9 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 31: actual 38 (0.005%)  origin-forest_43.843 27 (err=1.407)  
90.9 queries/sec
Query 32: actual 407 (0.058%)  origin-forest_43.843 488 (err=1.199)  
90.9 queries/sec
Query 33: actual 44 (0.006%)  origin-forest_43.843 41 (err=1.073)  
80.0 queries/sec
Query 34: actual 998 (0.143%)  origin-forest_43.843 1225 (err=1.227)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
90.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.2 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.6 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 40: actual 7075 (1.015%)  origin-forest_43.843 6135 (err=1.153)  
90.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 42: actual 968 (0.139%)  origin-forest_43.843 1469 (err=1.518)  
95.2 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 25 (0.004%)  origin-forest_43.843 1 (err=25.000)  
90.9 queries/sec
Query 45: actual 59970 (8.601%)  origin-forest_43.843 61083 (err=1.019)  
90.9 queries/sec
Query 46: actual 1577 (0.226%)  origin-forest_43.843 2099 (err=1.331)  
100.0 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 48: actual 11 (0.002%)  origin-forest_43.843 20 (err=1.818)  
90.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 56.0000	99th: 40.8100	95th: 17.1000	median: 1.1063	mean: 3.6744
ReportEsts: [2.5, 1.0, 56.0, 1.0, 1.0029708853238266, 1.5, 1.2806314684981162, 5.75, 1.0, 1.0, 1.0, 6.0, 1.2253787878787878, 1.0, 3.6025641025641026, 1.25977422907489, 3.0, 1.0, 1.0, 1.0499861149680645, 18.0, 2.0, 16.0, 1.077120822622108, 1.2596371882086168, 1.0, 1.0, 1.3307984790874525, 1.1355409630342828, 1.0, 1.0, 1.4074074074074074, 1.199017199017199, 1.0731707317073171, 1.2274549098196392, 1.0, 2.0, 1.0, 1.0, 1.0, 1.1532192339038305, 1.0, 1.5175619834710743, 1.0, 25.0, 1.01855927963982, 1.331008243500317, 1.0, 1.8181818181818181, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 42/50 | Workload-time: 3.987276 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 43/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 25
RandomSeedCommunicator.get: 25
Query 0: actual 19 (0.003%)  origin-forest_43.843 25 (err=1.316)  
40.8 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
90.9 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 4: actual 942 (0.135%)  origin-forest_43.843 1693 (err=1.797)  
90.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 6: actual 12 (0.002%)  origin-forest_43.843 5 (err=2.400)  
83.3 queries/sec
Query 7: actual 8677 (1.245%)  origin-forest_43.843 10052 (err=1.158)  
89.5 queries/sec
Query 8: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 9: actual 65 (0.009%)  origin-forest_43.843 42 (err=1.548)  
100.0 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 7 (0.001%)  origin-forest_43.843 10 (err=1.429)  
100.0 queries/sec
Query 13: actual 136 (0.020%)  origin-forest_43.843 1 (err=136.000)  
76.7 queries/sec
Query 14: actual 39 (0.006%)  origin-forest_43.843 42 (err=1.077)  
91.2 queries/sec
Query 15: actual 15629 (2.242%)  origin-forest_43.843 9495 (err=1.646)  
100.0 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.8 queries/sec
Query 17: actual 1555 (0.223%)  origin-forest_43.843 1521 (err=1.022)  
90.9 queries/sec
Query 18: actual 26 (0.004%)  origin-forest_43.843 29 (err=1.115)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 21: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 1279 (0.183%)  origin-forest_43.843 1702 (err=1.331)  
83.3 queries/sec
Query 24: actual 4171 (0.598%)  origin-forest_43.843 3462 (err=1.205)  
95.2 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 5 (0.001%)  origin-forest_43.843 12 (err=2.400)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 84 (0.012%)  origin-forest_43.843 112 (err=1.333)  
100.0 queries/sec
Query 29: actual 52 (0.007%)  origin-forest_43.843 44 (err=1.182)  
76.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 31: actual 5 (0.001%)  origin-forest_43.843 8 (err=1.600)  
76.9 queries/sec
Query 32: actual 1196 (0.172%)  origin-forest_43.843 1425 (err=1.191)  
90.9 queries/sec
Query 33: actual 554 (0.079%)  origin-forest_43.843 553 (err=1.002)  
86.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
58.8 queries/sec
Query 35: actual 53 (0.008%)  origin-forest_43.843 1 (err=53.000)  
83.3 queries/sec
Query 36: actual 28 (0.004%)  origin-forest_43.843 1 (err=28.000)  
76.9 queries/sec
Query 37: actual 21 (0.003%)  origin-forest_43.843 79 (err=3.762)  
83.3 queries/sec
Query 38: actual 6831 (0.980%)  origin-forest_43.843 7886 (err=1.154)  
88.2 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
81.0 queries/sec
Query 40: actual 5121 (0.734%)  origin-forest_43.843 5037 (err=1.017)  
97.7 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 42: actual 8 (0.001%)  origin-forest_43.843 4 (err=2.000)  
83.3 queries/sec
Query 43: actual 454 (0.065%)  origin-forest_43.843 781 (err=1.720)  
90.9 queries/sec
Query 44: actual 33 (0.005%)  origin-forest_43.843 7 (err=4.714)  
76.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 500 (0.072%)  origin-forest_43.843 826 (err=1.652)  
83.3 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 3 (err=2.667)  
90.9 queries/sec
Query 48: actual 3 (0.000%)  origin-forest_43.843 3 (err=1.000)  
83.3 queries/sec
Query 49: actual 19 (0.003%)  origin-forest_43.843 1 (err=19.000)  
origin-forest_43.843 	max: 136.0000	99th: 95.3300	95th: 23.9500	median: 1.1866	mean: 6.0588
ReportEsts: [1.3157894736842106, 1.0, 1.5, 1.0, 1.79723991507431, 1.0, 2.4, 1.1584649072259998, 2.0, 1.5476190476190477, 1.0, 1.0, 1.4285714285714286, 136.0, 1.0769230769230769, 1.646024223275408, 1.0, 1.022353714661407, 1.1153846153846154, 1.0, 1.0, 2.0, 1.0, 1.3307271305707584, 1.204794916233391, 1.0, 2.4, 1.0, 1.3333333333333333, 1.1818181818181819, 1.0, 1.6, 1.1914715719063544, 1.0018083182640145, 1.0, 53.0, 28.0, 3.761904761904762, 1.154442980529937, 1.0, 1.0166765932102442, 1.0, 2.0, 1.7202643171806167, 4.714285714285714, 1.0, 1.652, 2.6666666666666665, 1.0, 19.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 43/50 | Workload-time: 4.029592 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 44/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 26
RandomSeedCommunicator.get: 26
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 7: actual 18577 (2.664%)  origin-forest_43.843 22580 (err=1.215)  
90.9 queries/sec
Query 8: actual 125 (0.018%)  origin-forest_43.843 50 (err=2.500)  
83.3 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 62643 (8.985%)  origin-forest_43.843 72592 (err=1.159)  
90.9 queries/sec
Query 11: actual 15 (0.002%)  origin-forest_43.843 34 (err=2.267)  
83.3 queries/sec
Query 12: actual 394 (0.057%)  origin-forest_43.843 282 (err=1.397)  
86.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 14: actual 12 (0.002%)  origin-forest_43.843 13 (err=1.083)  
83.3 queries/sec
Query 15: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 262 (0.038%)  origin-forest_43.843 240 (err=1.092)  
83.3 queries/sec
Query 18: actual 17 (0.002%)  origin-forest_43.843 30 (err=1.765)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 20: actual 7950 (1.140%)  origin-forest_43.843 8777 (err=1.104)  
99.6 queries/sec
Query 21: actual 130 (0.019%)  origin-forest_43.843 105 (err=1.238)  
87.2 queries/sec
Query 22: actual 15 (0.002%)  origin-forest_43.843 1 (err=15.000)  
83.3 queries/sec
Query 23: actual 6136 (0.880%)  origin-forest_43.843 3861 (err=1.589)  
90.9 queries/sec
Query 24: actual 60 (0.009%)  origin-forest_43.843 0 (err=60.000)  
76.9 queries/sec
Query 25: actual 13 (0.002%)  origin-forest_43.843 25 (err=1.923)  
66.7 queries/sec
Query 26: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
58.8 queries/sec
Query 27: actual 5 (0.001%)  origin-forest_43.843 15 (err=3.000)  
83.3 queries/sec
Query 28: actual 13 (0.002%)  origin-forest_43.843 8 (err=1.625)  
83.3 queries/sec
Query 29: actual 160120 (22.966%)  origin-forest_43.843 159207 (err=1.006)  
89.7 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
58.8 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 32: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
90.9 queries/sec
Query 33: actual 112 (0.016%)  origin-forest_43.843 158 (err=1.411)  
90.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 27 (0.004%)  origin-forest_43.843 16 (err=1.688)  
82.8 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 38: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 39: actual 1510 (0.217%)  origin-forest_43.843 1112 (err=1.358)  
90.9 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 43: actual 140 (0.020%)  origin-forest_43.843 1 (err=140.000)  
90.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.2 queries/sec
Query 46: actual 20713 (2.971%)  origin-forest_43.843 24733 (err=1.194)  
90.9 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 48: actual 18 (0.003%)  origin-forest_43.843 1 (err=18.000)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 140.0000	99th: 100.8000	95th: 16.6500	median: 1.0875	mean: 5.9023
ReportEsts: [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.2154815093933358, 2.5, 1.0, 1.1588206184250436, 2.2666666666666666, 1.3971631205673758, 1.0, 1.0833333333333333, 4.0, 1.0, 1.0916666666666666, 1.7647058823529411, 1.0, 1.1040251572327044, 1.2380952380952381, 15.0, 1.5892255892255893, 60, 1.9230769230769231, 2.0, 3.0, 1.625, 1.0057346724704315, 1.0, 1.0, 1.5, 1.4107142857142858, 1.0, 1.6875, 1.0, 1.0, 2.0, 1.3579136690647482, 1.0, 1.0, 1.0, 140.0, 1.0, 1.0, 1.1940810119248781, 1.0, 18.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 44/50 | Workload-time: 4.060348 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 45/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 27
RandomSeedCommunicator.get: 27
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
42.5 queries/sec
Query 1: actual 35 (0.005%)  origin-forest_43.843 13 (err=2.692)  
76.9 queries/sec
Query 2: actual 7770 (1.114%)  origin-forest_43.843 9824 (err=1.264)  
83.3 queries/sec
Query 3: actual 3484 (0.500%)  origin-forest_43.843 4884 (err=1.402)  
90.9 queries/sec
Query 4: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 5: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 8: actual 589 (0.084%)  origin-forest_43.843 666 (err=1.131)  
100.0 queries/sec
Query 9: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
74.0 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 12: actual 87 (0.012%)  origin-forest_43.843 1 (err=87.000)  
83.3 queries/sec
Query 13: actual 19485 (2.795%)  origin-forest_43.843 24029 (err=1.233)  
90.9 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 16: actual 332 (0.048%)  origin-forest_43.843 411 (err=1.238)  
83.3 queries/sec
Query 17: actual 253 (0.036%)  origin-forest_43.843 1 (err=253.000)  
89.8 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 20: actual 232 (0.033%)  origin-forest_43.843 78 (err=2.974)  
100.0 queries/sec
Query 21: actual 2 (0.000%)  origin-forest_43.843 4 (err=2.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
90.9 queries/sec
Query 24: actual 23 (0.003%)  origin-forest_43.843 8 (err=2.875)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.8 queries/sec
Query 26: actual 1555 (0.223%)  origin-forest_43.843 1961 (err=1.261)  
76.9 queries/sec
Query 27: actual 133 (0.019%)  origin-forest_43.843 1 (err=133.000)  
83.3 queries/sec
Query 28: actual 14 (0.002%)  origin-forest_43.843 34 (err=2.429)  
90.9 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 31: actual 3 (0.000%)  origin-forest_43.843 5 (err=1.667)  
90.9 queries/sec
Query 32: actual 5 (0.001%)  origin-forest_43.843 3 (err=1.667)  
90.9 queries/sec
Query 33: actual 241 (0.035%)  origin-forest_43.843 224 (err=1.076)  
99.9 queries/sec
Query 34: actual 177 (0.025%)  origin-forest_43.843 221 (err=1.249)  
83.2 queries/sec
Query 35: actual 100 (0.014%)  origin-forest_43.843 1 (err=100.000)  
76.9 queries/sec
Query 36: actual 32 (0.005%)  origin-forest_43.843 31 (err=1.032)  
83.3 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 38: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 39: actual 6 (0.001%)  origin-forest_43.843 2 (err=3.000)  
83.4 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 41: actual 431521 (61.892%)  origin-forest_43.843 401609 (err=1.074)  
99.9 queries/sec
Query 42: actual 187 (0.027%)  origin-forest_43.843 244 (err=1.305)  
79.9 queries/sec
Query 43: actual 255 (0.037%)  origin-forest_43.843 13 (err=19.615)  
100.0 queries/sec
Query 44: actual 45 (0.006%)  origin-forest_43.843 15 (err=3.000)  
90.9 queries/sec
Query 45: actual 39 (0.006%)  origin-forest_43.843 1 (err=39.000)  
83.3 queries/sec
Query 46: actual 242 (0.035%)  origin-forest_43.843 223 (err=1.085)  
90.9 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 48: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
76.9 queries/sec
Query 49: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
origin-forest_43.843 	max: 253.0000	99th: 194.2000	95th: 94.1500	median: 1.2548	mean: 15.1554
ReportEsts: [1.0, 2.6923076923076925, 1.2643500643500643, 1.401836969001148, 3.0, 2.0, 1.0, 1.0, 1.130730050933786, 1.0, 1.0, 1.0, 87.0, 1.2332050295098793, 1.0, 1.0, 1.2379518072289157, 253.0, 1.0, 1.0, 2.9743589743589745, 2.0, 1.0, 1.5, 2.875, 1.0, 1.2610932475884244, 133.0, 2.4285714285714284, 1.0, 1.0, 1.6666666666666667, 1.6666666666666667, 1.0758928571428572, 1.2485875706214689, 100.0, 1.032258064516129, 1.0, 2.0, 3.0, 1.0, 1.0744804025806194, 1.304812834224599, 19.615384615384617, 3.0, 39.0, 1.0852017937219731, 1.0, 62.0, 2.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 45/50 | Workload-time: 4.006579 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 46/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (761012, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 39.7540
detection mean = 44.4330
detection threshold = 0.6337
test statistic = 4.6790
Offline time = 2.8933169841766357
Online time = 0.5341968536376953
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 46-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (761012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 761012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.1256 bits (loss 61.570, data 18.444) 0.00100 lr
epoch 9 train loss 42.3786 nats / 61.1395 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.6057 bits (loss 61.050, data 18.444) 0.00082 lr
epoch 19 train loss 42.2388 nats / 60.9377 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 37.5464 nats / 54.1680 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 46/50 | Workload-time: 6.630713 | Model-update-time: 10.324766


WORKLOAD-START | Type: QueryWorkload | Progress: 47/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 28
RandomSeedCommunicator.get: 28
Query 0: actual 2 (0.000%)  origin-forest_43.843 4 (err=2.000)  
42.5 queries/sec
Query 1: actual 31 (0.004%)  origin-forest_43.843 1 (err=31.000)  
73.4 queries/sec
Query 2: actual 45 (0.006%)  origin-forest_43.843 26 (err=1.731)  
89.5 queries/sec
Query 3: actual 314 (0.045%)  origin-forest_43.843 347 (err=1.105)  
90.5 queries/sec
Query 4: actual 14 (0.002%)  origin-forest_43.843 14 (err=1.000)  
76.9 queries/sec
Query 5: actual 18 (0.003%)  origin-forest_43.843 36 (err=2.000)  
71.4 queries/sec
Query 6: actual 63 (0.009%)  origin-forest_43.843 2 (err=31.500)  
83.3 queries/sec
Query 7: actual 29709 (4.261%)  origin-forest_43.843 36903 (err=1.242)  
90.8 queries/sec
Query 8: actual 4 (0.001%)  origin-forest_43.843 4 (err=1.000)  
86.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 11: actual 77979 (11.184%)  origin-forest_43.843 81661 (err=1.047)  
90.9 queries/sec
Query 12: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 16: actual 193 (0.028%)  origin-forest_43.843 1 (err=193.000)  
90.8 queries/sec
Query 17: actual 19 (0.003%)  origin-forest_43.843 1 (err=19.000)  
79.9 queries/sec
Query 18: actual 84976 (12.188%)  origin-forest_43.843 65363 (err=1.300)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 20: actual 48 (0.007%)  origin-forest_43.843 1 (err=48.000)  
76.9 queries/sec
Query 21: actual 201 (0.029%)  origin-forest_43.843 236 (err=1.174)  
90.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 24: actual 312 (0.045%)  origin-forest_43.843 424 (err=1.359)  
90.8 queries/sec
Query 25: actual 148 (0.021%)  origin-forest_43.843 193 (err=1.304)  
80.0 queries/sec
Query 26: actual 828 (0.119%)  origin-forest_43.843 392 (err=2.112)  
66.7 queries/sec
Query 27: actual 5288 (0.758%)  origin-forest_43.843 2549 (err=2.075)  
90.9 queries/sec
Query 28: actual 138 (0.020%)  origin-forest_43.843 148 (err=1.072)  
90.9 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 30: actual 215 (0.031%)  origin-forest_43.843 168 (err=1.280)  
90.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.3 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 33: actual 2257 (0.324%)  origin-forest_43.843 3197 (err=1.416)  
90.9 queries/sec
Query 34: actual 150 (0.022%)  origin-forest_43.843 123 (err=1.220)  
86.6 queries/sec
Query 35: actual 108507 (15.563%)  origin-forest_43.843 87644 (err=1.238)  
100.0 queries/sec
Query 36: actual 3897 (0.559%)  origin-forest_43.843 3574 (err=1.090)  
90.9 queries/sec
Query 37: actual 69 (0.010%)  origin-forest_43.843 74 (err=1.072)  
90.9 queries/sec
Query 38: actual 10077 (1.445%)  origin-forest_43.843 9529 (err=1.058)  
90.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 41: actual 342 (0.049%)  origin-forest_43.843 466 (err=1.363)  
83.3 queries/sec
Query 42: actual 3 (0.000%)  origin-forest_43.843 3 (err=1.000)  
83.3 queries/sec
Query 43: actual 88982 (12.763%)  origin-forest_43.843 106304 (err=1.195)  
86.9 queries/sec
Query 44: actual 208 (0.030%)  origin-forest_43.843 477 (err=2.293)  
90.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 48: actual 14 (0.002%)  origin-forest_43.843 11 (err=1.273)  
90.9 queries/sec
Query 49: actual 15 (0.002%)  origin-forest_43.843 1 (err=15.000)  
origin-forest_43.843 	max: 193.0000	99th: 121.9500	95th: 31.2750	median: 1.1844	mean: 7.8704
ReportEsts: [2.0, 31.0, 1.7307692307692308, 1.105095541401274, 1.0, 2.0, 31.5, 1.2421488437847117, 1.0, 1.0, 1.0, 1.0472178407007016, 2.0, 1.0, 1.0, 1.0, 193.0, 19.0, 1.3000627266190352, 1.0, 48.0, 1.1741293532338308, 1.0, 1.0, 1.358974358974359, 1.304054054054054, 2.1122448979591835, 2.074539034915653, 1.0724637681159421, 1.0, 1.2797619047619047, 1.0, 1.0, 1.416482055826318, 1.2195121951219512, 1.2380425357126557, 1.0903749300503638, 1.0724637681159421, 1.0575086577815092, 1.0, 1.0, 1.3625730994152048, 1.0, 1.194668584657571, 2.293269230769231, 2.0, 1.0, 1.0, 1.2727272727272727, 15.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 47/50 | Workload-time: 4.049070 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 48/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 29
RandomSeedCommunicator.get: 29
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
38.5 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 2: actual 9 (0.001%)  origin-forest_43.843 6 (err=1.500)  
80.3 queries/sec
Query 3: actual 19 (0.003%)  origin-forest_43.843 0 (err=19.000)  
81.5 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 2342 (0.336%)  origin-forest_43.843 2649 (err=1.131)  
86.9 queries/sec
Query 7: actual 120321 (17.257%)  origin-forest_43.843 106315 (err=1.132)  
90.9 queries/sec
Query 8: actual 2 (0.000%)  origin-forest_43.843 4 (err=2.000)  
83.3 queries/sec
Query 9: actual 65 (0.009%)  origin-forest_43.843 1 (err=65.000)  
90.9 queries/sec
Query 10: actual 27 (0.004%)  origin-forest_43.843 1 (err=27.000)  
83.3 queries/sec
Query 11: actual 21 (0.003%)  origin-forest_43.843 1 (err=21.000)  
83.3 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 3 (err=3.000)  
83.3 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 385 (0.055%)  origin-forest_43.843 3 (err=128.333)  
100.0 queries/sec
Query 18: actual 6452 (0.925%)  origin-forest_43.843 2993 (err=2.156)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 20: actual 284 (0.041%)  origin-forest_43.843 409 (err=1.440)  
76.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 349 (0.050%)  origin-forest_43.843 349 (err=1.000)  
83.3 queries/sec
Query 23: actual 2560 (0.367%)  origin-forest_43.843 2 (err=1280.000)  
74.0 queries/sec
Query 24: actual 32 (0.005%)  origin-forest_43.843 1 (err=32.000)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 26: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 29: actual 195 (0.028%)  origin-forest_43.843 245 (err=1.256)  
86.5 queries/sec
Query 30: actual 267 (0.038%)  origin-forest_43.843 107 (err=2.495)  
90.8 queries/sec
Query 31: actual 208 (0.030%)  origin-forest_43.843 159 (err=1.308)  
95.2 queries/sec
Query 32: actual 124 (0.018%)  origin-forest_43.843 82 (err=1.512)  
76.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.6 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.4 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.6 queries/sec
Query 36: actual 6 (0.001%)  origin-forest_43.843 2 (err=3.000)  
90.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 579 (0.083%)  origin-forest_43.843 775 (err=1.339)  
90.9 queries/sec
Query 40: actual 3 (0.000%)  origin-forest_43.843 5 (err=1.667)  
90.2 queries/sec
Query 41: actual 5 (0.001%)  origin-forest_43.843 7 (err=1.400)  
83.3 queries/sec
Query 42: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 45: actual 35 (0.005%)  origin-forest_43.843 20 (err=1.750)  
90.9 queries/sec
Query 46: actual 151 (0.022%)  origin-forest_43.843 233 (err=1.543)  
90.9 queries/sec
Query 47: actual 31053 (4.454%)  origin-forest_43.843 31406 (err=1.011)  
90.8 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 49: actual 119407 (17.126%)  origin-forest_43.843 147885 (err=1.238)  
origin-forest_43.843 	max: 1280.0000	99th: 715.6833	95th: 50.1500	median: 1.2475	mean: 32.6442
ReportEsts: [1.0, 1.0, 1.5, 19, 1.0, 1.0, 1.1310845431255336, 1.1317405822320463, 2.0, 65.0, 27.0, 21.0, 3.0, 1.0, 1.0, 1.0, 1.0, 128.33333333333334, 2.1556966254594054, 1.0, 1.4401408450704225, 1.0, 1.0, 1280.0, 32.0, 1.0, 2.0, 1.0, 1.0, 1.2564102564102564, 2.4953271028037385, 1.3081761006289307, 1.5121951219512195, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.3385146804835923, 1.6666666666666667, 1.4, 3.0, 1.0, 2.0, 1.75, 1.5430463576158941, 1.0113676617396066, 1.0, 1.2384952305978711]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 48/50 | Workload-time: 4.024284 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 49/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 30
RandomSeedCommunicator.get: 30
Query 0: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
40.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 3: actual 1491 (0.214%)  origin-forest_43.843 163 (err=9.147)  
82.7 queries/sec
Query 4: actual 7002 (1.004%)  origin-forest_43.843 9586 (err=1.369)  
83.3 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 7: actual 66 (0.009%)  origin-forest_43.843 1 (err=66.000)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 9: actual 8448 (1.212%)  origin-forest_43.843 9974 (err=1.181)  
83.3 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 11: actual 67 (0.010%)  origin-forest_43.843 51 (err=1.314)  
90.9 queries/sec
Query 12: actual 124 (0.018%)  origin-forest_43.843 1 (err=124.000)  
95.2 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.3 queries/sec
Query 15: actual 95 (0.014%)  origin-forest_43.843 82 (err=1.159)  
90.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 225 (0.032%)  origin-forest_43.843 394 (err=1.751)  
83.4 queries/sec
Query 18: actual 21 (0.003%)  origin-forest_43.843 9 (err=2.333)  
83.3 queries/sec
Query 19: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
90.9 queries/sec
Query 20: actual 21 (0.003%)  origin-forest_43.843 51 (err=2.429)  
57.1 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 55 (0.008%)  origin-forest_43.843 73 (err=1.327)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 24: actual 18 (0.003%)  origin-forest_43.843 1 (err=18.000)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.5 queries/sec
Query 26: actual 1605 (0.230%)  origin-forest_43.843 524 (err=3.063)  
90.9 queries/sec
Query 27: actual 17 (0.002%)  origin-forest_43.843 27 (err=1.588)  
83.3 queries/sec
Query 28: actual 179 (0.026%)  origin-forest_43.843 46 (err=3.891)  
90.3 queries/sec
Query 29: actual 876 (0.126%)  origin-forest_43.843 1021 (err=1.166)  
100.0 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 31: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
90.9 queries/sec
Query 32: actual 49685 (7.126%)  origin-forest_43.843 30553 (err=1.626)  
90.9 queries/sec
Query 33: actual 875 (0.125%)  origin-forest_43.843 926 (err=1.058)  
90.9 queries/sec
Query 34: actual 91 (0.013%)  origin-forest_43.843 148 (err=1.626)  
83.3 queries/sec
Query 35: actual 1867 (0.268%)  origin-forest_43.843 2039 (err=1.092)  
90.9 queries/sec
Query 36: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
83.3 queries/sec
Query 37: actual 1483 (0.213%)  origin-forest_43.843 2092 (err=1.411)  
88.5 queries/sec
Query 38: actual 145 (0.021%)  origin-forest_43.843 119 (err=1.218)  
90.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 284 (0.041%)  origin-forest_43.843 157 (err=1.809)  
90.9 queries/sec
Query 45: actual 14265 (2.046%)  origin-forest_43.843 11559 (err=1.234)  
90.9 queries/sec
Query 46: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
79.9 queries/sec
Query 47: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 48: actual 9 (0.001%)  origin-forest_43.843 1 (err=9.000)  
83.3 queries/sec
Query 49: actual 27 (0.004%)  origin-forest_43.843 2 (err=13.500)  
origin-forest_43.843 	max: 124.0000	99th: 95.5800	95th: 19.1000	median: 1.2739	mean: 6.4459
ReportEsts: [1.0, 1.0, 1.0, 9.14723926380368, 1.3690374178806055, 1.0, 2.0, 66.0, 1.0, 1.1806344696969697, 1.0, 1.3137254901960784, 124.0, 1.0, 1.0, 1.1585365853658536, 1.0, 1.751111111111111, 2.3333333333333335, 1.0, 2.4285714285714284, 1.0, 1.3272727272727274, 2.0, 18.0, 1.0, 3.062977099236641, 1.588235294117647, 3.891304347826087, 1.1655251141552512, 1.0, 3.0, 1.6261905541190718, 1.0582857142857143, 1.6263736263736264, 1.0921264059989289, 20.0, 1.4106540795684424, 1.218487394957983, 1.0, 1.0, 1.0, 1.0, 1.0, 1.8089171974522293, 1.2341032961328835, 2.0, 2.0, 9.0, 13.5]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 49/50 | Workload-time: 4.031237 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 50/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 31
RandomSeedCommunicator.get: 31
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
37.0 queries/sec
Query 1: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 3: actual 128 (0.018%)  origin-forest_43.843 229 (err=1.789)  
83.3 queries/sec
Query 4: actual 6 (0.001%)  origin-forest_43.843 3 (err=2.000)  
90.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.7 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.2 queries/sec
Query 8: actual 68 (0.010%)  origin-forest_43.843 1 (err=68.000)  
90.9 queries/sec
Query 9: actual 9 (0.001%)  origin-forest_43.843 1 (err=9.000)  
76.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 13: actual 438 (0.063%)  origin-forest_43.843 513 (err=1.171)  
100.0 queries/sec
Query 14: actual 1332 (0.191%)  origin-forest_43.843 1110 (err=1.200)  
90.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 16: actual 55 (0.008%)  origin-forest_43.843 11 (err=5.000)  
83.3 queries/sec
Query 17: actual 1838 (0.264%)  origin-forest_43.843 2247 (err=1.223)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
65.9 queries/sec
Query 19: actual 6 (0.001%)  origin-forest_43.843 1 (err=6.000)  
76.9 queries/sec
Query 20: actual 42 (0.006%)  origin-forest_43.843 1 (err=42.000)  
83.3 queries/sec
Query 21: actual 32944 (4.725%)  origin-forest_43.843 25683 (err=1.283)  
90.9 queries/sec
Query 22: actual 158 (0.023%)  origin-forest_43.843 73 (err=2.164)  
90.9 queries/sec
Query 23: actual 5149 (0.739%)  origin-forest_43.843 5385 (err=1.046)  
90.9 queries/sec
Query 24: actual 7 (0.001%)  origin-forest_43.843 11 (err=1.571)  
94.3 queries/sec
Query 25: actual 22033 (3.160%)  origin-forest_43.843 25813 (err=1.172)  
90.9 queries/sec
Query 26: actual 21901 (3.141%)  origin-forest_43.843 29500 (err=1.347)  
90.9 queries/sec
Query 27: actual 574 (0.082%)  origin-forest_43.843 743 (err=1.294)  
86.8 queries/sec
Query 28: actual 14 (0.002%)  origin-forest_43.843 3 (err=4.667)  
90.9 queries/sec
Query 29: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 31: actual 1154 (0.166%)  origin-forest_43.843 1388 (err=1.203)  
90.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 34: actual 39414 (5.653%)  origin-forest_43.843 36863 (err=1.069)  
90.9 queries/sec
Query 35: actual 68 (0.010%)  origin-forest_43.843 83 (err=1.221)  
100.0 queries/sec
Query 36: actual 67 (0.010%)  origin-forest_43.843 17 (err=3.941)  
82.7 queries/sec
Query 37: actual 4 (0.001%)  origin-forest_43.843 9 (err=2.250)  
83.3 queries/sec
Query 38: actual 23 (0.003%)  origin-forest_43.843 1 (err=23.000)  
83.3 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 488 (0.070%)  origin-forest_43.843 1 (err=488.000)  
83.3 queries/sec
Query 43: actual 9 (0.001%)  origin-forest_43.843 16 (err=1.778)  
90.9 queries/sec
Query 44: actual 692 (0.099%)  origin-forest_43.843 270 (err=2.563)  
95.2 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 47: actual 17 (0.002%)  origin-forest_43.843 1 (err=17.000)  
100.0 queries/sec
Query 48: actual 4 (0.001%)  origin-forest_43.843 4 (err=1.000)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 488.0000	99th: 282.2000	95th: 33.4500	median: 1.2117	mean: 14.3790
ReportEsts: [1.0, 2.0, 1.0, 1.7890625, 2.0, 1.0, 1.0, 1.0, 68.0, 9.0, 1.0, 1.0, 1.0, 1.1712328767123288, 1.2, 1.0, 5.0, 1.222524483133841, 1.0, 6.0, 42.0, 1.2827161935910913, 2.164383561643836, 1.0458341425519517, 1.5714285714285714, 1.1715608405573459, 1.3469704579699557, 1.2944250871080138, 4.666666666666667, 2.0, 1.0, 1.2027729636048528, 1.0, 1.0, 1.069202181048748, 1.2205882352941178, 3.9411764705882355, 2.25, 23.0, 1.0, 1.0, 1.0, 488.0, 1.7777777777777777, 2.562962962962963, 1.0, 2.0, 17.0, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 50/50 | Workload-time: 4.018267 | Model-update-time: 0.000000





Experiment Summary: #drift=15 | total-time=401.286482
