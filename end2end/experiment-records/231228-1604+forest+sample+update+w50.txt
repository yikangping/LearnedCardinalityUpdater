Input arguments = Namespace(data_update='sample', dataset='forest', debug=False, drift_test='ddup', model_update='update', model='naru', random_seed=42, num_workload=50)
MODEL-PATH=F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
DATASET-PATH=F:\DBGroup\LearnedCardinalityUpdater\data\forest\end2end\forest.npy
Workload weights: query=15, data-update=10
Workloads: ['DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload']



WORKLOAD-START | Type: DataUpdateWorkload | Progress: 1/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (591012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.0s
new data average log likelihood = 44.2785
detection mean = 43.5363
detection threshold = 0.3234
test statistic = 0.7422
Offline time = 2.8663783073425293
Online time = 0.438565731048584
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 1-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (591012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 591012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.5605 bits (loss 62.699, data 19.139) 0.00100 lr
epoch 9 train loss 43.1645 nats / 62.2732 bits
time since start: 4.0 secs
Epoch 10 Iter 0, train entropy gap 43.1431 bits (loss 62.282, data 19.139) 0.00082 lr
epoch 19 train loss 43.0631 nats / 62.1270 bits
time since start: 7.2 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 42.4280 nats / 61.2106 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 1/50 | Workload-time: 6.423673 | Model-update-time: 10.535576


WORKLOAD-START | Type: QueryWorkload | Progress: 2/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 147 (0.021%)  origin-forest_43.843 139 (err=1.058)  
40.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 3: actual 832 (0.119%)  origin-forest_43.843 530 (err=1.570)  
90.9 queries/sec
Query 4: actual 729 (0.105%)  origin-forest_43.843 850 (err=1.166)  
90.9 queries/sec
Query 5: actual 213 (0.031%)  origin-forest_43.843 1 (err=213.000)  
83.3 queries/sec
Query 6: actual 3939 (0.565%)  origin-forest_43.843 5783 (err=1.468)  
71.1 queries/sec
Query 7: actual 131 (0.019%)  origin-forest_43.843 146 (err=1.115)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 9: actual 33 (0.005%)  origin-forest_43.843 6 (err=5.500)  
90.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 11: actual 60 (0.009%)  origin-forest_43.843 0 (err=60.000)  
83.3 queries/sec
Query 12: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
76.9 queries/sec
Query 13: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
83.3 queries/sec
Query 14: actual 10 (0.001%)  origin-forest_43.843 1 (err=10.000)  
90.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
88.6 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 342147 (49.073%)  origin-forest_43.843 343988 (err=1.005)  
90.9 queries/sec
Query 20: actual 36 (0.005%)  origin-forest_43.843 15 (err=2.400)  
83.3 queries/sec
Query 21: actual 515 (0.074%)  origin-forest_43.843 534 (err=1.037)  
90.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 68 (0.010%)  origin-forest_43.843 44 (err=1.545)  
95.2 queries/sec
Query 24: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
79.8 queries/sec
Query 25: actual 19988 (2.867%)  origin-forest_43.843 12770 (err=1.565)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
73.7 queries/sec
Query 27: actual 3360 (0.482%)  origin-forest_43.843 3075 (err=1.093)  
83.3 queries/sec
Query 28: actual 3 (0.000%)  origin-forest_43.843 5 (err=1.667)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 30: actual 3112 (0.446%)  origin-forest_43.843 3906 (err=1.255)  
90.9 queries/sec
Query 31: actual 226 (0.032%)  origin-forest_43.843 269 (err=1.190)  
86.9 queries/sec
Query 32: actual 509 (0.073%)  origin-forest_43.843 1 (err=509.000)  
83.3 queries/sec
Query 33: actual 4 (0.001%)  origin-forest_43.843 3 (err=1.333)  
76.9 queries/sec
Query 34: actual 62137 (8.912%)  origin-forest_43.843 71434 (err=1.150)  
83.3 queries/sec
Query 35: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 36: actual 74 (0.011%)  origin-forest_43.843 1 (err=74.000)  
83.3 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 38: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 39: actual 24952 (3.579%)  origin-forest_43.843 32381 (err=1.298)  
90.9 queries/sec
Query 40: actual 4581 (0.657%)  origin-forest_43.843 5596 (err=1.222)  
86.9 queries/sec
Query 41: actual 68 (0.010%)  origin-forest_43.843 78 (err=1.147)  
83.3 queries/sec
Query 42: actual 165778 (23.777%)  origin-forest_43.843 140692 (err=1.178)  
90.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 2645 (0.379%)  origin-forest_43.843 4296 (err=1.624)  
83.3 queries/sec
Query 45: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
83.3 queries/sec
Query 46: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
90.9 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 48: actual 14379 (2.062%)  origin-forest_43.843 8650 (err=1.662)  
94.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 509.0000	99th: 363.9600	95th: 67.7000	median: 1.1721	mean: 18.5750
ReportEsts: [1.0575539568345325, 1.0, 1.0, 1.569811320754717, 1.1659807956104253, 213.0, 1.4681391216044681, 1.1145038167938932, 1.0, 5.5, 1.0, 60, 3.0, 1.0, 10.0, 1.0, 1.0, 1.0, 1.0, 1.0053807281665483, 2.4, 1.036893203883495, 1.0, 1.5454545454545454, 2.0, 1.5652310101801097, 1.0, 1.0926829268292684, 1.6666666666666667, 1.0, 1.2551413881748072, 1.1902654867256637, 509.0, 1.3333333333333333, 1.1496209987608028, 2.0, 74.0, 1.0, 2.0, 1.2977316447579352, 1.221567343374809, 1.1470588235294117, 1.1783043812014897, 1.0, 1.624196597353497, 1.5, 1.0, 1.0, 1.6623121387283237, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 2/50 | Workload-time: 4.135676 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
40.0 queries/sec
Query 1: actual 5123 (0.735%)  origin-forest_43.843 5302 (err=1.035)  
90.9 queries/sec
Query 2: actual 11 (0.002%)  origin-forest_43.843 14 (err=1.273)  
83.3 queries/sec
Query 3: actual 356 (0.051%)  origin-forest_43.843 1 (err=356.000)  
76.9 queries/sec
Query 4: actual 78 (0.011%)  origin-forest_43.843 1 (err=78.000)  
64.5 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 6 (err=6.000)  
76.9 queries/sec
Query 6: actual 212773 (30.518%)  origin-forest_43.843 162432 (err=1.310)  
76.9 queries/sec
Query 7: actual 40 (0.006%)  origin-forest_43.843 8 (err=5.000)  
70.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
69.4 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.0 queries/sec
Query 10: actual 93 (0.013%)  origin-forest_43.843 1 (err=93.000)  
76.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
67.7 queries/sec
Query 12: actual 43 (0.006%)  origin-forest_43.843 0 (err=43.000)  
66.7 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 14: actual 14228 (2.041%)  origin-forest_43.843 10195 (err=1.396)  
76.9 queries/sec
Query 15: actual 191 (0.027%)  origin-forest_43.843 160 (err=1.194)  
76.9 queries/sec
Query 16: actual 4 (0.001%)  origin-forest_43.843 8 (err=2.000)  
76.9 queries/sec
Query 17: actual 4 (0.001%)  origin-forest_43.843 3 (err=1.333)  
76.9 queries/sec
Query 18: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
76.9 queries/sec
Query 19: actual 29 (0.004%)  origin-forest_43.843 26 (err=1.115)  
66.2 queries/sec
Query 20: actual 591 (0.085%)  origin-forest_43.843 1 (err=591.000)  
66.7 queries/sec
Query 21: actual 108 (0.015%)  origin-forest_43.843 87 (err=1.241)  
73.6 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
69.5 queries/sec
Query 23: actual 106025 (15.207%)  origin-forest_43.843 94484 (err=1.122)  
76.9 queries/sec
Query 24: actual 65 (0.009%)  origin-forest_43.843 1 (err=65.000)  
71.4 queries/sec
Query 25: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 26: actual 162228 (23.268%)  origin-forest_43.843 175042 (err=1.079)  
83.1 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 29: actual 154 (0.022%)  origin-forest_43.843 8 (err=19.250)  
71.4 queries/sec
Query 30: actual 315 (0.045%)  origin-forest_43.843 0 (err=315.000)  
76.9 queries/sec
Query 31: actual 113 (0.016%)  origin-forest_43.843 117 (err=1.035)  
76.9 queries/sec
Query 32: actual 461 (0.066%)  origin-forest_43.843 1 (err=461.000)  
76.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 34: actual 14 (0.002%)  origin-forest_43.843 29 (err=2.071)  
90.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 40: actual 20 (0.003%)  origin-forest_43.843 25 (err=1.250)  
90.9 queries/sec
Query 41: actual 10 (0.001%)  origin-forest_43.843 1 (err=10.000)  
83.3 queries/sec
Query 42: actual 230 (0.033%)  origin-forest_43.843 266 (err=1.157)  
95.2 queries/sec
Query 43: actual 6040 (0.866%)  origin-forest_43.843 5094 (err=1.186)  
90.9 queries/sec
Query 44: actual 155 (0.022%)  origin-forest_43.843 138 (err=1.123)  
90.9 queries/sec
Query 45: actual 9 (0.001%)  origin-forest_43.843 15 (err=1.667)  
90.9 queries/sec
Query 46: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
83.3 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 48: actual 1512 (0.217%)  origin-forest_43.843 197 (err=7.675)  
90.9 queries/sec
Query 49: actual 34 (0.005%)  origin-forest_43.843 1 (err=34.000)  
origin-forest_43.843 	max: 591.0000	99th: 527.3000	95th: 337.5500	median: 1.2614	mean: 42.6502
ReportEsts: [1.0, 1.03494046457154, 1.2727272727272727, 356.0, 78.0, 6.0, 1.3099204590228526, 5.0, 1.0, 1.0, 93.0, 1.0, 43, 1.0, 1.3955860716037274, 1.19375, 2.0, 1.3333333333333333, 3.0, 1.1153846153846154, 591.0, 1.2413793103448276, 1.0, 1.1221476652131577, 65.0, 2.0, 1.0789875977019996, 1.0, 1.0, 19.25, 315, 1.0353982300884956, 461.0, 1.0, 2.0714285714285716, 1.0, 1.0, 1.0, 1.0, 2.0, 1.25, 10.0, 1.1565217391304348, 1.1857086768747547, 1.1231884057971016, 1.6666666666666667, 4.0, 1.0, 7.675126903553299, 34.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/50 | Workload-time: 4.047493 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 4/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (601012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.0s
done, took 0.0s
new data average log likelihood = 43.8203
detection mean = 43.1977
detection threshold = 0.3139
test statistic = 0.6226
Offline time = 2.938746452331543
Online time = 0.4405090808868408
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 4-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (601012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.0s
dataset size: 601012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.1404 bits (loss 62.258, data 19.117) 0.00100 lr
epoch 9 train loss 43.0076 nats / 62.0469 bits
time since start: 4.0 secs
Epoch 10 Iter 0, train entropy gap 42.8293 bits (loss 61.947, data 19.117) 0.00082 lr
epoch 19 train loss 42.8891 nats / 61.8759 bits
time since start: 7.2 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 41.8434 nats / 60.3672 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 4/50 | Workload-time: 6.642581 | Model-update-time: 10.553554


WORKLOAD-START | Type: QueryWorkload | Progress: 5/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 2: actual 534 (0.077%)  origin-forest_43.843 550 (err=1.030)  
76.9 queries/sec
Query 3: actual 9 (0.001%)  origin-forest_43.843 6 (err=1.500)  
90.9 queries/sec
Query 4: actual 19 (0.003%)  origin-forest_43.843 15 (err=1.267)  
83.3 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
90.9 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 8: actual 4824 (0.692%)  origin-forest_43.843 3416 (err=1.412)  
99.9 queries/sec
Query 9: actual 128 (0.018%)  origin-forest_43.843 8 (err=16.000)  
79.9 queries/sec
Query 10: actual 65 (0.009%)  origin-forest_43.843 0 (err=65.000)  
90.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 40 (0.006%)  origin-forest_43.843 1 (err=40.000)  
83.3 queries/sec
Query 13: actual 8 (0.001%)  origin-forest_43.843 4 (err=2.000)  
83.3 queries/sec
Query 14: actual 8 (0.001%)  origin-forest_43.843 3 (err=2.667)  
90.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 16: actual 404 (0.058%)  origin-forest_43.843 416 (err=1.030)  
90.9 queries/sec
Query 17: actual 4 (0.001%)  origin-forest_43.843 3 (err=1.333)  
90.9 queries/sec
Query 18: actual 254 (0.036%)  origin-forest_43.843 9 (err=28.222)  
86.9 queries/sec
Query 19: actual 1830 (0.262%)  origin-forest_43.843 997 (err=1.836)  
90.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 21: actual 44 (0.006%)  origin-forest_43.843 42 (err=1.048)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 24: actual 133 (0.019%)  origin-forest_43.843 9 (err=14.778)  
83.3 queries/sec
Query 25: actual 3010 (0.432%)  origin-forest_43.843 4198 (err=1.395)  
90.8 queries/sec
Query 26: actual 36 (0.005%)  origin-forest_43.843 24 (err=1.500)  
95.1 queries/sec
Query 27: actual 6 (0.001%)  origin-forest_43.843 1 (err=6.000)  
90.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 30: actual 6 (0.001%)  origin-forest_43.843 4 (err=1.500)  
90.9 queries/sec
Query 31: actual 1938 (0.278%)  origin-forest_43.843 1556 (err=1.246)  
100.0 queries/sec
Query 32: actual 97 (0.014%)  origin-forest_43.843 130 (err=1.340)  
83.3 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 35: actual 821 (0.118%)  origin-forest_43.843 869 (err=1.058)  
86.8 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 37: actual 1067 (0.153%)  origin-forest_43.843 159 (err=6.711)  
90.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 39: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 40: actual 36 (0.005%)  origin-forest_43.843 25 (err=1.440)  
100.0 queries/sec
Query 41: actual 19 (0.003%)  origin-forest_43.843 1 (err=19.000)  
83.3 queries/sec
Query 42: actual 2194 (0.315%)  origin-forest_43.843 2763 (err=1.259)  
90.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.4 queries/sec
Query 44: actual 1113 (0.160%)  origin-forest_43.843 1510 (err=1.357)  
90.9 queries/sec
Query 45: actual 3108 (0.446%)  origin-forest_43.843 4053 (err=1.304)  
83.3 queries/sec
Query 46: actual 1701 (0.244%)  origin-forest_43.843 2017 (err=1.186)  
90.9 queries/sec
Query 47: actual 627 (0.090%)  origin-forest_43.843 829 (err=1.322)  
83.3 queries/sec
Query 48: actual 27 (0.004%)  origin-forest_43.843 40 (err=1.481)  
90.9 queries/sec
Query 49: actual 283 (0.041%)  origin-forest_43.843 238 (err=1.189)  
origin-forest_43.843 	max: 65.0000	99th: 52.7500	95th: 24.0722	median: 1.2854	mean: 4.9882
ReportEsts: [1.0, 1.0, 1.0299625468164795, 1.5, 1.2666666666666666, 2.0, 1.0, 1.0, 1.4121779859484778, 16.0, 65, 1.0, 40.0, 2.0, 2.6666666666666665, 1.0, 1.0297029702970297, 1.3333333333333333, 28.22222222222222, 1.835506519558676, 1.0, 1.0476190476190477, 1.0, 1.0, 14.777777777777779, 1.3946843853820599, 1.5, 6.0, 1.0, 1.0, 1.5, 1.2455012853470437, 1.3402061855670102, 1.0, 1.0, 1.058465286236297, 1.0, 6.710691823899371, 1.0, 2.0, 1.44, 19.0, 1.2593436645396536, 1.0, 1.3566936208445641, 1.304054054054054, 1.1857730746619635, 1.3221690590111643, 1.4814814814814814, 1.1890756302521008]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 5/50 | Workload-time: 4.135017 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 6/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
39.2 queries/sec
Query 1: actual 11 (0.002%)  origin-forest_43.843 7 (err=1.571)  
76.9 queries/sec
Query 2: actual 369 (0.053%)  origin-forest_43.843 298 (err=1.238)  
90.9 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 6: actual 4 (0.001%)  origin-forest_43.843 4 (err=1.000)  
83.3 queries/sec
Query 7: actual 18 (0.003%)  origin-forest_43.843 17 (err=1.059)  
86.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 7 (0.001%)  origin-forest_43.843 10 (err=1.429)  
83.3 queries/sec
Query 11: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 14: actual 48 (0.007%)  origin-forest_43.843 46 (err=1.043)  
90.6 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
75.2 queries/sec
Query 16: actual 25 (0.004%)  origin-forest_43.843 23 (err=1.087)  
90.9 queries/sec
Query 17: actual 428 (0.061%)  origin-forest_43.843 307 (err=1.394)  
83.3 queries/sec
Query 18: actual 152 (0.022%)  origin-forest_43.843 100 (err=1.520)  
90.9 queries/sec
Query 19: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
76.9 queries/sec
Query 21: actual 68171 (9.778%)  origin-forest_43.843 80571 (err=1.182)  
100.0 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 25: actual 35 (0.005%)  origin-forest_43.843 34 (err=1.029)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 114 (0.016%)  origin-forest_43.843 0 (err=114.000)  
76.9 queries/sec
Query 29: actual 3176 (0.456%)  origin-forest_43.843 3245 (err=1.022)  
90.9 queries/sec
Query 30: actual 19 (0.003%)  origin-forest_43.843 24 (err=1.263)  
83.4 queries/sec
Query 31: actual 46 (0.007%)  origin-forest_43.843 1 (err=46.000)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 35: actual 16633 (2.386%)  origin-forest_43.843 18422 (err=1.108)  
83.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 44541 (6.388%)  origin-forest_43.843 56143 (err=1.260)  
90.5 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 42: actual 930 (0.133%)  origin-forest_43.843 1025 (err=1.102)  
90.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 51 (0.007%)  origin-forest_43.843 10 (err=5.100)  
76.9 queries/sec
Query 45: actual 145 (0.021%)  origin-forest_43.843 0 (err=145.000)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 47: actual 90 (0.013%)  origin-forest_43.843 1 (err=90.000)  
76.9 queries/sec
Query 48: actual 1480 (0.212%)  origin-forest_43.843 1660 (err=1.122)  
90.6 queries/sec
Query 49: actual 791 (0.113%)  origin-forest_43.843 1158 (err=1.464)  
origin-forest_43.843 	max: 145.0000	99th: 129.8100	95th: 70.2000	median: 1.0109	mean: 9.0399
ReportEsts: [1.0, 1.5714285714285714, 1.238255033557047, 1.0, 1.0, 1.0, 1.0, 1.0588235294117647, 1.0, 1.0, 1.4285714285714286, 2.0, 1.0, 1.0, 1.0434782608695652, 1.0, 1.0869565217391304, 1.3941368078175895, 1.52, 2.0, 2.0, 1.1818955274236846, 1.0, 1.0, 1.0, 1.0294117647058822, 1.0, 1.0, 114, 1.0217254408060454, 1.263157894736842, 46.0, 1.0, 1.0, 1.0, 1.1075572656766668, 1.0, 1.0, 1.0, 1.0, 1.2604791091354033, 1.0, 1.1021505376344085, 1.0, 5.1, 145, 1.0, 90.0, 1.1216216216216217, 1.4639696586599242]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 6/50 | Workload-time: 4.114628 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 7/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1633 (0.234%)  origin-forest_43.843 1888 (err=1.156)  
43.5 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 3 (err=3.000)  
83.3 queries/sec
Query 5: actual 33630 (4.823%)  origin-forest_43.843 35243 (err=1.048)  
83.3 queries/sec
Query 6: actual 14 (0.002%)  origin-forest_43.843 8 (err=1.750)  
95.2 queries/sec
Query 7: actual 57 (0.008%)  origin-forest_43.843 1 (err=57.000)  
83.3 queries/sec
Query 8: actual 536 (0.077%)  origin-forest_43.843 595 (err=1.110)  
90.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 10: actual 19 (0.003%)  origin-forest_43.843 49 (err=2.579)  
83.3 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 5 (0.001%)  origin-forest_43.843 2 (err=2.500)  
83.3 queries/sec
Query 13: actual 335 (0.048%)  origin-forest_43.843 416 (err=1.242)  
83.3 queries/sec
Query 14: actual 68 (0.010%)  origin-forest_43.843 2 (err=34.000)  
83.3 queries/sec
Query 15: actual 5762 (0.826%)  origin-forest_43.843 6192 (err=1.075)  
86.8 queries/sec
Query 16: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
83.3 queries/sec
Query 17: actual 281 (0.040%)  origin-forest_43.843 2 (err=140.500)  
83.3 queries/sec
Query 18: actual 1058 (0.152%)  origin-forest_43.843 1330 (err=1.257)  
73.8 queries/sec
Query 19: actual 4 (0.001%)  origin-forest_43.843 4 (err=1.000)  
84.0 queries/sec
Query 20: actual 10259 (1.471%)  origin-forest_43.843 12583 (err=1.227)  
95.1 queries/sec
Query 21: actual 6955 (0.998%)  origin-forest_43.843 9950 (err=1.431)  
90.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.8 queries/sec
Query 23: actual 7159 (1.027%)  origin-forest_43.843 7337 (err=1.025)  
86.9 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 25: actual 2814 (0.404%)  origin-forest_43.843 3716 (err=1.321)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 27: actual 41 (0.006%)  origin-forest_43.843 1 (err=41.000)  
83.4 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 30: actual 928 (0.133%)  origin-forest_43.843 949 (err=1.023)  
83.3 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 32: actual 15589 (2.236%)  origin-forest_43.843 11732 (err=1.329)  
90.0 queries/sec
Query 33: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
76.9 queries/sec
Query 34: actual 34 (0.005%)  origin-forest_43.843 25 (err=1.360)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 36: actual 94 (0.013%)  origin-forest_43.843 4 (err=23.500)  
100.0 queries/sec
Query 37: actual 52 (0.007%)  origin-forest_43.843 1 (err=52.000)  
83.3 queries/sec
Query 38: actual 17795 (2.552%)  origin-forest_43.843 21183 (err=1.190)  
71.4 queries/sec
Query 39: actual 12 (0.002%)  origin-forest_43.843 19 (err=1.583)  
83.3 queries/sec
Query 40: actual 116 (0.017%)  origin-forest_43.843 100 (err=1.160)  
86.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 44: actual 20 (0.003%)  origin-forest_43.843 18 (err=1.111)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
90.9 queries/sec
Query 46: actual 826 (0.118%)  origin-forest_43.843 362 (err=2.282)  
90.9 queries/sec
Query 47: actual 31377 (4.500%)  origin-forest_43.843 44295 (err=1.412)  
90.9 queries/sec
Query 48: actual 240369 (34.476%)  origin-forest_43.843 213918 (err=1.124)  
90.9 queries/sec
Query 49: actual 941 (0.135%)  origin-forest_43.843 1122 (err=1.192)  
origin-forest_43.843 	max: 140.5000	99th: 99.5850	95th: 47.0500	median: 1.1581	mean: 8.0997
ReportEsts: [1.1561543172075934, 1.0, 1.0, 1.0, 3.0, 1.0479631281593815, 1.75, 57.0, 1.1100746268656716, 1.0, 2.5789473684210527, 1.0, 2.5, 1.2417910447761193, 34.0, 1.0746268656716418, 1.0, 140.5, 1.2570888468809074, 1.0, 1.226532800467882, 1.430625449317038, 1.0, 1.0248638077943848, 1.0, 1.320540156361052, 1.0, 41.0, 1.0, 1.0, 1.0226293103448276, 1.0, 1.3287589498806682, 1.5, 1.36, 1.0, 23.5, 52.0, 1.1903905591458275, 1.5833333333333333, 1.16, 1.0, 1.0, 1.0, 1.1111111111111112, 2.0, 2.281767955801105, 1.4117028396596234, 1.1236501837152553, 1.1923485653560042]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 7/50 | Workload-time: 4.106323 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 8/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 13250 (1.900%)  origin-forest_43.843 13112 (err=1.011)  
41.7 queries/sec
Query 1: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 3: actual 4354 (0.624%)  origin-forest_43.843 3546 (err=1.228)  
86.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 6: actual 15 (0.002%)  origin-forest_43.843 0 (err=15.000)  
76.9 queries/sec
Query 7: actual 113 (0.016%)  origin-forest_43.843 15 (err=7.533)  
90.9 queries/sec
Query 8: actual 92 (0.013%)  origin-forest_43.843 218 (err=2.370)  
83.3 queries/sec
Query 9: actual 67 (0.010%)  origin-forest_43.843 73 (err=1.090)  
83.3 queries/sec
Query 10: actual 2410 (0.346%)  origin-forest_43.843 3013 (err=1.250)  
76.9 queries/sec
Query 11: actual 340 (0.049%)  origin-forest_43.843 344 (err=1.012)  
76.9 queries/sec
Query 12: actual 12011 (1.723%)  origin-forest_43.843 11504 (err=1.044)  
79.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 14: actual 19575 (2.808%)  origin-forest_43.843 22775 (err=1.163)  
76.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 16: actual 278 (0.040%)  origin-forest_43.843 260 (err=1.069)  
76.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 18: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
71.4 queries/sec
Query 19: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
79.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 3 (err=3.000)  
71.4 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 25: actual 108374 (15.544%)  origin-forest_43.843 123656 (err=1.141)  
83.3 queries/sec
Query 26: actual 4 (0.001%)  origin-forest_43.843 7 (err=1.750)  
90.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.2 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 126 (0.018%)  origin-forest_43.843 1 (err=126.000)  
76.9 queries/sec
Query 30: actual 24 (0.003%)  origin-forest_43.843 90 (err=3.750)  
90.9 queries/sec
Query 31: actual 7 (0.001%)  origin-forest_43.843 7 (err=1.000)  
83.3 queries/sec
Query 32: actual 4 (0.001%)  origin-forest_43.843 8 (err=2.000)  
90.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
66.7 queries/sec
Query 34: actual 87 (0.012%)  origin-forest_43.843 167 (err=1.920)  
76.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.5 queries/sec
Query 36: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 38: actual 39068 (5.603%)  origin-forest_43.843 47063 (err=1.205)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 42: actual 3629 (0.521%)  origin-forest_43.843 2204 (err=1.647)  
83.3 queries/sec
Query 43: actual 4 (0.001%)  origin-forest_43.843 3 (err=1.333)  
86.9 queries/sec
Query 44: actual 382 (0.055%)  origin-forest_43.843 65 (err=5.877)  
76.9 queries/sec
Query 45: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 46: actual 38 (0.005%)  origin-forest_43.843 19 (err=2.000)  
89.7 queries/sec
Query 47: actual 13 (0.002%)  origin-forest_43.843 9 (err=1.444)  
89.8 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.6 queries/sec
Query 49: actual 135 (0.019%)  origin-forest_43.843 4 (err=33.750)  
origin-forest_43.843 	max: 126.0000	99th: 94.6400	95th: 25.3125	median: 1.1522	mean: 6.2417
ReportEsts: [1.0105247101891397, 2.0, 1.0, 1.2278623801466442, 1.0, 1.0, 15, 7.533333333333333, 2.369565217391304, 1.0895522388059702, 1.250207468879668, 1.011764705882353, 1.0440716272600834, 1.0, 1.1634738186462323, 1.0, 1.0692307692307692, 1.0, 1.5, 62.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.14101168176869, 1.75, 1.0, 1.0, 126.0, 3.75, 1.0, 2.0, 2.0, 1.9195402298850575, 1.0, 2.0, 1.0, 1.2046431862393776, 1.0, 1.0, 1.0, 1.646551724137931, 1.3333333333333333, 5.876923076923077, 3.0, 2.0, 1.4444444444444444, 1.0, 33.75]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 8/50 | Workload-time: 4.130235 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 9/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (611012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.0s
new data average log likelihood = 43.5548
detection mean = 43.2097
detection threshold = 0.3196
test statistic = 0.3451
Offline time = 2.9538300037384033
Online time = 0.43389415740966797
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 9-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (611012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 611012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.1896 bits (loss 62.278, data 19.089) 0.00100 lr
epoch 9 train loss 42.8740 nats / 61.8541 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.8422 bits (loss 61.931, data 19.089) 0.00082 lr
epoch 19 train loss 42.7305 nats / 61.6471 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 41.2961 nats / 59.5777 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 9/50 | Workload-time: 6.606983 | Model-update-time: 10.321790


WORKLOAD-START | Type: QueryWorkload | Progress: 10/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 59 (0.008%)  origin-forest_43.843 1 (err=59.000)  
41.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 3: actual 31 (0.004%)  origin-forest_43.843 65 (err=2.097)  
90.9 queries/sec
Query 4: actual 37 (0.005%)  origin-forest_43.843 1 (err=37.000)  
83.3 queries/sec
Query 5: actual 107 (0.015%)  origin-forest_43.843 1 (err=107.000)  
83.2 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 7: actual 67 (0.010%)  origin-forest_43.843 34 (err=1.971)  
95.1 queries/sec
Query 8: actual 5 (0.001%)  origin-forest_43.843 7 (err=1.400)  
83.3 queries/sec
Query 9: actual 215 (0.031%)  origin-forest_43.843 249 (err=1.158)  
76.9 queries/sec
Query 10: actual 7893 (1.132%)  origin-forest_43.843 8152 (err=1.033)  
100.0 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 12: actual 62 (0.009%)  origin-forest_43.843 65 (err=1.048)  
83.3 queries/sec
Query 13: actual 24 (0.003%)  origin-forest_43.843 1 (err=24.000)  
83.3 queries/sec
Query 14: actual 10 (0.001%)  origin-forest_43.843 12 (err=1.200)  
83.3 queries/sec
Query 15: actual 74 (0.011%)  origin-forest_43.843 64 (err=1.156)  
86.8 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 93 (0.013%)  origin-forest_43.843 81 (err=1.148)  
83.3 queries/sec
Query 18: actual 118 (0.017%)  origin-forest_43.843 1 (err=118.000)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 20: actual 18597 (2.667%)  origin-forest_43.843 23643 (err=1.271)  
90.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 100 (0.014%)  origin-forest_43.843 101 (err=1.010)  
76.9 queries/sec
Query 23: actual 1912 (0.274%)  origin-forest_43.843 2820 (err=1.475)  
95.1 queries/sec
Query 24: actual 53 (0.008%)  origin-forest_43.843 64 (err=1.208)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 147457 (21.149%)  origin-forest_43.843 160597 (err=1.089)  
90.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 28: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 29: actual 543 (0.078%)  origin-forest_43.843 515 (err=1.054)  
71.4 queries/sec
Query 30: actual 97 (0.014%)  origin-forest_43.843 5 (err=19.400)  
83.3 queries/sec
Query 31: actual 173 (0.025%)  origin-forest_43.843 152 (err=1.138)  
90.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
76.9 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.0 queries/sec
Query 37: actual 38 (0.005%)  origin-forest_43.843 12 (err=3.167)  
97.6 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 37 (0.005%)  origin-forest_43.843 36 (err=1.028)  
83.0 queries/sec
Query 41: actual 58 (0.008%)  origin-forest_43.843 71 (err=1.224)  
83.3 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 43: actual 26 (0.004%)  origin-forest_43.843 1 (err=26.000)  
76.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 46: actual 95 (0.014%)  origin-forest_43.843 1 (err=95.000)  
71.4 queries/sec
Query 47: actual 5 (0.001%)  origin-forest_43.843 6 (err=1.200)  
76.9 queries/sec
Query 48: actual 50653 (7.265%)  origin-forest_43.843 57672 (err=1.139)  
82.1 queries/sec
Query 49: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
origin-forest_43.843 	max: 118.0000	99th: 112.6100	95th: 78.8000	median: 1.1384	mean: 10.7523
ReportEsts: [59.0, 1.0, 1.0, 2.096774193548387, 37.0, 107.0, 1.0, 1.9705882352941178, 1.4, 1.158139534883721, 1.0328138857215254, 1.0, 1.0483870967741935, 24.0, 1.2, 1.15625, 1.0, 1.1481481481481481, 118.0, 1.0, 1.2713340861429263, 1.0, 1.01, 1.4748953974895398, 1.2075471698113207, 1.0, 1.0891107238042277, 1.0, 2.0, 1.054368932038835, 19.4, 1.138157894736842, 1.0, 1.0, 1.0, 2.0, 1.0, 3.1666666666666665, 1.0, 1.0, 1.0277777777777777, 1.2241379310344827, 1.0, 26.0, 1.0, 1.0, 95.0, 1.2, 1.138570272244487, 2.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 10/50 | Workload-time: 4.027389 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 11/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (621012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.0s
done, took 0.0s
new data average log likelihood = 43.3375
detection mean = 43.2960
detection threshold = 0.3252
test statistic = 0.0415
Offline time = 3.027008056640625
Online time = 0.45116496086120605
Test result: False
Drift detection: False
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 11/50 | Workload-time: 6.641963 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 12/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (631012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.0s
new data average log likelihood = 43.1836
detection mean = 43.3003
detection threshold = 0.3329
test statistic = 0.1167
Offline time = 2.8723642826080322
Online time = 0.4371521472930908
Test result: False
Drift detection: False
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 12/50 | Workload-time: 6.409927 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 13/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (641012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.0s
new data average log likelihood = 43.0425
detection mean = 43.3068
detection threshold = 0.3366
test statistic = 0.2643
Offline time = 2.867706298828125
Online time = 0.4431185722351074
Test result: False
Drift detection: False
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 13/50 | Workload-time: 6.558271 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 14/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 72673 (10.423%)  origin-forest_43.843 85868 (err=1.182)  
35.6 queries/sec
Query 1: actual 24 (0.003%)  origin-forest_43.843 26 (err=1.083)  
83.3 queries/sec
Query 2: actual 210 (0.030%)  origin-forest_43.843 174 (err=1.207)  
90.9 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 4: actual 181 (0.026%)  origin-forest_43.843 96 (err=1.885)  
83.3 queries/sec
Query 5: actual 198 (0.028%)  origin-forest_43.843 254 (err=1.283)  
90.8 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 7: actual 21 (0.003%)  origin-forest_43.843 41 (err=1.952)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 9: actual 23 (0.003%)  origin-forest_43.843 14 (err=1.643)  
83.3 queries/sec
Query 10: actual 40989 (5.879%)  origin-forest_43.843 29310 (err=1.398)  
90.9 queries/sec
Query 11: actual 21091 (3.025%)  origin-forest_43.843 13474 (err=1.565)  
90.9 queries/sec
Query 12: actual 274 (0.039%)  origin-forest_43.843 257 (err=1.066)  
90.9 queries/sec
Query 13: actual 135 (0.019%)  origin-forest_43.843 1 (err=135.000)  
83.3 queries/sec
Query 14: actual 80 (0.011%)  origin-forest_43.843 123 (err=1.538)  
90.9 queries/sec
Query 15: actual 43 (0.006%)  origin-forest_43.843 1 (err=43.000)  
86.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 18: actual 97 (0.014%)  origin-forest_43.843 172 (err=1.773)  
76.9 queries/sec
Query 19: actual 773 (0.111%)  origin-forest_43.843 396 (err=1.952)  
76.9 queries/sec
Query 20: actual 84086 (12.060%)  origin-forest_43.843 94096 (err=1.119)  
100.0 queries/sec
Query 21: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
83.3 queries/sec
Query 22: actual 158 (0.023%)  origin-forest_43.843 1 (err=158.000)  
90.9 queries/sec
Query 23: actual 9 (0.001%)  origin-forest_43.843 3 (err=3.000)  
86.9 queries/sec
Query 24: actual 451 (0.065%)  origin-forest_43.843 50 (err=9.020)  
90.9 queries/sec
Query 25: actual 3 (0.000%)  origin-forest_43.843 9 (err=3.000)  
90.9 queries/sec
Query 26: actual 24 (0.003%)  origin-forest_43.843 23 (err=1.043)  
90.9 queries/sec
Query 27: actual 396 (0.057%)  origin-forest_43.843 0 (err=396.000)  
76.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
83.3 queries/sec
Query 30: actual 2048 (0.294%)  origin-forest_43.843 2363 (err=1.154)  
90.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.4 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 35: actual 269 (0.039%)  origin-forest_43.843 67 (err=4.015)  
83.3 queries/sec
Query 36: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 37: actual 30 (0.004%)  origin-forest_43.843 14 (err=2.143)  
90.9 queries/sec
Query 38: actual 25489 (3.656%)  origin-forest_43.843 33353 (err=1.309)  
83.3 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 40: actual 56 (0.008%)  origin-forest_43.843 1 (err=56.000)  
79.9 queries/sec
Query 41: actual 10 (0.001%)  origin-forest_43.843 4 (err=2.500)  
83.3 queries/sec
Query 42: actual 388 (0.056%)  origin-forest_43.843 238 (err=1.630)  
90.9 queries/sec
Query 43: actual 566 (0.081%)  origin-forest_43.843 784 (err=1.385)  
90.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 45: actual 58 (0.008%)  origin-forest_43.843 58 (err=1.000)  
100.0 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 48: actual 587 (0.084%)  origin-forest_43.843 44 (err=13.341)  
83.3 queries/sec
Query 49: actual 3171 (0.455%)  origin-forest_43.843 2581 (err=1.229)  
origin-forest_43.843 	max: 396.0000	99th: 279.3800	95th: 99.4500	median: 1.2957	mean: 17.4583
ReportEsts: [1.1815667441828464, 1.0833333333333333, 1.206896551724138, 1.0, 1.8854166666666667, 1.2828282828282829, 1.0, 1.9523809523809523, 1.0, 1.6428571428571428, 1.3984646878198568, 1.5653109692741576, 1.066147859922179, 135.0, 1.5375, 43.0, 1.0, 1.0, 1.7731958762886597, 1.952020202020202, 1.1190447874794853, 1.5, 158.0, 3.0, 9.02, 3.0, 1.0434782608695652, 396, 1.0, 1.0, 1.15380859375, 1.0, 1.0, 1.0, 1.0, 4.014925373134329, 2.0, 2.142857142857143, 1.3085252461846286, 1.0, 56.0, 2.5, 1.6302521008403361, 1.3851590106007068, 1.0, 1.0, 1.0, 1.0, 13.340909090909092, 1.2285935683843472]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 14/50 | Workload-time: 4.001017 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 15/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (651012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 42.9099
detection mean = 43.3148
detection threshold = 0.3348
test statistic = 0.4048
Offline time = 2.858989953994751
Online time = 0.4744296073913574
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 15-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (651012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 651012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.0471 bits (loss 61.985, data 18.938) 0.00100 lr
epoch 9 train loss 42.7348 nats / 61.6533 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.6875 bits (loss 61.625, data 18.938) 0.00082 lr
epoch 19 train loss 42.6139 nats / 61.4788 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 40.8281 nats / 58.9025 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 15/50 | Workload-time: 6.402044 | Model-update-time: 10.183520


WORKLOAD-START | Type: QueryWorkload | Progress: 16/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
39.2 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 2: actual 26 (0.004%)  origin-forest_43.843 28 (err=1.077)  
76.9 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 4: actual 10396 (1.491%)  origin-forest_43.843 11141 (err=1.072)  
90.9 queries/sec
Query 5: actual 169 (0.024%)  origin-forest_43.843 1 (err=169.000)  
90.9 queries/sec
Query 6: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.3 queries/sec
Query 8: actual 754 (0.108%)  origin-forest_43.843 731 (err=1.031)  
100.0 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 12: actual 47 (0.007%)  origin-forest_43.843 1 (err=47.000)  
66.7 queries/sec
Query 13: actual 5623 (0.806%)  origin-forest_43.843 6850 (err=1.218)  
100.0 queries/sec
Query 14: actual 58 (0.008%)  origin-forest_43.843 67 (err=1.155)  
83.3 queries/sec
Query 15: actual 3 (0.000%)  origin-forest_43.843 4 (err=1.333)  
83.3 queries/sec
Query 16: actual 43 (0.006%)  origin-forest_43.843 51 (err=1.186)  
82.7 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 568 (0.081%)  origin-forest_43.843 1 (err=568.000)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
87.5 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.5 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.3 queries/sec
Query 22: actual 125120 (17.946%)  origin-forest_43.843 67320 (err=1.859)  
90.9 queries/sec
Query 23: actual 3 (0.000%)  origin-forest_43.843 11 (err=3.667)  
90.8 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 25: actual 54099 (7.759%)  origin-forest_43.843 37327 (err=1.449)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 30: actual 10 (0.001%)  origin-forest_43.843 3 (err=3.333)  
83.3 queries/sec
Query 31: actual 80 (0.011%)  origin-forest_43.843 1 (err=80.000)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.4 queries/sec
Query 33: actual 11 (0.002%)  origin-forest_43.843 1 (err=11.000)  
76.9 queries/sec
Query 34: actual 1865 (0.267%)  origin-forest_43.843 3728 (err=1.999)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 36: actual 142979 (20.507%)  origin-forest_43.843 138223 (err=1.034)  
100.0 queries/sec
Query 37: actual 64 (0.009%)  origin-forest_43.843 0 (err=64.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 41: actual 83 (0.012%)  origin-forest_43.843 90 (err=1.084)  
86.8 queries/sec
Query 42: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
83.3 queries/sec
Query 43: actual 17 (0.002%)  origin-forest_43.843 14 (err=1.214)  
90.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
76.9 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 48: actual 1026 (0.147%)  origin-forest_43.843 552 (err=1.859)  
90.8 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 568.0000	99th: 372.4900	95th: 72.8000	median: 1.0329	mean: 19.9064
ReportEsts: [2.0, 1.0, 1.0769230769230769, 1.0, 1.0716621777606772, 169.0, 2.0, 1.0, 1.0314637482900137, 1.0, 1.0, 1.0, 47.0, 1.2182109194380224, 1.1551724137931034, 1.3333333333333333, 1.186046511627907, 1.0, 568.0, 1.0, 1.0, 1.0, 1.8585858585858586, 3.6666666666666665, 1.0, 1.4493262249845955, 1.0, 1.0, 1.0, 1.0, 3.3333333333333335, 80.0, 1.0, 11.0, 1.9989276139410188, 1.0, 1.0344081665135325, 64, 1.0, 1.0, 1.0, 1.0843373493975903, 1.25, 1.2142857142857142, 1.0, 1.0, 1.5, 1.0, 1.858695652173913, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 16/50 | Workload-time: 4.007777 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 17/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 2: actual 131 (0.019%)  origin-forest_43.843 151 (err=1.153)  
88.7 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 4: actual 61748 (8.856%)  origin-forest_43.843 74398 (err=1.205)  
90.9 queries/sec
Query 5: actual 9 (0.001%)  origin-forest_43.843 5 (err=1.800)  
90.9 queries/sec
Query 6: actual 16 (0.002%)  origin-forest_43.843 2 (err=8.000)  
83.4 queries/sec
Query 7: actual 355 (0.051%)  origin-forest_43.843 413 (err=1.163)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 9: actual 286 (0.041%)  origin-forest_43.843 154 (err=1.857)  
90.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.7 queries/sec
Query 12: actual 136 (0.020%)  origin-forest_43.843 2 (err=68.000)  
91.3 queries/sec
Query 13: actual 49 (0.007%)  origin-forest_43.843 99 (err=2.020)  
83.3 queries/sec
Query 14: actual 15 (0.002%)  origin-forest_43.843 1 (err=15.000)  
83.3 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 16: actual 130305 (18.689%)  origin-forest_43.843 129480 (err=1.006)  
90.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 2713 (0.389%)  origin-forest_43.843 3062 (err=1.129)  
86.9 queries/sec
Query 20: actual 209 (0.030%)  origin-forest_43.843 344 (err=1.646)  
83.3 queries/sec
Query 21: actual 146 (0.021%)  origin-forest_43.843 178 (err=1.219)  
83.3 queries/sec
Query 22: actual 4416 (0.633%)  origin-forest_43.843 4970 (err=1.125)  
90.9 queries/sec
Query 23: actual 1563 (0.224%)  origin-forest_43.843 469 (err=3.333)  
90.9 queries/sec
Query 24: actual 1577 (0.226%)  origin-forest_43.843 1278 (err=1.234)  
100.0 queries/sec
Query 25: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
83.3 queries/sec
Query 26: actual 63 (0.009%)  origin-forest_43.843 11 (err=5.727)  
90.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 28: actual 9586 (1.375%)  origin-forest_43.843 9453 (err=1.014)  
95.1 queries/sec
Query 29: actual 43 (0.006%)  origin-forest_43.843 25 (err=1.720)  
90.9 queries/sec
Query 30: actual 31 (0.004%)  origin-forest_43.843 26 (err=1.192)  
90.9 queries/sec
Query 31: actual 1146 (0.164%)  origin-forest_43.843 1334 (err=1.164)  
90.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 133 (0.019%)  origin-forest_43.843 1 (err=133.000)  
90.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 26105 (3.744%)  origin-forest_43.843 9066 (err=2.879)  
83.3 queries/sec
Query 36: actual 1127 (0.162%)  origin-forest_43.843 707 (err=1.594)  
73.7 queries/sec
Query 37: actual 253 (0.036%)  origin-forest_43.843 1 (err=253.000)  
80.0 queries/sec
Query 38: actual 28 (0.004%)  origin-forest_43.843 1 (err=28.000)  
83.3 queries/sec
Query 39: actual 6770 (0.971%)  origin-forest_43.843 7668 (err=1.133)  
76.9 queries/sec
Query 40: actual 1382 (0.198%)  origin-forest_43.843 1643 (err=1.189)  
100.0 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 43: actual 38 (0.005%)  origin-forest_43.843 86 (err=2.263)  
90.9 queries/sec
Query 44: actual 147 (0.021%)  origin-forest_43.843 3 (err=49.000)  
83.3 queries/sec
Query 45: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
95.2 queries/sec
Query 46: actual 60 (0.009%)  origin-forest_43.843 6 (err=10.000)  
83.3 queries/sec
Query 47: actual 451 (0.065%)  origin-forest_43.843 371 (err=1.216)  
90.9 queries/sec
Query 48: actual 1142 (0.164%)  origin-forest_43.843 1216 (err=1.065)  
90.9 queries/sec
Query 49: actual 106 (0.015%)  origin-forest_43.843 97 (err=1.093)  
origin-forest_43.843 	max: 253.0000	99th: 194.2000	95th: 59.4500	median: 1.1906	mean: 12.5128
ReportEsts: [1.0, 1.0, 1.1526717557251909, 1.0, 1.204864934896677, 1.8, 8.0, 1.1633802816901408, 1.0, 1.8571428571428572, 1.0, 1.0, 68.0, 2.020408163265306, 15.0, 1.0, 1.006371640407785, 1.0, 1.0, 1.128639882049392, 1.645933014354067, 1.2191780821917808, 1.1254528985507246, 3.3326226012793176, 1.2339593114241, 1.5, 5.7272727272727275, 1.0, 1.0140696075320004, 1.72, 1.1923076923076923, 1.1640488656195462, 1.0, 133.0, 1.0, 2.8794396646812266, 1.5940594059405941, 253.0, 28.0, 1.1326440177252586, 1.1888567293777135, 1.0, 1.0, 2.263157894736842, 49.0, 3.0, 10.0, 1.215633423180593, 1.064798598949212, 1.092783505154639]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 17/50 | Workload-time: 3.949935 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 18/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 148496 (21.298%)  origin-forest_43.843 185213 (err=1.247)  
41.7 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.7 queries/sec
Query 3: actual 496 (0.071%)  origin-forest_43.843 771 (err=1.554)  
90.9 queries/sec
Query 4: actual 1357 (0.195%)  origin-forest_43.843 1127 (err=1.204)  
87.0 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 10 (err=1.250)  
83.3 queries/sec
Query 6: actual 410 (0.059%)  origin-forest_43.843 407 (err=1.007)  
83.3 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 8: actual 50 (0.007%)  origin-forest_43.843 1 (err=50.000)  
76.9 queries/sec
Query 9: actual 128 (0.018%)  origin-forest_43.843 2 (err=64.000)  
83.3 queries/sec
Query 10: actual 164 (0.024%)  origin-forest_43.843 138 (err=1.188)  
83.3 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 12: actual 42 (0.006%)  origin-forest_43.843 48 (err=1.143)  
90.9 queries/sec
Query 13: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
83.3 queries/sec
Query 14: actual 62879 (9.019%)  origin-forest_43.843 34393 (err=1.828)  
90.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
71.4 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 69 (0.010%)  origin-forest_43.843 41 (err=1.683)  
86.8 queries/sec
Query 20: actual 33 (0.005%)  origin-forest_43.843 15 (err=2.200)  
90.9 queries/sec
Query 21: actual 13191 (1.892%)  origin-forest_43.843 13644 (err=1.034)  
90.9 queries/sec
Query 22: actual 23937 (3.433%)  origin-forest_43.843 31080 (err=1.298)  
90.9 queries/sec
Query 23: actual 176 (0.025%)  origin-forest_43.843 237 (err=1.347)  
100.0 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 5 (err=5.000)  
83.3 queries/sec
Query 25: actual 409 (0.059%)  origin-forest_43.843 371 (err=1.102)  
90.9 queries/sec
Query 26: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
90.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 196 (0.028%)  origin-forest_43.843 252 (err=1.286)  
86.8 queries/sec
Query 29: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
90.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 31: actual 4701 (0.674%)  origin-forest_43.843 2715 (err=1.731)  
83.3 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 33: actual 6045 (0.867%)  origin-forest_43.843 5747 (err=1.052)  
83.3 queries/sec
Query 34: actual 1808 (0.259%)  origin-forest_43.843 2248 (err=1.243)  
90.9 queries/sec
Query 35: actual 8 (0.001%)  origin-forest_43.843 19 (err=2.375)  
86.2 queries/sec
Query 36: actual 147 (0.021%)  origin-forest_43.843 128 (err=1.148)  
86.8 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 41: actual 5 (0.001%)  origin-forest_43.843 3 (err=1.667)  
76.9 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 43: actual 2612 (0.375%)  origin-forest_43.843 2578 (err=1.013)  
90.8 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 17 (0.002%)  origin-forest_43.843 32 (err=1.882)  
83.3 queries/sec
Query 47: actual 19540 (2.803%)  origin-forest_43.843 18099 (err=1.080)  
90.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 64.0000	99th: 57.1400	95th: 4.1000	median: 1.1226	mean: 3.5913
ReportEsts: [1.2472591854326043, 1.0, 1.0, 1.5544354838709677, 1.2040816326530612, 1.25, 1.0073710073710074, 1.0, 50.0, 64.0, 1.1884057971014492, 1.0, 1.1428571428571428, 1.5, 1.828249934579711, 2.0, 1.0, 1.0, 1.0, 1.6829268292682926, 2.2, 1.0343415965430975, 1.2984083218448428, 1.3465909090909092, 5.0, 1.1024258760107817, 1.5, 1.0, 1.2857142857142858, 3.0, 1.0, 1.7314917127071823, 1.0, 1.051853140769097, 1.2433628318584071, 2.375, 1.1484375, 1.0, 1.0, 1.0, 1.0, 1.6666666666666667, 1.0, 1.013188518231187, 1.0, 1.0, 1.8823529411764706, 1.0796176584341677, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 18/50 | Workload-time: 4.015315 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 19/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 12149 (1.743%)  origin-forest_43.843 14421 (err=1.187)  
43.5 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 310 (0.044%)  origin-forest_43.843 1 (err=310.000)  
76.9 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 5 (err=1.600)  
90.9 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 7: actual 198 (0.028%)  origin-forest_43.843 178 (err=1.112)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 9: actual 3533 (0.507%)  origin-forest_43.843 3608 (err=1.021)  
90.9 queries/sec
Query 10: actual 9 (0.001%)  origin-forest_43.843 15 (err=1.667)  
83.3 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
82.5 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 15: actual 16 (0.002%)  origin-forest_43.843 34 (err=2.125)  
83.3 queries/sec
Query 16: actual 524 (0.075%)  origin-forest_43.843 749 (err=1.429)  
52.6 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 743 (0.107%)  origin-forest_43.843 178 (err=4.174)  
90.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.5 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 22: actual 3996 (0.573%)  origin-forest_43.843 4047 (err=1.013)  
100.0 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 25: actual 58 (0.008%)  origin-forest_43.843 3 (err=19.333)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 28: actual 16 (0.002%)  origin-forest_43.843 9 (err=1.778)  
90.9 queries/sec
Query 29: actual 16197 (2.323%)  origin-forest_43.843 18721 (err=1.156)  
83.0 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 31: actual 931 (0.134%)  origin-forest_43.843 550 (err=1.693)  
100.0 queries/sec
Query 32: actual 54 (0.008%)  origin-forest_43.843 3 (err=18.000)  
90.9 queries/sec
Query 33: actual 44 (0.006%)  origin-forest_43.843 1 (err=44.000)  
83.3 queries/sec
Query 34: actual 6 (0.001%)  origin-forest_43.843 29 (err=4.833)  
90.9 queries/sec
Query 35: actual 65 (0.009%)  origin-forest_43.843 50 (err=1.300)  
83.3 queries/sec
Query 36: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 37: actual 62 (0.009%)  origin-forest_43.843 76 (err=1.226)  
82.4 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
77.6 queries/sec
Query 39: actual 7 (0.001%)  origin-forest_43.843 3 (err=2.333)  
81.4 queries/sec
Query 40: actual 32 (0.005%)  origin-forest_43.843 14 (err=2.286)  
83.3 queries/sec
Query 41: actual 89 (0.013%)  origin-forest_43.843 95 (err=1.067)  
90.9 queries/sec
Query 42: actual 46 (0.007%)  origin-forest_43.843 9 (err=5.111)  
76.9 queries/sec
Query 43: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 44: actual 227 (0.033%)  origin-forest_43.843 1 (err=227.000)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 161 (0.023%)  origin-forest_43.843 5 (err=32.200)  
79.9 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 310.0000	99th: 269.3300	95th: 38.6900	median: 1.1341	mean: 14.3929
ReportEsts: [1.1870112766482839, 1.0, 310.0, 1.0, 1.0, 1.6, 1.0, 1.1123595505617978, 1.0, 1.0212284177752617, 1.6666666666666667, 1.0, 4.0, 1.0, 1.0, 2.125, 1.4293893129770991, 1.0, 1.0, 4.174157303370786, 1.0, 1.0, 1.0127627627627627, 1.0, 1.0, 19.333333333333332, 1.0, 2.0, 1.7777777777777777, 1.1558313267889115, 1.0, 1.6927272727272726, 18.0, 44.0, 4.833333333333333, 1.3, 2.0, 1.2258064516129032, 1.0, 2.3333333333333335, 2.2857142857142856, 1.0674157303370786, 5.111111111111111, 2.0, 227.0, 1.0, 32.2, 1.0, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 19/50 | Workload-time: 3.983761 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 20/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
33.9 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 3: actual 101 (0.014%)  origin-forest_43.843 77 (err=1.312)  
90.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 5: actual 33 (0.005%)  origin-forest_43.843 1 (err=33.000)  
90.9 queries/sec
Query 6: actual 56 (0.008%)  origin-forest_43.843 35 (err=1.600)  
90.9 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 10: actual 83 (0.012%)  origin-forest_43.843 229 (err=2.759)  
90.9 queries/sec
Query 11: actual 49 (0.007%)  origin-forest_43.843 1 (err=49.000)  
83.3 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 16: actual 14 (0.002%)  origin-forest_43.843 5 (err=2.800)  
76.6 queries/sec
Query 17: actual 544 (0.078%)  origin-forest_43.843 578 (err=1.062)  
90.9 queries/sec
Query 18: actual 141 (0.020%)  origin-forest_43.843 204 (err=1.447)  
95.4 queries/sec
Query 19: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
76.9 queries/sec
Query 20: actual 4 (0.001%)  origin-forest_43.843 18 (err=4.500)  
71.4 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 23 (0.003%)  origin-forest_43.843 31 (err=1.348)  
90.9 queries/sec
Query 23: actual 4 (0.001%)  origin-forest_43.843 2 (err=2.000)  
90.9 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 25: actual 8 (0.001%)  origin-forest_43.843 18 (err=2.250)  
95.1 queries/sec
Query 26: actual 1960 (0.281%)  origin-forest_43.843 2716 (err=1.386)  
76.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 28: actual 104 (0.015%)  origin-forest_43.843 120 (err=1.154)  
90.9 queries/sec
Query 29: actual 9 (0.001%)  origin-forest_43.843 1 (err=9.000)  
90.9 queries/sec
Query 30: actual 308 (0.044%)  origin-forest_43.843 359 (err=1.166)  
90.9 queries/sec
Query 31: actual 23388 (3.354%)  origin-forest_43.843 26880 (err=1.149)  
90.9 queries/sec
Query 32: actual 1315 (0.189%)  origin-forest_43.843 501 (err=2.625)  
90.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 34: actual 8 (0.001%)  origin-forest_43.843 6 (err=1.333)  
86.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 39: actual 113717 (16.310%)  origin-forest_43.843 108685 (err=1.046)  
83.3 queries/sec
Query 40: actual 39 (0.006%)  origin-forest_43.843 1 (err=39.000)  
79.4 queries/sec
Query 41: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
83.3 queries/sec
Query 42: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
80.0 queries/sec
Query 43: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 44: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.5 queries/sec
Query 47: actual 24 (0.003%)  origin-forest_43.843 23 (err=1.043)  
79.6 queries/sec
Query 48: actual 106 (0.015%)  origin-forest_43.843 107 (err=1.009)  
90.1 queries/sec
Query 49: actual 4 (0.001%)  origin-forest_43.843 6 (err=1.500)  
origin-forest_43.843 	max: 49.0000	99th: 44.1000	95th: 22.2000	median: 1.0265	mean: 3.8698
ReportEsts: [1.0, 1.0, 1.0, 1.3116883116883118, 1.0, 33.0, 1.6, 1.0, 1.0, 1.0, 2.7590361445783134, 49.0, 1.0, 1.0, 1.0, 1.0, 2.8, 1.0625, 1.446808510638298, 3.0, 4.5, 1.0, 1.3478260869565217, 2.0, 1.0, 2.25, 1.3857142857142857, 1.0, 1.1538461538461537, 9.0, 1.1655844155844155, 1.1493073370959466, 2.624750499001996, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 1.046298937295855, 39.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0434782608695652, 1.009433962264151, 1.5]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 20/50 | Workload-time: 3.939940 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 21/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 106274 (15.243%)  origin-forest_43.843 125457 (err=1.181)  
44.4 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 37 (0.005%)  origin-forest_43.843 1 (err=37.000)  
71.4 queries/sec
Query 3: actual 23 (0.003%)  origin-forest_43.843 35 (err=1.522)  
90.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 5: actual 845 (0.121%)  origin-forest_43.843 531 (err=1.591)  
90.9 queries/sec
Query 6: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 7: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
83.3 queries/sec
Query 8: actual 730 (0.105%)  origin-forest_43.843 827 (err=1.133)  
90.6 queries/sec
Query 9: actual 110626 (15.867%)  origin-forest_43.843 90549 (err=1.222)  
90.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 13: actual 19575 (2.808%)  origin-forest_43.843 20636 (err=1.054)  
100.0 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 15: actual 14 (0.002%)  origin-forest_43.843 16 (err=1.143)  
83.3 queries/sec
Query 16: actual 5 (0.001%)  origin-forest_43.843 1 (err=5.000)  
76.9 queries/sec
Query 17: actual 2519 (0.361%)  origin-forest_43.843 2596 (err=1.031)  
95.1 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.0 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.7 queries/sec
Query 20: actual 9810 (1.407%)  origin-forest_43.843 16099 (err=1.641)  
76.8 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 22: actual 52 (0.007%)  origin-forest_43.843 1 (err=52.000)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 25: actual 18 (0.003%)  origin-forest_43.843 16 (err=1.125)  
95.1 queries/sec
Query 26: actual 274 (0.039%)  origin-forest_43.843 430 (err=1.569)  
90.9 queries/sec
Query 27: actual 128 (0.018%)  origin-forest_43.843 160 (err=1.250)  
90.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 49 (0.007%)  origin-forest_43.843 1 (err=49.000)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 31: actual 10 (0.001%)  origin-forest_43.843 12 (err=1.200)  
90.9 queries/sec
Query 32: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
83.3 queries/sec
Query 33: actual 52 (0.007%)  origin-forest_43.843 1 (err=52.000)  
79.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 35: actual 28 (0.004%)  origin-forest_43.843 51 (err=1.821)  
90.9 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.8 queries/sec
Query 37: actual 49 (0.007%)  origin-forest_43.843 53 (err=1.082)  
91.0 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 108 (0.015%)  origin-forest_43.843 40 (err=2.700)  
83.3 queries/sec
Query 40: actual 3491 (0.501%)  origin-forest_43.843 6518 (err=1.867)  
94.3 queries/sec
Query 41: actual 47 (0.007%)  origin-forest_43.843 45 (err=1.044)  
83.3 queries/sec
Query 42: actual 27 (0.004%)  origin-forest_43.843 1 (err=27.000)  
68.9 queries/sec
Query 43: actual 65 (0.009%)  origin-forest_43.843 61 (err=1.066)  
90.9 queries/sec
Query 44: actual 167001 (23.953%)  origin-forest_43.843 186540 (err=1.117)  
90.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 46: actual 45 (0.006%)  origin-forest_43.843 42 (err=1.071)  
90.9 queries/sec
Query 47: actual 5 (0.001%)  origin-forest_43.843 2 (err=2.500)  
83.3 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 49: actual 30 (0.004%)  origin-forest_43.843 1 (err=30.000)  
origin-forest_43.843 	max: 52.0000	99th: 52.0000	95th: 43.6000	median: 1.1289	mean: 6.2086
ReportEsts: [1.1805051094341044, 1.0, 37.0, 1.5217391304347827, 1.0, 1.591337099811676, 2.0, 1.5, 1.132876712328767, 1.2217252537300247, 1.0, 1.0, 3.0, 1.0542017879948915, 1.0, 1.1428571428571428, 5.0, 1.0305676855895196, 1.0, 1.0, 1.6410805300713558, 1.0, 52.0, 1.0, 1.0, 1.125, 1.5693430656934306, 1.25, 1.0, 49.0, 1.0, 1.2, 4.0, 52.0, 1.0, 1.8214285714285714, 1.0, 1.0816326530612246, 1.0, 2.7, 1.8670867946147236, 1.0444444444444445, 27.0, 1.0655737704918034, 1.1169992994053928, 1.0, 1.0714285714285714, 2.5, 1.0, 30.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 21/50 | Workload-time: 3.996321 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 22/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (661012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.0s
new data average log likelihood = 42.5141
detection mean = 43.4464
detection threshold = 0.3480
test statistic = 0.9323
Offline time = 2.8786771297454834
Online time = 0.47434043884277344
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 22-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (661012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 661012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.0761 bits (loss 61.971, data 18.895) 0.00100 lr
epoch 9 train loss 42.7047 nats / 61.6098 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.8105 bits (loss 61.706, data 18.895) 0.00082 lr
epoch 19 train loss 42.5678 nats / 61.4123 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 40.4144 nats / 58.3056 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 22/50 | Workload-time: 6.462385 | Model-update-time: 10.177020


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 23/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (671012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 42.0110
detection mean = 43.6060
detection threshold = 0.3602
test statistic = 1.5950
Offline time = 2.858859062194824
Online time = 0.4875209331512451
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 23-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (671012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 671012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.1911 bits (loss 62.043, data 18.852) 0.00100 lr
epoch 9 train loss 42.6342 nats / 61.5082 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.7087 bits (loss 61.560, data 18.852) 0.00082 lr
epoch 19 train loss 42.5124 nats / 61.3324 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 39.9796 nats / 57.6784 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 23/50 | Workload-time: 6.440703 | Model-update-time: 10.253992


WORKLOAD-START | Type: QueryWorkload | Progress: 24/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 6 (0.001%)  origin-forest_43.843 2 (err=3.000)  
39.2 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.3 queries/sec
Query 3: actual 91 (0.013%)  origin-forest_43.843 1 (err=91.000)  
86.6 queries/sec
Query 4: actual 1569 (0.225%)  origin-forest_43.843 2589 (err=1.650)  
90.9 queries/sec
Query 5: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 6: actual 14 (0.002%)  origin-forest_43.843 21 (err=1.500)  
83.3 queries/sec
Query 7: actual 262 (0.038%)  origin-forest_43.843 231 (err=1.134)  
90.9 queries/sec
Query 8: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 9: actual 206377 (29.600%)  origin-forest_43.843 251704 (err=1.220)  
90.9 queries/sec
Query 10: actual 36 (0.005%)  origin-forest_43.843 26 (err=1.385)  
90.8 queries/sec
Query 11: actual 159 (0.023%)  origin-forest_43.843 199 (err=1.252)  
100.0 queries/sec
Query 12: actual 9 (0.001%)  origin-forest_43.843 5 (err=1.800)  
79.9 queries/sec
Query 13: actual 5 (0.001%)  origin-forest_43.843 2 (err=2.500)  
83.3 queries/sec
Query 14: actual 112 (0.016%)  origin-forest_43.843 63 (err=1.778)  
83.3 queries/sec
Query 15: actual 70 (0.010%)  origin-forest_43.843 10 (err=7.000)  
76.9 queries/sec
Query 16: actual 9 (0.001%)  origin-forest_43.843 10 (err=1.111)  
83.3 queries/sec
Query 17: actual 328 (0.047%)  origin-forest_43.843 328 (err=1.000)  
94.6 queries/sec
Query 18: actual 154527 (22.163%)  origin-forest_43.843 166750 (err=1.079)  
83.3 queries/sec
Query 19: actual 3 (0.000%)  origin-forest_43.843 4 (err=1.333)  
83.3 queries/sec
Query 20: actual 311 (0.045%)  origin-forest_43.843 353 (err=1.135)  
79.9 queries/sec
Query 21: actual 496 (0.071%)  origin-forest_43.843 626 (err=1.262)  
83.3 queries/sec
Query 22: actual 720 (0.103%)  origin-forest_43.843 618 (err=1.165)  
90.9 queries/sec
Query 23: actual 12 (0.002%)  origin-forest_43.843 4 (err=3.000)  
100.0 queries/sec
Query 24: actual 6 (0.001%)  origin-forest_43.843 22 (err=3.667)  
76.9 queries/sec
Query 25: actual 99 (0.014%)  origin-forest_43.843 47 (err=2.106)  
100.0 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.8 queries/sec
Query 28: actual 100353 (14.393%)  origin-forest_43.843 119144 (err=1.187)  
100.0 queries/sec
Query 29: actual 17576 (2.521%)  origin-forest_43.843 665 (err=26.430)  
95.1 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 31: actual 37 (0.005%)  origin-forest_43.843 1 (err=37.000)  
76.9 queries/sec
Query 32: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.4 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.6 queries/sec
Query 37: actual 966 (0.139%)  origin-forest_43.843 815 (err=1.185)  
94.7 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 39: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 41: actual 2 (0.000%)  origin-forest_43.843 5 (err=2.500)  
83.3 queries/sec
Query 42: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
83.3 queries/sec
Query 43: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
90.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 48: actual 119 (0.017%)  origin-forest_43.843 145 (err=1.218)  
90.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 91.0000	99th: 64.5400	95th: 17.6865	median: 1.2191	mean: 4.5970
ReportEsts: [3.0, 1.0, 1.0, 91.0, 1.650095602294455, 2.0, 1.5, 1.1341991341991342, 2.0, 1.219632032639296, 1.3846153846153846, 1.251572327044025, 1.8, 2.5, 1.7777777777777777, 7.0, 1.1111111111111112, 1.0, 1.079099445404363, 1.3333333333333333, 1.135048231511254, 1.2620967741935485, 1.1650485436893203, 3.0, 3.6666666666666665, 2.106382978723404, 1.0, 1.0, 1.187249010991201, 26.430075187969926, 1.0, 37.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.185276073619632, 1.0, 2.0, 1.0, 2.5, 1.25, 3.0, 1.0, 1.0, 1.0, 1.0, 1.218487394957983, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 24/50 | Workload-time: 3.946932 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 25/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (681012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 41.5880
detection mean = 43.7577
detection threshold = 0.3941
test statistic = 2.1696
Offline time = 2.8747403621673584
Online time = 0.4675474166870117
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 25-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (681012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 681012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.1155 bits (loss 61.923, data 18.807) 0.00100 lr
epoch 9 train loss 42.6015 nats / 61.4610 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.7040 bits (loss 61.511, data 18.807) 0.00082 lr
epoch 19 train loss 42.4897 nats / 61.2996 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 39.6151 nats / 57.1526 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 25/50 | Workload-time: 6.441558 | Model-update-time: 10.146487


WORKLOAD-START | Type: QueryWorkload | Progress: 26/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 28 (0.004%)  origin-forest_43.843 1 (err=28.000)  
41.5 queries/sec
Query 1: actual 12 (0.002%)  origin-forest_43.843 85 (err=7.083)  
83.3 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 4: actual 43 (0.006%)  origin-forest_43.843 23 (err=1.870)  
83.3 queries/sec
Query 5: actual 8 (0.001%)  origin-forest_43.843 5 (err=1.600)  
83.3 queries/sec
Query 6: actual 77 (0.011%)  origin-forest_43.843 92 (err=1.195)  
83.3 queries/sec
Query 7: actual 3 (0.000%)  origin-forest_43.843 5 (err=1.667)  
86.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 10: actual 8569 (1.229%)  origin-forest_43.843 8654 (err=1.010)  
83.3 queries/sec
Query 11: actual 114 (0.016%)  origin-forest_43.843 57 (err=2.000)  
90.9 queries/sec
Query 12: actual 52 (0.007%)  origin-forest_43.843 16 (err=3.250)  
83.3 queries/sec
Query 13: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
80.3 queries/sec
Query 14: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
81.3 queries/sec
Query 15: actual 22 (0.003%)  origin-forest_43.843 36 (err=1.636)  
95.2 queries/sec
Query 16: actual 2658 (0.381%)  origin-forest_43.843 1950 (err=1.363)  
83.3 queries/sec
Query 17: actual 114 (0.016%)  origin-forest_43.843 17 (err=6.706)  
83.3 queries/sec
Query 18: actual 1310 (0.188%)  origin-forest_43.843 1574 (err=1.202)  
90.9 queries/sec
Query 19: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 21: actual 839 (0.120%)  origin-forest_43.843 1004 (err=1.197)  
90.9 queries/sec
Query 22: actual 17 (0.002%)  origin-forest_43.843 30 (err=1.765)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.9 queries/sec
Query 25: actual 32 (0.005%)  origin-forest_43.843 1 (err=32.000)  
83.3 queries/sec
Query 26: actual 1321 (0.189%)  origin-forest_43.843 875 (err=1.510)  
90.9 queries/sec
Query 27: actual 8 (0.001%)  origin-forest_43.843 3 (err=2.667)  
83.3 queries/sec
Query 28: actual 2096 (0.301%)  origin-forest_43.843 2073 (err=1.011)  
66.7 queries/sec
Query 29: actual 78505 (11.260%)  origin-forest_43.843 78128 (err=1.005)  
58.8 queries/sec
Query 30: actual 24168 (3.466%)  origin-forest_43.843 28715 (err=1.188)  
66.7 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 32: actual 9 (0.001%)  origin-forest_43.843 11 (err=1.222)  
66.6 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 3 (err=3.000)  
45.5 queries/sec
Query 34: actual 6 (0.001%)  origin-forest_43.843 6 (err=1.000)  
62.5 queries/sec
Query 35: actual 154 (0.022%)  origin-forest_43.843 172 (err=1.117)  
62.5 queries/sec
Query 36: actual 34 (0.005%)  origin-forest_43.843 1 (err=34.000)  
58.8 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 38: actual 6 (0.001%)  origin-forest_43.843 7 (err=1.167)  
71.4 queries/sec
Query 39: actual 5333 (0.765%)  origin-forest_43.843 7309 (err=1.371)  
62.5 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
58.8 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 42: actual 28838 (4.136%)  origin-forest_43.843 27257 (err=1.058)  
62.5 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
58.8 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
57.1 queries/sec
Query 45: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
62.5 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
56.9 queries/sec
Query 48: actual 10 (0.001%)  origin-forest_43.843 1 (err=10.000)  
62.5 queries/sec
Query 49: actual 1596 (0.229%)  origin-forest_43.843 35 (err=45.600)  
origin-forest_43.843 	max: 45.6000	99th: 39.9160	95th: 30.2000	median: 1.1991	mean: 4.4541
ReportEsts: [28.0, 7.083333333333333, 1.0, 1.0, 1.8695652173913044, 1.6, 1.1948051948051948, 1.6666666666666667, 1.0, 1.0, 1.0099194771852025, 2.0, 3.25, 1.25, 2.0, 1.6363636363636365, 1.363076923076923, 6.705882352941177, 1.201526717557252, 2.0, 1.0, 1.1966626936829559, 1.7647058823529411, 1.0, 1.0, 32.0, 1.5097142857142858, 2.6666666666666665, 1.0110950313555234, 1.0048254147040754, 1.1881413439258524, 1.0, 1.2222222222222223, 3.0, 1.0, 1.1168831168831168, 34.0, 1.0, 1.1666666666666667, 1.370523157697356, 1.0, 1.0, 1.0580034486553913, 1.0, 1.0, 2.0, 1.0, 1.0, 10.0, 45.6]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 26/50 | Workload-time: 4.074505 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 27/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (691012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 41.2656
detection mean = 43.8891
detection threshold = 0.4195
test statistic = 2.6236
Offline time = 2.851503610610962
Online time = 0.49116015434265137
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 27-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (691012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 691012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.0100 bits (loss 61.772, data 18.762) 0.00100 lr
epoch 9 train loss 42.5499 nats / 61.3865 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.6021 bits (loss 61.364, data 18.762) 0.00082 lr
epoch 19 train loss 42.4400 nats / 61.2279 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 39.2777 nats / 56.6657 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 27/50 | Workload-time: 6.460308 | Model-update-time: 10.191762


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 28/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (701012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 40.9432
detection mean = 44.0154
detection threshold = 0.4430
test statistic = 3.0722
Offline time = 2.8271725177764893
Online time = 0.4946630001068115
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 28-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (701012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 701012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.1677 bits (loss 61.884, data 18.717) 0.00100 lr
epoch 9 train loss 42.5638 nats / 61.4066 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 43.0425 bits (loss 61.759, data 18.717) 0.00082 lr
epoch 19 train loss 42.4286 nats / 61.2115 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 38.9934 nats / 56.2556 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 28/50 | Workload-time: 6.441220 | Model-update-time: 10.214315


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 29/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (711012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 40.7035
detection mean = 44.1136
detection threshold = 0.4839
test statistic = 3.4102
Offline time = 2.8611974716186523
Online time = 0.4951047897338867
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 29-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (711012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 711012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.2044 bits (loss 61.876, data 18.671) 0.00100 lr
epoch 9 train loss 42.4902 nats / 61.3004 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.6297 bits (loss 61.301, data 18.671) 0.00082 lr
epoch 19 train loss 42.3600 nats / 61.1126 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 38.7429 nats / 55.8942 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 29/50 | Workload-time: 6.495453 | Model-update-time: 10.216325


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 30/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (721012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 40.4732
detection mean = 44.2025
detection threshold = 0.5155
test statistic = 3.7293
Offline time = 2.8576056957244873
Online time = 0.5174098014831543
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 30-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (721012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 721012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.3342 bits (loss 61.960, data 18.626) 0.00100 lr
epoch 9 train loss 42.4192 nats / 61.1980 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.8070 bits (loss 61.433, data 18.626) 0.00082 lr
epoch 19 train loss 42.3017 nats / 61.0285 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 38.4875 nats / 55.5257 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 30/50 | Workload-time: 6.513271 | Model-update-time: 10.258616


WORKLOAD-START | Type: QueryWorkload | Progress: 31/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 68 (0.010%)  origin-forest_43.843 38 (err=1.789)  
41.7 queries/sec
Query 1: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 2: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
86.9 queries/sec
Query 3: actual 50 (0.007%)  origin-forest_43.843 73 (err=1.460)  
83.3 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 24 (0.003%)  origin-forest_43.843 1 (err=24.000)  
83.4 queries/sec
Query 6: actual 2052 (0.294%)  origin-forest_43.843 2076 (err=1.012)  
90.9 queries/sec
Query 7: actual 474 (0.068%)  origin-forest_43.843 714 (err=1.506)  
83.3 queries/sec
Query 8: actual 955 (0.137%)  origin-forest_43.843 1 (err=955.000)  
86.9 queries/sec
Query 9: actual 1432 (0.205%)  origin-forest_43.843 650 (err=2.203)  
84.4 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.6 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 1281 (0.184%)  origin-forest_43.843 2 (err=640.500)  
90.9 queries/sec
Query 13: actual 13 (0.002%)  origin-forest_43.843 1 (err=13.000)  
83.3 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 16: actual 323 (0.046%)  origin-forest_43.843 558 (err=1.728)  
83.3 queries/sec
Query 17: actual 41 (0.006%)  origin-forest_43.843 1 (err=41.000)  
76.9 queries/sec
Query 18: actual 1007 (0.144%)  origin-forest_43.843 2157 (err=2.142)  
82.8 queries/sec
Query 19: actual 97 (0.014%)  origin-forest_43.843 108 (err=1.113)  
90.9 queries/sec
Query 20: actual 38 (0.005%)  origin-forest_43.843 47 (err=1.237)  
90.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 24: actual 39 (0.006%)  origin-forest_43.843 4 (err=9.750)  
83.3 queries/sec
Query 25: actual 275 (0.039%)  origin-forest_43.843 316 (err=1.149)  
90.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 43 (0.006%)  origin-forest_43.843 56 (err=1.302)  
90.5 queries/sec
Query 28: actual 38 (0.005%)  origin-forest_43.843 39 (err=1.026)  
90.9 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 30: actual 1276 (0.183%)  origin-forest_43.843 1264 (err=1.009)  
83.3 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 34 (0.005%)  origin-forest_43.843 1 (err=34.000)  
89.6 queries/sec
Query 36: actual 2 (0.000%)  origin-forest_43.843 4 (err=2.000)  
97.0 queries/sec
Query 37: actual 12943 (1.856%)  origin-forest_43.843 18200 (err=1.406)  
90.9 queries/sec
Query 38: actual 25 (0.004%)  origin-forest_43.843 1 (err=25.000)  
83.3 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 320 (0.046%)  origin-forest_43.843 265 (err=1.208)  
83.3 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 19 (0.003%)  origin-forest_43.843 17 (err=1.118)  
90.9 queries/sec
Query 43: actual 141 (0.020%)  origin-forest_43.843 36 (err=3.917)  
90.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 46: actual 106 (0.015%)  origin-forest_43.843 134 (err=1.264)  
90.9 queries/sec
Query 47: actual 227 (0.033%)  origin-forest_43.843 1 (err=227.000)  
83.3 queries/sec
Query 48: actual 88 (0.013%)  origin-forest_43.843 192 (err=2.182)  
83.3 queries/sec
Query 49: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
origin-forest_43.843 	max: 955.0000	99th: 800.8950	95th: 143.3000	median: 1.2222	mean: 40.4904
ReportEsts: [1.7894736842105263, 2.0, 1.5, 1.46, 1.0, 24.0, 1.0116959064327486, 1.5063291139240507, 955.0, 2.203076923076923, 1.0, 1.0, 640.5, 13.0, 1.0, 1.0, 1.7275541795665634, 41.0, 2.142005958291956, 1.1134020618556701, 1.236842105263158, 1.0, 1.0, 1.0, 9.75, 1.1490909090909092, 1.0, 1.302325581395349, 1.0263157894736843, 1.0, 1.009493670886076, 1.0, 1.0, 1.0, 1.0, 34.0, 2.0, 1.4061654948620876, 25.0, 1.0, 1.2075471698113207, 1.0, 1.1176470588235294, 3.9166666666666665, 1.0, 1.0, 1.2641509433962264, 227.0, 2.1818181818181817, 2.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 31/50 | Workload-time: 3.998998 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 32/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 38 (0.005%)  origin-forest_43.843 1 (err=38.000)  
40.8 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 44 (0.006%)  origin-forest_43.843 1 (err=44.000)  
83.3 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 4: actual 195 (0.028%)  origin-forest_43.843 2 (err=97.500)  
83.3 queries/sec
Query 5: actual 22 (0.003%)  origin-forest_43.843 1 (err=22.000)  
83.3 queries/sec
Query 6: actual 793 (0.114%)  origin-forest_43.843 60 (err=13.217)  
90.9 queries/sec
Query 7: actual 53 (0.008%)  origin-forest_43.843 1 (err=53.000)  
83.3 queries/sec
Query 8: actual 424 (0.061%)  origin-forest_43.843 506 (err=1.193)  
86.9 queries/sec
Query 9: actual 541332 (77.642%)  origin-forest_43.843 540890 (err=1.001)  
100.0 queries/sec
Query 10: actual 118 (0.017%)  origin-forest_43.843 1 (err=118.000)  
90.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 15: actual 65 (0.009%)  origin-forest_43.843 79 (err=1.215)  
90.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 53 (0.008%)  origin-forest_43.843 1 (err=53.000)  
90.9 queries/sec
Query 24: actual 48 (0.007%)  origin-forest_43.843 1 (err=48.000)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 26: actual 157 (0.023%)  origin-forest_43.843 155 (err=1.013)  
83.3 queries/sec
Query 27: actual 8092 (1.161%)  origin-forest_43.843 9335 (err=1.154)  
90.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 29: actual 259938 (37.282%)  origin-forest_43.843 237914 (err=1.093)  
90.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 31: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 32: actual 21 (0.003%)  origin-forest_43.843 24 (err=1.143)  
83.3 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
95.1 queries/sec
Query 35: actual 9 (0.001%)  origin-forest_43.843 1 (err=9.000)  
90.9 queries/sec
Query 36: actual 10 (0.001%)  origin-forest_43.843 9 (err=1.111)  
90.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 38: actual 1186 (0.170%)  origin-forest_43.843 4 (err=296.500)  
90.9 queries/sec
Query 39: actual 5 (0.001%)  origin-forest_43.843 3 (err=1.667)  
90.9 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
58.8 queries/sec
Query 42: actual 280 (0.040%)  origin-forest_43.843 251 (err=1.116)  
95.1 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 44: actual 303 (0.043%)  origin-forest_43.843 1 (err=303.000)  
76.9 queries/sec
Query 45: actual 407 (0.058%)  origin-forest_43.843 1 (err=407.000)  
90.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 47: actual 42 (0.006%)  origin-forest_43.843 1 (err=42.000)  
76.9 queries/sec
Query 48: actual 156 (0.022%)  origin-forest_43.843 1 (err=156.000)  
83.3 queries/sec
Query 49: actual 69 (0.010%)  origin-forest_43.843 1 (err=69.000)  
origin-forest_43.843 	max: 407.0000	99th: 356.0400	95th: 233.2750	median: 1.0527	mean: 36.1184
ReportEsts: [38.0, 1.0, 44.0, 1.0, 97.5, 22.0, 13.216666666666667, 53.0, 1.1933962264150944, 1.0008171716984968, 118.0, 1.0, 1.0, 1.0, 1.0, 1.2153846153846153, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 53.0, 48.0, 1.0, 1.0129032258064516, 1.1536085022244191, 1.0, 1.092571265247106, 1.0, 2.0, 1.1428571428571428, 1.0, 1.0, 9.0, 1.1111111111111112, 1.0, 296.5, 1.6666666666666667, 1.0, 1.0, 1.1155378486055776, 1.0, 303.0, 407.0, 1.0, 42.0, 156.0, 69.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 32/50 | Workload-time: 4.034235 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 33/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 2169 (0.311%)  origin-forest_43.843 5 (err=433.800)  
35.1 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 23 (0.003%)  origin-forest_43.843 2 (err=11.500)  
83.3 queries/sec
Query 3: actual 72 (0.010%)  origin-forest_43.843 87 (err=1.208)  
83.3 queries/sec
Query 4: actual 3500 (0.502%)  origin-forest_43.843 5553 (err=1.587)  
83.3 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
83.3 queries/sec
Query 7: actual 23266 (3.337%)  origin-forest_43.843 19064 (err=1.220)  
90.8 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
84.2 queries/sec
Query 9: actual 16 (0.002%)  origin-forest_43.843 23 (err=1.438)  
85.5 queries/sec
Query 10: actual 1258 (0.180%)  origin-forest_43.843 1614 (err=1.283)  
90.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 12: actual 35 (0.005%)  origin-forest_43.843 41 (err=1.171)  
90.9 queries/sec
Query 13: actual 268 (0.038%)  origin-forest_43.843 110 (err=2.436)  
90.9 queries/sec
Query 14: actual 108 (0.015%)  origin-forest_43.843 138 (err=1.278)  
90.9 queries/sec
Query 15: actual 9 (0.001%)  origin-forest_43.843 6 (err=1.500)  
83.3 queries/sec
Query 16: actual 139573 (20.019%)  origin-forest_43.843 112359 (err=1.242)  
99.9 queries/sec
Query 17: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
86.8 queries/sec
Query 18: actual 6 (0.001%)  origin-forest_43.843 6 (err=1.000)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 23: actual 58283 (8.359%)  origin-forest_43.843 70711 (err=1.213)  
90.9 queries/sec
Query 24: actual 221 (0.032%)  origin-forest_43.843 256 (err=1.158)  
76.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 28: actual 478 (0.069%)  origin-forest_43.843 161 (err=2.969)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 30: actual 1101 (0.158%)  origin-forest_43.843 1136 (err=1.032)  
76.9 queries/sec
Query 31: actual 61 (0.009%)  origin-forest_43.843 91 (err=1.492)  
100.0 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
90.9 queries/sec
Query 34: actual 29 (0.004%)  origin-forest_43.843 37 (err=1.276)  
79.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 37: actual 59 (0.008%)  origin-forest_43.843 89 (err=1.508)  
90.9 queries/sec
Query 38: actual 7 (0.001%)  origin-forest_43.843 13 (err=1.857)  
83.3 queries/sec
Query 39: actual 231 (0.033%)  origin-forest_43.843 244 (err=1.056)  
83.3 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 41: actual 110 (0.016%)  origin-forest_43.843 9 (err=12.222)  
71.4 queries/sec
Query 42: actual 11 (0.002%)  origin-forest_43.843 12 (err=1.091)  
95.1 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 44: actual 141 (0.020%)  origin-forest_43.843 209 (err=1.482)  
83.3 queries/sec
Query 45: actual 39 (0.006%)  origin-forest_43.843 83 (err=2.128)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 47: actual 1190 (0.171%)  origin-forest_43.843 1047 (err=1.137)  
83.3 queries/sec
Query 48: actual 419 (0.060%)  origin-forest_43.843 1 (err=419.000)  
83.3 queries/sec
Query 49: actual 215 (0.031%)  origin-forest_43.843 157 (err=1.369)  
origin-forest_43.843 	max: 433.8000	99th: 426.5480	95th: 11.8972	median: 1.1475	mean: 18.6806
ReportEsts: [433.8, 1.0, 11.5, 1.2083333333333333, 1.5865714285714285, 1.0, 1.25, 1.2204154427192615, 1.0, 1.4375, 1.2829888712241653, 1.0, 1.1714285714285715, 2.4363636363636365, 1.2777777777777777, 1.5, 1.2422057868083554, 1.125, 1.0, 1.0, 1.0, 1.0, 1.0, 1.2132354202769247, 1.158371040723982, 1.0, 1.0, 1.0, 2.968944099378882, 1.0, 1.0317892824704813, 1.4918032786885247, 1.0, 1.0, 1.2758620689655173, 1.0, 1.0, 1.5084745762711864, 1.8571428571428572, 1.0562770562770563, 1.0, 12.222222222222221, 1.0909090909090908, 1.0, 1.4822695035460993, 2.128205128205128, 1.0, 1.1365807067812799, 419.0, 1.3694267515923566]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 33/50 | Workload-time: 3.980850 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 34/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (731012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 40.2830
detection mean = 44.2839
detection threshold = 0.5326
test statistic = 4.0009
Offline time = 2.8632190227508545
Online time = 0.5095338821411133
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 34-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (731012, 10)
Parsing... done, took 0.0s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 731012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.0691 bits (loss 61.649, data 18.580) 0.00100 lr
epoch 9 train loss 42.4411 nats / 61.2296 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.7961 bits (loss 61.376, data 18.580) 0.00082 lr
epoch 19 train loss 42.3033 nats / 61.0307 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 38.2058 nats / 55.1194 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 34/50 | Workload-time: 6.497986 | Model-update-time: 10.274915


WORKLOAD-START | Type: QueryWorkload | Progress: 35/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.0 queries/sec
Query 1: actual 4 (0.001%)  origin-forest_43.843 2 (err=2.000)  
71.4 queries/sec
Query 2: actual 89752 (12.873%)  origin-forest_43.843 80223 (err=1.119)  
90.7 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 4: actual 30 (0.004%)  origin-forest_43.843 1 (err=30.000)  
90.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 7: actual 9610 (1.378%)  origin-forest_43.843 9908 (err=1.031)  
90.9 queries/sec
Query 8: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 9: actual 100 (0.014%)  origin-forest_43.843 86 (err=1.163)  
90.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 11: actual 19 (0.003%)  origin-forest_43.843 4 (err=4.750)  
95.3 queries/sec
Query 12: actual 66 (0.009%)  origin-forest_43.843 74 (err=1.121)  
90.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 14: actual 451 (0.065%)  origin-forest_43.843 43 (err=10.488)  
90.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 16: actual 25 (0.004%)  origin-forest_43.843 1 (err=25.000)  
83.3 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
95.2 queries/sec
Query 20: actual 120 (0.017%)  origin-forest_43.843 1 (err=120.000)  
83.3 queries/sec
Query 21: actual 14793 (2.122%)  origin-forest_43.843 2959 (err=4.999)  
90.9 queries/sec
Query 22: actual 23502 (3.371%)  origin-forest_43.843 1 (err=23502.000)  
97.4 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.3 queries/sec
Query 24: actual 16 (0.002%)  origin-forest_43.843 13 (err=1.231)  
74.7 queries/sec
Query 25: actual 299 (0.043%)  origin-forest_43.843 344 (err=1.151)  
90.9 queries/sec
Query 26: actual 4 (0.001%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 27: actual 3805 (0.546%)  origin-forest_43.843 4610 (err=1.212)  
90.9 queries/sec
Query 28: actual 155 (0.022%)  origin-forest_43.843 70 (err=2.214)  
76.0 queries/sec
Query 29: actual 135 (0.019%)  origin-forest_43.843 70 (err=1.929)  
83.3 queries/sec
Query 30: actual 58294 (8.361%)  origin-forest_43.843 49047 (err=1.189)  
100.0 queries/sec
Query 31: actual 12 (0.002%)  origin-forest_43.843 7 (err=1.714)  
84.2 queries/sec
Query 32: actual 805 (0.115%)  origin-forest_43.843 1026 (err=1.275)  
90.9 queries/sec
Query 33: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 34: actual 19 (0.003%)  origin-forest_43.843 1 (err=19.000)  
83.3 queries/sec
Query 35: actual 36 (0.005%)  origin-forest_43.843 19 (err=1.895)  
83.3 queries/sec
Query 36: actual 115 (0.016%)  origin-forest_43.843 1 (err=115.000)  
83.3 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 1239 (0.178%)  origin-forest_43.843 119 (err=10.412)  
90.9 queries/sec
Query 41: actual 303834 (43.578%)  origin-forest_43.843 284131 (err=1.069)  
90.9 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 43: actual 101894 (14.614%)  origin-forest_43.843 99990 (err=1.019)  
100.0 queries/sec
Query 44: actual 2643 (0.379%)  origin-forest_43.843 2373 (err=1.114)  
83.3 queries/sec
Query 45: actual 86767 (12.445%)  origin-forest_43.843 94047 (err=1.084)  
95.2 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.9 queries/sec
Query 47: actual 2619 (0.376%)  origin-forest_43.843 5671 (err=2.165)  
86.8 queries/sec
Query 48: actual 12 (0.002%)  origin-forest_43.843 9 (err=1.333)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 23502.0000	99th: 12044.8200	95th: 76.7500	median: 1.1566	mean: 477.8535
ReportEsts: [1.0, 2.0, 1.1187813968562632, 1.0, 30.0, 1.0, 1.0, 1.031009365244537, 2.0, 1.1627906976744187, 1.0, 4.75, 1.121212121212121, 1.0, 10.488372093023257, 1.0, 25.0, 1.0, 1.0, 1.0, 120.0, 4.999324095978371, 23502.0, 1.0, 1.2307692307692308, 1.1505016722408026, 2.0, 1.2115637319316688, 2.2142857142857144, 1.9285714285714286, 1.1885334475095317, 1.7142857142857142, 1.2745341614906833, 2.0, 19.0, 1.894736842105263, 115.0, 1.0, 1.0, 1.0, 10.411764705882353, 1.0693447740654838, 1.0, 1.019041904190419, 1.11378002528445, 1.0839028662970944, 1.0, 2.1653302787323407, 1.3333333333333333, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 35/50 | Workload-time: 4.008216 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 36/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 14 (0.002%)  origin-forest_43.843 12 (err=1.167)  
41.7 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 3: actual 52 (0.007%)  origin-forest_43.843 14 (err=3.714)  
83.3 queries/sec
Query 4: actual 72 (0.010%)  origin-forest_43.843 65 (err=1.108)  
90.9 queries/sec
Query 5: actual 198 (0.028%)  origin-forest_43.843 1 (err=198.000)  
83.3 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 7: actual 125 (0.018%)  origin-forest_43.843 1 (err=125.000)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 10: actual 71 (0.010%)  origin-forest_43.843 72 (err=1.014)  
86.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
90.9 queries/sec
Query 13: actual 47165 (6.765%)  origin-forest_43.843 51871 (err=1.100)  
90.9 queries/sec
Query 14: actual 6101 (0.875%)  origin-forest_43.843 7105 (err=1.165)  
100.0 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 16: actual 1470 (0.211%)  origin-forest_43.843 2297 (err=1.563)  
90.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 85 (0.012%)  origin-forest_43.843 100 (err=1.176)  
90.9 queries/sec
Query 19: actual 108 (0.015%)  origin-forest_43.843 103 (err=1.049)  
95.2 queries/sec
Query 20: actual 5 (0.001%)  origin-forest_43.843 2 (err=2.500)  
83.3 queries/sec
Query 21: actual 88 (0.013%)  origin-forest_43.843 122 (err=1.386)  
90.9 queries/sec
Query 22: actual 7 (0.001%)  origin-forest_43.843 11 (err=1.571)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 390 (0.056%)  origin-forest_43.843 372 (err=1.048)  
90.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 28: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
90.9 queries/sec
Query 29: actual 19 (0.003%)  origin-forest_43.843 10 (err=1.900)  
83.3 queries/sec
Query 30: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
90.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 3 (0.000%)  origin-forest_43.843 0 (err=3.000)  
71.5 queries/sec
Query 33: actual 13294 (1.907%)  origin-forest_43.843 5602 (err=2.373)  
83.3 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 1144 (0.164%)  origin-forest_43.843 1487 (err=1.300)  
100.0 queries/sec
Query 36: actual 8099 (1.162%)  origin-forest_43.843 9214 (err=1.138)  
90.5 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 38: actual 13 (0.002%)  origin-forest_43.843 3 (err=4.333)  
83.3 queries/sec
Query 39: actual 264 (0.038%)  origin-forest_43.843 242 (err=1.091)  
90.9 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 41: actual 49 (0.007%)  origin-forest_43.843 2 (err=24.500)  
100.0 queries/sec
Query 42: actual 1151 (0.165%)  origin-forest_43.843 1764 (err=1.533)  
83.3 queries/sec
Query 43: actual 61 (0.009%)  origin-forest_43.843 61 (err=1.000)  
83.3 queries/sec
Query 44: actual 73 (0.010%)  origin-forest_43.843 13 (err=5.615)  
90.9 queries/sec
Query 45: actual 43 (0.006%)  origin-forest_43.843 39 (err=1.103)  
86.8 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 47: actual 89 (0.013%)  origin-forest_43.843 97 (err=1.090)  
90.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 49: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
origin-forest_43.843 	max: 198.0000	99th: 162.2300	95th: 16.0019	median: 1.0904	mean: 8.3307
ReportEsts: [1.1666666666666667, 1.0, 1.0, 3.7142857142857144, 1.1076923076923078, 198.0, 1.0, 125.0, 1.0, 1.0, 1.0140845070422535, 1.0, 2.0, 1.099777377292484, 1.1645631863628914, 1.0, 1.5625850340136054, 1.0, 1.1764705882352942, 1.0485436893203883, 2.5, 1.3863636363636365, 1.5714285714285714, 1.0, 1.0, 1.0, 1.0483870967741935, 1.0, 1.0, 1.9, 1.0, 1.0, 3, 2.3730810424848268, 1.0, 1.2998251748251748, 1.1376713174465984, 1.0, 4.333333333333333, 1.0909090909090908, 1.0, 24.5, 1.5325803649000869, 1.0, 5.615384615384615, 1.1025641025641026, 1.0, 1.0898876404494382, 1.0, 2.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 36/50 | Workload-time: 4.011653 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 37/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (741012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 40.1020
detection mean = 44.3395
detection threshold = 0.5819
test statistic = 4.2375
Offline time = 2.8796234130859375
Online time = 0.5177078247070312
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 37-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (741012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 741012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.1362 bits (loss 61.671, data 18.535) 0.00100 lr
epoch 9 train loss 42.4635 nats / 61.2619 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 43.0015 bits (loss 61.536, data 18.535) 0.00082 lr
epoch 19 train loss 42.3351 nats / 61.0766 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 37.9611 nats / 54.7663 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 37/50 | Workload-time: 6.517312 | Model-update-time: 10.222508


WORKLOAD-START | Type: QueryWorkload | Progress: 38/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 135 (0.019%)  origin-forest_43.843 131 (err=1.031)  
40.8 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 7: actual 9 (0.001%)  origin-forest_43.843 8 (err=1.125)  
86.8 queries/sec
Query 8: actual 96 (0.014%)  origin-forest_43.843 129 (err=1.344)  
76.6 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 11: actual 63 (0.009%)  origin-forest_43.843 77 (err=1.222)  
100.0 queries/sec
Query 12: actual 8 (0.001%)  origin-forest_43.843 77 (err=9.625)  
83.3 queries/sec
Query 13: actual 34 (0.005%)  origin-forest_43.843 59 (err=1.735)  
83.3 queries/sec
Query 14: actual 40 (0.006%)  origin-forest_43.843 52 (err=1.300)  
83.3 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
93.0 queries/sec
Query 16: actual 19 (0.003%)  origin-forest_43.843 21 (err=1.105)  
86.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 21: actual 7 (0.001%)  origin-forest_43.843 11 (err=1.571)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
81.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 24: actual 16 (0.002%)  origin-forest_43.843 1 (err=16.000)  
95.2 queries/sec
Query 25: actual 25 (0.004%)  origin-forest_43.843 1 (err=25.000)  
90.9 queries/sec
Query 26: actual 8 (0.001%)  origin-forest_43.843 12 (err=1.500)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
84.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 30: actual 70714 (10.142%)  origin-forest_43.843 60245 (err=1.174)  
90.9 queries/sec
Query 31: actual 111 (0.016%)  origin-forest_43.843 75 (err=1.480)  
90.8 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 19 (0.003%)  origin-forest_43.843 29 (err=1.526)  
86.0 queries/sec
Query 34: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
76.9 queries/sec
Query 35: actual 4 (0.001%)  origin-forest_43.843 3 (err=1.333)  
83.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 37: actual 146 (0.021%)  origin-forest_43.843 80 (err=1.825)  
90.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 141752 (20.331%)  origin-forest_43.843 154002 (err=1.086)  
100.0 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.1 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 32 (0.005%)  origin-forest_43.843 1 (err=32.000)  
90.9 queries/sec
Query 45: actual 14 (0.002%)  origin-forest_43.843 13 (err=1.077)  
83.3 queries/sec
Query 46: actual 3959 (0.568%)  origin-forest_43.843 2185 (err=1.812)  
90.9 queries/sec
Query 47: actual 56 (0.008%)  origin-forest_43.843 47 (err=1.191)  
83.3 queries/sec
Query 48: actual 82609 (11.848%)  origin-forest_43.843 83427 (err=1.010)  
90.9 queries/sec
Query 49: actual 4827 (0.692%)  origin-forest_43.843 3032 (err=1.592)  
origin-forest_43.843 	max: 32.0000	99th: 28.5700	95th: 13.1312	median: 1.0202	mean: 2.8733
ReportEsts: [1.0305343511450382, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.125, 1.34375, 1.0, 1.0, 1.2222222222222223, 9.625, 1.7352941176470589, 1.3, 1.0, 1.105263157894737, 1.0, 1.0, 1.0, 2.0, 1.5714285714285714, 1.0, 1.0, 16.0, 25.0, 1.5, 1.0, 1.0, 1.0, 1.1737737571582705, 1.48, 1.0, 1.5263157894736843, 8.0, 1.3333333333333333, 1.0, 1.825, 1.0, 1.0864185337773011, 1.0, 1.0, 1.0, 1.0, 32.0, 1.0769230769230769, 1.811899313501144, 1.1914893617021276, 1.0099020687818518, 1.5920184696569921]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 38/50 | Workload-time: 4.006876 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 39/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (751012, 10)
Parsing... done, took 0.0s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 39.9379
detection mean = 44.3846
detection threshold = 0.5981
test statistic = 4.4467
Offline time = 2.8777949810028076
Online time = 0.5121626853942871
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 39-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (751012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 751012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.2298 bits (loss 61.719, data 18.489) 0.00100 lr
epoch 9 train loss 42.4048 nats / 61.1772 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.5498 bits (loss 61.039, data 18.489) 0.00082 lr
epoch 19 train loss 42.2473 nats / 60.9500 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 37.7479 nats / 54.4587 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 39/50 | Workload-time: 6.528331 | Model-update-time: 10.200868


WORKLOAD-START | Type: QueryWorkload | Progress: 40/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
41.7 queries/sec
Query 1: actual 14370 (2.061%)  origin-forest_43.843 19736 (err=1.373)  
83.3 queries/sec
Query 2: actual 16 (0.002%)  origin-forest_43.843 20 (err=1.250)  
83.3 queries/sec
Query 3: actual 1844 (0.264%)  origin-forest_43.843 1469 (err=1.255)  
90.9 queries/sec
Query 4: actual 1246 (0.179%)  origin-forest_43.843 933 (err=1.335)  
95.2 queries/sec
Query 5: actual 27 (0.004%)  origin-forest_43.843 2 (err=13.500)  
90.9 queries/sec
Query 6: actual 34 (0.005%)  origin-forest_43.843 374 (err=11.000)  
83.3 queries/sec
Query 7: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 8: actual 3530 (0.506%)  origin-forest_43.843 4486 (err=1.271)  
90.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.4 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 11: actual 31 (0.004%)  origin-forest_43.843 35 (err=1.129)  
76.9 queries/sec
Query 12: actual 23 (0.003%)  origin-forest_43.843 22 (err=1.045)  
83.3 queries/sec
Query 13: actual 4 (0.001%)  origin-forest_43.843 12 (err=3.000)  
86.9 queries/sec
Query 14: actual 16 (0.002%)  origin-forest_43.843 1 (err=16.000)  
76.9 queries/sec
Query 15: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 16: actual 51 (0.007%)  origin-forest_43.843 77 (err=1.510)  
83.3 queries/sec
Query 17: actual 26 (0.004%)  origin-forest_43.843 28 (err=1.077)  
71.4 queries/sec
Query 18: actual 128832 (18.478%)  origin-forest_43.843 135514 (err=1.052)  
76.9 queries/sec
Query 19: actual 72554 (10.406%)  origin-forest_43.843 82891 (err=1.142)  
83.3 queries/sec
Query 20: actual 176 (0.025%)  origin-forest_43.843 25 (err=7.040)  
100.0 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 22: actual 119 (0.017%)  origin-forest_43.843 57 (err=2.088)  
100.0 queries/sec
Query 23: actual 175 (0.025%)  origin-forest_43.843 3 (err=58.333)  
83.3 queries/sec
Query 24: actual 142 (0.020%)  origin-forest_43.843 1 (err=142.000)  
90.9 queries/sec
Query 25: actual 219 (0.031%)  origin-forest_43.843 1 (err=219.000)  
83.3 queries/sec
Query 26: actual 7 (0.001%)  origin-forest_43.843 10 (err=1.429)  
90.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 33: actual 80 (0.011%)  origin-forest_43.843 51 (err=1.569)  
83.3 queries/sec
Query 34: actual 6 (0.001%)  origin-forest_43.843 18 (err=3.000)  
100.0 queries/sec
Query 35: actual 108884 (15.617%)  origin-forest_43.843 78251 (err=1.391)  
90.9 queries/sec
Query 36: actual 336805 (48.307%)  origin-forest_43.843 350262 (err=1.040)  
90.9 queries/sec
Query 37: actual 10645 (1.527%)  origin-forest_43.843 11525 (err=1.083)  
90.8 queries/sec
Query 38: actual 1229 (0.176%)  origin-forest_43.843 1739 (err=1.415)  
90.9 queries/sec
Query 39: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
82.8 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 41: actual 151 (0.022%)  origin-forest_43.843 192 (err=1.272)  
76.9 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 3912 (0.561%)  origin-forest_43.843 4465 (err=1.141)  
90.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 185 (0.027%)  origin-forest_43.843 269 (err=1.454)  
90.8 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 48: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 219.0000	99th: 181.2700	95th: 39.2833	median: 1.2630	mean: 10.5339
ReportEsts: [1.0, 1.3734168406402227, 1.25, 1.255275697753574, 1.3354769560557342, 13.5, 11.0, 2.0, 1.2708215297450425, 1.0, 1.0, 1.1290322580645162, 1.0454545454545454, 3.0, 16.0, 2.0, 1.5098039215686274, 1.0769230769230769, 1.051865996025832, 1.1424731923808473, 7.04, 1.0, 2.087719298245614, 58.333333333333336, 142.0, 219.0, 1.4285714285714286, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0, 1.5686274509803921, 3.0, 1.391471035513923, 1.0399548700286516, 1.0826679192108972, 1.4149715215622458, 2.0, 1.0, 1.271523178807947, 1.0, 1.0, 1.141359918200409, 1.0, 1.454054054054054, 1.0, 4.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 40/50 | Workload-time: 4.003538 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 41/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 27817 (3.990%)  origin-forest_43.843 36098 (err=1.298)  
37.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 4 (err=4.000)  
80.0 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.8 queries/sec
Query 3: actual 5 (0.001%)  origin-forest_43.843 1 (err=5.000)  
76.9 queries/sec
Query 4: actual 6 (0.001%)  origin-forest_43.843 9 (err=1.500)  
83.3 queries/sec
Query 5: actual 12379 (1.775%)  origin-forest_43.843 6876 (err=1.800)  
90.9 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 7: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
77.6 queries/sec
Query 8: actual 24 (0.003%)  origin-forest_43.843 11 (err=2.182)  
86.7 queries/sec
Query 9: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 11: actual 8 (0.001%)  origin-forest_43.843 3 (err=2.667)  
90.9 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 13: actual 343 (0.049%)  origin-forest_43.843 16 (err=21.438)  
83.3 queries/sec
Query 14: actual 63303 (9.079%)  origin-forest_43.843 59409 (err=1.066)  
90.9 queries/sec
Query 15: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
71.4 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
90.9 queries/sec
Query 17: actual 145 (0.021%)  origin-forest_43.843 5 (err=29.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.7 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 20: actual 2538 (0.364%)  origin-forest_43.843 3115 (err=1.227)  
83.3 queries/sec
Query 21: actual 10 (0.001%)  origin-forest_43.843 10 (err=1.000)  
76.9 queries/sec
Query 22: actual 17 (0.002%)  origin-forest_43.843 1 (err=17.000)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.4 queries/sec
Query 24: actual 2 (0.000%)  origin-forest_43.843 5 (err=2.500)  
90.7 queries/sec
Query 25: actual 21 (0.003%)  origin-forest_43.843 3 (err=7.000)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 30: actual 1575 (0.226%)  origin-forest_43.843 1971 (err=1.251)  
90.9 queries/sec
Query 31: actual 101 (0.014%)  origin-forest_43.843 58 (err=1.741)  
83.3 queries/sec
Query 32: actual 6831 (0.980%)  origin-forest_43.843 7948 (err=1.164)  
90.9 queries/sec
Query 33: actual 20015 (2.871%)  origin-forest_43.843 23450 (err=1.172)  
90.9 queries/sec
Query 34: actual 36 (0.005%)  origin-forest_43.843 0 (err=36.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.7 queries/sec
Query 36: actual 3 (0.000%)  origin-forest_43.843 3 (err=1.000)  
90.9 queries/sec
Query 37: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 38: actual 106 (0.015%)  origin-forest_43.843 118 (err=1.113)  
83.3 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 41: actual 7 (0.001%)  origin-forest_43.843 6 (err=1.167)  
90.9 queries/sec
Query 42: actual 3401 (0.488%)  origin-forest_43.843 4776 (err=1.404)  
76.9 queries/sec
Query 43: actual 45 (0.006%)  origin-forest_43.843 56 (err=1.244)  
76.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 45: actual 13 (0.002%)  origin-forest_43.843 25 (err=1.923)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 36.0000	99th: 32.5700	95th: 19.4406	median: 1.1384	mean: 3.5171
ReportEsts: [1.2976956537369235, 4.0, 1.0, 5.0, 1.5, 1.8003199534613148, 1.0, 1.0, 2.1818181818181817, 3.0, 1.0, 2.6666666666666665, 1.0, 21.4375, 1.0655456244003434, 1.0, 2.0, 29.0, 1.0, 1.0, 1.227344365642238, 1.0, 17.0, 1.0, 2.5, 7.0, 1.0, 1.0, 1.0, 1.0, 1.2514285714285713, 1.7413793103448276, 1.1635192504757723, 1.1716212840369722, 36, 1.0, 1.0, 2.0, 1.1132075471698113, 1.0, 1.0, 1.1666666666666667, 1.4042928550426346, 1.2444444444444445, 1.0, 1.9230769230769231, 1.0, 1.0, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 41/50 | Workload-time: 4.037652 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 42/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
41.7 queries/sec
Query 1: actual 197 (0.028%)  origin-forest_43.843 242 (err=1.228)  
83.3 queries/sec
Query 2: actual 84 (0.012%)  origin-forest_43.843 42 (err=2.000)  
76.9 queries/sec
Query 3: actual 9 (0.001%)  origin-forest_43.843 16 (err=1.778)  
99.2 queries/sec
Query 4: actual 79331 (11.378%)  origin-forest_43.843 100673 (err=1.269)  
90.9 queries/sec
Query 5: actual 195 (0.028%)  origin-forest_43.843 225 (err=1.154)  
90.9 queries/sec
Query 6: actual 96 (0.014%)  origin-forest_43.843 175 (err=1.823)  
90.9 queries/sec
Query 7: actual 123 (0.018%)  origin-forest_43.843 105 (err=1.171)  
90.9 queries/sec
Query 8: actual 430 (0.062%)  origin-forest_43.843 364 (err=1.181)  
90.9 queries/sec
Query 9: actual 14 (0.002%)  origin-forest_43.843 2 (err=7.000)  
83.3 queries/sec
Query 10: actual 9 (0.001%)  origin-forest_43.843 9 (err=1.000)  
83.3 queries/sec
Query 11: actual 15 (0.002%)  origin-forest_43.843 5 (err=3.000)  
83.3 queries/sec
Query 12: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
81.2 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 15: actual 79915 (11.462%)  origin-forest_43.843 73284 (err=1.090)  
90.9 queries/sec
Query 16: actual 996 (0.143%)  origin-forest_43.843 867 (err=1.149)  
83.3 queries/sec
Query 17: actual 3 (0.000%)  origin-forest_43.843 3 (err=1.000)  
66.7 queries/sec
Query 18: actual 1420 (0.204%)  origin-forest_43.843 614 (err=2.313)  
90.9 queries/sec
Query 19: actual 18833 (2.701%)  origin-forest_43.843 1802 (err=10.451)  
90.9 queries/sec
Query 20: actual 117 (0.017%)  origin-forest_43.843 1 (err=117.000)  
90.9 queries/sec
Query 21: actual 45 (0.006%)  origin-forest_43.843 55 (err=1.222)  
82.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 411 (0.059%)  origin-forest_43.843 578 (err=1.406)  
90.9 queries/sec
Query 24: actual 41226 (5.913%)  origin-forest_43.843 31588 (err=1.305)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 27: actual 48563 (6.965%)  origin-forest_43.843 58640 (err=1.208)  
90.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 4 (err=4.000)  
90.9 queries/sec
Query 29: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
90.3 queries/sec
Query 30: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
83.3 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 34: actual 135 (0.019%)  origin-forest_43.843 249 (err=1.844)  
90.9 queries/sec
Query 35: actual 83 (0.012%)  origin-forest_43.843 1 (err=83.000)  
83.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 9 (err=9.000)  
82.7 queries/sec
Query 38: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
76.8 queries/sec
Query 39: actual 247 (0.035%)  origin-forest_43.843 271 (err=1.097)  
83.3 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.7 queries/sec
Query 42: actual 70 (0.010%)  origin-forest_43.843 1 (err=70.000)  
73.7 queries/sec
Query 43: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
90.6 queries/sec
Query 44: actual 4367 (0.626%)  origin-forest_43.843 3037 (err=1.438)  
90.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 27 (0.004%)  origin-forest_43.843 7 (err=3.857)  
81.3 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 48: actual 5 (0.001%)  origin-forest_43.843 13 (err=2.600)  
90.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 117.0000	99th: 100.3400	95th: 43.2030	median: 1.2149	mean: 7.2267
ReportEsts: [1.0, 1.2284263959390862, 2.0, 1.7777777777777777, 1.2690247192144306, 1.1538461538461537, 1.8229166666666667, 1.1714285714285715, 1.1813186813186813, 7.0, 1.0, 3.0, 2.0, 1.0, 1.0, 1.0904835980568746, 1.1487889273356402, 1.0, 2.3127035830618894, 10.4511653718091, 117.0, 1.2222222222222223, 1.0, 1.4063260340632604, 1.305115866784855, 1.0, 1.0, 1.2075036550460228, 4.0, 1.5, 1.25, 1.0, 1.0, 1.0, 1.8444444444444446, 83.0, 1.0, 9.0, 1.0, 1.097165991902834, 1.0, 1.0, 70.0, 3.0, 1.4379321699045111, 1.0, 3.857142857142857, 1.0, 2.6, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 42/50 | Workload-time: 3.971232 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 43/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.0 queries/sec
Query 1: actual 197 (0.028%)  origin-forest_43.843 144 (err=1.368)  
83.3 queries/sec
Query 2: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 3: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
86.8 queries/sec
Query 4: actual 4 (0.001%)  origin-forest_43.843 2 (err=2.000)  
88.3 queries/sec
Query 5: actual 9 (0.001%)  origin-forest_43.843 1 (err=9.000)  
79.8 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.6 queries/sec
Query 7: actual 369 (0.053%)  origin-forest_43.843 417 (err=1.130)  
83.3 queries/sec
Query 8: actual 244552 (35.076%)  origin-forest_43.843 188557 (err=1.297)  
90.9 queries/sec
Query 9: actual 3076 (0.441%)  origin-forest_43.843 4671 (err=1.519)  
83.3 queries/sec
Query 10: actual 15 (0.002%)  origin-forest_43.843 11 (err=1.364)  
83.3 queries/sec
Query 11: actual 55 (0.008%)  origin-forest_43.843 28 (err=1.964)  
76.9 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 13: actual 2 (0.000%)  origin-forest_43.843 4 (err=2.000)  
90.9 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 15: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
76.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
55.6 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 5 (0.001%)  origin-forest_43.843 1 (err=5.000)  
83.3 queries/sec
Query 19: actual 8 (0.001%)  origin-forest_43.843 8 (err=1.000)  
90.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 21: actual 2674 (0.384%)  origin-forest_43.843 4167 (err=1.558)  
100.0 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 24: actual 50 (0.007%)  origin-forest_43.843 42 (err=1.190)  
92.7 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 27: actual 11 (0.002%)  origin-forest_43.843 1 (err=11.000)  
83.3 queries/sec
Query 28: actual 56094 (8.045%)  origin-forest_43.843 58324 (err=1.040)  
100.0 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 9216 (1.322%)  origin-forest_43.843 5721 (err=1.611)  
100.0 queries/sec
Query 33: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
83.3 queries/sec
Query 34: actual 1200 (0.172%)  origin-forest_43.843 67 (err=17.910)  
90.9 queries/sec
Query 35: actual 103 (0.015%)  origin-forest_43.843 112 (err=1.087)  
90.9 queries/sec
Query 36: actual 19 (0.003%)  origin-forest_43.843 23 (err=1.211)  
86.2 queries/sec
Query 37: actual 9 (0.001%)  origin-forest_43.843 9 (err=1.000)  
86.9 queries/sec
Query 38: actual 122 (0.017%)  origin-forest_43.843 183 (err=1.500)  
90.9 queries/sec
Query 39: actual 162 (0.023%)  origin-forest_43.843 179 (err=1.105)  
83.3 queries/sec
Query 40: actual 5 (0.001%)  origin-forest_43.843 7 (err=1.400)  
76.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 42: actual 19690 (2.824%)  origin-forest_43.843 9444 (err=2.085)  
90.9 queries/sec
Query 43: actual 65 (0.009%)  origin-forest_43.843 81 (err=1.246)  
90.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 1677 (0.241%)  origin-forest_43.843 1179 (err=1.422)  
90.9 queries/sec
Query 46: actual 39 (0.006%)  origin-forest_43.843 1 (err=39.000)  
90.7 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 48: actual 4 (0.001%)  origin-forest_43.843 5 (err=1.250)  
90.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 62.0000	99th: 50.7300	95th: 19.0597	median: 1.2005	mean: 4.3552
ReportEsts: [1.0, 1.3680555555555556, 2.0, 62.0, 2.0, 9.0, 1.0, 1.1300813008130082, 1.2969659042093373, 1.5185305591677503, 1.3636363636363635, 1.9642857142857142, 1.0, 2.0, 1.0, 1.5, 1.0, 1.0, 5.0, 1.0, 1.0, 1.5583395661929693, 1.0, 1.0, 1.1904761904761905, 1.0, 1.0, 11.0, 1.0397546974721004, 1.0, 1.0, 1.0, 1.610907184058731, 20.0, 17.91044776119403, 1.087378640776699, 1.2105263157894737, 1.0, 1.5, 1.1049382716049383, 1.4, 1.0, 2.0849216433714526, 1.2461538461538462, 1.0, 1.4223918575063612, 39.0, 1.0, 1.25, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 43/50 | Workload-time: 4.023576 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 44/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 579 (0.083%)  origin-forest_43.843 335 (err=1.728)  
43.5 queries/sec
Query 1: actual 5 (0.001%)  origin-forest_43.843 3 (err=1.667)  
79.9 queries/sec
Query 2: actual 6 (0.001%)  origin-forest_43.843 3 (err=2.000)  
83.3 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 4: actual 9 (0.001%)  origin-forest_43.843 8 (err=1.125)  
83.3 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 7: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
76.9 queries/sec
Query 8: actual 760 (0.109%)  origin-forest_43.843 592 (err=1.284)  
83.3 queries/sec
Query 9: actual 21 (0.003%)  origin-forest_43.843 32 (err=1.524)  
82.6 queries/sec
Query 10: actual 106 (0.015%)  origin-forest_43.843 202 (err=1.906)  
83.3 queries/sec
Query 11: actual 11 (0.002%)  origin-forest_43.843 5 (err=2.200)  
71.4 queries/sec
Query 12: actual 168 (0.024%)  origin-forest_43.843 1 (err=168.000)  
83.3 queries/sec
Query 13: actual 9 (0.001%)  origin-forest_43.843 6 (err=1.500)  
83.3 queries/sec
Query 14: actual 17 (0.002%)  origin-forest_43.843 1 (err=17.000)  
76.9 queries/sec
Query 15: actual 38581 (5.534%)  origin-forest_43.843 37678 (err=1.024)  
90.9 queries/sec
Query 16: actual 60 (0.009%)  origin-forest_43.843 1 (err=60.000)  
83.3 queries/sec
Query 17: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.0 queries/sec
Query 18: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 19: actual 28 (0.004%)  origin-forest_43.843 1 (err=28.000)  
90.9 queries/sec
Query 20: actual 9850 (1.413%)  origin-forest_43.843 9772 (err=1.008)  
90.9 queries/sec
Query 21: actual 17 (0.002%)  origin-forest_43.843 9 (err=1.889)  
90.9 queries/sec
Query 22: actual 31 (0.004%)  origin-forest_43.843 28 (err=1.107)  
90.9 queries/sec
Query 23: actual 157738 (22.624%)  origin-forest_43.843 152998 (err=1.031)  
83.3 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 26: actual 209 (0.030%)  origin-forest_43.843 1 (err=209.000)  
95.2 queries/sec
Query 27: actual 353 (0.051%)  origin-forest_43.843 1 (err=353.000)  
95.5 queries/sec
Query 28: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
82.3 queries/sec
Query 29: actual 181 (0.026%)  origin-forest_43.843 13 (err=13.923)  
83.3 queries/sec
Query 30: actual 7 (0.001%)  origin-forest_43.843 15 (err=2.143)  
90.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.6 queries/sec
Query 32: actual 23 (0.003%)  origin-forest_43.843 1 (err=23.000)  
90.9 queries/sec
Query 33: actual 10 (0.001%)  origin-forest_43.843 1 (err=10.000)  
72.7 queries/sec
Query 34: actual 54 (0.008%)  origin-forest_43.843 0 (err=54.000)  
71.2 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 45: actual 211 (0.030%)  origin-forest_43.843 215 (err=1.019)  
76.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 47: actual 205 (0.029%)  origin-forest_43.843 0 (err=205.000)  
62.5 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 49: actual 27 (0.004%)  origin-forest_43.843 24 (err=1.125)  
origin-forest_43.843 	max: 353.0000	99th: 282.4400	95th: 188.3500	median: 1.3919	mean: 23.9240
ReportEsts: [1.7283582089552239, 1.6666666666666667, 2.0, 1.0, 1.125, 1.0, 1.0, 4.0, 1.2837837837837838, 1.5238095238095237, 1.9056603773584906, 2.2, 168.0, 1.5, 17.0, 1.0239662402462977, 60.0, 2.0, 3.0, 28.0, 1.0079819893573476, 1.8888888888888888, 1.1071428571428572, 1.030980797134603, 1.0, 1.0, 209.0, 353.0, 2.0, 13.923076923076923, 2.142857142857143, 1.0, 23.0, 10.0, 54, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.018957345971564, 1.0, 205, 1.0, 1.125]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 44/50 | Workload-time: 4.109909 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 45/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=sample', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (761012, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 39.7540
detection mean = 44.4330
detection threshold = 0.6337
test statistic = 4.6790
Offline time = 2.916602849960327
Online time = 0.5139472484588623
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 45-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (761012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 761012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 43.1256 bits (loss 61.570, data 18.444) 0.00100 lr
epoch 9 train loss 42.3786 nats / 61.1395 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 42.6057 bits (loss 61.050, data 18.444) 0.00082 lr
epoch 19 train loss 42.2388 nats / 60.9377 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 37.5464 nats / 54.1680 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 45/50 | Workload-time: 6.752265 | Model-update-time: 10.478991


WORKLOAD-START | Type: QueryWorkload | Progress: 46/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
41.7 queries/sec
Query 1: actual 147 (0.021%)  origin-forest_43.843 93 (err=1.581)  
83.3 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 3: actual 714 (0.102%)  origin-forest_43.843 2 (err=357.000)  
76.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 5: actual 2878 (0.413%)  origin-forest_43.843 1835 (err=1.568)  
96.5 queries/sec
Query 6: actual 34 (0.005%)  origin-forest_43.843 12 (err=2.833)  
86.2 queries/sec
Query 7: actual 6736 (0.966%)  origin-forest_43.843 8754 (err=1.300)  
99.5 queries/sec
Query 8: actual 282 (0.040%)  origin-forest_43.843 1 (err=282.000)  
90.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.7 queries/sec
Query 10: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
95.2 queries/sec
Query 11: actual 3 (0.000%)  origin-forest_43.843 3 (err=1.000)  
83.3 queries/sec
Query 12: actual 6 (0.001%)  origin-forest_43.843 11 (err=1.833)  
76.9 queries/sec
Query 13: actual 159 (0.023%)  origin-forest_43.843 149 (err=1.067)  
79.9 queries/sec
Query 14: actual 61 (0.009%)  origin-forest_43.843 19 (err=3.211)  
90.9 queries/sec
Query 15: actual 24 (0.003%)  origin-forest_43.843 4 (err=6.000)  
90.9 queries/sec
Query 16: actual 6 (0.001%)  origin-forest_43.843 4 (err=1.500)  
83.3 queries/sec
Query 17: actual 42 (0.006%)  origin-forest_43.843 1 (err=42.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 3 (err=3.000)  
90.9 queries/sec
Query 19: actual 155 (0.022%)  origin-forest_43.843 317 (err=2.045)  
100.0 queries/sec
Query 20: actual 80149 (11.496%)  origin-forest_43.843 67688 (err=1.184)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 24: actual 439 (0.063%)  origin-forest_43.843 601 (err=1.369)  
90.9 queries/sec
Query 25: actual 282 (0.040%)  origin-forest_43.843 327 (err=1.160)  
100.0 queries/sec
Query 26: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
83.3 queries/sec
Query 27: actual 16 (0.002%)  origin-forest_43.843 21 (err=1.312)  
90.9 queries/sec
Query 28: actual 47 (0.007%)  origin-forest_43.843 1 (err=47.000)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
100.0 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 32: actual 55 (0.008%)  origin-forest_43.843 12 (err=4.583)  
90.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 34: actual 16556 (2.375%)  origin-forest_43.843 19470 (err=1.176)  
90.9 queries/sec
Query 35: actual 257 (0.037%)  origin-forest_43.843 373 (err=1.451)  
90.9 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 37: actual 1706 (0.245%)  origin-forest_43.843 945 (err=1.805)  
90.9 queries/sec
Query 38: actual 1896 (0.272%)  origin-forest_43.843 1576 (err=1.203)  
90.9 queries/sec
Query 39: actual 7 (0.001%)  origin-forest_43.843 6 (err=1.167)  
100.0 queries/sec
Query 40: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
86.9 queries/sec
Query 41: actual 260 (0.037%)  origin-forest_43.843 330 (err=1.269)  
83.3 queries/sec
Query 42: actual 22 (0.003%)  origin-forest_43.843 18 (err=1.222)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 45: actual 5 (0.001%)  origin-forest_43.843 2 (err=2.500)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
102.1 queries/sec
Query 47: actual 180628 (25.907%)  origin-forest_43.843 209310 (err=1.159)  
90.3 queries/sec
Query 48: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.6 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 357.0000	99th: 320.2500	95th: 44.7500	median: 1.2457	mean: 16.3825
ReportEsts: [1.0, 1.5806451612903225, 1.0, 357.0, 1.0, 1.5683923705722072, 2.8333333333333335, 1.29958432304038, 282.0, 1.0, 1.5, 1.0, 1.8333333333333333, 1.0671140939597314, 3.210526315789474, 6.0, 1.5, 42.0, 3.0, 2.0451612903225804, 1.1840946696607966, 1.0, 1.0, 1.0, 1.3690205011389522, 1.1595744680851063, 1.125, 1.3125, 47.0, 1.0, 1.0, 1.0, 4.583333333333333, 2.0, 1.1760086977530804, 1.45136186770428, 1.0, 1.8052910052910054, 1.2030456852791878, 1.1666666666666667, 20.0, 1.2692307692307692, 1.2222222222222223, 1.0, 1.0, 2.5, 1.0, 1.1587904422348694, 2.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 46/50 | Workload-time: 3.968475 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 47/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.1s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 2: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
76.9 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 6: actual 138 (0.020%)  origin-forest_43.843 169 (err=1.225)  
86.9 queries/sec
Query 7: actual 37 (0.005%)  origin-forest_43.843 33 (err=1.121)  
83.3 queries/sec
Query 8: actual 7 (0.001%)  origin-forest_43.843 10 (err=1.429)  
90.9 queries/sec
Query 9: actual 14 (0.002%)  origin-forest_43.843 9 (err=1.556)  
90.9 queries/sec
Query 10: actual 19 (0.003%)  origin-forest_43.843 1 (err=19.000)  
79.5 queries/sec
Query 11: actual 35 (0.005%)  origin-forest_43.843 41 (err=1.171)  
90.9 queries/sec
Query 12: actual 1037 (0.149%)  origin-forest_43.843 1263 (err=1.218)  
76.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 14: actual 25 (0.004%)  origin-forest_43.843 1 (err=25.000)  
80.0 queries/sec
Query 15: actual 185 (0.027%)  origin-forest_43.843 286 (err=1.546)  
90.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
76.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 20: actual 59152 (8.484%)  origin-forest_43.843 63932 (err=1.081)  
90.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 105 (0.015%)  origin-forest_43.843 120 (err=1.143)  
86.9 queries/sec
Query 23: actual 54 (0.008%)  origin-forest_43.843 2 (err=27.000)  
90.9 queries/sec
Query 24: actual 140743 (20.186%)  origin-forest_43.843 153779 (err=1.093)  
90.9 queries/sec
Query 25: actual 184 (0.026%)  origin-forest_43.843 239 (err=1.299)  
83.3 queries/sec
Query 26: actual 5 (0.001%)  origin-forest_43.843 1 (err=5.000)  
90.9 queries/sec
Query 27: actual 6 (0.001%)  origin-forest_43.843 2 (err=3.000)  
83.3 queries/sec
Query 28: actual 21900 (3.141%)  origin-forest_43.843 24860 (err=1.135)  
90.9 queries/sec
Query 29: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 31: actual 728 (0.104%)  origin-forest_43.843 1 (err=728.000)  
86.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 37: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
90.9 queries/sec
Query 38: actual 1701 (0.244%)  origin-forest_43.843 1222 (err=1.392)  
83.3 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 40: actual 16 (0.002%)  origin-forest_43.843 1 (err=16.000)  
83.3 queries/sec
Query 41: actual 83 (0.012%)  origin-forest_43.843 87 (err=1.048)  
91.6 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
94.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.8 queries/sec
Query 44: actual 35 (0.005%)  origin-forest_43.843 3 (err=11.667)  
83.3 queries/sec
Query 45: actual 21 (0.003%)  origin-forest_43.843 4 (err=5.250)  
90.9 queries/sec
Query 46: actual 98 (0.014%)  origin-forest_43.843 138 (err=1.408)  
90.9 queries/sec
Query 47: actual 10 (0.001%)  origin-forest_43.843 8 (err=1.250)  
90.9 queries/sec
Query 48: actual 3 (0.000%)  origin-forest_43.843 3 (err=1.000)  
83.1 queries/sec
Query 49: actual 2303 (0.330%)  origin-forest_43.843 1 (err=2303.000)  
origin-forest_43.843 	max: 2303.0000	99th: 1531.2500	95th: 26.1000	median: 1.1390	mean: 63.9006
ReportEsts: [1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.2246376811594204, 1.121212121212121, 1.4285714285714286, 1.5555555555555556, 19.0, 1.1714285714285715, 1.2179363548698168, 1.0, 25.0, 1.545945945945946, 1.0, 3.0, 1.0, 1.0, 1.0808087638625914, 1.0, 1.1428571428571428, 27.0, 1.0926227236878565, 1.298913043478261, 5.0, 3.0, 1.1351598173515982, 2.0, 1.0, 728.0, 1.0, 1.0, 1.0, 1.0, 1.0, 4.0, 1.3919803600654665, 1.0, 16.0, 1.0481927710843373, 1.0, 1.0, 11.666666666666666, 5.25, 1.4081632653061225, 1.25, 1.0, 2303.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 47/50 | Workload-time: 3.998738 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 48/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 6426 (0.922%)  origin-forest_43.843 6367 (err=1.009)  
43.5 queries/sec
Query 1: actual 153486 (22.014%)  origin-forest_43.843 149535 (err=1.026)  
90.9 queries/sec
Query 2: actual 15 (0.002%)  origin-forest_43.843 6 (err=2.500)  
83.3 queries/sec
Query 3: actual 124 (0.018%)  origin-forest_43.843 102 (err=1.216)  
83.3 queries/sec
Query 4: actual 34593 (4.962%)  origin-forest_43.843 44879 (err=1.297)  
76.9 queries/sec
Query 5: actual 11 (0.002%)  origin-forest_43.843 1 (err=11.000)  
83.3 queries/sec
Query 6: actual 4 (0.001%)  origin-forest_43.843 2 (err=2.000)  
87.9 queries/sec
Query 7: actual 115324 (16.541%)  origin-forest_43.843 126811 (err=1.100)  
90.9 queries/sec
Query 8: actual 67 (0.010%)  origin-forest_43.843 111 (err=1.657)  
90.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 10: actual 41 (0.006%)  origin-forest_43.843 2 (err=20.500)  
83.3 queries/sec
Query 11: actual 681 (0.098%)  origin-forest_43.843 418 (err=1.629)  
86.5 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 15: actual 8 (0.001%)  origin-forest_43.843 23 (err=2.875)  
86.9 queries/sec
Query 16: actual 2 (0.000%)  origin-forest_43.843 5 (err=2.500)  
76.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 225393 (32.328%)  origin-forest_43.843 235958 (err=1.047)  
90.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 21: actual 17 (0.002%)  origin-forest_43.843 80 (err=4.706)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 31 (0.004%)  origin-forest_43.843 30 (err=1.033)  
86.9 queries/sec
Query 24: actual 84 (0.012%)  origin-forest_43.843 1 (err=84.000)  
76.9 queries/sec
Query 25: actual 3 (0.000%)  origin-forest_43.843 3 (err=1.000)  
83.3 queries/sec
Query 26: actual 10741 (1.541%)  origin-forest_43.843 9062 (err=1.185)  
90.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 23 (0.003%)  origin-forest_43.843 1 (err=23.000)  
90.9 queries/sec
Query 29: actual 37 (0.005%)  origin-forest_43.843 61 (err=1.649)  
90.9 queries/sec
Query 30: actual 67652 (9.703%)  origin-forest_43.843 60286 (err=1.122)  
90.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 155 (0.022%)  origin-forest_43.843 232 (err=1.497)  
99.1 queries/sec
Query 33: actual 291 (0.042%)  origin-forest_43.843 419 (err=1.440)  
90.9 queries/sec
Query 34: actual 188 (0.027%)  origin-forest_43.843 178 (err=1.056)  
76.9 queries/sec
Query 35: actual 103086 (14.785%)  origin-forest_43.843 102590 (err=1.005)  
100.0 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 37: actual 198 (0.028%)  origin-forest_43.843 95 (err=2.084)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 9120 (1.308%)  origin-forest_43.843 10320 (err=1.132)  
83.3 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.2 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 24 (0.003%)  origin-forest_43.843 26 (err=1.083)  
90.9 queries/sec
Query 45: actual 98684 (14.154%)  origin-forest_43.843 100179 (err=1.015)  
90.9 queries/sec
Query 46: actual 3136 (0.450%)  origin-forest_43.843 4462 (err=1.423)  
100.0 queries/sec
Query 47: actual 2042 (0.293%)  origin-forest_43.843 1808 (err=1.129)  
83.3 queries/sec
Query 48: actual 1441 (0.207%)  origin-forest_43.843 1653 (err=1.147)  
100.0 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 84.0000	99th: 54.1100	95th: 16.2250	median: 1.0698	mean: 4.0013
ReportEsts: [1.0092665305481388, 1.0264219079145351, 2.5, 1.2156862745098038, 1.297343393172029, 11.0, 2.0, 1.0996063265235336, 1.6567164179104477, 1.0, 20.5, 1.6291866028708133, 1.0, 1.0, 1.0, 2.875, 2.5, 1.0, 1.0, 1.0468736828561669, 1.0, 4.705882352941177, 1.0, 1.0333333333333334, 84.0, 1.0, 1.1852791878172588, 1.0, 23.0, 1.6486486486486487, 1.122184255050924, 1.0, 1.4967741935483871, 1.4398625429553265, 1.0561797752808988, 1.0048347792182475, 1.0, 2.0842105263157893, 1.0, 1.131578947368421, 1.0, 1.0, 1.0, 1.0, 1.0833333333333333, 1.01514936565198, 1.4228316326530612, 1.1294247787610618, 1.147120055517002, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 48/50 | Workload-time: 4.008785 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 49/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 69 (0.010%)  origin-forest_43.843 124 (err=1.797)  
45.5 queries/sec
Query 1: actual 69 (0.010%)  origin-forest_43.843 60 (err=1.150)  
83.3 queries/sec
Query 2: actual 119 (0.017%)  origin-forest_43.843 100 (err=1.190)  
90.9 queries/sec
Query 3: actual 1450 (0.208%)  origin-forest_43.843 15 (err=96.667)  
83.3 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 6: actual 548 (0.079%)  origin-forest_43.843 292 (err=1.877)  
90.9 queries/sec
Query 7: actual 8310 (1.192%)  origin-forest_43.843 8897 (err=1.071)  
83.3 queries/sec
Query 8: actual 8 (0.001%)  origin-forest_43.843 9 (err=1.125)  
94.6 queries/sec
Query 9: actual 5717 (0.820%)  origin-forest_43.843 6077 (err=1.063)  
90.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 11: actual 8358 (1.199%)  origin-forest_43.843 10130 (err=1.212)  
90.9 queries/sec
Query 12: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 13: actual 4464 (0.640%)  origin-forest_43.843 5383 (err=1.206)  
86.2 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
78.6 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
91.1 queries/sec
Query 16: actual 38668 (5.546%)  origin-forest_43.843 53033 (err=1.371)  
90.9 queries/sec
Query 17: actual 164028 (23.526%)  origin-forest_43.843 147159 (err=1.115)  
90.9 queries/sec
Query 18: actual 199 (0.029%)  origin-forest_43.843 22 (err=9.045)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 23: actual 39 (0.006%)  origin-forest_43.843 94 (err=2.410)  
83.3 queries/sec
Query 24: actual 17289 (2.480%)  origin-forest_43.843 15426 (err=1.121)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 5 (err=5.000)  
100.0 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 27: actual 146 (0.021%)  origin-forest_43.843 2 (err=73.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 29: actual 12679 (1.819%)  origin-forest_43.843 924 (err=13.722)  
90.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 31: actual 5 (0.001%)  origin-forest_43.843 7 (err=1.400)  
95.2 queries/sec
Query 32: actual 4 (0.001%)  origin-forest_43.843 4 (err=1.000)  
100.0 queries/sec
Query 33: actual 5 (0.001%)  origin-forest_43.843 6 (err=1.200)  
83.3 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 36: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
90.9 queries/sec
Query 37: actual 6 (0.001%)  origin-forest_43.843 2 (err=3.000)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 2214 (0.318%)  origin-forest_43.843 325 (err=6.812)  
100.0 queries/sec
Query 40: actual 8 (0.001%)  origin-forest_43.843 3 (err=2.667)  
80.0 queries/sec
Query 41: actual 1216 (0.174%)  origin-forest_43.843 1 (err=1216.000)  
87.5 queries/sec
Query 42: actual 194 (0.028%)  origin-forest_43.843 1 (err=194.000)  
90.9 queries/sec
Query 43: actual 5364 (0.769%)  origin-forest_43.843 4174 (err=1.285)  
76.9 queries/sec
Query 44: actual 110 (0.016%)  origin-forest_43.843 122 (err=1.109)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 46: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 47: actual 5 (0.001%)  origin-forest_43.843 2 (err=2.500)  
76.9 queries/sec
Query 48: actual 93 (0.013%)  origin-forest_43.843 53 (err=1.755)  
80.0 queries/sec
Query 49: actual 220 (0.032%)  origin-forest_43.843 1 (err=220.000)  
origin-forest_43.843 	max: 1216.0000	99th: 727.9600	95th: 150.2000	median: 1.2029	mean: 39.0174
ReportEsts: [1.7971014492753623, 1.15, 1.19, 96.66666666666667, 1.0, 1.0, 1.8767123287671232, 1.0706377858002407, 1.125, 1.0629700892076264, 1.0, 1.212012443168222, 2.0, 1.2058691756272402, 1.0, 1.0, 1.3714958104892934, 1.11463111328563, 9.045454545454545, 1.0, 1.0, 1.0, 1.0, 2.41025641025641, 1.1207701283547258, 5.0, 1.0, 73.0, 1.0, 13.721861471861471, 1.0, 1.4, 1.0, 1.2, 1.0, 2.0, 62.0, 3.0, 1.0, 6.812307692307693, 2.6666666666666665, 1216.0, 194.0, 1.2850982271202682, 1.1090909090909091, 1.0, 2.0, 2.5, 1.7547169811320755, 220.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 49/50 | Workload-time: 3.997400 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 50/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
Query 0: actual 241 (0.035%)  origin-forest_43.843 1 (err=241.000)  
41.7 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 3: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 4: actual 105 (0.015%)  origin-forest_43.843 17 (err=6.176)  
83.3 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 7: actual 100544 (14.421%)  origin-forest_43.843 65497 (err=1.535)  
100.0 queries/sec
Query 8: actual 40868 (5.862%)  origin-forest_43.843 34642 (err=1.180)  
90.9 queries/sec
Query 9: actual 181 (0.026%)  origin-forest_43.843 98 (err=1.847)  
94.5 queries/sec
Query 10: actual 108 (0.015%)  origin-forest_43.843 7 (err=15.429)  
90.9 queries/sec
Query 11: actual 18 (0.003%)  origin-forest_43.843 3 (err=6.000)  
71.4 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.9 queries/sec
Query 14: actual 160 (0.023%)  origin-forest_43.843 0 (err=160.000)  
76.9 queries/sec
Query 15: actual 40936 (5.871%)  origin-forest_43.843 55881 (err=1.365)  
90.9 queries/sec
Query 16: actual 559 (0.080%)  origin-forest_43.843 434 (err=1.288)  
90.9 queries/sec
Query 17: actual 316 (0.045%)  origin-forest_43.843 341 (err=1.079)  
90.9 queries/sec
Query 18: actual 5 (0.001%)  origin-forest_43.843 1 (err=5.000)  
90.9 queries/sec
Query 19: actual 31 (0.004%)  origin-forest_43.843 90 (err=2.903)  
83.3 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 21: actual 2813 (0.403%)  origin-forest_43.843 3678 (err=1.308)  
90.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
99.6 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
90.9 queries/sec
Query 27: actual 69 (0.010%)  origin-forest_43.843 1 (err=69.000)  
90.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 29: actual 49 (0.007%)  origin-forest_43.843 1 (err=49.000)  
83.3 queries/sec
Query 30: actual 983 (0.141%)  origin-forest_43.843 1189 (err=1.210)  
100.0 queries/sec
Query 31: actual 972 (0.139%)  origin-forest_43.843 20 (err=48.600)  
90.7 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 87 (0.012%)  origin-forest_43.843 160 (err=1.839)  
90.9 queries/sec
Query 36: actual 14 (0.002%)  origin-forest_43.843 10 (err=1.400)  
83.3 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 38: actual 350 (0.050%)  origin-forest_43.843 360 (err=1.029)  
83.3 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
100.1 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
87.0 queries/sec
Query 41: actual 30 (0.004%)  origin-forest_43.843 8 (err=3.750)  
90.9 queries/sec
Query 42: actual 122 (0.017%)  origin-forest_43.843 50 (err=2.440)  
90.9 queries/sec
Query 43: actual 94 (0.013%)  origin-forest_43.843 1 (err=94.000)  
90.9 queries/sec
Query 44: actual 601 (0.086%)  origin-forest_43.843 491 (err=1.224)  
90.9 queries/sec
Query 45: actual 497 (0.071%)  origin-forest_43.843 221 (err=2.249)  
90.9 queries/sec
Query 46: actual 34 (0.005%)  origin-forest_43.843 5 (err=6.800)  
90.9 queries/sec
Query 47: actual 317 (0.045%)  origin-forest_43.843 152 (err=2.086)  
90.8 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 241.0000	99th: 201.3100	95th: 82.7500	median: 1.2560	mean: 15.0947
ReportEsts: [241.0, 1.0, 1.0, 2.0, 6.176470588235294, 1.0, 2.0, 1.5350932103760477, 1.1797240344090987, 1.846938775510204, 15.428571428571429, 6.0, 1.0, 1.0, 160, 1.3650820793433653, 1.2880184331797235, 1.0791139240506329, 5.0, 2.903225806451613, 1.0, 1.3075008887308923, 1.0, 1.0, 1.0, 1.0, 1.0, 69.0, 1.0, 49.0, 1.2095625635808749, 48.6, 1.0, 1.0, 1.0, 1.839080459770115, 1.4, 1.0, 1.0285714285714285, 1.0, 1.0, 3.75, 2.44, 94.0, 1.2240325865580448, 2.248868778280543, 6.8, 2.085526315789474, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 50/50 | Workload-time: 3.990576 | Model-update-time: 0.000000





Experiment Summary: #drift=15 | total-time=400.304125
