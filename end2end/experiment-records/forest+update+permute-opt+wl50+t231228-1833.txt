Input arguments = Namespace(data_update='permute-opt', dataset='forest', debug=False, drift_test='ddup', model_update='update', model='naru', random_seed=42, num_workload=50)
MODEL-PATH=F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
DATASET-PATH=F:\DBGroup\LearnedCardinalityUpdater\data\forest\end2end\forest.npy
Workload weights: query=15, data-update=10
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload', 'QueryWorkload']



WORKLOAD-START | Type: QueryWorkload | Progress: 1/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.1s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 0
RandomSeedCommunicator.get: 0
Query 0: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
39.2 queries/sec
Query 1: actual 5561 (0.798%)  origin-forest_43.843 5247 (err=1.060)  
83.3 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 3: actual 59 (0.008%)  origin-forest_43.843 40 (err=1.475)  
76.9 queries/sec
Query 4: actual 8 (0.001%)  origin-forest_43.843 3 (err=2.667)  
90.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 6: actual 384 (0.055%)  origin-forest_43.843 501 (err=1.305)  
76.9 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 8: actual 703 (0.101%)  origin-forest_43.843 555 (err=1.267)  
86.8 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 10: actual 67 (0.010%)  origin-forest_43.843 74 (err=1.104)  
83.3 queries/sec
Query 11: actual 66 (0.009%)  origin-forest_43.843 1 (err=66.000)  
71.4 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 13: actual 2 (0.000%)  origin-forest_43.843 5 (err=2.500)  
83.3 queries/sec
Query 14: actual 134 (0.019%)  origin-forest_43.843 66 (err=2.030)  
83.3 queries/sec
Query 15: actual 89 (0.013%)  origin-forest_43.843 75 (err=1.187)  
76.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.1 queries/sec
Query 17: actual 22 (0.003%)  origin-forest_43.843 1 (err=22.000)  
76.8 queries/sec
Query 18: actual 53 (0.008%)  origin-forest_43.843 86 (err=1.623)  
76.9 queries/sec
Query 19: actual 86 (0.012%)  origin-forest_43.843 68 (err=1.265)  
90.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 21: actual 134 (0.019%)  origin-forest_43.843 1 (err=134.000)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 24: actual 395 (0.057%)  origin-forest_43.843 605 (err=1.532)  
81.5 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
55.6 queries/sec
Query 26: actual 14604 (2.095%)  origin-forest_43.843 14924 (err=1.022)  
83.3 queries/sec
Query 27: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
71.4 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 29: actual 7 (0.001%)  origin-forest_43.843 2 (err=3.500)  
64.1 queries/sec
Query 30: actual 4 (0.001%)  origin-forest_43.843 7 (err=1.750)  
66.6 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.5 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 35: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
71.4 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 37: actual 86 (0.012%)  origin-forest_43.843 1 (err=86.000)  
66.7 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.4 queries/sec
Query 39: actual 6 (0.001%)  origin-forest_43.843 3 (err=2.000)  
76.9 queries/sec
Query 40: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
71.4 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 42: actual 17 (0.002%)  origin-forest_43.843 10 (err=1.700)  
73.1 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.5 queries/sec
Query 44: actual 123 (0.018%)  origin-forest_43.843 148 (err=1.203)  
83.3 queries/sec
Query 45: actual 689 (0.099%)  origin-forest_43.843 227 (err=3.035)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.6 queries/sec
Query 47: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
73.8 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 134.0000	99th: 110.4800	95th: 46.2000	median: 1.1456	mean: 7.5045
ReportEsts: [2.0, 1.0598437202210786, 1.0, 1.475, 2.6666666666666665, 1.0, 1.3046875, 1.0, 1.2666666666666666, 1.0, 1.1044776119402986, 66.0, 1.0, 2.5, 2.0303030303030303, 1.1866666666666668, 1.0, 22.0, 1.6226415094339623, 1.2647058823529411, 1.0, 134.0, 1.0, 1.0, 1.5316455696202531, 1.0, 1.0219118049849356, 4.0, 1.0, 3.5, 1.75, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 86.0, 1.0, 2.0, 2.0, 1.0, 1.7, 1.0, 1.2032520325203253, 3.0352422907488985, 1.0, 2.0, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/50 | Workload-time: 4.248432 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (591012, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 71.6770
detection mean = 43.5391
detection threshold = 0.3111
test statistic = 28.1379
Offline time = 2.883141279220581
Online time = 0.465653657913208
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 2-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (591012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 591012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 79.6711 bits (loss 98.844, data 19.173) 0.00100 lr
epoch 9 train loss 55.0178 nats / 79.3739 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 59.8828 bits (loss 79.056, data 19.173) 0.00082 lr
epoch 19 train loss 52.6179 nats / 75.9116 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 101.6384 nats / 146.6332 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/50 | Workload-time: 6.640568 | Model-update-time: 10.555768


WORKLOAD-START | Type: QueryWorkload | Progress: 3/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 1
RandomSeedCommunicator.get: 1
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
34.5 queries/sec
Query 1: actual 3 (0.000%)  origin-forest_43.843 8 (err=2.667)  
76.9 queries/sec
Query 2: actual 4 (0.001%)  origin-forest_43.843 4 (err=1.000)  
79.4 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 4: actual 292 (0.042%)  origin-forest_43.843 375 (err=1.284)  
95.2 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 35874 (5.145%)  origin-forest_43.843 41758 (err=1.164)  
90.9 queries/sec
Query 7: actual 4 (0.001%)  origin-forest_43.843 61 (err=15.250)  
76.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
71.4 queries/sec
Query 10: actual 13191 (1.892%)  origin-forest_43.843 6828 (err=1.932)  
90.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
81.0 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.7 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 21: actual 51 (0.007%)  origin-forest_43.843 18 (err=2.833)  
90.9 queries/sec
Query 22: actual 277 (0.040%)  origin-forest_43.843 84 (err=3.298)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 25: actual 41 (0.006%)  origin-forest_43.843 1 (err=41.000)  
76.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 27: actual 852 (0.122%)  origin-forest_43.843 1002 (err=1.176)  
76.9 queries/sec
Query 28: actual 339109 (48.638%)  origin-forest_43.843 317324 (err=1.069)  
95.2 queries/sec
Query 29: actual 11 (0.002%)  origin-forest_43.843 4 (err=2.750)  
76.9 queries/sec
Query 30: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 31: actual 10 (0.001%)  origin-forest_43.843 14 (err=1.400)  
76.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 35: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
83.3 queries/sec
Query 36: actual 80 (0.011%)  origin-forest_43.843 1 (err=80.000)  
79.9 queries/sec
Query 37: actual 7 (0.001%)  origin-forest_43.843 7 (err=1.000)  
90.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.2 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.5 queries/sec
Query 40: actual 2 (0.000%)  origin-forest_43.843 7 (err=3.500)  
76.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 42: actual 64 (0.009%)  origin-forest_43.843 1 (err=64.000)  
76.9 queries/sec
Query 43: actual 25 (0.004%)  origin-forest_43.843 47 (err=1.880)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 45: actual 32 (0.005%)  origin-forest_43.843 20 (err=1.600)  
86.8 queries/sec
Query 46: actual 31604 (4.533%)  origin-forest_43.843 44639 (err=1.412)  
90.9 queries/sec
Query 47: actual 44 (0.006%)  origin-forest_43.843 69 (err=1.568)  
90.9 queries/sec
Query 48: actual 56 (0.008%)  origin-forest_43.843 64 (err=1.143)  
90.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 80.0000	99th: 72.1600	95th: 29.4125	median: 1.0000	mean: 5.2585
ReportEsts: [1.0, 2.6666666666666665, 1.0, 1.0, 1.2842465753424657, 1.0, 1.164018509226738, 15.25, 1.0, 1.5, 1.9318980667838312, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.8333333333333335, 3.2976190476190474, 1.0, 1.0, 41.0, 1.0, 1.176056338028169, 1.0686522292672473, 2.75, 2.0, 1.4, 1.0, 1.0, 1.0, 1.5, 80.0, 1.0, 1.0, 1.0, 3.5, 1.0, 64.0, 1.88, 1.0, 1.6, 1.4124477914188078, 1.5681818181818181, 1.1428571428571428, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/50 | Workload-time: 4.072356 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 4/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.1s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 2
RandomSeedCommunicator.get: 2
Query 0: actual 1898 (0.272%)  origin-forest_43.843 1963 (err=1.034)  
41.7 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 6 (0.001%)  origin-forest_43.843 1 (err=6.000)  
76.9 queries/sec
Query 3: actual 3 (0.000%)  origin-forest_43.843 3 (err=1.000)  
90.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 5: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.8 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 7: actual 18 (0.003%)  origin-forest_43.843 1 (err=18.000)  
74.1 queries/sec
Query 8: actual 2479 (0.356%)  origin-forest_43.843 1473 (err=1.683)  
73.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 14 (err=14.000)  
76.9 queries/sec
Query 10: actual 140 (0.020%)  origin-forest_43.843 491 (err=3.507)  
90.9 queries/sec
Query 11: actual 9575 (1.373%)  origin-forest_43.843 11138 (err=1.163)  
90.9 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 13: actual 19 (0.003%)  origin-forest_43.843 1 (err=19.000)  
76.9 queries/sec
Query 14: actual 152 (0.022%)  origin-forest_43.843 155 (err=1.020)  
90.9 queries/sec
Query 15: actual 3607 (0.517%)  origin-forest_43.843 3299 (err=1.093)  
86.8 queries/sec
Query 16: actual 515 (0.074%)  origin-forest_43.843 400 (err=1.288)  
76.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 18: actual 41888 (6.008%)  origin-forest_43.843 16041 (err=2.611)  
83.3 queries/sec
Query 19: actual 578 (0.083%)  origin-forest_43.843 717 (err=1.240)  
100.0 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 104091 (14.930%)  origin-forest_43.843 87924 (err=1.184)  
90.8 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 24: actual 15 (0.002%)  origin-forest_43.843 1 (err=15.000)  
71.4 queries/sec
Query 25: actual 3342 (0.479%)  origin-forest_43.843 2617 (err=1.277)  
83.3 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 7 (0.001%)  origin-forest_43.843 1 (err=7.000)  
83.3 queries/sec
Query 30: actual 44825 (6.429%)  origin-forest_43.843 52453 (err=1.170)  
100.0 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.6 queries/sec
Query 32: actual 721 (0.103%)  origin-forest_43.843 454 (err=1.588)  
83.4 queries/sec
Query 33: actual 32 (0.005%)  origin-forest_43.843 1 (err=32.000)  
83.3 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 35: actual 6 (0.001%)  origin-forest_43.843 1 (err=6.000)  
83.3 queries/sec
Query 36: actual 882 (0.127%)  origin-forest_43.843 1002 (err=1.136)  
83.3 queries/sec
Query 37: actual 691 (0.099%)  origin-forest_43.843 775 (err=1.122)  
90.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 39: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 40: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
74.0 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 42: actual 5 (0.001%)  origin-forest_43.843 3 (err=1.667)  
83.3 queries/sec
Query 43: actual 393 (0.056%)  origin-forest_43.843 205 (err=1.917)  
90.9 queries/sec
Query 44: actual 5277 (0.757%)  origin-forest_43.843 3902 (err=1.352)  
90.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 46: actual 23 (0.003%)  origin-forest_43.843 1 (err=23.000)  
76.9 queries/sec
Query 47: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
90.9 queries/sec
Query 48: actual 18 (0.003%)  origin-forest_43.843 37 (err=2.056)  
76.8 queries/sec
Query 49: actual 66 (0.009%)  origin-forest_43.843 1 (err=66.000)  
origin-forest_43.843 	max: 66.0000	99th: 49.3400	95th: 21.2000	median: 1.2122	mean: 5.2422
ReportEsts: [1.0342465753424657, 1.0, 6.0, 1.0, 1.0, 2.0, 1.0, 18.0, 1.68295994568907, 14.0, 3.507142857142857, 1.163237597911227, 1.0, 19.0, 1.019736842105263, 1.0933616247347682, 1.2875, 1.0, 2.611308521912599, 1.240484429065744, 1.0, 1.0, 1.1838747099767981, 1.0, 15.0, 1.2770347726404279, 1.0, 1.0, 1.0, 7.0, 1.1701728945900725, 1.0, 1.5881057268722467, 32.0, 1.0, 6.0, 1.1360544217687074, 1.1215629522431259, 1.0, 2.0, 2.0, 1.0, 1.6666666666666667, 1.9170731707317072, 1.3523833931317273, 1.0, 23.0, 4.0, 2.0555555555555554, 66.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 4/50 | Workload-time: 4.050022 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 5/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (601012, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 58.9725
detection mean = 47.5463
detection threshold = 0.3411
test statistic = 11.4262
Offline time = 2.9736924171447754
Online time = 0.4670844078063965
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 5-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (601012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 601012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 58.1136 bits (loss 77.311, data 19.197) 0.00100 lr
epoch 9 train loss 51.8842 nats / 74.8530 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 55.3772 bits (loss 74.574, data 19.197) 0.00082 lr
epoch 19 train loss 51.3490 nats / 74.0810 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 78.0756 nats / 112.6393 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 5/50 | Workload-time: 6.635251 | Model-update-time: 10.242027


WORKLOAD-START | Type: QueryWorkload | Progress: 6/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 3
RandomSeedCommunicator.get: 3
Query 0: actual 184 (0.026%)  origin-forest_43.843 1 (err=184.000)  
34.5 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 2: actual 219 (0.031%)  origin-forest_43.843 259 (err=1.183)  
100.0 queries/sec
Query 3: actual 1291 (0.185%)  origin-forest_43.843 1348 (err=1.044)  
76.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.5 queries/sec
Query 5: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
83.3 queries/sec
Query 6: actual 40770 (5.848%)  origin-forest_43.843 42621 (err=1.045)  
86.8 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 8: actual 225 (0.032%)  origin-forest_43.843 383 (err=1.702)  
82.5 queries/sec
Query 9: actual 2367 (0.339%)  origin-forest_43.843 1307 (err=1.811)  
86.3 queries/sec
Query 10: actual 168 (0.024%)  origin-forest_43.843 1 (err=168.000)  
76.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 21 (0.003%)  origin-forest_43.843 12 (err=1.750)  
83.3 queries/sec
Query 13: actual 52 (0.007%)  origin-forest_43.843 63 (err=1.212)  
76.9 queries/sec
Query 14: actual 58 (0.008%)  origin-forest_43.843 61 (err=1.052)  
86.8 queries/sec
Query 15: actual 113 (0.016%)  origin-forest_43.843 1 (err=113.000)  
90.9 queries/sec
Query 16: actual 18 (0.003%)  origin-forest_43.843 38 (err=2.111)  
83.3 queries/sec
Query 17: actual 456 (0.065%)  origin-forest_43.843 506 (err=1.110)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 3248 (0.466%)  origin-forest_43.843 3871 (err=1.192)  
90.9 queries/sec
Query 20: actual 45 (0.006%)  origin-forest_43.843 105 (err=2.333)  
90.9 queries/sec
Query 21: actual 6 (0.001%)  origin-forest_43.843 1 (err=6.000)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 411 (0.059%)  origin-forest_43.843 1 (err=411.000)  
86.9 queries/sec
Query 24: actual 25071 (3.596%)  origin-forest_43.843 11309 (err=2.217)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 26: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 27: actual 34 (0.005%)  origin-forest_43.843 1 (err=34.000)  
83.3 queries/sec
Query 28: actual 50 (0.007%)  origin-forest_43.843 62 (err=1.240)  
90.9 queries/sec
Query 29: actual 12447 (1.785%)  origin-forest_43.843 7686 (err=1.619)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.8 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
86.8 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 34: actual 280 (0.040%)  origin-forest_43.843 76 (err=3.684)  
90.9 queries/sec
Query 35: actual 56 (0.008%)  origin-forest_43.843 1 (err=56.000)  
90.9 queries/sec
Query 36: actual 7 (0.001%)  origin-forest_43.843 3 (err=2.333)  
83.3 queries/sec
Query 37: actual 6 (0.001%)  origin-forest_43.843 9 (err=1.500)  
90.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 137 (0.020%)  origin-forest_43.843 2 (err=68.500)  
90.9 queries/sec
Query 40: actual 3097 (0.444%)  origin-forest_43.843 9391 (err=3.032)  
86.9 queries/sec
Query 41: actual 40283 (5.778%)  origin-forest_43.843 14301 (err=2.817)  
90.9 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 1893 (0.272%)  origin-forest_43.843 1515 (err=1.250)  
83.3 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 411.0000	99th: 299.7700	95th: 143.2500	median: 1.2258	mean: 22.0747
ReportEsts: [184.0, 1.0, 1.182648401826484, 1.0441518202943454, 1.0, 4.0, 1.045401030169242, 1.0, 1.7022222222222223, 1.811017597551645, 168.0, 1.0, 1.75, 1.2115384615384615, 1.0517241379310345, 113.0, 2.111111111111111, 1.1096491228070176, 1.0, 1.1918103448275863, 2.3333333333333335, 6.0, 1.0, 411.0, 2.216906888319038, 1.0, 2.0, 34.0, 1.24, 1.6194379391100702, 1.0, 2.0, 1.0, 1.0, 3.6842105263157894, 56.0, 2.3333333333333335, 1.5, 1.0, 68.5, 3.0322893122376495, 2.816796028249773, 1.0, 1.0, 1.0, 1.0, 1.0, 1.2495049504950495, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 6/50 | Workload-time: 4.002743 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 7/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 4
RandomSeedCommunicator.get: 4
Query 0: actual 335 (0.048%)  origin-forest_43.843 409 (err=1.221)  
41.7 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
64.4 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 4: actual 2984 (0.428%)  origin-forest_43.843 1960 (err=1.522)  
83.3 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.4 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 10: actual 66205 (9.496%)  origin-forest_43.843 54941 (err=1.205)  
90.3 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 13: actual 189 (0.027%)  origin-forest_43.843 26 (err=7.269)  
90.9 queries/sec
Query 14: actual 10 (0.001%)  origin-forest_43.843 1 (err=10.000)  
83.3 queries/sec
Query 15: actual 19 (0.003%)  origin-forest_43.843 18 (err=1.056)  
90.9 queries/sec
Query 16: actual 141378 (20.278%)  origin-forest_43.843 101974 (err=1.386)  
90.9 queries/sec
Query 17: actual 19 (0.003%)  origin-forest_43.843 38 (err=2.000)  
90.8 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 19: actual 145 (0.021%)  origin-forest_43.843 212 (err=1.462)  
90.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 21: actual 939 (0.135%)  origin-forest_43.843 1013 (err=1.079)  
90.9 queries/sec
Query 22: actual 604 (0.087%)  origin-forest_43.843 299 (err=2.020)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 24: actual 181232 (25.994%)  origin-forest_43.843 186472 (err=1.029)  
90.9 queries/sec
Query 25: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 26: actual 17 (0.002%)  origin-forest_43.843 2 (err=8.500)  
76.9 queries/sec
Query 27: actual 386673 (55.460%)  origin-forest_43.843 378678 (err=1.021)  
95.1 queries/sec
Query 28: actual 218 (0.031%)  origin-forest_43.843 252 (err=1.156)  
83.3 queries/sec
Query 29: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 30: actual 1893 (0.272%)  origin-forest_43.843 1823 (err=1.038)  
90.9 queries/sec
Query 31: actual 4 (0.001%)  origin-forest_43.843 3 (err=1.333)  
90.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 28 (0.004%)  origin-forest_43.843 28 (err=1.000)  
90.9 queries/sec
Query 34: actual 82 (0.012%)  origin-forest_43.843 1 (err=82.000)  
76.9 queries/sec
Query 35: actual 75224 (10.789%)  origin-forest_43.843 70080 (err=1.073)  
95.1 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 38: actual 2066 (0.296%)  origin-forest_43.843 8616 (err=4.170)  
100.0 queries/sec
Query 39: actual 12 (0.002%)  origin-forest_43.843 67 (err=5.583)  
90.9 queries/sec
Query 40: actual 23 (0.003%)  origin-forest_43.843 25 (err=1.087)  
90.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 43: actual 164 (0.024%)  origin-forest_43.843 159 (err=1.031)  
90.9 queries/sec
Query 44: actual 9007 (1.292%)  origin-forest_43.843 15671 (err=1.740)  
80.0 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
79.8 queries/sec
Query 48: actual 14387 (2.063%)  origin-forest_43.843 28049 (err=1.950)  
86.5 queries/sec
Query 49: actual 7656 (1.098%)  origin-forest_43.843 4391 (err=1.744)  
origin-forest_43.843 	max: 82.0000	99th: 46.7200	95th: 8.2750	median: 1.0645	mean: 3.5735
ReportEsts: [1.2208955223880598, 1.0, 1.0, 1.0, 1.5224489795918368, 1.0, 1.0, 1.0, 1.0, 1.0, 1.2050199304708689, 2.0, 1.0, 7.269230769230769, 10.0, 1.0555555555555556, 1.3864122227234392, 2.0, 1.0, 1.4620689655172414, 1.0, 1.0788072417465389, 2.020066889632107, 1.0, 1.028913216209058, 2.0, 8.5, 1.0211129244371207, 1.1559633027522935, 8.0, 1.038398244651673, 1.3333333333333333, 1.0, 1.0, 82.0, 1.0734018264840182, 1.0, 1.0, 4.170377541142304, 5.583333333333333, 1.0869565217391304, 1.0, 1.0, 1.0314465408805031, 1.739868990784945, 1.0, 1.0, 2.0, 1.9496072843539307, 1.7435663857891142]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 7/50 | Workload-time: 3.967196 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 8/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 5
RandomSeedCommunicator.get: 5
Query 0: actual 1832 (0.263%)  origin-forest_43.843 2091 (err=1.141)  
35.1 queries/sec
Query 1: actual 33175 (4.758%)  origin-forest_43.843 27142 (err=1.222)  
62.5 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 4: actual 172 (0.025%)  origin-forest_43.843 94 (err=1.830)  
90.9 queries/sec
Query 5: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
86.7 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 7: actual 59 (0.008%)  origin-forest_43.843 1 (err=59.000)  
90.9 queries/sec
Query 8: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
86.9 queries/sec
Query 9: actual 47787 (6.854%)  origin-forest_43.843 21750 (err=2.197)  
90.9 queries/sec
Query 10: actual 13073 (1.875%)  origin-forest_43.843 18681 (err=1.429)  
90.9 queries/sec
Query 11: actual 12 (0.002%)  origin-forest_43.843 6 (err=2.000)  
83.3 queries/sec
Query 12: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 13: actual 9736 (1.396%)  origin-forest_43.843 9020 (err=1.079)  
90.9 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 15: actual 1442 (0.207%)  origin-forest_43.843 2508 (err=1.739)  
90.6 queries/sec
Query 16: actual 6 (0.001%)  origin-forest_43.843 4 (err=1.500)  
90.0 queries/sec
Query 17: actual 23578 (3.382%)  origin-forest_43.843 38630 (err=1.638)  
95.1 queries/sec
Query 18: actual 52 (0.007%)  origin-forest_43.843 1 (err=52.000)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 20: actual 13 (0.002%)  origin-forest_43.843 1 (err=13.000)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 26: actual 21601 (3.098%)  origin-forest_43.843 16930 (err=1.276)  
90.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 29: actual 15 (0.002%)  origin-forest_43.843 6 (err=2.500)  
83.3 queries/sec
Query 30: actual 65 (0.009%)  origin-forest_43.843 1 (err=65.000)  
90.9 queries/sec
Query 31: actual 1639 (0.235%)  origin-forest_43.843 4701 (err=2.868)  
83.3 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 33: actual 3592 (0.515%)  origin-forest_43.843 2872 (err=1.251)  
90.9 queries/sec
Query 34: actual 508 (0.073%)  origin-forest_43.843 68 (err=7.471)  
95.1 queries/sec
Query 35: actual 120 (0.017%)  origin-forest_43.843 18 (err=6.667)  
90.9 queries/sec
Query 36: actual 6 (0.001%)  origin-forest_43.843 8 (err=1.333)  
83.3 queries/sec
Query 37: actual 96854 (13.892%)  origin-forest_43.843 76079 (err=1.273)  
90.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 21 (0.003%)  origin-forest_43.843 11 (err=1.909)  
90.9 queries/sec
Query 41: actual 87 (0.012%)  origin-forest_43.843 1 (err=87.000)  
83.3 queries/sec
Query 42: actual 5160 (0.740%)  origin-forest_43.843 3998 (err=1.291)  
95.2 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 4 (0.001%)  origin-forest_43.843 11 (err=2.750)  
83.3 queries/sec
Query 45: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
90.9 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 48: actual 11 (0.002%)  origin-forest_43.843 1 (err=11.000)  
83.3 queries/sec
Query 49: actual 24 (0.003%)  origin-forest_43.843 58 (err=2.417)  
origin-forest_43.843 	max: 87.0000	99th: 76.2200	95th: 55.8500	median: 1.3812	mean: 7.6256
ReportEsts: [1.1413755458515285, 1.2222754402770615, 1.0, 1.0, 1.8297872340425532, 20.0, 1.0, 59.0, 1.5, 2.197103448275862, 1.428975751548994, 2.0, 3.0, 1.0793791574279379, 1.0, 1.739251040221914, 1.5, 1.638391721095937, 52.0, 1.0, 13.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.2759007678676906, 1.0, 1.0, 2.5, 65.0, 2.8682123245881637, 1.0, 1.2506963788300836, 7.470588235294118, 6.666666666666667, 1.3333333333333333, 1.2730714126105758, 1.0, 1.0, 1.9090909090909092, 87.0, 1.2906453226613306, 1.0, 2.75, 2.0, 2.0, 1.0, 11.0, 2.4166666666666665]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 8/50 | Workload-time: 4.012580 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 9/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 6
RandomSeedCommunicator.get: 6
Query 0: actual 28 (0.004%)  origin-forest_43.843 72 (err=2.571)  
40.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
73.7 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
76.9 queries/sec
Query 3: actual 38445 (5.514%)  origin-forest_43.843 16287 (err=2.360)  
90.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 61640 (8.841%)  origin-forest_43.843 48831 (err=1.262)  
71.4 queries/sec
Query 7: actual 20 (0.003%)  origin-forest_43.843 2 (err=10.000)  
83.3 queries/sec
Query 8: actual 927 (0.133%)  origin-forest_43.843 1586 (err=1.711)  
83.4 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 1231 (0.177%)  origin-forest_43.843 1793 (err=1.457)  
90.9 queries/sec
Query 11: actual 21076 (3.023%)  origin-forest_43.843 27131 (err=1.287)  
90.9 queries/sec
Query 12: actual 61 (0.009%)  origin-forest_43.843 1 (err=61.000)  
74.0 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 14: actual 133 (0.019%)  origin-forest_43.843 130 (err=1.023)  
76.9 queries/sec
Query 15: actual 12 (0.002%)  origin-forest_43.843 1 (err=12.000)  
79.7 queries/sec
Query 16: actual 491 (0.070%)  origin-forest_43.843 287 (err=1.711)  
82.7 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
86.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 20: actual 151 (0.022%)  origin-forest_43.843 2 (err=75.500)  
86.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 23: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
71.4 queries/sec
Query 24: actual 218 (0.031%)  origin-forest_43.843 125 (err=1.744)  
76.9 queries/sec
Query 25: actual 150795 (21.628%)  origin-forest_43.843 137287 (err=1.098)  
90.9 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 27: actual 18 (0.003%)  origin-forest_43.843 34 (err=1.889)  
74.0 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 29: actual 321 (0.046%)  origin-forest_43.843 2867 (err=8.931)  
83.3 queries/sec
Query 30: actual 80 (0.011%)  origin-forest_43.843 35 (err=2.286)  
76.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 32: actual 195 (0.028%)  origin-forest_43.843 108 (err=1.806)  
90.9 queries/sec
Query 33: actual 6 (0.001%)  origin-forest_43.843 15 (err=2.500)  
83.3 queries/sec
Query 34: actual 217 (0.031%)  origin-forest_43.843 1 (err=217.000)  
90.9 queries/sec
Query 35: actual 6 (0.001%)  origin-forest_43.843 1 (err=6.000)  
79.9 queries/sec
Query 36: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 38: actual 3 (0.000%)  origin-forest_43.843 5 (err=1.667)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 151 (0.022%)  origin-forest_43.843 145 (err=1.041)  
83.3 queries/sec
Query 41: actual 7493 (1.075%)  origin-forest_43.843 8259 (err=1.102)  
90.9 queries/sec
Query 42: actual 127990 (18.357%)  origin-forest_43.843 83165 (err=1.539)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 45: actual 166 (0.024%)  origin-forest_43.843 233 (err=1.404)  
90.9 queries/sec
Query 46: actual 31 (0.004%)  origin-forest_43.843 57 (err=1.839)  
90.9 queries/sec
Query 47: actual 376 (0.054%)  origin-forest_43.843 206 (err=1.825)  
83.3 queries/sec
Query 48: actual 6481 (0.930%)  origin-forest_43.843 7080 (err=1.092)  
90.9 queries/sec
Query 49: actual 59239 (8.497%)  origin-forest_43.843 83708 (err=1.413)  
origin-forest_43.843 	max: 217.0000	99th: 147.6650	95th: 38.9500	median: 1.4348	mean: 9.0612
ReportEsts: [2.5714285714285716, 1.0, 2.0, 2.3604715417203903, 1.0, 1.0, 1.262312875017919, 10.0, 1.7108953613807982, 1.0, 1.4565393988627133, 1.2872936040994496, 61.0, 1.0, 1.023076923076923, 12.0, 1.710801393728223, 2.0, 1.0, 1.0, 75.5, 1.0, 1.0, 3.0, 1.744, 1.0983924188014889, 1.0, 1.8888888888888888, 1.0, 8.93146417445483, 2.2857142857142856, 1.0, 1.8055555555555556, 2.5, 217.0, 6.0, 2.0, 1.0, 1.6666666666666667, 1.0, 1.0413793103448277, 1.102228746830375, 1.5389887572897252, 1.0, 1.0, 1.4036144578313252, 1.8387096774193548, 1.825242718446602, 1.0924240086406418, 1.4130555883792772]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 9/50 | Workload-time: 4.121628 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 10/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (611012, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 57.7729
detection mean = 48.3735
detection threshold = 0.3205
test statistic = 9.3994
Offline time = 2.9419610500335693
Online time = 0.4785480499267578
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 10-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (611012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 611012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 56.3295 bits (loss 75.550, data 19.221) 0.00100 lr
epoch 9 train loss 51.6612 nats / 74.5314 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 55.3898 bits (loss 74.611, data 19.221) 0.00082 lr
epoch 19 train loss 51.4042 nats / 74.1605 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 69.6710 nats / 100.5140 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 10/50 | Workload-time: 6.671739 | Model-update-time: 10.365066


WORKLOAD-START | Type: QueryWorkload | Progress: 11/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 7
RandomSeedCommunicator.get: 7
Query 0: actual 5 (0.001%)  origin-forest_43.843 2 (err=2.500)  
40.0 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 2: actual 5 (0.001%)  origin-forest_43.843 3 (err=1.667)  
76.9 queries/sec
Query 3: actual 9 (0.001%)  origin-forest_43.843 18 (err=2.000)  
95.2 queries/sec
Query 4: actual 1291 (0.185%)  origin-forest_43.843 4854 (err=3.760)  
85.3 queries/sec
Query 5: actual 20 (0.003%)  origin-forest_43.843 2 (err=10.000)  
90.9 queries/sec
Query 6: actual 21 (0.003%)  origin-forest_43.843 601 (err=28.619)  
83.3 queries/sec
Query 7: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
83.3 queries/sec
Query 8: actual 34317 (4.922%)  origin-forest_43.843 43396 (err=1.265)  
90.9 queries/sec
Query 9: actual 187 (0.027%)  origin-forest_43.843 86 (err=2.174)  
83.3 queries/sec
Query 10: actual 12 (0.002%)  origin-forest_43.843 3 (err=4.000)  
76.9 queries/sec
Query 11: actual 461 (0.066%)  origin-forest_43.843 301 (err=1.532)  
79.9 queries/sec
Query 12: actual 90 (0.013%)  origin-forest_43.843 43 (err=2.093)  
83.3 queries/sec
Query 13: actual 37 (0.005%)  origin-forest_43.843 3 (err=12.333)  
71.4 queries/sec
Query 14: actual 23994 (3.441%)  origin-forest_43.843 17511 (err=1.370)  
90.6 queries/sec
Query 15: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.6 queries/sec
Query 16: actual 131 (0.019%)  origin-forest_43.843 154 (err=1.176)  
90.9 queries/sec
Query 17: actual 6 (0.001%)  origin-forest_43.843 15 (err=2.500)  
83.3 queries/sec
Query 18: actual 4 (0.001%)  origin-forest_43.843 2 (err=2.000)  
99.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 20: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
76.9 queries/sec
Query 21: actual 125 (0.018%)  origin-forest_43.843 1 (err=125.000)  
83.3 queries/sec
Query 22: actual 1808 (0.259%)  origin-forest_43.843 665 (err=2.719)  
83.3 queries/sec
Query 23: actual 533 (0.076%)  origin-forest_43.843 733 (err=1.375)  
100.0 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 25: actual 3 (0.000%)  origin-forest_43.843 3 (err=1.000)  
90.9 queries/sec
Query 26: actual 116 (0.017%)  origin-forest_43.843 1 (err=116.000)  
83.3 queries/sec
Query 27: actual 547289 (78.497%)  origin-forest_43.843 531558 (err=1.030)  
90.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 30: actual 9155 (1.313%)  origin-forest_43.843 1709 (err=5.357)  
83.3 queries/sec
Query 31: actual 18764 (2.691%)  origin-forest_43.843 23320 (err=1.243)  
76.9 queries/sec
Query 32: actual 170 (0.024%)  origin-forest_43.843 3 (err=56.667)  
83.3 queries/sec
Query 33: actual 12244 (1.756%)  origin-forest_43.843 15989 (err=1.306)  
90.9 queries/sec
Query 34: actual 21 (0.003%)  origin-forest_43.843 32 (err=1.524)  
90.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 37: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 67 (0.010%)  origin-forest_43.843 42 (err=1.595)  
76.9 queries/sec
Query 40: actual 30444 (4.367%)  origin-forest_43.843 41186 (err=1.353)  
90.9 queries/sec
Query 41: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 36377 (5.217%)  origin-forest_43.843 38903 (err=1.069)  
90.9 queries/sec
Query 45: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
79.9 queries/sec
Query 46: actual 90 (0.013%)  origin-forest_43.843 1 (err=90.000)  
83.3 queries/sec
Query 47: actual 127 (0.018%)  origin-forest_43.843 42 (err=3.024)  
83.3 queries/sec
Query 48: actual 388234 (55.684%)  origin-forest_43.843 355344 (err=1.093)  
100.0 queries/sec
Query 49: actual 520 (0.075%)  origin-forest_43.843 519 (err=1.002)  
origin-forest_43.843 	max: 125.0000	99th: 120.5900	95th: 75.0000	median: 1.5119	mean: 10.2419
ReportEsts: [2.5, 1.0, 1.6666666666666667, 2.0, 3.7598760650658405, 10.0, 28.61904761904762, 1.0, 1.2645627531544132, 2.1744186046511627, 4.0, 1.5315614617940199, 2.0930232558139537, 12.333333333333334, 1.3702244303580606, 2.0, 1.1755725190839694, 2.5, 2.0, 1.0, 1.5, 125.0, 2.718796992481203, 1.375234521575985, 1.0, 1.0, 116.0, 1.0295941364818137, 1.0, 1.0, 5.356933879461674, 1.242805371988915, 56.666666666666664, 1.3058640967004247, 1.5238095238095237, 1.0, 1.0, 1.25, 1.0, 1.5952380952380953, 1.352844567073972, 2.0, 1.0, 1.0, 1.069439480990736, 3.0, 90.0, 3.0238095238095237, 1.0925581971272906, 1.001926782273603]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 11/50 | Workload-time: 4.023720 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 12/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (621012, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 57.5319
detection mean = 48.7605
detection threshold = 0.3126
test statistic = 8.7714
Offline time = 2.8790957927703857
Online time = 0.4791295528411865
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 12-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (621012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 621012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 55.9750 bits (loss 75.219, data 19.244) 0.00100 lr
epoch 9 train loss 51.7216 nats / 74.6186 bits
time since start: 4.0 secs
Epoch 10 Iter 0, train entropy gap 55.5509 bits (loss 74.795, data 19.244) 0.00082 lr
epoch 19 train loss 51.5777 nats / 74.4108 bits
time since start: 7.2 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 66.8678 nats / 96.4698 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 12/50 | Workload-time: 6.602475 | Model-update-time: 10.576298


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 13/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (631012, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 57.7331
detection mean = 49.0210
detection threshold = 0.3131
test statistic = 8.7122
Offline time = 2.9236340522766113
Online time = 0.510526180267334
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 13-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (631012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 631012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 55.9643 bits (loss 75.232, data 19.267) 0.00100 lr
epoch 9 train loss 51.8268 nats / 74.7703 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 55.5941 bits (loss 74.861, data 19.267) 0.00082 lr
epoch 19 train loss 51.7246 nats / 74.6229 bits
time since start: 7.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 64.4846 nats / 93.0317 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 13/50 | Workload-time: 6.833657 | Model-update-time: 10.604543


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 14/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (641012, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 58.2473
detection mean = 49.2202
detection threshold = 0.3150
test statistic = 9.0271
Offline time = 2.9852330684661865
Online time = 0.517486572265625
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 14-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (641012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 641012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 56.0810 bits (loss 75.371, data 19.290) 0.00100 lr
epoch 9 train loss 52.0395 nats / 75.0771 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 55.8778 bits (loss 75.168, data 19.290) 0.00082 lr
epoch 19 train loss 51.9342 nats / 74.9252 bits
time since start: 7.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 63.4102 nats / 91.4817 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 14/50 | Workload-time: 6.869190 | Model-update-time: 10.539557


WORKLOAD-START | Type: QueryWorkload | Progress: 15/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.1s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 8
RandomSeedCommunicator.get: 8
Query 0: actual 42 (0.006%)  origin-forest_43.843 14 (err=3.000)  
41.7 queries/sec
Query 1: actual 10 (0.001%)  origin-forest_43.843 71 (err=7.100)  
83.3 queries/sec
Query 2: actual 58583 (8.402%)  origin-forest_43.843 68023 (err=1.161)  
84.0 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
85.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 5: actual 21 (0.003%)  origin-forest_43.843 15 (err=1.400)  
86.9 queries/sec
Query 6: actual 63 (0.009%)  origin-forest_43.843 307 (err=4.873)  
83.3 queries/sec
Query 7: actual 12 (0.002%)  origin-forest_43.843 14 (err=1.167)  
83.3 queries/sec
Query 8: actual 23 (0.003%)  origin-forest_43.843 1 (err=23.000)  
76.9 queries/sec
Query 9: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 11: actual 108 (0.015%)  origin-forest_43.843 1 (err=108.000)  
83.3 queries/sec
Query 12: actual 55 (0.008%)  origin-forest_43.843 21 (err=2.619)  
90.9 queries/sec
Query 13: actual 160379 (23.003%)  origin-forest_43.843 168469 (err=1.050)  
95.2 queries/sec
Query 14: actual 31 (0.004%)  origin-forest_43.843 1 (err=31.000)  
83.3 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 16: actual 47 (0.007%)  origin-forest_43.843 1 (err=47.000)  
83.3 queries/sec
Query 17: actual 10266 (1.472%)  origin-forest_43.843 27018 (err=2.632)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
76.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.9 queries/sec
Query 22: actual 44 (0.006%)  origin-forest_43.843 16 (err=2.750)  
90.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 24: actual 35 (0.005%)  origin-forest_43.843 19 (err=1.842)  
90.8 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 26: actual 192 (0.028%)  origin-forest_43.843 76 (err=2.526)  
83.3 queries/sec
Query 27: actual 25 (0.004%)  origin-forest_43.843 47 (err=1.880)  
83.3 queries/sec
Query 28: actual 285 (0.041%)  origin-forest_43.843 199 (err=1.432)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 30: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
95.2 queries/sec
Query 31: actual 5 (0.001%)  origin-forest_43.843 1 (err=5.000)  
83.3 queries/sec
Query 32: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 34: actual 73 (0.010%)  origin-forest_43.843 1 (err=73.000)  
76.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 36: actual 63040 (9.042%)  origin-forest_43.843 72083 (err=1.143)  
90.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 38: actual 88 (0.013%)  origin-forest_43.843 181 (err=2.057)  
80.0 queries/sec
Query 39: actual 361 (0.052%)  origin-forest_43.843 315 (err=1.146)  
90.9 queries/sec
Query 40: actual 161 (0.023%)  origin-forest_43.843 1 (err=161.000)  
90.9 queries/sec
Query 41: actual 27 (0.004%)  origin-forest_43.843 8980 (err=332.593)  
62.9 queries/sec
Query 42: actual 153 (0.022%)  origin-forest_43.843 1 (err=153.000)  
71.4 queries/sec
Query 43: actual 204 (0.029%)  origin-forest_43.843 117 (err=1.744)  
71.4 queries/sec
Query 44: actual 288 (0.041%)  origin-forest_43.843 339 (err=1.177)  
66.6 queries/sec
Query 45: actual 1016 (0.146%)  origin-forest_43.843 951 (err=1.068)  
69.3 queries/sec
Query 46: actual 288 (0.041%)  origin-forest_43.843 7 (err=41.143)  
71.4 queries/sec
Query 47: actual 1445 (0.207%)  origin-forest_43.843 1209 (err=1.195)  
66.7 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
58.8 queries/sec
Query 49: actual 52 (0.007%)  origin-forest_43.843 25 (err=2.080)  
origin-forest_43.843 	max: 332.5926	99th: 248.5122	95th: 132.7500	median: 1.8611	mean: 20.9356
ReportEsts: [3.0, 7.1, 1.161138896949627, 1.0, 1.0, 1.4, 4.873015873015873, 1.1666666666666667, 23.0, 3.0, 1.0, 108.0, 2.619047619047619, 1.0504430131126894, 31.0, 1.0, 47.0, 2.631794272355348, 1.0, 1.0, 2.0, 1.0, 2.75, 1.0, 1.8421052631578947, 1.0, 2.526315789473684, 1.88, 1.4321608040201006, 1.0, 3.0, 5.0, 2.0, 2.0, 73.0, 1.0, 1.1434486040609138, 1.0, 2.0568181818181817, 1.146031746031746, 161.0, 332.5925925925926, 153.0, 1.7435897435897436, 1.1770833333333333, 1.0683491062039958, 41.142857142857146, 1.19520264681555, 1.0, 2.08]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 15/50 | Workload-time: 4.127842 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 16/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (651012, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 58.8434
detection mean = 49.3204
detection threshold = 0.3222
test statistic = 9.5230
Offline time = 2.9110336303710938
Online time = 0.48638033866882324
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 16-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (651012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 651012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 56.1288 bits (loss 75.441, data 19.312) 0.00100 lr
epoch 9 train loss 52.0988 nats / 75.1627 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 55.6759 bits (loss 74.988, data 19.312) 0.00082 lr
epoch 19 train loss 52.0104 nats / 75.0351 bits
time since start: 7.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 62.7580 nats / 90.5406 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 16/50 | Workload-time: 6.665743 | Model-update-time: 10.522005


WORKLOAD-START | Type: QueryWorkload | Progress: 17/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 9
RandomSeedCommunicator.get: 9
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.8 queries/sec
Query 1: actual 214 (0.031%)  origin-forest_43.843 1 (err=214.000)  
78.7 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 3: actual 55 (0.008%)  origin-forest_43.843 1 (err=55.000)  
83.3 queries/sec
Query 4: actual 3403 (0.488%)  origin-forest_43.843 2481 (err=1.372)  
100.0 queries/sec
Query 5: actual 623 (0.089%)  origin-forest_43.843 871 (err=1.398)  
83.3 queries/sec
Query 6: actual 13 (0.002%)  origin-forest_43.843 6 (err=2.167)  
83.3 queries/sec
Query 7: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 9: actual 52 (0.007%)  origin-forest_43.843 34 (err=1.529)  
86.9 queries/sec
Query 10: actual 1674 (0.240%)  origin-forest_43.843 1045 (err=1.602)  
90.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 12: actual 14 (0.002%)  origin-forest_43.843 1 (err=14.000)  
76.9 queries/sec
Query 13: actual 1191 (0.171%)  origin-forest_43.843 1622 (err=1.362)  
83.3 queries/sec
Query 14: actual 604 (0.087%)  origin-forest_43.843 967 (err=1.601)  
83.3 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 30 (0.004%)  origin-forest_43.843 38 (err=1.267)  
86.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 20: actual 2569 (0.368%)  origin-forest_43.843 3118 (err=1.214)  
90.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 24: actual 18870 (2.706%)  origin-forest_43.843 16121 (err=1.171)  
83.3 queries/sec
Query 25: actual 2846 (0.408%)  origin-forest_43.843 4397 (err=1.545)  
90.9 queries/sec
Query 26: actual 6943 (0.996%)  origin-forest_43.843 2422 (err=2.867)  
86.9 queries/sec
Query 27: actual 18582 (2.665%)  origin-forest_43.843 23010 (err=1.238)  
83.3 queries/sec
Query 28: actual 3190 (0.458%)  origin-forest_43.843 3452 (err=1.082)  
83.3 queries/sec
Query 29: actual 71 (0.010%)  origin-forest_43.843 73 (err=1.028)  
90.9 queries/sec
Query 30: actual 13 (0.002%)  origin-forest_43.843 16 (err=1.231)  
90.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 9 (0.001%)  origin-forest_43.843 9 (err=1.000)  
71.4 queries/sec
Query 33: actual 279 (0.040%)  origin-forest_43.843 5 (err=55.800)  
90.9 queries/sec
Query 34: actual 34855 (4.999%)  origin-forest_43.843 48825 (err=1.401)  
100.0 queries/sec
Query 35: actual 23 (0.003%)  origin-forest_43.843 49 (err=2.130)  
86.9 queries/sec
Query 36: actual 6 (0.001%)  origin-forest_43.843 11 (err=1.833)  
90.9 queries/sec
Query 37: actual 4 (0.001%)  origin-forest_43.843 19 (err=4.750)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.6 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 40: actual 71772 (10.294%)  origin-forest_43.843 98324 (err=1.370)  
90.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 43: actual 40 (0.006%)  origin-forest_43.843 11 (err=3.636)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 45: actual 4 (0.001%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 47: actual 27 (0.004%)  origin-forest_43.843 2 (err=13.500)  
99.6 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
77.1 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 214.0000	99th: 136.4820	95th: 36.5500	median: 1.2222	mean: 8.3119
ReportEsts: [1.0, 214.0, 1.0, 55.0, 1.3716243450221686, 1.3980738362760834, 2.1666666666666665, 1.5, 1.0, 1.5294117647058822, 1.6019138755980862, 1.0, 14.0, 1.3618807724601176, 1.6009933774834437, 1.0, 1.0, 1.0, 1.2666666666666666, 1.0, 1.2137018295056443, 1.0, 1.0, 1.0, 1.1705229204143663, 1.544975404075896, 2.8666391412056154, 1.238295124313852, 1.0821316614420062, 1.028169014084507, 1.2307692307692308, 1.0, 1.0, 55.8, 1.400803328073447, 2.130434782608696, 1.8333333333333333, 4.75, 1.0, 1.0, 1.3699492838432814, 1.0, 1.0, 3.6363636363636362, 1.0, 2.0, 1.0, 13.5, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 17/50 | Workload-time: 4.089957 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 18/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 10
RandomSeedCommunicator.get: 10
Query 0: actual 3155 (0.453%)  origin-forest_43.843 1371 (err=2.301)  
43.5 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 3: actual 4130 (0.592%)  origin-forest_43.843 6635 (err=1.607)  
83.3 queries/sec
Query 4: actual 43 (0.006%)  origin-forest_43.843 49 (err=1.140)  
86.8 queries/sec
Query 5: actual 60 (0.009%)  origin-forest_43.843 48 (err=1.250)  
83.3 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 7: actual 32710 (4.692%)  origin-forest_43.843 23779 (err=1.376)  
90.9 queries/sec
Query 8: actual 47 (0.007%)  origin-forest_43.843 10 (err=4.700)  
76.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 178 (0.026%)  origin-forest_43.843 324 (err=1.820)  
83.3 queries/sec
Query 11: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 12: actual 81 (0.012%)  origin-forest_43.843 67 (err=1.209)  
79.9 queries/sec
Query 13: actual 356 (0.051%)  origin-forest_43.843 303 (err=1.175)  
83.3 queries/sec
Query 14: actual 207 (0.030%)  origin-forest_43.843 7 (err=29.571)  
83.3 queries/sec
Query 15: actual 1597 (0.229%)  origin-forest_43.843 2013 (err=1.260)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 15 (0.002%)  origin-forest_43.843 5 (err=3.000)  
71.4 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 19: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 20: actual 15 (0.002%)  origin-forest_43.843 9 (err=1.667)  
79.9 queries/sec
Query 21: actual 157 (0.023%)  origin-forest_43.843 96 (err=1.635)  
100.0 queries/sec
Query 22: actual 110401 (15.835%)  origin-forest_43.843 134951 (err=1.222)  
90.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 24: actual 713 (0.102%)  origin-forest_43.843 1 (err=713.000)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
55.6 queries/sec
Query 26: actual 38 (0.005%)  origin-forest_43.843 1 (err=38.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 29: actual 50 (0.007%)  origin-forest_43.843 1 (err=50.000)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 3 (err=3.000)  
66.7 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 32: actual 497 (0.071%)  origin-forest_43.843 707 (err=1.423)  
83.3 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 36: actual 1043 (0.150%)  origin-forest_43.843 565 (err=1.846)  
86.8 queries/sec
Query 37: actual 4 (0.001%)  origin-forest_43.843 3 (err=1.333)  
76.9 queries/sec
Query 38: actual 141 (0.020%)  origin-forest_43.843 62 (err=2.274)  
83.3 queries/sec
Query 39: actual 190 (0.027%)  origin-forest_43.843 103 (err=1.845)  
83.3 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 5740 (0.823%)  origin-forest_43.843 5295 (err=1.084)  
90.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 21 (0.003%)  origin-forest_43.843 31 (err=1.476)  
86.8 queries/sec
Query 45: actual 5568 (0.799%)  origin-forest_43.843 6781 (err=1.218)  
83.4 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 47: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
71.4 queries/sec
Query 48: actual 16 (0.002%)  origin-forest_43.843 24 (err=1.500)  
76.9 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 713.0000	99th: 388.1300	95th: 34.2071	median: 1.2362	mean: 17.9786
ReportEsts: [2.301239970824216, 1.0, 1.0, 1.6065375302663438, 1.1395348837209303, 1.25, 1.0, 1.375583498044493, 4.7, 1.0, 1.8202247191011236, 2.0, 1.208955223880597, 1.174917491749175, 29.571428571428573, 1.2604884157795868, 1.0, 3.0, 1.0, 2.0, 1.6666666666666667, 1.6354166666666667, 1.222371174174147, 1.0, 713.0, 1.0, 38.0, 1.0, 1.0, 50.0, 3.0, 1.0, 1.4225352112676057, 1.0, 1.0, 1.0, 1.8460176991150443, 1.3333333333333333, 2.274193548387097, 1.8446601941747574, 1.0, 1.0, 1.0840415486307837, 1.0, 1.4761904761904763, 1.2178520114942528, 1.0, 3.0, 1.5, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 18/50 | Workload-time: 4.136363 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 19/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 11
RandomSeedCommunicator.get: 11
Query 0: actual 4511 (0.647%)  origin-forest_43.843 7248 (err=1.607)  
42.5 queries/sec
Query 1: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
83.3 queries/sec
Query 2: actual 4102 (0.588%)  origin-forest_43.843 3470 (err=1.182)  
90.9 queries/sec
Query 3: actual 19 (0.003%)  origin-forest_43.843 1 (err=19.000)  
83.3 queries/sec
Query 4: actual 2449 (0.351%)  origin-forest_43.843 776 (err=3.156)  
83.3 queries/sec
Query 5: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 6: actual 21 (0.003%)  origin-forest_43.843 1 (err=21.000)  
83.3 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 8: actual 578 (0.083%)  origin-forest_43.843 1 (err=578.000)  
79.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 26 (0.004%)  origin-forest_43.843 1 (err=26.000)  
83.3 queries/sec
Query 11: actual 453381 (65.028%)  origin-forest_43.843 441904 (err=1.026)  
83.3 queries/sec
Query 12: actual 6 (0.001%)  origin-forest_43.843 9 (err=1.500)  
90.9 queries/sec
Query 13: actual 339 (0.049%)  origin-forest_43.843 194 (err=1.747)  
58.8 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
73.7 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.7 queries/sec
Query 17: actual 328 (0.047%)  origin-forest_43.843 7 (err=46.857)  
83.0 queries/sec
Query 18: actual 32 (0.005%)  origin-forest_43.843 24 (err=1.333)  
74.0 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 22: actual 33 (0.005%)  origin-forest_43.843 32 (err=1.031)  
90.9 queries/sec
Query 23: actual 13 (0.002%)  origin-forest_43.843 1 (err=13.000)  
90.9 queries/sec
Query 24: actual 6262 (0.898%)  origin-forest_43.843 6841 (err=1.092)  
86.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 26: actual 19 (0.003%)  origin-forest_43.843 11 (err=1.727)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
90.9 queries/sec
Query 29: actual 4910 (0.704%)  origin-forest_43.843 3864 (err=1.271)  
83.3 queries/sec
Query 30: actual 76 (0.011%)  origin-forest_43.843 1 (err=76.000)  
66.7 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.3 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.6 queries/sec
Query 35: actual 214 (0.031%)  origin-forest_43.843 65 (err=3.292)  
71.4 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 38: actual 166510 (23.882%)  origin-forest_43.843 184503 (err=1.108)  
71.4 queries/sec
Query 39: actual 140 (0.020%)  origin-forest_43.843 120 (err=1.167)  
79.9 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 41: actual 765 (0.110%)  origin-forest_43.843 12 (err=63.750)  
83.3 queries/sec
Query 42: actual 4 (0.001%)  origin-forest_43.843 7 (err=1.750)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 6 (0.001%)  origin-forest_43.843 5 (err=1.200)  
76.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 11862 (1.701%)  origin-forest_43.843 15032 (err=1.267)  
86.8 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 578.0000	99th: 332.0200	95th: 56.1482	median: 1.1003	mean: 18.1413
ReportEsts: [1.6067390822434051, 8.0, 1.1821325648414986, 19.0, 3.1559278350515463, 3.0, 21.0, 1.0, 578.0, 1.0, 26.0, 1.025971704261559, 1.5, 1.7474226804123711, 1.0, 1.0, 1.0, 46.857142857142854, 1.3333333333333333, 1.0, 1.0, 1.0, 1.03125, 13.0, 1.0924624720536569, 1.0, 1.7272727272727273, 1.0, 4.0, 1.270703933747412, 76.0, 1.0, 1.0, 1.0, 1.0, 3.292307692307692, 1.0, 1.0, 1.1080595760014413, 1.1666666666666667, 1.0, 63.75, 1.75, 1.0, 1.2, 1.0, 1.0, 1.267239925813522, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 19/50 | Workload-time: 4.143192 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 20/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 12
RandomSeedCommunicator.get: 12
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
30.3 queries/sec
Query 1: actual 6 (0.001%)  origin-forest_43.843 7 (err=1.167)  
90.9 queries/sec
Query 2: actual 633 (0.091%)  origin-forest_43.843 54 (err=11.722)  
79.9 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 4: actual 8 (0.001%)  origin-forest_43.843 11 (err=1.375)  
83.3 queries/sec
Query 5: actual 2 (0.000%)  origin-forest_43.843 4 (err=2.000)  
95.1 queries/sec
Query 6: actual 380 (0.055%)  origin-forest_43.843 408 (err=1.074)  
90.9 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 9: actual 167 (0.024%)  origin-forest_43.843 177 (err=1.060)  
100.0 queries/sec
Query 10: actual 42669 (6.120%)  origin-forest_43.843 54181 (err=1.270)  
83.3 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 12: actual 10545 (1.512%)  origin-forest_43.843 14326 (err=1.359)  
90.9 queries/sec
Query 13: actual 25423 (3.646%)  origin-forest_43.843 14366 (err=1.770)  
90.9 queries/sec
Query 14: actual 35 (0.005%)  origin-forest_43.843 1 (err=35.000)  
77.0 queries/sec
Query 15: actual 70 (0.010%)  origin-forest_43.843 112 (err=1.600)  
76.9 queries/sec
Query 16: actual 5847 (0.839%)  origin-forest_43.843 10509 (err=1.797)  
90.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 19: actual 42 (0.006%)  origin-forest_43.843 6 (err=7.000)  
86.8 queries/sec
Query 20: actual 161577 (23.175%)  origin-forest_43.843 148787 (err=1.086)  
83.3 queries/sec
Query 21: actual 71 (0.010%)  origin-forest_43.843 100 (err=1.408)  
90.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 1741 (0.250%)  origin-forest_43.843 51 (err=34.137)  
90.9 queries/sec
Query 27: actual 195 (0.028%)  origin-forest_43.843 192 (err=1.016)  
76.9 queries/sec
Query 28: actual 1359 (0.195%)  origin-forest_43.843 859 (err=1.582)  
79.9 queries/sec
Query 29: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
83.3 queries/sec
Query 30: actual 5131 (0.736%)  origin-forest_43.843 2853 (err=1.798)  
76.9 queries/sec
Query 31: actual 111 (0.016%)  origin-forest_43.843 163 (err=1.468)  
90.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.5 queries/sec
Query 35: actual 37 (0.005%)  origin-forest_43.843 20 (err=1.850)  
71.4 queries/sec
Query 36: actual 6 (0.001%)  origin-forest_43.843 11 (err=1.833)  
76.9 queries/sec
Query 37: actual 6 (0.001%)  origin-forest_43.843 4 (err=1.500)  
83.3 queries/sec
Query 38: actual 791 (0.113%)  origin-forest_43.843 960 (err=1.214)  
83.3 queries/sec
Query 39: actual 7 (0.001%)  origin-forest_43.843 4 (err=1.750)  
76.9 queries/sec
Query 40: actual 1512 (0.217%)  origin-forest_43.843 2810 (err=1.858)  
71.4 queries/sec
Query 41: actual 52 (0.007%)  origin-forest_43.843 1 (err=52.000)  
76.9 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 43: actual 9 (0.001%)  origin-forest_43.843 1 (err=9.000)  
82.5 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 49: actual 156933 (22.509%)  origin-forest_43.843 117381 (err=1.337)  
origin-forest_43.843 	max: 52.0000	99th: 43.6700	95th: 24.0505	median: 1.1263	mean: 4.0806
ReportEsts: [1.0, 1.1666666666666667, 11.722222222222221, 1.0, 1.375, 2.0, 1.0736842105263158, 1.0, 1.0, 1.0598802395209581, 1.2697977454357965, 1.0, 1.3585585585585584, 1.7696644855909787, 35.0, 1.6, 1.797331965110313, 1.0, 1.0, 7.0, 1.0859618111797402, 1.408450704225352, 1.0, 1.0, 1.0, 1.0, 34.13725490196079, 1.015625, 1.5820721769499417, 1.0, 1.7984577637574484, 1.4684684684684686, 1.0, 1.0, 1.0, 1.85, 1.8333333333333333, 1.5, 1.213653603034134, 1.75, 1.8584656084656084, 52.0, 1.0, 9.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.3369540215196667]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 20/50 | Workload-time: 4.146362 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 21/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 13
RandomSeedCommunicator.get: 13
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.8 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 12128 (1.739%)  origin-forest_43.843 6339 (err=1.913)  
83.3 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 4: actual 8 (0.001%)  origin-forest_43.843 5 (err=1.600)  
76.9 queries/sec
Query 5: actual 146 (0.021%)  origin-forest_43.843 145 (err=1.007)  
83.3 queries/sec
Query 6: actual 31786 (4.559%)  origin-forest_43.843 32393 (err=1.019)  
83.3 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 3 (err=3.000)  
83.3 queries/sec
Query 8: actual 11308 (1.622%)  origin-forest_43.843 6567 (err=1.722)  
95.1 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 10: actual 59 (0.008%)  origin-forest_43.843 73 (err=1.237)  
83.3 queries/sec
Query 11: actual 14574 (2.090%)  origin-forest_43.843 10590 (err=1.376)  
76.9 queries/sec
Query 12: actual 854 (0.122%)  origin-forest_43.843 2605 (err=3.050)  
76.9 queries/sec
Query 13: actual 8 (0.001%)  origin-forest_43.843 4 (err=2.000)  
83.3 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 15: actual 335 (0.048%)  origin-forest_43.843 51 (err=6.569)  
83.3 queries/sec
Query 16: actual 7 (0.001%)  origin-forest_43.843 290 (err=41.429)  
79.9 queries/sec
Query 17: actual 95 (0.014%)  origin-forest_43.843 1 (err=95.000)  
76.9 queries/sec
Query 18: actual 4247 (0.609%)  origin-forest_43.843 4545 (err=1.070)  
83.3 queries/sec
Query 19: actual 87 (0.012%)  origin-forest_43.843 630 (err=7.241)  
90.9 queries/sec
Query 20: actual 59035 (8.467%)  origin-forest_43.843 69736 (err=1.181)  
90.9 queries/sec
Query 21: actual 7 (0.001%)  origin-forest_43.843 1 (err=7.000)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.1 queries/sec
Query 25: actual 232 (0.033%)  origin-forest_43.843 47 (err=4.936)  
100.0 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 13 (0.002%)  origin-forest_43.843 3 (err=4.333)  
83.3 queries/sec
Query 29: actual 27 (0.004%)  origin-forest_43.843 1 (err=27.000)  
83.3 queries/sec
Query 30: actual 36 (0.005%)  origin-forest_43.843 1 (err=36.000)  
90.9 queries/sec
Query 31: actual 501 (0.072%)  origin-forest_43.843 418 (err=1.199)  
83.3 queries/sec
Query 32: actual 57 (0.008%)  origin-forest_43.843 1 (err=57.000)  
83.3 queries/sec
Query 33: actual 15 (0.002%)  origin-forest_43.843 22 (err=1.467)  
80.0 queries/sec
Query 34: actual 26 (0.004%)  origin-forest_43.843 1 (err=26.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
84.0 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 37: actual 3379 (0.485%)  origin-forest_43.843 3361 (err=1.005)  
90.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 175 (0.025%)  origin-forest_43.843 21 (err=8.333)  
90.9 queries/sec
Query 40: actual 3 (0.000%)  origin-forest_43.843 4 (err=1.333)  
76.9 queries/sec
Query 41: actual 76945 (11.036%)  origin-forest_43.843 94259 (err=1.225)  
86.9 queries/sec
Query 42: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
76.9 queries/sec
Query 43: actual 19 (0.003%)  origin-forest_43.843 11 (err=1.727)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 45: actual 9 (0.001%)  origin-forest_43.843 11 (err=1.222)  
83.3 queries/sec
Query 46: actual 12212 (1.752%)  origin-forest_43.843 15285 (err=1.252)  
90.9 queries/sec
Query 47: actual 12503 (1.793%)  origin-forest_43.843 14739 (err=1.179)  
90.9 queries/sec
Query 48: actual 7 (0.001%)  origin-forest_43.843 12 (err=1.714)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 95.0000	99th: 76.3800	95th: 38.9857	median: 1.2312	mean: 7.4068
ReportEsts: [1.0, 1.0, 1.913235526108219, 1.0, 1.6, 1.006896551724138, 1.019096457559932, 3.0, 1.7219430485762144, 1.0, 1.2372881355932204, 1.3762039660056657, 3.050351288056206, 2.0, 1.0, 6.568627450980392, 41.42857142857143, 95.0, 1.070167176830704, 7.241379310344827, 1.1812653510629287, 7.0, 1.0, 1.0, 1.0, 4.9361702127659575, 1.0, 1.0, 4.333333333333333, 27.0, 36.0, 1.1985645933014355, 57.0, 1.4666666666666666, 26.0, 1.0, 1.0, 1.0053555489437667, 1.0, 8.333333333333334, 1.3333333333333333, 1.2250178699070764, 1.0, 1.7272727272727273, 1.0, 1.2222222222222223, 1.2516377333770061, 1.1788370791010157, 1.7142857142857142, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 21/50 | Workload-time: 4.140430 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 22/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 14
RandomSeedCommunicator.get: 14
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
41.4 queries/sec
Query 1: actual 3 (0.000%)  origin-forest_43.843 27 (err=9.000)  
76.9 queries/sec
Query 2: actual 349 (0.050%)  origin-forest_43.843 385 (err=1.103)  
83.3 queries/sec
Query 3: actual 129 (0.019%)  origin-forest_43.843 150 (err=1.163)  
86.9 queries/sec
Query 4: actual 1181 (0.169%)  origin-forest_43.843 1113 (err=1.061)  
76.5 queries/sec
Query 5: actual 145 (0.021%)  origin-forest_43.843 10 (err=14.500)  
71.4 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 8: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
79.9 queries/sec
Query 9: actual 64 (0.009%)  origin-forest_43.843 3 (err=21.333)  
71.4 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 12: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
76.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 14: actual 10 (0.001%)  origin-forest_43.843 5 (err=2.000)  
71.4 queries/sec
Query 15: actual 2472 (0.355%)  origin-forest_43.843 1918 (err=1.289)  
80.0 queries/sec
Query 16: actual 334 (0.048%)  origin-forest_43.843 342 (err=1.024)  
76.9 queries/sec
Query 17: actual 6959 (0.998%)  origin-forest_43.843 6443 (err=1.080)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 19 (0.003%)  origin-forest_43.843 25 (err=1.316)  
76.9 queries/sec
Query 20: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.6 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 25: actual 47 (0.007%)  origin-forest_43.843 1 (err=47.000)  
90.9 queries/sec
Query 26: actual 2914 (0.418%)  origin-forest_43.843 2957 (err=1.015)  
90.9 queries/sec
Query 27: actual 16 (0.002%)  origin-forest_43.843 1 (err=16.000)  
76.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 30: actual 36 (0.005%)  origin-forest_43.843 1 (err=36.000)  
71.4 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 32: actual 27 (0.004%)  origin-forest_43.843 20 (err=1.350)  
76.9 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.1 queries/sec
Query 35: actual 99 (0.014%)  origin-forest_43.843 1 (err=99.000)  
77.1 queries/sec
Query 36: actual 191 (0.027%)  origin-forest_43.843 1 (err=191.000)  
83.3 queries/sec
Query 37: actual 2147 (0.308%)  origin-forest_43.843 99 (err=21.687)  
90.9 queries/sec
Query 38: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 39: actual 171 (0.025%)  origin-forest_43.843 13 (err=13.154)  
90.9 queries/sec
Query 40: actual 198 (0.028%)  origin-forest_43.843 213 (err=1.076)  
86.9 queries/sec
Query 41: actual 555 (0.080%)  origin-forest_43.843 691 (err=1.245)  
76.9 queries/sec
Query 42: actual 131 (0.019%)  origin-forest_43.843 50 (err=2.620)  
90.9 queries/sec
Query 43: actual 3 (0.000%)  origin-forest_43.843 7 (err=2.333)  
90.9 queries/sec
Query 44: actual 1341 (0.192%)  origin-forest_43.843 2143 (err=1.598)  
83.3 queries/sec
Query 45: actual 101 (0.014%)  origin-forest_43.843 120 (err=1.188)  
76.9 queries/sec
Query 46: actual 95 (0.014%)  origin-forest_43.843 94 (err=1.011)  
76.9 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
64.5 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 191.0000	99th: 145.9200	95th: 42.0500	median: 1.0779	mean: 10.3729
ReportEsts: [1.0, 9.0, 1.1031518624641834, 1.1627906976744187, 1.0610961365678346, 14.5, 1.0, 1.0, 1.5, 21.333333333333332, 1.0, 1.0, 3.0, 1.0, 2.0, 1.2888425443169969, 1.0239520958083832, 1.0800869160329039, 1.0, 1.3157894736842106, 1.0, 1.0, 1.0, 1.0, 1.0, 47.0, 1.0147563486616336, 16.0, 1.0, 1.0, 36.0, 1.0, 1.35, 1.0, 1.0, 99.0, 191.0, 21.68686868686869, 2.0, 13.153846153846153, 1.0757575757575757, 1.245045045045045, 2.62, 2.3333333333333335, 1.5980611483967189, 1.188118811881188, 1.0106382978723405, 1.0, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 22/50 | Workload-time: 4.151512 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 23/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (661012, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 59.4504
detection mean = 49.3927
detection threshold = 0.3388
test statistic = 10.0577
Offline time = 2.9382243156433105
Online time = 0.523174524307251
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 23-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (661012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 661012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 56.2090 bits (loss 75.543, data 19.334) 0.00100 lr
epoch 9 train loss 52.1678 nats / 75.2622 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 55.9186 bits (loss 75.253, data 19.334) 0.00082 lr
epoch 19 train loss 52.1008 nats / 75.1655 bits
time since start: 7.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 61.9094 nats / 89.3164 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 23/50 | Workload-time: 6.856269 | Model-update-time: 10.526407


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 24/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (671012, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 59.9130
detection mean = 49.4941
detection threshold = 0.3378
test statistic = 10.4190
Offline time = 2.9463932514190674
Online time = 0.5125563144683838
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 24-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (671012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 671012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 56.4518 bits (loss 75.808, data 19.356) 0.00100 lr
epoch 9 train loss 52.3251 nats / 75.4892 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 56.2423 bits (loss 75.598, data 19.356) 0.00082 lr
epoch 19 train loss 52.2235 nats / 75.3426 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 61.8909 nats / 89.2897 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 24/50 | Workload-time: 6.753234 | Model-update-time: 10.460417


WORKLOAD-START | Type: QueryWorkload | Progress: 25/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 15
RandomSeedCommunicator.get: 15
Query 0: actual 60725 (8.710%)  origin-forest_43.843 84585 (err=1.393)  
44.4 queries/sec
Query 1: actual 1234 (0.177%)  origin-forest_43.843 646 (err=1.910)  
76.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 3: actual 1480 (0.212%)  origin-forest_43.843 809 (err=1.829)  
66.7 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 5: actual 47 (0.007%)  origin-forest_43.843 1 (err=47.000)  
76.9 queries/sec
Query 6: actual 37 (0.005%)  origin-forest_43.843 9 (err=4.111)  
76.9 queries/sec
Query 7: actual 124 (0.018%)  origin-forest_43.843 98 (err=1.265)  
95.1 queries/sec
Query 8: actual 11 (0.002%)  origin-forest_43.843 3 (err=3.667)  
79.6 queries/sec
Query 9: actual 17 (0.002%)  origin-forest_43.843 16 (err=1.062)  
76.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 11: actual 6 (0.001%)  origin-forest_43.843 11 (err=1.833)  
76.9 queries/sec
Query 12: actual 894 (0.128%)  origin-forest_43.843 972 (err=1.087)  
83.3 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.6 queries/sec
Query 15: actual 140 (0.020%)  origin-forest_43.843 74 (err=1.892)  
79.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.5 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 20: actual 138219 (19.824%)  origin-forest_43.843 129348 (err=1.069)  
100.0 queries/sec
Query 21: actual 36 (0.005%)  origin-forest_43.843 3 (err=12.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 23: actual 67 (0.010%)  origin-forest_43.843 3 (err=22.333)  
86.8 queries/sec
Query 24: actual 251 (0.036%)  origin-forest_43.843 10 (err=25.100)  
83.3 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 2 (0.000%)  origin-forest_43.843 4 (err=2.000)  
76.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 28: actual 156 (0.022%)  origin-forest_43.843 156 (err=1.000)  
90.9 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 30: actual 108 (0.015%)  origin-forest_43.843 37 (err=2.919)  
83.3 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.4 queries/sec
Query 32: actual 15 (0.002%)  origin-forest_43.843 20 (err=1.333)  
76.9 queries/sec
Query 33: actual 297 (0.043%)  origin-forest_43.843 358 (err=1.205)  
76.9 queries/sec
Query 34: actual 1490 (0.214%)  origin-forest_43.843 1530 (err=1.027)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 37: actual 41869 (6.005%)  origin-forest_43.843 39882 (err=1.050)  
90.9 queries/sec
Query 38: actual 43969 (6.306%)  origin-forest_43.843 27494 (err=1.599)  
90.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 18989 (2.724%)  origin-forest_43.843 24171 (err=1.273)  
86.9 queries/sec
Query 41: actual 66 (0.009%)  origin-forest_43.843 39 (err=1.692)  
76.9 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 43: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
83.3 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 45: actual 31 (0.004%)  origin-forest_43.843 17 (err=1.824)  
83.1 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.6 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.9 queries/sec
Query 48: actual 6810 (0.977%)  origin-forest_43.843 3899 (err=1.747)  
83.3 queries/sec
Query 49: actual 629 (0.090%)  origin-forest_43.843 526 (err=1.196)  
origin-forest_43.843 	max: 47.0000	99th: 36.2690	95th: 17.6833	median: 1.0655	mean: 3.3983
ReportEsts: [1.3929188966652943, 1.910216718266254, 1.0, 1.8294190358467244, 1.0, 47.0, 4.111111111111111, 1.2653061224489797, 3.6666666666666665, 1.0625, 1.0, 1.8333333333333333, 1.087248322147651, 1.0, 1.0, 1.8918918918918919, 1.0, 1.0, 1.0, 1.0, 1.0685824287967345, 12.0, 1.0, 22.333333333333332, 25.1, 1.0, 2.0, 1.0, 1.0, 1.0, 2.918918918918919, 1.0, 1.3333333333333333, 1.2053872053872055, 1.0268456375838926, 1.0, 1.0, 1.049821974825736, 1.5992216483596422, 1.0, 1.272894833851177, 1.6923076923076923, 1.0, 1.5, 1.0, 1.8235294117647058, 1.0, 1.0, 1.7466016927417287, 1.1958174904942966]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 25/50 | Workload-time: 4.065148 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 26/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (681012, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 60.3942
detection mean = 49.5985
detection threshold = 0.3388
test statistic = 10.7957
Offline time = 2.9011502265930176
Online time = 0.5222132205963135
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 26-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (681012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 681012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 56.6530 bits (loss 76.030, data 19.377) 0.00100 lr
epoch 9 train loss 52.4286 nats / 75.6385 bits
time since start: 4.0 secs
Epoch 10 Iter 0, train entropy gap 56.4206 bits (loss 75.798, data 19.377) 0.00082 lr
epoch 19 train loss 52.3334 nats / 75.5011 bits
time since start: 7.4 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 61.2379 nats / 88.3477 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 26/50 | Workload-time: 6.715567 | Model-update-time: 11.108885


WORKLOAD-START | Type: QueryWorkload | Progress: 27/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.1s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 16
RandomSeedCommunicator.get: 16
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
29.4 queries/sec
Query 1: actual 12327 (1.768%)  origin-forest_43.843 6721 (err=1.834)  
28.6 queries/sec
Query 2: actual 104 (0.015%)  origin-forest_43.843 21 (err=4.952)  
5.4 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 4: actual 3703 (0.531%)  origin-forest_43.843 5697 (err=1.538)  
71.4 queries/sec
Query 5: actual 11 (0.002%)  origin-forest_43.843 5 (err=2.200)  
64.5 queries/sec
Query 6: actual 2 (0.000%)  origin-forest_43.843 5 (err=2.500)  
71.4 queries/sec
Query 7: actual 123 (0.018%)  origin-forest_43.843 119 (err=1.034)  
10.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
10.8 queries/sec
Query 9: actual 52 (0.007%)  origin-forest_43.843 54 (err=1.038)  
41.4 queries/sec
Query 10: actual 99292 (14.241%)  origin-forest_43.843 115462 (err=1.163)  
52.6 queries/sec
Query 11: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
45.5 queries/sec
Query 12: actual 42698 (6.124%)  origin-forest_43.843 46670 (err=1.093)  
47.6 queries/sec
Query 13: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
57.1 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 3 (err=3.000)  
52.6 queries/sec
Query 15: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
52.6 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
47.6 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
58.8 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 19: actual 305 (0.044%)  origin-forest_43.843 156 (err=1.955)  
51.6 queries/sec
Query 20: actual 341 (0.049%)  origin-forest_43.843 78 (err=4.372)  
47.6 queries/sec
Query 21: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
50.0 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
50.0 queries/sec
Query 23: actual 6 (0.001%)  origin-forest_43.843 3 (err=2.000)  
50.0 queries/sec
Query 24: actual 1518 (0.218%)  origin-forest_43.843 1440 (err=1.054)  
54.0 queries/sec
Query 25: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
55.6 queries/sec
Query 26: actual 6 (0.001%)  origin-forest_43.843 19 (err=3.167)  
47.6 queries/sec
Query 27: actual 4 (0.001%)  origin-forest_43.843 2 (err=2.000)  
47.6 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
50.0 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
64.5 queries/sec
Query 30: actual 37 (0.005%)  origin-forest_43.843 1 (err=37.000)  
50.0 queries/sec
Query 31: actual 2099 (0.301%)  origin-forest_43.843 2312 (err=1.101)  
52.6 queries/sec
Query 32: actual 11 (0.002%)  origin-forest_43.843 1 (err=11.000)  
50.0 queries/sec
Query 33: actual 14813 (2.125%)  origin-forest_43.843 13176 (err=1.124)  
66.7 queries/sec
Query 34: actual 43 (0.006%)  origin-forest_43.843 1 (err=43.000)  
57.1 queries/sec
Query 35: actual 220449 (31.619%)  origin-forest_43.843 216686 (err=1.017)  
58.8 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
41.7 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
52.6 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
47.6 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
51.2 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
50.0 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
55.6 queries/sec
Query 42: actual 5 (0.001%)  origin-forest_43.843 3 (err=1.667)  
55.6 queries/sec
Query 43: actual 611 (0.088%)  origin-forest_43.843 1291 (err=2.113)  
62.5 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
55.5 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
57.1 queries/sec
Query 46: actual 177 (0.025%)  origin-forest_43.843 2473 (err=13.972)  
55.5 queries/sec
Query 47: actual 104 (0.015%)  origin-forest_43.843 159 (err=1.529)  
62.5 queries/sec
Query 48: actual 866 (0.124%)  origin-forest_43.843 1034 (err=1.194)  
58.8 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 43.0000	99th: 40.0600	95th: 12.6345	median: 1.0973	mean: 3.4924
ReportEsts: [1.0, 1.8341020681446214, 4.9523809523809526, 1.0, 1.5384823116392115, 2.2, 2.5, 1.0336134453781514, 1.0, 1.0384615384615385, 1.1628529992345809, 2.0, 1.0930254344465784, 1.5, 3.0, 1.5, 1.0, 1.0, 1.0, 1.955128205128205, 4.371794871794871, 1.0, 1.0, 2.0, 1.0541666666666667, 1.0, 3.1666666666666665, 2.0, 1.0, 1.0, 37.0, 1.1014768937589328, 11.0, 1.1242410443230115, 43.0, 1.0173661427134195, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.6666666666666667, 2.1129296235679216, 1.0, 1.0, 13.971751412429379, 1.5288461538461537, 1.1939953810623556, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 27/50 | Workload-time: 7.719928 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 28/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (691012, 10)
Parsing... done, took 0.2s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 61.0387
detection mean = 49.6297
detection threshold = 0.3374
test statistic = 11.4090
Offline time = 4.95652437210083
Online time = 0.5926849842071533
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 28-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (691012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 691012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 56.7360 bits (loss 76.134, data 19.398) 0.00100 lr
epoch 9 train loss 52.4895 nats / 75.7263 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 56.2937 bits (loss 75.692, data 19.398) 0.00082 lr
epoch 19 train loss 52.3946 nats / 75.5894 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 60.8594 nats / 87.8016 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 28/50 | Workload-time: 13.059983 | Model-update-time: 10.604313


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 29/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (701012, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 61.2093
detection mean = 49.7579
detection threshold = 0.3561
test statistic = 11.4514
Offline time = 2.899571180343628
Online time = 0.520054817199707
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 29-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (701012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 701012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 56.8742 bits (loss 76.293, data 19.419) 0.00100 lr
epoch 9 train loss 52.6361 nats / 75.9378 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 56.7115 bits (loss 76.131, data 19.419) 0.00082 lr
epoch 19 train loss 52.5167 nats / 75.7655 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 60.7928 nats / 87.7055 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 29/50 | Workload-time: 6.843234 | Model-update-time: 10.576666


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 30/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (711012, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 60.9173
detection mean = 49.9700
detection threshold = 0.3718
test statistic = 10.9473
Offline time = 2.887267589569092
Online time = 0.5412740707397461
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 30-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (711012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 711012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 57.0951 bits (loss 76.535, data 19.440) 0.00100 lr
epoch 9 train loss 52.6687 nats / 75.9849 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 56.5152 bits (loss 75.955, data 19.440) 0.00082 lr
epoch 19 train loss 52.5819 nats / 75.8597 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 60.1346 nats / 86.7559 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 30/50 | Workload-time: 6.788205 | Model-update-time: 10.356828


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 31/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (721012, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 60.5515
detection mean = 50.2134
detection threshold = 0.3867
test statistic = 10.3381
Offline time = 3.027088165283203
Online time = 0.544313907623291
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 31-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (721012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 721012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 56.9313 bits (loss 76.391, data 19.460) 0.00100 lr
epoch 9 train loss 52.7337 nats / 76.0786 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 56.7403 bits (loss 76.200, data 19.460) 0.00082 lr
epoch 19 train loss 52.6687 nats / 75.9849 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 60.5382 nats / 87.3382 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 31/50 | Workload-time: 6.992200 | Model-update-time: 10.409495


WORKLOAD-START | Type: QueryWorkload | Progress: 32/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 17
RandomSeedCommunicator.get: 17
Query 0: actual 13463 (1.931%)  origin-forest_43.843 11728 (err=1.148)  
43.5 queries/sec
Query 1: actual 628 (0.090%)  origin-forest_43.843 551 (err=1.140)  
90.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 3: actual 5 (0.001%)  origin-forest_43.843 6 (err=1.200)  
83.3 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 3 (err=3.000)  
90.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 4 (0.001%)  origin-forest_43.843 3 (err=1.333)  
83.3 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 8: actual 35 (0.005%)  origin-forest_43.843 28 (err=1.250)  
90.9 queries/sec
Query 9: actual 3 (0.000%)  origin-forest_43.843 5 (err=1.667)  
90.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 17 (0.002%)  origin-forest_43.843 42 (err=2.471)  
83.3 queries/sec
Query 13: actual 260 (0.037%)  origin-forest_43.843 51 (err=5.098)  
83.3 queries/sec
Query 14: actual 1814 (0.260%)  origin-forest_43.843 3512 (err=1.936)  
90.9 queries/sec
Query 15: actual 65 (0.009%)  origin-forest_43.843 81 (err=1.246)  
90.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
95.2 queries/sec
Query 20: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 946 (0.136%)  origin-forest_43.843 1608 (err=1.700)  
90.9 queries/sec
Query 23: actual 519 (0.074%)  origin-forest_43.843 377 (err=1.377)  
83.3 queries/sec
Query 24: actual 3 (0.000%)  origin-forest_43.843 9 (err=3.000)  
83.3 queries/sec
Query 25: actual 39 (0.006%)  origin-forest_43.843 29 (err=1.345)  
90.9 queries/sec
Query 26: actual 7187 (1.031%)  origin-forest_43.843 3155 (err=2.278)  
83.3 queries/sec
Query 27: actual 103 (0.015%)  origin-forest_43.843 102 (err=1.010)  
86.3 queries/sec
Query 28: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
77.0 queries/sec
Query 29: actual 45 (0.006%)  origin-forest_43.843 37 (err=1.216)  
90.9 queries/sec
Query 30: actual 341 (0.049%)  origin-forest_43.843 132 (err=2.583)  
90.9 queries/sec
Query 31: actual 23 (0.003%)  origin-forest_43.843 16 (err=1.438)  
83.3 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 34: actual 15 (0.002%)  origin-forest_43.843 33 (err=2.200)  
90.9 queries/sec
Query 35: actual 5 (0.001%)  origin-forest_43.843 134 (err=26.800)  
83.3 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 38 (err=38.000)  
76.9 queries/sec
Query 38: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
90.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 11433 (1.640%)  origin-forest_43.843 14555 (err=1.273)  
90.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 25090 (3.599%)  origin-forest_43.843 20786 (err=1.207)  
90.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 141 (0.020%)  origin-forest_43.843 1 (err=141.000)  
86.8 queries/sec
Query 45: actual 65 (0.009%)  origin-forest_43.843 48 (err=1.354)  
83.3 queries/sec
Query 46: actual 12 (0.002%)  origin-forest_43.843 15 (err=1.250)  
90.9 queries/sec
Query 47: actual 202 (0.029%)  origin-forest_43.843 207 (err=1.025)  
90.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 141.0000	99th: 90.5300	95th: 17.0341	median: 1.2481	mean: 5.5309
ReportEsts: [1.14793656207367, 1.1397459165154264, 1.0, 1.2, 3.0, 1.0, 1.3333333333333333, 1.0, 1.25, 1.6666666666666667, 1.0, 1.0, 2.4705882352941178, 5.098039215686274, 1.9360529217199558, 1.2461538461538462, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.6997885835095137, 1.376657824933687, 3.0, 1.3448275862068966, 2.27797147385103, 1.0098039215686274, 2.0, 1.2162162162162162, 2.5833333333333335, 1.4375, 1.0, 2.0, 2.2, 26.8, 1.0, 38.0, 2.0, 1.0, 1.273069185690545, 1.0, 1.2070624458770327, 1.0, 141.0, 1.3541666666666667, 1.25, 1.0247524752475248, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 32/50 | Workload-time: 4.082887 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 33/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 18
RandomSeedCommunicator.get: 18
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
43.5 queries/sec
Query 1: actual 8 (0.001%)  origin-forest_43.843 17 (err=2.125)  
83.3 queries/sec
Query 2: actual 298 (0.043%)  origin-forest_43.843 372 (err=1.248)  
90.9 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 4: actual 13499 (1.936%)  origin-forest_43.843 18327 (err=1.358)  
90.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
83.3 queries/sec
Query 7: actual 955 (0.137%)  origin-forest_43.843 1440 (err=1.508)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 9: actual 6 (0.001%)  origin-forest_43.843 4 (err=1.500)  
90.9 queries/sec
Query 10: actual 144 (0.021%)  origin-forest_43.843 2 (err=72.000)  
83.3 queries/sec
Query 11: actual 35 (0.005%)  origin-forest_43.843 1 (err=35.000)  
83.3 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.0 queries/sec
Query 13: actual 34 (0.005%)  origin-forest_43.843 1 (err=34.000)  
90.9 queries/sec
Query 14: actual 358 (0.051%)  origin-forest_43.843 514 (err=1.436)  
90.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 5500 (0.789%)  origin-forest_43.843 5944 (err=1.081)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 20: actual 233770 (33.529%)  origin-forest_43.843 218163 (err=1.072)  
90.9 queries/sec
Query 21: actual 8202 (1.176%)  origin-forest_43.843 8262 (err=1.007)  
86.9 queries/sec
Query 22: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
76.8 queries/sec
Query 23: actual 104 (0.015%)  origin-forest_43.843 104 (err=1.000)  
88.8 queries/sec
Query 24: actual 62 (0.009%)  origin-forest_43.843 1 (err=62.000)  
86.8 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 21 (0.003%)  origin-forest_43.843 133 (err=6.333)  
90.9 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 17 (err=17.000)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.7 queries/sec
Query 30: actual 21535 (3.089%)  origin-forest_43.843 22257 (err=1.034)  
90.9 queries/sec
Query 31: actual 29 (0.004%)  origin-forest_43.843 33 (err=1.138)  
83.3 queries/sec
Query 32: actual 11 (0.002%)  origin-forest_43.843 4 (err=2.750)  
90.9 queries/sec
Query 33: actual 605 (0.087%)  origin-forest_43.843 953 (err=1.575)  
83.3 queries/sec
Query 34: actual 201 (0.029%)  origin-forest_43.843 140 (err=1.436)  
83.3 queries/sec
Query 35: actual 446 (0.064%)  origin-forest_43.843 351 (err=1.271)  
90.9 queries/sec
Query 36: actual 5 (0.001%)  origin-forest_43.843 6 (err=1.200)  
83.3 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 39: actual 32625 (4.679%)  origin-forest_43.843 16550 (err=1.971)  
90.9 queries/sec
Query 40: actual 282 (0.040%)  origin-forest_43.843 226 (err=1.248)  
90.9 queries/sec
Query 41: actual 989 (0.142%)  origin-forest_43.843 1383 (err=1.398)  
83.3 queries/sec
Query 42: actual 3799 (0.545%)  origin-forest_43.843 2303 (err=1.650)  
90.9 queries/sec
Query 43: actual 14 (0.002%)  origin-forest_43.843 15 (err=1.071)  
90.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 45: actual 107 (0.015%)  origin-forest_43.843 100 (err=1.070)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 47: actual 14271 (2.047%)  origin-forest_43.843 10380 (err=1.375)  
95.1 queries/sec
Query 48: actual 11 (0.002%)  origin-forest_43.843 25 (err=2.273)  
76.9 queries/sec
Query 49: actual 46 (0.007%)  origin-forest_43.843 55 (err=1.196)  
origin-forest_43.843 	max: 72.0000	99th: 67.1000	95th: 34.5500	median: 1.2239	mean: 6.1064
ReportEsts: [1.0, 2.125, 1.2483221476510067, 1.0, 1.3576561226757538, 1.0, 4.0, 1.5078534031413613, 1.0, 1.5, 72.0, 35.0, 1.0, 34.0, 1.4357541899441342, 20.0, 1.0, 1.0, 1.0807272727272728, 1.0, 1.0715382535076983, 1.0073152889539136, 3.0, 1.0, 62.0, 1.0, 6.333333333333333, 1.0, 17.0, 1.0, 1.0335268168098444, 1.1379310344827587, 2.75, 1.5752066115702479, 1.4357142857142857, 1.2706552706552707, 1.2, 1.0, 1.0, 1.9712990936555892, 1.247787610619469, 1.3983822042467138, 1.649587494572297, 1.0714285714285714, 1.0, 1.07, 1.0, 1.3748554913294797, 2.272727272727273, 1.1956521739130435]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 33/50 | Workload-time: 4.066242 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 34/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 19
RandomSeedCommunicator.get: 19
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.8 queries/sec
Query 1: actual 31665 (4.542%)  origin-forest_43.843 36065 (err=1.139)  
90.9 queries/sec
Query 2: actual 17 (0.002%)  origin-forest_43.843 6 (err=2.833)  
76.9 queries/sec
Query 3: actual 10 (0.001%)  origin-forest_43.843 1 (err=10.000)  
83.3 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 5: actual 8932 (1.281%)  origin-forest_43.843 13536 (err=1.515)  
90.9 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 7: actual 132 (0.019%)  origin-forest_43.843 159 (err=1.205)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 9: actual 71707 (10.285%)  origin-forest_43.843 86523 (err=1.207)  
90.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 13: actual 82 (0.012%)  origin-forest_43.843 35 (err=2.343)  
90.9 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 2496 (0.358%)  origin-forest_43.843 1334 (err=1.871)  
90.9 queries/sec
Query 19: actual 32501 (4.662%)  origin-forest_43.843 41601 (err=1.280)  
76.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 4 (err=4.000)  
71.4 queries/sec
Query 24: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.1 queries/sec
Query 25: actual 129 (0.019%)  origin-forest_43.843 154 (err=1.194)  
83.3 queries/sec
Query 26: actual 296 (0.042%)  origin-forest_43.843 193 (err=1.534)  
83.3 queries/sec
Query 27: actual 10 (0.001%)  origin-forest_43.843 17 (err=1.700)  
83.3 queries/sec
Query 28: actual 83 (0.012%)  origin-forest_43.843 1 (err=83.000)  
83.3 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 30: actual 55 (0.008%)  origin-forest_43.843 40 (err=1.375)  
83.3 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 32: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
64.4 queries/sec
Query 33: actual 17232 (2.472%)  origin-forest_43.843 17449 (err=1.013)  
66.7 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 35: actual 146610 (21.028%)  origin-forest_43.843 161520 (err=1.102)  
76.9 queries/sec
Query 36: actual 164 (0.024%)  origin-forest_43.843 196 (err=1.195)  
76.9 queries/sec
Query 37: actual 15 (0.002%)  origin-forest_43.843 7 (err=2.143)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 3 (err=3.000)  
83.3 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 41: actual 302 (0.043%)  origin-forest_43.843 23 (err=13.130)  
76.9 queries/sec
Query 42: actual 2366 (0.339%)  origin-forest_43.843 1945 (err=1.216)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 81 (0.012%)  origin-forest_43.843 115 (err=1.420)  
90.9 queries/sec
Query 45: actual 5851 (0.839%)  origin-forest_43.843 7710 (err=1.318)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 48: actual 140 (0.020%)  origin-forest_43.843 57 (err=2.456)  
79.9 queries/sec
Query 49: actual 412 (0.059%)  origin-forest_43.843 1195 (err=2.900)  
origin-forest_43.843 	max: 83.0000	99th: 48.7639	95th: 7.3000	median: 1.1203	mean: 3.4418
ReportEsts: [1.0, 1.1389546818253593, 2.8333333333333335, 10.0, 1.0, 1.515450067174205, 1.0, 1.2045454545454546, 1.0, 1.2066186006944928, 1.0, 1.0, 1.0, 2.342857142857143, 1.0, 1.0, 1.0, 1.0, 1.871064467766117, 1.2799913848804652, 1.0, 1.0, 1.0, 4.0, 1.0, 1.193798449612403, 1.5336787564766838, 1.7, 83.0, 1.0, 1.375, 1.0, 2.0, 1.0125928505106778, 1.0, 1.1016983834663392, 1.1951219512195121, 2.142857142857143, 3.0, 1.0, 1.0, 13.130434782608695, 1.216452442159383, 1.0, 1.4197530864197532, 1.3177234660741755, 1.0, 1.0, 2.456140350877193, 2.900485436893204]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 34/50 | Workload-time: 4.116575 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 35/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (731012, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 60.2366
detection mean = 50.4175
detection threshold = 0.3930
test statistic = 9.8191
Offline time = 2.9072186946868896
Online time = 0.5634117126464844
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 35-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (731012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 731012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 56.9131 bits (loss 76.393, data 19.480) 0.00100 lr
epoch 9 train loss 52.8337 nats / 76.2229 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 56.8289 bits (loss 76.308, data 19.480) 0.00082 lr
epoch 19 train loss 52.7617 nats / 76.1190 bits
time since start: 6.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 60.0161 nats / 86.5849 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 35/50 | Workload-time: 6.938963 | Model-update-time: 10.468050


WORKLOAD-START | Type: QueryWorkload | Progress: 36/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 20
RandomSeedCommunicator.get: 20
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
30.3 queries/sec
Query 1: actual 29 (0.004%)  origin-forest_43.843 48 (err=1.655)  
68.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 3: actual 58 (0.008%)  origin-forest_43.843 2 (err=29.000)  
90.9 queries/sec
Query 4: actual 348 (0.050%)  origin-forest_43.843 21 (err=16.571)  
83.3 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 2205 (0.316%)  origin-forest_43.843 2164 (err=1.019)  
86.1 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 8: actual 61 (0.009%)  origin-forest_43.843 6 (err=10.167)  
83.3 queries/sec
Query 9: actual 66 (0.009%)  origin-forest_43.843 8 (err=8.250)  
86.9 queries/sec
Query 10: actual 19 (0.003%)  origin-forest_43.843 6 (err=3.167)  
83.3 queries/sec
Query 11: actual 3 (0.000%)  origin-forest_43.843 5 (err=1.667)  
90.9 queries/sec
Query 12: actual 36 (0.005%)  origin-forest_43.843 1 (err=36.000)  
83.3 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
90.9 queries/sec
Query 14: actual 50 (0.007%)  origin-forest_43.843 10 (err=5.000)  
80.5 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
83.2 queries/sec
Query 16: actual 47 (0.007%)  origin-forest_43.843 1 (err=47.000)  
76.9 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 18: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
86.8 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 21: actual 86580 (12.418%)  origin-forest_43.843 83645 (err=1.035)  
90.9 queries/sec
Query 22: actual 14 (0.002%)  origin-forest_43.843 29 (err=2.071)  
76.9 queries/sec
Query 23: actual 34 (0.005%)  origin-forest_43.843 23 (err=1.478)  
90.9 queries/sec
Query 24: actual 633 (0.091%)  origin-forest_43.843 599 (err=1.057)  
83.4 queries/sec
Query 25: actual 327 (0.047%)  origin-forest_43.843 3142 (err=9.609)  
90.8 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
89.4 queries/sec
Query 27: actual 127960 (18.353%)  origin-forest_43.843 153659 (err=1.201)  
90.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 30: actual 148340 (21.276%)  origin-forest_43.843 193324 (err=1.303)  
90.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 10 (0.001%)  origin-forest_43.843 4 (err=2.500)  
83.3 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 34: actual 102 (0.015%)  origin-forest_43.843 130 (err=1.275)  
83.3 queries/sec
Query 35: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
89.8 queries/sec
Query 36: actual 66410 (9.525%)  origin-forest_43.843 74168 (err=1.117)  
83.3 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 39: actual 77146 (11.065%)  origin-forest_43.843 100700 (err=1.305)  
90.9 queries/sec
Query 40: actual 1115 (0.160%)  origin-forest_43.843 1224 (err=1.098)  
83.3 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
83.3 queries/sec
Query 43: actual 8 (0.001%)  origin-forest_43.843 1 (err=8.000)  
79.9 queries/sec
Query 44: actual 3 (0.000%)  origin-forest_43.843 16 (err=5.333)  
76.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 47: actual 2363 (0.339%)  origin-forest_43.843 2200 (err=1.074)  
90.9 queries/sec
Query 48: actual 279 (0.040%)  origin-forest_43.843 349 (err=1.251)  
90.9 queries/sec
Query 49: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
origin-forest_43.843 	max: 47.0000	99th: 41.6100	95th: 23.4071	median: 1.1588	mean: 4.5240
ReportEsts: [1.0, 1.6551724137931034, 1.0, 29.0, 16.571428571428573, 1.0, 1.0189463955637708, 1.0, 10.166666666666666, 8.25, 3.1666666666666665, 1.6666666666666667, 36.0, 2.0, 5.0, 2.0, 47.0, 1.0, 1.0, 1.0, 1.0, 1.0350887680076515, 2.0714285714285716, 1.4782608695652173, 1.0567612687813022, 9.608562691131498, 1.0, 1.2008361988121288, 1.0, 1.0, 1.303249292166644, 1.0, 2.5, 1.0, 1.2745098039215685, 1.5, 1.1168197560608342, 1.0, 1.0, 1.3053171907811163, 1.0977578475336323, 1.0, 1.5, 8.0, 5.333333333333333, 1.0, 1.0, 1.074090909090909, 1.2508960573476702, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 36/50 | Workload-time: 4.129177 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 37/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.1s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 21
RandomSeedCommunicator.get: 21
Query 0: actual 2425 (0.348%)  origin-forest_43.843 1971 (err=1.230)  
43.5 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 11 (0.002%)  origin-forest_43.843 1 (err=11.000)  
79.3 queries/sec
Query 3: actual 10 (0.001%)  origin-forest_43.843 9 (err=1.111)  
90.6 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.0 queries/sec
Query 5: actual 273 (0.039%)  origin-forest_43.843 8415 (err=30.824)  
90.9 queries/sec
Query 6: actual 84 (0.012%)  origin-forest_43.843 15 (err=5.600)  
83.3 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 8: actual 308779 (44.288%)  origin-forest_43.843 299565 (err=1.031)  
90.9 queries/sec
Query 9: actual 9405 (1.349%)  origin-forest_43.843 10531 (err=1.120)  
83.3 queries/sec
Query 10: actual 251 (0.036%)  origin-forest_43.843 163 (err=1.540)  
83.3 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 12: actual 4 (0.001%)  origin-forest_43.843 88 (err=22.000)  
83.3 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 16: actual 30 (0.004%)  origin-forest_43.843 131 (err=4.367)  
83.3 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 44 (0.006%)  origin-forest_43.843 42 (err=1.048)  
90.8 queries/sec
Query 19: actual 3 (0.000%)  origin-forest_43.843 13 (err=4.333)  
74.0 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 21: actual 3 (0.000%)  origin-forest_43.843 7 (err=2.333)  
90.9 queries/sec
Query 22: actual 12 (0.002%)  origin-forest_43.843 23 (err=1.917)  
83.3 queries/sec
Query 23: actual 110 (0.016%)  origin-forest_43.843 115 (err=1.045)  
90.9 queries/sec
Query 24: actual 36 (0.005%)  origin-forest_43.843 39 (err=1.083)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 26: actual 2140 (0.307%)  origin-forest_43.843 1984 (err=1.079)  
90.9 queries/sec
Query 27: actual 61 (0.009%)  origin-forest_43.843 36 (err=1.694)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 30: actual 140 (0.020%)  origin-forest_43.843 81 (err=1.728)  
90.9 queries/sec
Query 31: actual 307 (0.044%)  origin-forest_43.843 28 (err=10.964)  
83.3 queries/sec
Query 32: actual 46 (0.007%)  origin-forest_43.843 1 (err=46.000)  
83.3 queries/sec
Query 33: actual 6688 (0.959%)  origin-forest_43.843 12071 (err=1.805)  
100.0 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 36: actual 2727 (0.391%)  origin-forest_43.843 203 (err=13.433)  
100.0 queries/sec
Query 37: actual 75 (0.011%)  origin-forest_43.843 85 (err=1.133)  
74.0 queries/sec
Query 38: actual 4 (0.001%)  origin-forest_43.843 7 (err=1.750)  
90.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 40: actual 58 (0.008%)  origin-forest_43.843 1 (err=58.000)  
76.9 queries/sec
Query 41: actual 32 (0.005%)  origin-forest_43.843 99 (err=3.094)  
83.3 queries/sec
Query 42: actual 952 (0.137%)  origin-forest_43.843 888 (err=1.072)  
90.9 queries/sec
Query 43: actual 77365 (11.096%)  origin-forest_43.843 82051 (err=1.061)  
90.9 queries/sec
Query 44: actual 42731 (6.129%)  origin-forest_43.843 67450 (err=1.578)  
83.3 queries/sec
Query 45: actual 58017 (8.321%)  origin-forest_43.843 23539 (err=2.465)  
95.1 queries/sec
Query 46: actual 8 (0.001%)  origin-forest_43.843 7 (err=1.143)  
90.9 queries/sec
Query 47: actual 625 (0.090%)  origin-forest_43.843 336 (err=1.860)  
90.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
origin-forest_43.843 	max: 58.0000	99th: 52.1200	95th: 26.8533	median: 1.1265	mean: 5.1888
ReportEsts: [1.230339928970066, 1.0, 11.0, 1.1111111111111112, 1.0, 30.824175824175825, 5.6, 1.0, 1.0307579323352194, 1.1197235513024986, 1.539877300613497, 1.0, 22.0, 1.0, 1.0, 1.0, 4.366666666666666, 1.0, 1.0476190476190477, 4.333333333333333, 1.0, 2.3333333333333335, 1.9166666666666667, 1.0454545454545454, 1.0833333333333333, 1.0, 1.0786290322580645, 1.6944444444444444, 1.0, 1.0, 1.728395061728395, 10.964285714285714, 46.0, 1.8048744019138756, 1.0, 1.0, 13.433497536945813, 1.1333333333333333, 1.75, 1.0, 58.0, 3.09375, 1.072072072072072, 1.0605700252051962, 1.578479324144064, 2.4647181273630996, 1.1428571428571428, 1.8601190476190477, 1.0, 2.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 37/50 | Workload-time: 4.164901 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 38/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (741012, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 60.2192
detection mean = 50.5064
detection threshold = 0.4049
test statistic = 9.7128
Offline time = 2.9040212631225586
Online time = 0.562171220779419
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 38-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (741012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 741012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 57.2312 bits (loss 76.730, data 19.499) 0.00100 lr
epoch 9 train loss 52.9048 nats / 76.3255 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 56.9057 bits (loss 76.405, data 19.499) 0.00082 lr
epoch 19 train loss 52.8116 nats / 76.1911 bits
time since start: 7.2 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 59.9964 nats / 86.5566 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 38/50 | Workload-time: 6.868046 | Model-update-time: 10.803540


WORKLOAD-START | Type: QueryWorkload | Progress: 39/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 22
RandomSeedCommunicator.get: 22
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
39.4 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
78.3 queries/sec
Query 2: actual 61787 (8.862%)  origin-forest_43.843 51773 (err=1.193)  
83.3 queries/sec
Query 3: actual 16 (0.002%)  origin-forest_43.843 5 (err=3.200)  
71.4 queries/sec
Query 4: actual 4000 (0.574%)  origin-forest_43.843 3622 (err=1.104)  
90.9 queries/sec
Query 5: actual 27 (0.004%)  origin-forest_43.843 8 (err=3.375)  
68.9 queries/sec
Query 6: actual 53 (0.008%)  origin-forest_43.843 107 (err=2.019)  
90.9 queries/sec
Query 7: actual 85342 (12.240%)  origin-forest_43.843 112715 (err=1.321)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 14 (0.002%)  origin-forest_43.843 20 (err=1.429)  
83.3 queries/sec
Query 10: actual 86 (0.012%)  origin-forest_43.843 3 (err=28.667)  
83.3 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 14: actual 574 (0.082%)  origin-forest_43.843 751 (err=1.308)  
90.9 queries/sec
Query 15: actual 109505 (15.706%)  origin-forest_43.843 66305 (err=1.652)  
90.9 queries/sec
Query 16: actual 353 (0.051%)  origin-forest_43.843 223 (err=1.583)  
90.9 queries/sec
Query 17: actual 467 (0.067%)  origin-forest_43.843 171 (err=2.731)  
83.3 queries/sec
Query 18: actual 3 (0.000%)  origin-forest_43.843 30 (err=10.000)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 20: actual 7 (0.001%)  origin-forest_43.843 10 (err=1.429)  
90.9 queries/sec
Query 21: actual 779 (0.112%)  origin-forest_43.843 888 (err=1.140)  
83.3 queries/sec
Query 22: actual 18 (0.003%)  origin-forest_43.843 1860 (err=103.333)  
80.0 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 24: actual 17 (0.002%)  origin-forest_43.843 1 (err=17.000)  
83.3 queries/sec
Query 25: actual 41 (0.006%)  origin-forest_43.843 64 (err=1.561)  
90.9 queries/sec
Query 26: actual 15 (0.002%)  origin-forest_43.843 4 (err=3.750)  
83.3 queries/sec
Query 27: actual 318 (0.046%)  origin-forest_43.843 1140 (err=3.585)  
90.9 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
82.1 queries/sec
Query 29: actual 4 (0.001%)  origin-forest_43.843 22 (err=5.500)  
75.5 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
85.8 queries/sec
Query 31: actual 24 (0.003%)  origin-forest_43.843 18 (err=1.333)  
83.3 queries/sec
Query 32: actual 12 (0.002%)  origin-forest_43.843 52 (err=4.333)  
83.3 queries/sec
Query 33: actual 30 (0.004%)  origin-forest_43.843 8 (err=3.750)  
83.3 queries/sec
Query 34: actual 245 (0.035%)  origin-forest_43.843 739 (err=3.016)  
83.3 queries/sec
Query 35: actual 35 (0.005%)  origin-forest_43.843 1 (err=35.000)  
90.9 queries/sec
Query 36: actual 2 (0.000%)  origin-forest_43.843 33 (err=16.500)  
76.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
76.9 queries/sec
Query 38: actual 1261 (0.181%)  origin-forest_43.843 30 (err=42.033)  
83.3 queries/sec
Query 39: actual 12 (0.002%)  origin-forest_43.843 1 (err=12.000)  
80.0 queries/sec
Query 40: actual 6 (0.001%)  origin-forest_43.843 4 (err=1.500)  
76.9 queries/sec
Query 41: actual 6 (0.001%)  origin-forest_43.843 1 (err=6.000)  
83.3 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 20 (err=20.000)  
76.9 queries/sec
Query 44: actual 19057 (2.733%)  origin-forest_43.843 32122 (err=1.686)  
83.3 queries/sec
Query 45: actual 126 (0.018%)  origin-forest_43.843 37 (err=3.405)  
83.3 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 47: actual 320 (0.046%)  origin-forest_43.843 19 (err=16.842)  
90.7 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 103.3333	99th: 73.2963	95th: 32.1500	median: 1.6172	mean: 7.6056
ReportEsts: [1.0, 1.0, 1.1934212813628726, 3.2, 1.1043622308117063, 3.375, 2.018867924528302, 1.3207447681094888, 1.0, 1.4285714285714286, 28.666666666666668, 1.0, 1.0, 1.0, 1.3083623693379791, 1.6515345750697534, 1.5829596412556053, 2.7309941520467835, 10.0, 1.0, 1.4285714285714286, 1.1399229781771503, 103.33333333333333, 1.0, 17.0, 1.5609756097560976, 3.75, 3.5849056603773586, 1.0, 5.5, 1.0, 1.3333333333333333, 4.333333333333333, 3.75, 3.016326530612245, 35.0, 16.5, 2.0, 42.03333333333333, 12.0, 1.5, 6.0, 1.0, 20.0, 1.6855748543842157, 3.4054054054054053, 1.0, 16.842105263157894, 1.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 39/50 | Workload-time: 4.255246 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 40/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (751012, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 60.1405
detection mean = 50.6289
detection threshold = 0.4120
test statistic = 9.5116
Offline time = 3.010826826095581
Online time = 0.5716516971588135
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 40-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (751012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 751012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 57.1916 bits (loss 76.710, data 19.518) 0.00100 lr
epoch 9 train loss 52.8466 nats / 76.2415 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 56.8489 bits (loss 76.367, data 19.518) 0.00082 lr
epoch 19 train loss 52.8126 nats / 76.1924 bits
time since start: 7.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 59.7793 nats / 86.2433 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 40/50 | Workload-time: 7.322535 | Model-update-time: 10.615664


WORKLOAD-START | Type: QueryWorkload | Progress: 41/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.1s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 23
RandomSeedCommunicator.get: 23
Query 0: actual 1661 (0.238%)  origin-forest_43.843 19 (err=87.421)  
41.7 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 2: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 4: actual 73 (0.010%)  origin-forest_43.843 327 (err=4.479)  
100.0 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 6: actual 11625 (1.667%)  origin-forest_43.843 6707 (err=1.733)  
100.0 queries/sec
Query 7: actual 1663 (0.239%)  origin-forest_43.843 1412 (err=1.178)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 36 (0.005%)  origin-forest_43.843 43 (err=1.194)  
90.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.5 queries/sec
Query 11: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
100.5 queries/sec
Query 12: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 13: actual 221 (0.032%)  origin-forest_43.843 162 (err=1.364)  
83.3 queries/sec
Query 14: actual 2 (0.000%)  origin-forest_43.843 3 (err=1.500)  
83.3 queries/sec
Query 15: actual 767 (0.110%)  origin-forest_43.843 748 (err=1.025)  
90.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 17: actual 338274 (48.518%)  origin-forest_43.843 317448 (err=1.066)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 19: actual 110 (0.016%)  origin-forest_43.843 1 (err=110.000)  
73.9 queries/sec
Query 20: actual 182 (0.026%)  origin-forest_43.843 1 (err=182.000)  
83.6 queries/sec
Query 21: actual 131 (0.019%)  origin-forest_43.843 1 (err=131.000)  
83.3 queries/sec
Query 22: actual 198 (0.028%)  origin-forest_43.843 119 (err=1.664)  
90.9 queries/sec
Query 23: actual 717 (0.103%)  origin-forest_43.843 8 (err=89.625)  
83.3 queries/sec
Query 24: actual 282 (0.040%)  origin-forest_43.843 332 (err=1.177)  
90.9 queries/sec
Query 25: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
90.9 queries/sec
Query 26: actual 22 (0.003%)  origin-forest_43.843 165 (err=7.500)  
76.9 queries/sec
Query 27: actual 328 (0.047%)  origin-forest_43.843 574 (err=1.750)  
79.9 queries/sec
Query 28: actual 65 (0.009%)  origin-forest_43.843 167 (err=2.569)  
87.6 queries/sec
Query 29: actual 76297 (10.943%)  origin-forest_43.843 71282 (err=1.070)  
86.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.5 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 32: actual 115955 (16.631%)  origin-forest_43.843 103954 (err=1.115)  
90.9 queries/sec
Query 33: actual 104726 (15.021%)  origin-forest_43.843 100474 (err=1.042)  
76.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 126 (0.018%)  origin-forest_43.843 171 (err=1.357)  
90.9 queries/sec
Query 36: actual 251 (0.036%)  origin-forest_43.843 4110 (err=16.375)  
86.8 queries/sec
Query 37: actual 290 (0.042%)  origin-forest_43.843 525 (err=1.810)  
76.9 queries/sec
Query 38: actual 8 (0.001%)  origin-forest_43.843 7 (err=1.143)  
90.9 queries/sec
Query 39: actual 104 (0.015%)  origin-forest_43.843 94 (err=1.106)  
90.9 queries/sec
Query 40: actual 1508 (0.216%)  origin-forest_43.843 681 (err=2.214)  
83.3 queries/sec
Query 41: actual 9 (0.001%)  origin-forest_43.843 98 (err=10.889)  
83.3 queries/sec
Query 42: actual 98 (0.014%)  origin-forest_43.843 18 (err=5.444)  
90.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 54058 (7.753%)  origin-forest_43.843 51365 (err=1.052)  
86.8 queries/sec
Query 45: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
76.9 queries/sec
Query 46: actual 105633 (15.151%)  origin-forest_43.843 130732 (err=1.238)  
90.9 queries/sec
Query 47: actual 51 (0.007%)  origin-forest_43.843 62 (err=1.216)  
83.3 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 49: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
origin-forest_43.843 	max: 182.0000	99th: 157.0100	95th: 100.8312	median: 1.2051	mean: 13.9864
ReportEsts: [87.42105263157895, 1.0, 3.0, 1.0, 4.47945205479452, 1.0, 1.7332637542865663, 1.1777620396600565, 1.0, 1.1944444444444444, 1.0, 3.0, 2.0, 1.3641975308641976, 1.5, 1.0254010695187166, 1.0, 1.0656044454524836, 1.0, 110.0, 182.0, 131.0, 1.6638655462184875, 89.625, 1.177304964539007, 1.0, 7.5, 1.75, 2.5692307692307694, 1.0703543671614153, 1.0, 1.0, 1.1154452931104142, 1.0423194060154866, 1.0, 1.3571428571428572, 16.374501992031874, 1.8103448275862069, 1.1428571428571428, 1.1063829787234043, 2.2143906020558, 10.88888888888889, 5.444444444444445, 1.0, 1.0524286965832765, 1.0, 1.2376056724697775, 1.2156862745098038, 1.0, 2.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 41/50 | Workload-time: 4.085598 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 42/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 24
RandomSeedCommunicator.get: 24
Query 0: actual 5 (0.001%)  origin-forest_43.843 1 (err=5.000)  
38.5 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 56 (0.008%)  origin-forest_43.843 1 (err=56.000)  
83.3 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 4: actual 1683 (0.241%)  origin-forest_43.843 1310 (err=1.285)  
90.9 queries/sec
Query 5: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 6: actual 41934 (6.015%)  origin-forest_43.843 49768 (err=1.187)  
95.1 queries/sec
Query 7: actual 92 (0.013%)  origin-forest_43.843 18 (err=5.111)  
83.3 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 11: actual 36 (0.005%)  origin-forest_43.843 2 (err=18.000)  
100.0 queries/sec
Query 12: actual 528 (0.076%)  origin-forest_43.843 853 (err=1.616)  
90.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 14: actual 562 (0.081%)  origin-forest_43.843 271 (err=2.074)  
90.9 queries/sec
Query 15: actual 14528 (2.084%)  origin-forest_43.843 39106 (err=2.692)  
88.1 queries/sec
Query 16: actual 3 (0.000%)  origin-forest_43.843 3 (err=1.000)  
83.3 queries/sec
Query 17: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 19: actual 3601 (0.516%)  origin-forest_43.843 3560 (err=1.012)  
90.9 queries/sec
Query 20: actual 18 (0.003%)  origin-forest_43.843 1 (err=18.000)  
83.3 queries/sec
Query 21: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 22: actual 16 (0.002%)  origin-forest_43.843 1 (err=16.000)  
76.9 queries/sec
Query 23: actual 389 (0.056%)  origin-forest_43.843 743 (err=1.910)  
100.0 queries/sec
Query 24: actual 882 (0.127%)  origin-forest_43.843 650 (err=1.357)  
95.2 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
100.0 queries/sec
Query 26: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 27: actual 263 (0.038%)  origin-forest_43.843 476 (err=1.810)  
90.9 queries/sec
Query 28: actual 92437 (13.258%)  origin-forest_43.843 99391 (err=1.075)  
100.0 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 31: actual 38 (0.005%)  origin-forest_43.843 5 (err=7.600)  
90.9 queries/sec
Query 32: actual 407 (0.058%)  origin-forest_43.843 364 (err=1.118)  
80.0 queries/sec
Query 33: actual 44 (0.006%)  origin-forest_43.843 1786 (err=40.591)  
90.9 queries/sec
Query 34: actual 998 (0.143%)  origin-forest_43.843 845 (err=1.181)  
90.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
90.9 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 7075 (1.015%)  origin-forest_43.843 9039 (err=1.278)  
90.8 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 42: actual 968 (0.139%)  origin-forest_43.843 1004 (err=1.037)  
90.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 44: actual 25 (0.004%)  origin-forest_43.843 1 (err=25.000)  
83.3 queries/sec
Query 45: actual 59970 (8.601%)  origin-forest_43.843 71145 (err=1.186)  
90.9 queries/sec
Query 46: actual 1577 (0.226%)  origin-forest_43.843 1705 (err=1.081)  
83.3 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 48: actual 11 (0.002%)  origin-forest_43.843 23 (err=2.091)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 56.0000	99th: 48.4495	95th: 21.8500	median: 1.1496	mean: 4.9058
ReportEsts: [5.0, 1.0, 56.0, 1.0, 1.284732824427481, 3.0, 1.1868173796918968, 5.111111111111111, 1.0, 1.0, 1.0, 18.0, 1.615530303030303, 1.0, 2.07380073800738, 2.6917676211453743, 1.0, 1.0, 1.0, 1.0115168539325843, 18.0, 2.0, 16.0, 1.9100257069408741, 1.356923076923077, 1.0, 2.0, 1.8098859315589353, 1.0752296158464685, 1.0, 1.0, 7.6, 1.1181318681318682, 40.59090909090909, 1.1810650887573964, 1.0, 2.0, 1.0, 1.0, 1.0, 1.2775971731448763, 1.0, 1.037190082644628, 1.0, 25.0, 1.1863431715857928, 1.0811667723525682, 1.0, 2.090909090909091, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 42/50 | Workload-time: 4.047890 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 43/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 25
RandomSeedCommunicator.get: 25
Query 0: actual 19 (0.003%)  origin-forest_43.843 206 (err=10.842)  
39.2 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 2 (0.000%)  origin-forest_43.843 4 (err=2.000)  
83.3 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 4: actual 942 (0.135%)  origin-forest_43.843 2558 (err=2.715)  
83.3 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 12 (0.002%)  origin-forest_43.843 3 (err=4.000)  
90.9 queries/sec
Query 7: actual 8677 (1.245%)  origin-forest_43.843 18489 (err=2.131)  
89.4 queries/sec
Query 8: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
71.4 queries/sec
Query 9: actual 65 (0.009%)  origin-forest_43.843 44 (err=1.477)  
90.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 12: actual 7 (0.001%)  origin-forest_43.843 9 (err=1.286)  
90.9 queries/sec
Query 13: actual 136 (0.020%)  origin-forest_43.843 1 (err=136.000)  
83.3 queries/sec
Query 14: actual 39 (0.006%)  origin-forest_43.843 33 (err=1.182)  
90.9 queries/sec
Query 15: actual 15629 (2.242%)  origin-forest_43.843 8647 (err=1.807)  
86.9 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 1555 (0.223%)  origin-forest_43.843 1015 (err=1.532)  
83.3 queries/sec
Query 18: actual 26 (0.004%)  origin-forest_43.843 30 (err=1.154)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 20: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 21: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 1279 (0.183%)  origin-forest_43.843 1519 (err=1.188)  
83.3 queries/sec
Query 24: actual 4171 (0.598%)  origin-forest_43.843 5525 (err=1.325)  
86.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 26: actual 5 (0.001%)  origin-forest_43.843 4 (err=1.250)  
71.4 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 28: actual 84 (0.012%)  origin-forest_43.843 65 (err=1.292)  
62.5 queries/sec
Query 29: actual 52 (0.007%)  origin-forest_43.843 28 (err=1.857)  
58.8 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.6 queries/sec
Query 31: actual 5 (0.001%)  origin-forest_43.843 9 (err=1.800)  
66.5 queries/sec
Query 32: actual 1196 (0.172%)  origin-forest_43.843 1569 (err=1.312)  
71.4 queries/sec
Query 33: actual 554 (0.079%)  origin-forest_43.843 1489 (err=2.688)  
66.7 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
66.7 queries/sec
Query 35: actual 53 (0.008%)  origin-forest_43.843 541 (err=10.208)  
62.5 queries/sec
Query 36: actual 28 (0.004%)  origin-forest_43.843 1 (err=28.000)  
66.6 queries/sec
Query 37: actual 21 (0.003%)  origin-forest_43.843 144 (err=6.857)  
76.7 queries/sec
Query 38: actual 6831 (0.980%)  origin-forest_43.843 7956 (err=1.165)  
71.4 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 5121 (0.734%)  origin-forest_43.843 4565 (err=1.122)  
90.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 42: actual 8 (0.001%)  origin-forest_43.843 6 (err=1.333)  
66.7 queries/sec
Query 43: actual 454 (0.065%)  origin-forest_43.843 700 (err=1.542)  
71.4 queries/sec
Query 44: actual 33 (0.005%)  origin-forest_43.843 4 (err=8.250)  
62.5 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.9 queries/sec
Query 46: actual 500 (0.072%)  origin-forest_43.843 556 (err=1.112)  
76.9 queries/sec
Query 47: actual 8 (0.001%)  origin-forest_43.843 5 (err=1.600)  
71.4 queries/sec
Query 48: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
66.7 queries/sec
Query 49: actual 19 (0.003%)  origin-forest_43.843 1 (err=19.000)  
origin-forest_43.843 	max: 136.0000	99th: 83.0800	95th: 15.3289	median: 1.3021	mean: 5.6105
ReportEsts: [10.842105263157896, 1.0, 2.0, 1.0, 2.715498938428875, 1.0, 4.0, 2.1308055779647344, 2.0, 1.4772727272727273, 1.0, 1.0, 1.2857142857142858, 136.0, 1.1818181818181819, 1.807447669712039, 1.0, 1.5320197044334976, 1.1538461538461537, 1.0, 1.0, 2.0, 1.0, 1.1876465989053948, 1.3246223927115799, 1.0, 1.25, 1.0, 1.2923076923076924, 1.8571428571428572, 1.0, 1.8, 1.3118729096989967, 2.687725631768953, 1.0, 10.20754716981132, 28.0, 6.857142857142857, 1.1646903820816865, 1.0, 1.1217962760131435, 1.0, 1.3333333333333333, 1.5418502202643172, 8.25, 1.0, 1.112, 1.6, 1.5, 19.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 43/50 | Workload-time: 4.181320 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 44/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 26
RandomSeedCommunicator.get: 26
Query 0: actual 1 (0.000%)  origin-forest_43.843 4 (err=4.000)  
38.5 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 3: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
78.3 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.4 queries/sec
Query 7: actual 18577 (2.664%)  origin-forest_43.843 21915 (err=1.180)  
83.3 queries/sec
Query 8: actual 125 (0.018%)  origin-forest_43.843 26 (err=4.808)  
76.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 10: actual 62643 (8.985%)  origin-forest_43.843 71822 (err=1.147)  
76.9 queries/sec
Query 11: actual 15 (0.002%)  origin-forest_43.843 59 (err=3.933)  
76.9 queries/sec
Query 12: actual 394 (0.057%)  origin-forest_43.843 301 (err=1.309)  
86.8 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 14: actual 12 (0.002%)  origin-forest_43.843 7 (err=1.714)  
83.3 queries/sec
Query 15: actual 4 (0.001%)  origin-forest_43.843 1 (err=4.000)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 262 (0.038%)  origin-forest_43.843 290 (err=1.107)  
83.3 queries/sec
Query 18: actual 17 (0.002%)  origin-forest_43.843 40 (err=2.353)  
90.9 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 20: actual 7950 (1.140%)  origin-forest_43.843 24555 (err=3.089)  
83.3 queries/sec
Query 21: actual 130 (0.019%)  origin-forest_43.843 215 (err=1.654)  
95.1 queries/sec
Query 22: actual 15 (0.002%)  origin-forest_43.843 1 (err=15.000)  
71.4 queries/sec
Query 23: actual 6136 (0.880%)  origin-forest_43.843 5844 (err=1.050)  
90.9 queries/sec
Query 24: actual 60 (0.009%)  origin-forest_43.843 1 (err=60.000)  
76.9 queries/sec
Query 25: actual 13 (0.002%)  origin-forest_43.843 4 (err=3.250)  
83.3 queries/sec
Query 26: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 27: actual 5 (0.001%)  origin-forest_43.843 17 (err=3.400)  
90.9 queries/sec
Query 28: actual 13 (0.002%)  origin-forest_43.843 5 (err=2.600)  
90.8 queries/sec
Query 29: actual 160120 (22.966%)  origin-forest_43.843 152788 (err=1.048)  
86.8 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
90.9 queries/sec
Query 33: actual 112 (0.016%)  origin-forest_43.843 118 (err=1.054)  
83.3 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 35: actual 27 (0.004%)  origin-forest_43.843 19 (err=1.421)  
90.9 queries/sec
Query 36: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 4 (err=4.000)  
79.9 queries/sec
Query 38: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 39: actual 1510 (0.217%)  origin-forest_43.843 1104 (err=1.368)  
90.9 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 43: actual 140 (0.020%)  origin-forest_43.843 1 (err=140.000)  
76.9 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 46: actual 20713 (2.971%)  origin-forest_43.843 21645 (err=1.045)  
90.9 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 48: actual 18 (0.003%)  origin-forest_43.843 1 (err=18.000)  
83.3 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 140.0000	99th: 100.8000	95th: 16.6500	median: 1.1631	mean: 6.2706
ReportEsts: [4.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.17968455617161, 4.8076923076923075, 1.0, 1.14652874223776, 3.933333333333333, 1.308970099667774, 1.0, 1.7142857142857142, 4.0, 1.0, 1.1068702290076335, 2.3529411764705883, 1.0, 3.0886792452830187, 1.6538461538461537, 15.0, 1.049965776865161, 60.0, 3.25, 2.0, 3.4, 2.6, 1.0479880618896773, 1.0, 1.0, 3.0, 1.0535714285714286, 1.0, 1.4210526315789473, 2.0, 4.0, 2.0, 1.3677536231884058, 1.0, 2.0, 1.0, 140.0, 1.0, 1.0, 1.0449958962970116, 1.0, 18.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 44/50 | Workload-time: 4.162884 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 45/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 27
RandomSeedCommunicator.get: 27
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
40.8 queries/sec
Query 1: actual 35 (0.005%)  origin-forest_43.843 3 (err=11.667)  
76.9 queries/sec
Query 2: actual 7770 (1.114%)  origin-forest_43.843 12079 (err=1.555)  
83.3 queries/sec
Query 3: actual 3484 (0.500%)  origin-forest_43.843 5024 (err=1.442)  
90.9 queries/sec
Query 4: actual 3 (0.000%)  origin-forest_43.843 1 (err=3.000)  
83.3 queries/sec
Query 5: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
95.1 queries/sec
Query 8: actual 589 (0.084%)  origin-forest_43.843 650 (err=1.104)  
90.9 queries/sec
Query 9: actual 2 (0.000%)  origin-forest_43.843 29 (err=14.500)  
76.9 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 12: actual 87 (0.012%)  origin-forest_43.843 1 (err=87.000)  
76.9 queries/sec
Query 13: actual 19485 (2.795%)  origin-forest_43.843 20553 (err=1.055)  
76.9 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
68.9 queries/sec
Query 16: actual 332 (0.048%)  origin-forest_43.843 107 (err=3.103)  
83.3 queries/sec
Query 17: actual 253 (0.036%)  origin-forest_43.843 12 (err=21.083)  
76.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 25 (err=25.000)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 20: actual 232 (0.033%)  origin-forest_43.843 122 (err=1.902)  
83.4 queries/sec
Query 21: actual 2 (0.000%)  origin-forest_43.843 4 (err=2.000)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 2 (0.000%)  origin-forest_43.843 205 (err=102.500)  
86.8 queries/sec
Query 24: actual 23 (0.003%)  origin-forest_43.843 7 (err=3.286)  
79.6 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.3 queries/sec
Query 26: actual 1555 (0.223%)  origin-forest_43.843 933 (err=1.667)  
90.9 queries/sec
Query 27: actual 133 (0.019%)  origin-forest_43.843 1 (err=133.000)  
90.9 queries/sec
Query 28: actual 14 (0.002%)  origin-forest_43.843 18 (err=1.286)  
90.9 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
62.5 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 31: actual 3 (0.000%)  origin-forest_43.843 6 (err=2.000)  
86.8 queries/sec
Query 32: actual 5 (0.001%)  origin-forest_43.843 2 (err=2.500)  
100.0 queries/sec
Query 33: actual 241 (0.035%)  origin-forest_43.843 254 (err=1.054)  
90.9 queries/sec
Query 34: actual 177 (0.025%)  origin-forest_43.843 120 (err=1.475)  
94.7 queries/sec
Query 35: actual 100 (0.014%)  origin-forest_43.843 1 (err=100.000)  
83.3 queries/sec
Query 36: actual 32 (0.005%)  origin-forest_43.843 9 (err=3.556)  
83.3 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 38: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
66.6 queries/sec
Query 39: actual 6 (0.001%)  origin-forest_43.843 2 (err=3.000)  
74.0 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 41: actual 431521 (61.892%)  origin-forest_43.843 387917 (err=1.112)  
62.5 queries/sec
Query 42: actual 187 (0.027%)  origin-forest_43.843 205 (err=1.096)  
55.6 queries/sec
Query 43: actual 255 (0.037%)  origin-forest_43.843 10 (err=25.500)  
76.9 queries/sec
Query 44: actual 45 (0.006%)  origin-forest_43.843 16 (err=2.812)  
71.5 queries/sec
Query 45: actual 39 (0.006%)  origin-forest_43.843 1 (err=39.000)  
66.6 queries/sec
Query 46: actual 242 (0.035%)  origin-forest_43.843 291 (err=1.202)  
86.8 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 48: actual 62 (0.009%)  origin-forest_43.843 6 (err=10.333)  
76.9 queries/sec
Query 49: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
origin-forest_43.843 	max: 133.0000	99th: 118.0550	95th: 94.1500	median: 1.6106	mean: 12.6358
ReportEsts: [1.0, 11.666666666666666, 1.5545688545688545, 1.4420206659012629, 3.0, 2.0, 1.0, 1.0, 1.1035653650254669, 14.5, 1.0, 1.0, 87.0, 1.0548113933795227, 1.0, 1.0, 3.102803738317757, 21.083333333333332, 25.0, 1.0, 1.901639344262295, 2.0, 1.0, 102.5, 3.2857142857142856, 1.0, 1.6666666666666667, 133.0, 1.2857142857142858, 1.0, 1.0, 2.0, 2.5, 1.053941908713693, 1.475, 100.0, 3.5555555555555554, 1.0, 2.0, 3.0, 1.0, 1.112405488803017, 1.0962566844919786, 25.5, 2.8125, 39.0, 1.2024793388429753, 1.0, 10.333333333333334, 2.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 45/50 | Workload-time: 4.202357 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 46/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--data_update=permute-opt', '--dataset=forest', '--drift_test=ddup', '--end2end', '--eval_type=drift']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
Permute - START
Permute - END
load_npy_dataset_from_path - df.shape = (761012, 10)
Parsing... done, took 0.1s
Data updated!
done, took 0.1s
done, took 0.1s
new data average log likelihood = 59.9316
detection mean = 50.7733
detection threshold = 0.4258
test statistic = 9.1583
Offline time = 2.9544897079467773
Online time = 0.5917246341705322
Test result: True
Drift detection: True
[0m
DRIFT-DETECTED after 46-th workload
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\incremental_train.py', '--dataset=forest', '--end2end', '--model_update=update']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (761012, 10)
Parsing... done, took 0.1s
Number of model parameters: 4312876 (~= 16.5MB)
done, took 0.1s
dataset size: 761012
train data shape: torch.Size([10000, 10]), transfer data shape:torch.Size([10000, 10])
Epoch 0 Iter 0, train entropy gap 57.2234 bits (loss 76.761, data 19.538) 0.00100 lr
epoch 9 train loss 52.9239 nats / 76.3530 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 56.8495 bits (loss 76.387, data 19.538) 0.00082 lr
epoch 19 train loss 52.8516 nats / 76.2488 bits
time since start: 7.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 59.8597 nats / 86.3594 bits
Saved to: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
UpdateTask - END
[0m
WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 46/50 | Workload-time: 6.953654 | Model-update-time: 10.818544


WORKLOAD-START | Type: QueryWorkload | Progress: 47/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 28
RandomSeedCommunicator.get: 28
Query 0: actual 2 (0.000%)  origin-forest_43.843 7 (err=3.500)  
37.7 queries/sec
Query 1: actual 31 (0.004%)  origin-forest_43.843 1 (err=31.000)  
71.4 queries/sec
Query 2: actual 45 (0.006%)  origin-forest_43.843 1 (err=45.000)  
76.9 queries/sec
Query 3: actual 314 (0.045%)  origin-forest_43.843 104 (err=3.019)  
71.4 queries/sec
Query 4: actual 14 (0.002%)  origin-forest_43.843 6 (err=2.333)  
71.4 queries/sec
Query 5: actual 18 (0.003%)  origin-forest_43.843 2 (err=9.000)  
71.4 queries/sec
Query 6: actual 63 (0.009%)  origin-forest_43.843 2 (err=31.500)  
71.4 queries/sec
Query 7: actual 29709 (4.261%)  origin-forest_43.843 37866 (err=1.275)  
76.9 queries/sec
Query 8: actual 4 (0.001%)  origin-forest_43.843 4 (err=1.000)  
86.9 queries/sec
Query 9: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 11: actual 77979 (11.184%)  origin-forest_43.843 90599 (err=1.162)  
90.9 queries/sec
Query 12: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
76.9 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 16: actual 193 (0.028%)  origin-forest_43.843 28 (err=6.893)  
82.8 queries/sec
Query 17: actual 19 (0.003%)  origin-forest_43.843 1 (err=19.000)  
83.8 queries/sec
Query 18: actual 84976 (12.188%)  origin-forest_43.843 51920 (err=1.637)  
84.6 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.4 queries/sec
Query 20: actual 48 (0.007%)  origin-forest_43.843 1 (err=48.000)  
71.4 queries/sec
Query 21: actual 201 (0.029%)  origin-forest_43.843 154 (err=1.305)  
76.9 queries/sec
Query 22: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 24: actual 312 (0.045%)  origin-forest_43.843 315 (err=1.010)  
86.8 queries/sec
Query 25: actual 148 (0.021%)  origin-forest_43.843 448 (err=3.027)  
90.9 queries/sec
Query 26: actual 828 (0.119%)  origin-forest_43.843 782 (err=1.059)  
79.5 queries/sec
Query 27: actual 5288 (0.758%)  origin-forest_43.843 5025 (err=1.052)  
100.0 queries/sec
Query 28: actual 138 (0.020%)  origin-forest_43.843 131 (err=1.053)  
90.9 queries/sec
Query 29: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 30: actual 215 (0.031%)  origin-forest_43.843 624 (err=2.902)  
76.9 queries/sec
Query 31: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 33: actual 2257 (0.324%)  origin-forest_43.843 2847 (err=1.261)  
90.9 queries/sec
Query 34: actual 150 (0.022%)  origin-forest_43.843 216 (err=1.440)  
83.3 queries/sec
Query 35: actual 108507 (15.563%)  origin-forest_43.843 77721 (err=1.396)  
100.0 queries/sec
Query 36: actual 3897 (0.559%)  origin-forest_43.843 3635 (err=1.072)  
83.3 queries/sec
Query 37: actual 69 (0.010%)  origin-forest_43.843 130 (err=1.884)  
90.9 queries/sec
Query 38: actual 10077 (1.445%)  origin-forest_43.843 9443 (err=1.067)  
90.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 41: actual 342 (0.049%)  origin-forest_43.843 915 (err=2.675)  
95.1 queries/sec
Query 42: actual 3 (0.000%)  origin-forest_43.843 2 (err=1.500)  
83.3 queries/sec
Query 43: actual 88982 (12.763%)  origin-forest_43.843 98129 (err=1.103)  
90.9 queries/sec
Query 44: actual 208 (0.030%)  origin-forest_43.843 694 (err=3.337)  
83.3 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 46: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 47: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 48: actual 14 (0.002%)  origin-forest_43.843 7 (err=2.000)  
90.9 queries/sec
Query 49: actual 15 (0.002%)  origin-forest_43.843 1 (err=15.000)  
origin-forest_43.843 	max: 48.0000	99th: 46.5300	95th: 31.2750	median: 1.1323	mean: 5.3293
ReportEsts: [3.5, 31.0, 45.0, 3.019230769230769, 2.3333333333333335, 9.0, 31.5, 1.2745632636574775, 1.0, 1.0, 1.0, 1.1618384436835558, 1.0, 1.0, 1.0, 1.0, 6.892857142857143, 19.0, 1.6366718027734977, 1.0, 48.0, 1.3051948051948052, 1.0, 1.0, 1.0096153846153846, 3.027027027027027, 1.0588235294117647, 1.0523383084577114, 1.0534351145038168, 1.0, 2.902325581395349, 1.0, 1.0, 1.2614089499335401, 1.44, 1.3961091596865711, 1.0720770288858321, 1.8840579710144927, 1.0671396801863815, 1.0, 1.0, 2.675438596491228, 1.5, 1.1027960711155065, 3.3365384615384617, 1.0, 1.0, 1.0, 2.0, 15.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 47/50 | Workload-time: 4.270408 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 48/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 29
RandomSeedCommunicator.get: 29
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
39.2 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 2: actual 9 (0.001%)  origin-forest_43.843 1 (err=9.000)  
76.9 queries/sec
Query 3: actual 19 (0.003%)  origin-forest_43.843 1 (err=19.000)  
76.9 queries/sec
Query 4: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 6: actual 2342 (0.336%)  origin-forest_43.843 2494 (err=1.065)  
83.3 queries/sec
Query 7: actual 120321 (17.257%)  origin-forest_43.843 96436 (err=1.248)  
86.8 queries/sec
Query 8: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
76.9 queries/sec
Query 9: actual 65 (0.009%)  origin-forest_43.843 1 (err=65.000)  
90.9 queries/sec
Query 10: actual 27 (0.004%)  origin-forest_43.843 1 (err=27.000)  
71.4 queries/sec
Query 11: actual 21 (0.003%)  origin-forest_43.843 1 (err=21.000)  
55.6 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 3 (err=3.000)  
62.5 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
75.5 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
77.4 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.4 queries/sec
Query 17: actual 385 (0.055%)  origin-forest_43.843 3 (err=128.333)  
90.9 queries/sec
Query 18: actual 6452 (0.925%)  origin-forest_43.843 1310 (err=4.925)  
83.3 queries/sec
Query 19: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 20: actual 284 (0.041%)  origin-forest_43.843 406 (err=1.430)  
83.3 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 22: actual 349 (0.050%)  origin-forest_43.843 327 (err=1.067)  
86.8 queries/sec
Query 23: actual 2560 (0.367%)  origin-forest_43.843 530 (err=4.830)  
90.9 queries/sec
Query 24: actual 32 (0.005%)  origin-forest_43.843 1 (err=32.000)  
90.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 27: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 28: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 29: actual 195 (0.028%)  origin-forest_43.843 283 (err=1.451)  
90.9 queries/sec
Query 30: actual 267 (0.038%)  origin-forest_43.843 111 (err=2.405)  
90.8 queries/sec
Query 31: actual 208 (0.030%)  origin-forest_43.843 241 (err=1.159)  
86.9 queries/sec
Query 32: actual 124 (0.018%)  origin-forest_43.843 26 (err=4.769)  
83.3 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 34: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 35: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 36: actual 6 (0.001%)  origin-forest_43.843 166 (err=27.667)  
83.3 queries/sec
Query 37: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 38: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 39: actual 579 (0.083%)  origin-forest_43.843 365 (err=1.586)  
86.9 queries/sec
Query 40: actual 3 (0.000%)  origin-forest_43.843 6 (err=2.000)  
90.9 queries/sec
Query 41: actual 5 (0.001%)  origin-forest_43.843 5 (err=1.000)  
83.3 queries/sec
Query 42: actual 3 (0.000%)  origin-forest_43.843 3 (err=1.000)  
79.6 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 44: actual 1 (0.000%)  origin-forest_43.843 3 (err=3.000)  
76.9 queries/sec
Query 45: actual 35 (0.005%)  origin-forest_43.843 12 (err=2.917)  
90.9 queries/sec
Query 46: actual 151 (0.022%)  origin-forest_43.843 644 (err=4.265)  
90.8 queries/sec
Query 47: actual 31053 (4.454%)  origin-forest_43.843 32983 (err=1.062)  
90.9 queries/sec
Query 48: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 49: actual 119407 (17.126%)  origin-forest_43.843 78231 (err=1.526)  
origin-forest_43.843 	max: 128.3333	99th: 97.3000	95th: 30.0500	median: 1.0661	mean: 7.9541
ReportEsts: [1.0, 1.0, 9.0, 19.0, 1.0, 1.0, 1.0649017933390266, 1.2476772159774359, 1.0, 65.0, 27.0, 21.0, 3.0, 1.0, 1.0, 1.0, 1.0, 128.33333333333334, 4.925190839694657, 1.0, 1.4295774647887325, 1.0, 1.0672782874617737, 4.830188679245283, 32.0, 1.0, 2.0, 1.0, 1.0, 1.4512820512820512, 2.4054054054054053, 1.1586538461538463, 4.769230769230769, 1.0, 1.0, 1.0, 27.666666666666668, 1.0, 1.0, 1.5863013698630137, 2.0, 1.0, 1.0, 1.0, 3.0, 2.9166666666666665, 4.264900662251655, 1.062151804978585, 1.0, 1.5263386637010903]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 48/50 | Workload-time: 4.126021 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 49/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.1s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 30
RandomSeedCommunicator.get: 30
Query 0: actual 5 (0.001%)  origin-forest_43.843 7 (err=1.400)  
39.8 queries/sec
Query 1: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
71.4 queries/sec
Query 3: actual 1491 (0.214%)  origin-forest_43.843 227 (err=6.568)  
62.5 queries/sec
Query 4: actual 7002 (1.004%)  origin-forest_43.843 26399 (err=3.770)  
76.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 6: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
79.9 queries/sec
Query 7: actual 66 (0.009%)  origin-forest_43.843 1 (err=66.000)  
90.9 queries/sec
Query 8: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.5 queries/sec
Query 9: actual 8448 (1.212%)  origin-forest_43.843 9551 (err=1.131)  
83.3 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 11: actual 67 (0.010%)  origin-forest_43.843 1248 (err=18.627)  
90.9 queries/sec
Query 12: actual 124 (0.018%)  origin-forest_43.843 1 (err=124.000)  
83.3 queries/sec
Query 13: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 14: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
79.9 queries/sec
Query 15: actual 95 (0.014%)  origin-forest_43.843 27 (err=3.519)  
90.8 queries/sec
Query 16: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 17: actual 225 (0.032%)  origin-forest_43.843 253 (err=1.124)  
83.3 queries/sec
Query 18: actual 21 (0.003%)  origin-forest_43.843 8 (err=2.625)  
76.9 queries/sec
Query 19: actual 2 (0.000%)  origin-forest_43.843 2 (err=1.000)  
90.9 queries/sec
Query 20: actual 21 (0.003%)  origin-forest_43.843 9 (err=2.333)  
90.9 queries/sec
Query 21: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 22: actual 55 (0.008%)  origin-forest_43.843 24 (err=2.292)  
83.3 queries/sec
Query 23: actual 1 (0.000%)  origin-forest_43.843 2 (err=2.000)  
86.8 queries/sec
Query 24: actual 18 (0.003%)  origin-forest_43.843 1 (err=18.000)  
76.9 queries/sec
Query 25: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 26: actual 1605 (0.230%)  origin-forest_43.843 1676 (err=1.044)  
100.0 queries/sec
Query 27: actual 17 (0.002%)  origin-forest_43.843 8 (err=2.125)  
83.3 queries/sec
Query 28: actual 179 (0.026%)  origin-forest_43.843 35 (err=5.114)  
83.3 queries/sec
Query 29: actual 876 (0.126%)  origin-forest_43.843 742 (err=1.181)  
90.9 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.8 queries/sec
Query 31: actual 3 (0.000%)  origin-forest_43.843 9 (err=3.000)  
83.3 queries/sec
Query 32: actual 49685 (7.126%)  origin-forest_43.843 27571 (err=1.802)  
95.1 queries/sec
Query 33: actual 875 (0.125%)  origin-forest_43.843 714 (err=1.225)  
83.3 queries/sec
Query 34: actual 91 (0.013%)  origin-forest_43.843 30 (err=3.033)  
83.3 queries/sec
Query 35: actual 1867 (0.268%)  origin-forest_43.843 1580 (err=1.182)  
83.3 queries/sec
Query 36: actual 20 (0.003%)  origin-forest_43.843 1 (err=20.000)  
83.3 queries/sec
Query 37: actual 1483 (0.213%)  origin-forest_43.843 2247 (err=1.515)  
90.9 queries/sec
Query 38: actual 145 (0.021%)  origin-forest_43.843 47 (err=3.085)  
91.0 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 4 (err=4.000)  
76.9 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.8 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 43: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 44: actual 284 (0.041%)  origin-forest_43.843 201 (err=1.413)  
62.5 queries/sec
Query 45: actual 14265 (2.046%)  origin-forest_43.843 18273 (err=1.281)  
66.7 queries/sec
Query 46: actual 2 (0.000%)  origin-forest_43.843 4 (err=2.000)  
58.8 queries/sec
Query 47: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
79.9 queries/sec
Query 48: actual 9 (0.001%)  origin-forest_43.843 1 (err=9.000)  
76.9 queries/sec
Query 49: actual 27 (0.004%)  origin-forest_43.843 4 (err=6.750)  
origin-forest_43.843 	max: 124.0000	99th: 95.5800	95th: 19.3821	median: 1.4065	mean: 6.8228
ReportEsts: [1.4, 1.0, 1.0, 6.568281938325991, 3.770208511853756, 1.0, 1.0, 66.0, 1.0, 1.130563446969697, 1.0, 18.62686567164179, 124.0, 1.0, 1.0, 3.5185185185185186, 1.0, 1.1244444444444444, 2.625, 1.0, 2.3333333333333335, 1.0, 2.2916666666666665, 2.0, 18.0, 1.0, 1.0442367601246105, 2.125, 5.114285714285714, 1.1805929919137466, 1.0, 3.0, 1.8020746436473105, 1.2254901960784315, 3.033333333333333, 1.1816455696202532, 20.0, 1.5151719487525286, 3.0851063829787235, 4.0, 1.0, 1.0, 1.0, 1.0, 1.4129353233830846, 1.2809674027339641, 2.0, 2.0, 9.0, 6.75]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 49/50 | Workload-time: 4.127775 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 50/50
Going to run: ['python', 'F:\\DBGroup\\LearnedCardinalityUpdater\\Naru\\eval_model.py', '--dataset=forest', '--end2end', '--eval_type=estimate']
Torch device: cuda
GET-MODEL-PATH=./models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
ckpts [WindowsPath('F:/DBGroup/LearnedCardinalityUpdater/models/end2end/origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
(697214, 10)
data size: 697214, total size: 697214, split index: [581011 697214]
Parsing... done, took 0.0s
Loading ckpt: F:\DBGroup\LearnedCardinalityUpdater\models\end2end\origin-forest-16.5MB-model62.991-data19.148-100epochs-seed0.pt
RandomSeedCommunicator.get: 31
RandomSeedCommunicator.get: 31
Query 0: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
34.5 queries/sec
Query 1: actual 2 (0.000%)  origin-forest_43.843 6 (err=3.000)  
83.3 queries/sec
Query 2: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
74.0 queries/sec
Query 3: actual 128 (0.018%)  origin-forest_43.843 209 (err=1.633)  
90.9 queries/sec
Query 4: actual 6 (0.001%)  origin-forest_43.843 2 (err=3.000)  
76.9 queries/sec
Query 5: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 6: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 7: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 8: actual 68 (0.010%)  origin-forest_43.843 1 (err=68.000)  
83.3 queries/sec
Query 9: actual 9 (0.001%)  origin-forest_43.843 5 (err=1.800)  
83.3 queries/sec
Query 10: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
80.0 queries/sec
Query 11: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 12: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 13: actual 438 (0.063%)  origin-forest_43.843 454 (err=1.037)  
90.9 queries/sec
Query 14: actual 1332 (0.191%)  origin-forest_43.843 2022 (err=1.518)  
90.9 queries/sec
Query 15: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 16: actual 55 (0.008%)  origin-forest_43.843 15 (err=3.667)  
76.9 queries/sec
Query 17: actual 1838 (0.264%)  origin-forest_43.843 1894 (err=1.030)  
90.9 queries/sec
Query 18: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 19: actual 6 (0.001%)  origin-forest_43.843 1 (err=6.000)  
86.9 queries/sec
Query 20: actual 42 (0.006%)  origin-forest_43.843 1 (err=42.000)  
83.3 queries/sec
Query 21: actual 32944 (4.725%)  origin-forest_43.843 24950 (err=1.320)  
90.9 queries/sec
Query 22: actual 158 (0.023%)  origin-forest_43.843 103 (err=1.534)  
83.3 queries/sec
Query 23: actual 5149 (0.739%)  origin-forest_43.843 4973 (err=1.035)  
90.9 queries/sec
Query 24: actual 7 (0.001%)  origin-forest_43.843 37 (err=5.286)  
90.9 queries/sec
Query 25: actual 22033 (3.160%)  origin-forest_43.843 19635 (err=1.122)  
90.9 queries/sec
Query 26: actual 21901 (3.141%)  origin-forest_43.843 19188 (err=1.141)  
100.0 queries/sec
Query 27: actual 574 (0.082%)  origin-forest_43.843 402 (err=1.428)  
83.3 queries/sec
Query 28: actual 14 (0.002%)  origin-forest_43.843 15 (err=1.071)  
95.1 queries/sec
Query 29: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
83.3 queries/sec
Query 30: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
90.9 queries/sec
Query 31: actual 1154 (0.166%)  origin-forest_43.843 1017 (err=1.135)  
90.9 queries/sec
Query 32: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 33: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 34: actual 39414 (5.653%)  origin-forest_43.843 50072 (err=1.270)  
83.3 queries/sec
Query 35: actual 68 (0.010%)  origin-forest_43.843 82 (err=1.206)  
90.9 queries/sec
Query 36: actual 67 (0.010%)  origin-forest_43.843 21 (err=3.190)  
80.0 queries/sec
Query 37: actual 4 (0.001%)  origin-forest_43.843 2 (err=2.000)  
83.3 queries/sec
Query 38: actual 23 (0.003%)  origin-forest_43.843 1 (err=23.000)  
76.9 queries/sec
Query 39: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 40: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
76.9 queries/sec
Query 41: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
83.3 queries/sec
Query 42: actual 488 (0.070%)  origin-forest_43.843 66 (err=7.394)  
83.3 queries/sec
Query 43: actual 9 (0.001%)  origin-forest_43.843 37 (err=4.111)  
83.3 queries/sec
Query 44: actual 692 (0.099%)  origin-forest_43.843 169 (err=4.095)  
90.9 queries/sec
Query 45: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
86.9 queries/sec
Query 46: actual 2 (0.000%)  origin-forest_43.843 1 (err=2.000)  
76.9 queries/sec
Query 47: actual 17 (0.002%)  origin-forest_43.843 1 (err=17.000)  
90.9 queries/sec
Query 48: actual 4 (0.001%)  origin-forest_43.843 8 (err=2.000)  
83.4 queries/sec
Query 49: actual 1 (0.000%)  origin-forest_43.843 1 (err=1.000)  
origin-forest_43.843 	max: 68.0000	99th: 55.2600	95th: 20.3000	median: 1.1736	mean: 4.7005
ReportEsts: [1.0, 3.0, 1.0, 1.6328125, 3.0, 1.0, 1.0, 1.0, 68.0, 1.8, 1.0, 1.0, 1.0, 1.0365296803652968, 1.518018018018018, 1.0, 3.6666666666666665, 1.030467899891186, 1.0, 6.0, 42.0, 1.3204008016032065, 1.5339805825242718, 1.035391112004826, 5.285714285714286, 1.1221288515406163, 1.141390452366062, 1.427860696517413, 1.0714285714285714, 2.0, 1.0, 1.134709931170108, 1.0, 1.0, 1.270411528898361, 1.2058823529411764, 3.1904761904761907, 2.0, 23.0, 1.0, 1.0, 1.0, 7.393939393939394, 4.111111111111111, 4.094674556213017, 1.0, 2.0, 17.0, 2.0, 1.0]
...Done, result: results.csv
[0m
WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 50/50 | Workload-time: 4.132065 | Model-update-time: 0.000000





Experiment Summary: #drift=18 | total-time=454.608008
